!function(e){function r(e,r,o){return 4===arguments.length?t.apply(this,arguments):void n(e,{declarative:!0,deps:r,declare:o})}function t(e,r,t,o){n(e,{declarative:!1,deps:r,executingRequire:t,execute:o})}function n(e,r){r.name=e,e in v||(v[e]=r),r.normalizedDeps=r.deps}function o(e,r){if(r[e.groupIndex]=r[e.groupIndex]||[],-1==g.call(r[e.groupIndex],e)){r[e.groupIndex].push(e);for(var t=0,n=e.normalizedDeps.length;n>t;t++){var a=e.normalizedDeps[t],u=v[a];if(u&&!u.evaluated){var d=e.groupIndex+(u.declarative!=e.declarative);if(void 0===u.groupIndex||u.groupIndex<d){if(void 0!==u.groupIndex&&(r[u.groupIndex].splice(g.call(r[u.groupIndex],u),1),0==r[u.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");u.groupIndex=d}o(u,r)}}}}function a(e){var r=v[e];r.groupIndex=0;var t=[];o(r,t);for(var n=!!r.declarative==t.length%2,a=t.length-1;0<=a;a--){for(var u=t[a],i=0,s;i<u.length;i++)s=u[i],n?d(s):l(s);n=!n}}function u(e){return y[e]||(y[e]={name:e,dependencies:[],exports:{},importers:[]})}function d(r){if(!r.module){var t=r.module=u(r.name),n=r.module.exports,o=r.declare.call(e,function(e,r){if(t.locked=!0,"object"==typeof e)for(var o in e)n[o]=e[o];else n[e]=r;for(var a=0,u=t.importers.length,d;u>a;a++)if(d=t.importers[a],!d.locked)for(var i=0;i<d.dependencies.length;++i)d.dependencies[i]===t&&d.setters[i](n);return t.locked=!1,r},{id:r.name});t.setters=o.setters,t.execute=o.execute;for(var a=0,i=r.normalizedDeps.length;i>a;a++){var s=r.normalizedDeps[a],c=v[s],f=y[s],l;f?l=f.exports:c&&!c.declarative?l=c.esModule:c?(d(c),f=c.module,l=f.exports):l=p(s),f&&f.importers?(f.importers.push(t),t.dependencies.push(f)):t.dependencies.push(null),t.setters[a]&&t.setters[a](l)}}}function i(e){var t=v[e],r;if(t)t.declarative?f(e,[]):t.evaluated||l(t),r=t.module.exports;else if(r=p(e),!r)throw new Error("Unable to load dependency "+e+".");return(!t||t.declarative)&&r&&r.__useDefault?r["default"]:r}function l(r){if(!r.module){var t={},n=r.module={exports:t,id:r.name};if(!r.executingRequire)for(var o=0,a=r.normalizedDeps.length;a>o;o++){var u=r.normalizedDeps[o],d=v[u];d&&l(d)}r.evaluated=!0;var c=r.execute.call(e,function(e){for(var t=0,n=r.deps.length;n>t;t++)if(r.deps[t]==e)return i(r.normalizedDeps[t]);throw new TypeError("Module "+e+" not declared as a dependency.")},t,n);void 0!==c&&(n.exports=c),t=n.exports,r.esModule=t&&t.__esModule?t:s(t)}}function s(r){var t={};if(("object"==typeof r||"function"==typeof r)&&r!==e)if(m)for(var n in r)"default"!==n&&c(t,r,n);else{var o=r&&r.hasOwnProperty;for(var n in r)"default"===n||o&&!r.hasOwnProperty(n)||(t[n]=r[n])}return t["default"]=r,x(t,"__useDefault",{value:!0}),t}function c(e,r,t){try{var n;(n=Object.getOwnPropertyDescriptor(r,t))&&x(e,t,n)}catch(o){return e[t]=r[t],!1}}function f(r,t){var n=v[r];if(n&&!n.evaluated&&n.declarative){t.push(r);for(var o=0,a=n.normalizedDeps.length,u;a>o;o++)u=n.normalizedDeps[o],-1==g.call(t,u)&&(v[u]?f(u,t):p(u));n.evaluated||(n.evaluated=!0,n.module.execute.call(e))}}function p(e){if(I[e])return I[e];if("@node/"==e.substr(0,6))return I[e]=s(D(e.substr(6)));var r=v[e];if(!r)throw"Module "+e+" not present.";return a(e),f(e,[]),v[e]=void 0,r.declarative&&x(r.module.exports,"__esModule",{value:!0}),I[e]=r.declarative?r.module.exports:r.esModule}var v={},g=Array.prototype.indexOf||function(e){for(var r=0,t=this.length;t>r;r++)if(this[r]===e)return r;return-1},m=!0;try{Object.getOwnPropertyDescriptor({a:0},"a")}catch(h){m=!1}var x;!function(){try{Object.defineProperty({},"a",{})&&(x=Object.defineProperty)}catch(e){x=function(e,r,t){try{e[r]=t.value||t.get.call(e)}catch(n){}}}}();var y={},D="undefined"!=typeof System&&System._nodeRequire||"undefined"!=typeof require&&"undefined"!=typeof require.resolve&&"undefined"!=typeof process&&process.platform&&require,I={"@empty":{}};return function(e,n,o,a){return function(u){u(function(){for(var d={_nodeRequire:D,register:r,registerDynamic:t,get:p,set:function(e,r){I[e]=r},newModule:function(e){return e}},i=0;i<n.length;i++)(function(e,r){I[e]=r&&r.__esModule?r:s(r)})(n[i],arguments[i]);a(d);var l=p(e[0]);if(1<e.length)for(var i=1;i<e.length;i++)p(e[i]);return o?l["default"]:l})}}}("undefined"==typeof self?global:self)(["1","2"],[],!0,function($__System){var _MathLN=Math.LN2,_Mathlog=Math.log,_Mathmax=Math.max,_Mathabs=Math.abs,_Mathmin=Math.min,_Mathpow=Math.pow,_StringfromCharCode=String.fromCharCode,_Mathceil=Math.ceil,_Mathfloor=Math.floor,_Mathround=Math.round,require=this.require,exports=this.exports,module=this.module;!function(e){function r(e,r){for(var n=e.split(".");n.length;)r=r[n.shift()];return r}function n(n){if("string"==typeof n)return r(n,e);if(!(n instanceof Array))throw new Error("Global exports must be a string or array.");for(var t={},o=!0,f=0,i;f<n.length;f++)i=r(n[f],e),o&&(t["default"]=i,o=!1),t[n[f].split(".").pop()]=i;return t}function t(r){if(Object.keys)Object.keys(e).forEach(r);else for(var n in e)a.call(e,n)&&r(n)}function o(r){t(function(n){if(-1==l.call(s,n)){try{var t=e[n]}catch(o){s.push(n)}r(n,t)}})}var i=$__System,a=Object.prototype.hasOwnProperty,l=Array.prototype.indexOf||function(e){for(var r=0,n=this.length;n>r;r++)if(this[r]===e)return r;return-1},s=["_g","sessionStorage","localStorage","clipboardData","frames","frameElement","external","mozAnimationStartTime","webkitStorageInfo","webkitIndexedDB","mozInnerScreenY","mozInnerScreenX"],f;i.set("@@global-helpers",i.newModule({prepareGlobal:function(r,t,i){var a=e.define;e.define=void 0;var l;if(i)for(var s in l={},i)l[s]=e[s],e[s]=i[s];return t||(f={},o(function(e,r){f[e]=r})),function(){var r;if(t)r=n(t);else{r={};var i,s;o(function(e,n){f[e]!==n&&"undefined"!=typeof n&&(r[e]=n,"undefined"==typeof i?i=n:s||i===n||(s=!0))}),r=s?r:i}if(l)for(var u in l)e[u]=l[u];return e.define=a,r}}}))}("undefined"==typeof self?global:self),!function(e){function n(e,n){e=e.replace(l,"");var r=e.match(u),t=(r[1].split(",")[n]||"require").replace(s,""),i=p[t]||(p[t]=new RegExp(a+t+f,"g"));i.lastIndex=0;for(var c=[],o;o=i.exec(e);)c.push(o[2]||o[3]);return c}function r(e,n,t,o){if("object"==typeof e&&!(e instanceof Array))return r.apply(null,Array.prototype.splice.call(arguments,1,arguments.length-1));if("string"==typeof e&&"function"==typeof n&&(e=[e]),!(e instanceof Array)){if("string"==typeof e){var l=i.get(e);return l.__useDefault?l["default"]:l}throw new TypeError("Invalid require")}for(var a=[],f=0;f<e.length;f++)a.push(i["import"](e[f],o));Promise.all(a).then(function(e){n&&n.apply(null,e)},t)}function t(t,l,a){"string"!=typeof t&&(a=l,l=t,t=null),l instanceof Array||(a=l,l=["require","exports","module"].splice(0,a.length)),"function"!=typeof a&&(a=function(e){return function(){return e}}(a)),void 0===l[l.length-1]&&l.pop();var f,u,s;-1!=(f=o.call(l,"require"))&&(l.splice(f,1),t||(l=l.concat(n(a.toString(),f)))),-1!=(u=o.call(l,"exports"))&&l.splice(u,1),-1!=(s=o.call(l,"module"))&&l.splice(s,1);var p={name:t,deps:l,execute:function(n,t,o){for(var p=[],c=0;c<l.length;c++)p.push(n(l[c]));o.uri=o.id,o.config=function(){},-1!=s&&p.splice(s,0,o),-1!=u&&p.splice(u,0,t),-1!=f&&p.splice(f,0,function(e,t,l){return"string"==typeof e&&"function"!=typeof t?n(e):r.call(i,e,t,l,o.id)});var d=a.apply(-1==u?e:t,p);return"undefined"==typeof d&&o&&(d=o.exports),"undefined"==typeof d?void 0:d}};if(t)c.anonDefine||c.isBundle?c.anonDefine&&c.anonDefine.name&&(c.anonDefine=null):c.anonDefine=p,c.isBundle=!0,i.registerDynamic(p.name,p.deps,!1,p.execute);else{if(c.anonDefine&&!c.anonDefine.name)throw new Error("Multiple anonymous defines in module "+t);c.anonDefine=p}}var i=$__System,o=Array.prototype.indexOf||function(e){for(var n=0,r=this.length;r>n;n++)if(this[n]===e)return n;return-1},l=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,a="(?:^|[^$_a-zA-Z\\xA0-\\uFFFF.])",f="\\s*\\(\\s*(\"([^\"]+)\"|'([^']+)')\\s*\\)",u=/\(([^\)]*)\)/,s=/^\s+|\s+$/g,p={};t.amd={};var c={isBundle:!1,anonDefine:null};i.amdDefine=t,i.amdRequire=r}("undefined"==typeof self?global:self),$__System.registerDynamic("1",[],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function(){System.config({baseURL:"./",defaultJSExtensions:!0,transpiler:"babel",babelOptions:{optional:["runtime","optimisation.modules.system"]},paths:{"*":"./JavaScript/js/*","mock/*":"./JavaScript/mock/*","./*":"./*","github:*":"jspm_packages/github/*","npm:*":"jspm_packages/npm/*"},packages:{"summernote/summernote":{format:"cjs"}},meta:{"*/RTCMultiConnection.js":{format:"global"},"Editor/lib/codemirror/codemirror.js":{format:"global"},"Editor/lib/codemirror/css.js":{deps:["Editor/lib/codemirror/codemirror.js"]},"Editor/lib/codemirror/formatting.js":{deps:["Editor/lib/codemirror/codemirror.js"]},"Editor/lib/codemirror/htmlmixed.js":{deps:["Editor/lib/codemirror/codemirror.js"]},"Editor/lib/codemirror/javascript.js":{deps:["Editor/lib/codemirror/codemirror.js"]}},map:{"AkeemMcLennon/dom2hscript":"github:AkeemMcLennon/dom2hscript@master","Weedshaker/virtual-dom":"github:Weedshaker/virtual-dom@2.1.2",babel:"npm:babel-core@5.8.38","babel-runtime":"npm:babel-runtime@5.8.38",bootstrap:"github:twbs/bootstrap@3.3.7","capaj/systemjs-hot-reloader":"github:alexisvincent/systemjs-hot-reloader@0.6.0","core-js":"npm:core-js@1.2.7","hockic/summernote-ext-filedialog":"github:hockic/summernote-ext-filedialog@master",jquery:"npm:jquery@3.3.1","muaz-khan/RTCMultiConnection":"github:muaz-khan/RTCMultiConnection@3.4.4","parse-torrent":"npm:parse-torrent@5.8.3","pieroxy/lz-string":"github:pieroxy/lz-string@1.4.4","socket.io-client":"github:socketio/socket.io-client@1.7.4","summernote/summernote":"github:summernote/summernote@0.8.10","tanaka-de-silva/google-diff-match-patch-js":"github:tanaka-de-silva/google-diff-match-patch-js@1.0.0","webtorrent/webtorrent":"github:webtorrent/webtorrent@0.98.24","xuset/indexeddb-chunk-store":"github:xuset/indexeddb-chunk-store@2.2.1","github:alexisvincent/systemjs-hot-reloader@0.6.0":{debug:"npm:debug@2.6.9","socket.io-client":"github:socketio/socket.io-client@1.7.4",weakee:"npm:weakee@1.0.0"},"github:jspm/nodelibs-assert@0.1.0":{assert:"npm:assert@1.4.1"},"github:jspm/nodelibs-buffer@0.1.1":{buffer:"npm:buffer@5.1.0"},"github:jspm/nodelibs-constants@0.1.0":{"constants-browserify":"npm:constants-browserify@0.0.1"},"github:jspm/nodelibs-crypto@0.1.0":{"crypto-browserify":"npm:crypto-browserify@3.12.0"},"github:jspm/nodelibs-events@0.1.1":{events:"npm:events@1.0.2"},"github:jspm/nodelibs-http@1.7.1":{Base64:"npm:Base64@0.2.1",events:"github:jspm/nodelibs-events@0.1.1",inherits:"npm:inherits@2.0.1",stream:"github:jspm/nodelibs-stream@0.1.0",url:"github:jspm/nodelibs-url@0.1.0",util:"github:jspm/nodelibs-util@0.1.0"},"github:jspm/nodelibs-https@0.1.0":{"https-browserify":"npm:https-browserify@0.0.0"},"github:jspm/nodelibs-path@0.1.0":{"path-browserify":"npm:path-browserify@0.0.0"},"github:jspm/nodelibs-process@0.1.2":{process:"npm:process@0.11.10"},"github:jspm/nodelibs-querystring@0.1.0":{querystring:"npm:querystring@0.2.0"},"github:jspm/nodelibs-stream@0.1.0":{"stream-browserify":"npm:stream-browserify@1.0.0"},"github:jspm/nodelibs-string_decoder@0.1.0":{string_decoder:"npm:string_decoder@0.10.31"},"github:jspm/nodelibs-url@0.1.0":{url:"npm:url@0.10.3"},"github:jspm/nodelibs-util@0.1.0":{util:"npm:util@0.10.3"},"github:jspm/nodelibs-vm@0.1.0":{"vm-browserify":"npm:vm-browserify@0.0.4"},"github:twbs/bootstrap@3.3.7":{jquery:"npm:jquery@3.3.1"},"npm:asn1.js@4.10.1":{"bn.js":"npm:bn.js@4.11.8",buffer:"github:jspm/nodelibs-buffer@0.1.1",inherits:"npm:inherits@2.0.3","minimalistic-assert":"npm:minimalistic-assert@1.0.0",vm:"github:jspm/nodelibs-vm@0.1.0"},"npm:assert@1.4.1":{assert:"github:jspm/nodelibs-assert@0.1.0",buffer:"github:jspm/nodelibs-buffer@0.1.1",process:"github:jspm/nodelibs-process@0.1.2",util:"npm:util@0.10.3"},"npm:babel-runtime@5.8.38":{process:"github:jspm/nodelibs-process@0.1.2"},"npm:bencode@2.0.0":{buffer:"github:jspm/nodelibs-buffer@0.1.1","safe-buffer":"npm:safe-buffer@5.1.1"},"npm:blob-to-buffer@1.2.7":{buffer:"github:jspm/nodelibs-buffer@0.1.1"},"npm:browserify-aes@1.1.1":{buffer:"github:jspm/nodelibs-buffer@0.1.1","buffer-xor":"npm:buffer-xor@1.0.3","cipher-base":"npm:cipher-base@1.0.4","create-hash":"npm:create-hash@1.1.3",crypto:"github:jspm/nodelibs-crypto@0.1.0",evp_bytestokey:"npm:evp_bytestokey@1.0.3",inherits:"npm:inherits@2.0.1","safe-buffer":"npm:safe-buffer@5.1.1","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:browserify-cipher@1.0.0":{"browserify-aes":"npm:browserify-aes@1.1.1","browserify-des":"npm:browserify-des@1.0.0",buffer:"github:jspm/nodelibs-buffer@0.1.1",crypto:"github:jspm/nodelibs-crypto@0.1.0",evp_bytestokey:"npm:evp_bytestokey@1.0.3"},"npm:browserify-des@1.0.0":{buffer:"github:jspm/nodelibs-buffer@0.1.1","cipher-base":"npm:cipher-base@1.0.4",crypto:"github:jspm/nodelibs-crypto@0.1.0","des.js":"npm:des.js@1.0.0",inherits:"npm:inherits@2.0.1"},"npm:browserify-rsa@4.0.1":{"bn.js":"npm:bn.js@4.11.8",buffer:"github:jspm/nodelibs-buffer@0.1.1",constants:"github:jspm/nodelibs-constants@0.1.0",crypto:"github:jspm/nodelibs-crypto@0.1.0",randombytes:"npm:randombytes@2.0.6"},"npm:browserify-sign@4.0.4":{"bn.js":"npm:bn.js@4.11.8","browserify-rsa":"npm:browserify-rsa@4.0.1",buffer:"github:jspm/nodelibs-buffer@0.1.1","create-hash":"npm:create-hash@1.1.3","create-hmac":"npm:create-hmac@1.1.6",crypto:"github:jspm/nodelibs-crypto@0.1.0",elliptic:"npm:elliptic@6.4.0",inherits:"npm:inherits@2.0.1","parse-asn1":"npm:parse-asn1@5.1.0",stream:"github:jspm/nodelibs-stream@0.1.0","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:buffer-xor@1.0.3":{buffer:"github:jspm/nodelibs-buffer@0.1.1","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:buffer@5.1.0":{"base64-js":"npm:base64-js@1.3.0",ieee754:"npm:ieee754@1.1.12"},"npm:cipher-base@1.0.4":{buffer:"github:jspm/nodelibs-buffer@0.1.1",inherits:"npm:inherits@2.0.1","safe-buffer":"npm:safe-buffer@5.1.1",stream:"github:jspm/nodelibs-stream@0.1.0",string_decoder:"github:jspm/nodelibs-string_decoder@0.1.0"},"npm:constants-browserify@0.0.1":{"systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:core-js@1.2.7":{fs:"github:jspm/nodelibs-fs@0.1.2",path:"github:jspm/nodelibs-path@0.1.0",process:"github:jspm/nodelibs-process@0.1.2","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:core-util-is@1.0.2":{buffer:"github:jspm/nodelibs-buffer@0.1.1"},"npm:create-ecdh@4.0.0":{"bn.js":"npm:bn.js@4.11.8",buffer:"github:jspm/nodelibs-buffer@0.1.1",crypto:"github:jspm/nodelibs-crypto@0.1.0",elliptic:"npm:elliptic@6.4.0"},"npm:create-hash@1.1.3":{buffer:"github:jspm/nodelibs-buffer@0.1.1","cipher-base":"npm:cipher-base@1.0.4",crypto:"github:jspm/nodelibs-crypto@0.1.0",inherits:"npm:inherits@2.0.1",ripemd160:"npm:ripemd160@2.0.1","sha.js":"npm:sha.js@2.4.10"},"npm:create-hmac@1.1.6":{buffer:"github:jspm/nodelibs-buffer@0.1.1","cipher-base":"npm:cipher-base@1.0.4","create-hash":"npm:create-hash@1.1.3",crypto:"github:jspm/nodelibs-crypto@0.1.0",inherits:"npm:inherits@2.0.1",ripemd160:"npm:ripemd160@2.0.1","safe-buffer":"npm:safe-buffer@5.1.1","sha.js":"npm:sha.js@2.4.10"},"npm:crypto-browserify@3.12.0":{"browserify-cipher":"npm:browserify-cipher@1.0.0","browserify-sign":"npm:browserify-sign@4.0.4","create-ecdh":"npm:create-ecdh@4.0.0","create-hash":"npm:create-hash@1.1.3","create-hmac":"npm:create-hmac@1.1.6","diffie-hellman":"npm:diffie-hellman@5.0.2",inherits:"npm:inherits@2.0.1",pbkdf2:"npm:pbkdf2@3.0.14","public-encrypt":"npm:public-encrypt@4.0.0",randombytes:"npm:randombytes@2.0.6",randomfill:"npm:randomfill@1.0.4"},"npm:debug@2.6.9":{ms:"npm:ms@2.0.0"},"npm:des.js@1.0.0":{buffer:"github:jspm/nodelibs-buffer@0.1.1",inherits:"npm:inherits@2.0.1","minimalistic-assert":"npm:minimalistic-assert@1.0.0"},"npm:diffie-hellman@5.0.2":{"bn.js":"npm:bn.js@4.11.8",buffer:"github:jspm/nodelibs-buffer@0.1.1",crypto:"github:jspm/nodelibs-crypto@0.1.0","miller-rabin":"npm:miller-rabin@4.0.1",randombytes:"npm:randombytes@2.0.6","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:elliptic@6.4.0":{"bn.js":"npm:bn.js@4.11.8",brorand:"npm:brorand@1.1.0","hash.js":"npm:hash.js@1.1.3","hmac-drbg":"npm:hmac-drbg@1.0.1",inherits:"npm:inherits@2.0.1","minimalistic-assert":"npm:minimalistic-assert@1.0.0","minimalistic-crypto-utils":"npm:minimalistic-crypto-utils@1.0.1","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:evp_bytestokey@1.0.3":{buffer:"github:jspm/nodelibs-buffer@0.1.1","md5.js":"npm:md5.js@1.3.4","safe-buffer":"npm:safe-buffer@5.1.1"},"npm:get-stdin@5.0.1":{buffer:"github:jspm/nodelibs-buffer@0.1.1",process:"github:jspm/nodelibs-process@0.1.2"},"npm:hash-base@2.0.2":{buffer:"github:jspm/nodelibs-buffer@0.1.1",inherits:"npm:inherits@2.0.3",stream:"github:jspm/nodelibs-stream@0.1.0"},"npm:hash-base@3.0.4":{buffer:"github:jspm/nodelibs-buffer@0.1.1",inherits:"npm:inherits@2.0.3","safe-buffer":"npm:safe-buffer@5.1.1",stream:"github:jspm/nodelibs-stream@0.1.0"},"npm:hash.js@1.1.3":{inherits:"npm:inherits@2.0.3","minimalistic-assert":"npm:minimalistic-assert@1.0.0"},"npm:hmac-drbg@1.0.1":{"hash.js":"npm:hash.js@1.1.3","minimalistic-assert":"npm:minimalistic-assert@1.0.0","minimalistic-crypto-utils":"npm:minimalistic-crypto-utils@1.0.1","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:https-browserify@0.0.0":{http:"github:jspm/nodelibs-http@1.7.1"},"npm:inherits@2.0.1":{util:"github:jspm/nodelibs-util@0.1.0"},"npm:inherits@2.0.3":{util:"github:jspm/nodelibs-util@0.1.0"},"npm:magnet-uri@5.1.7":{buffer:"github:jspm/nodelibs-buffer@0.1.1","safe-buffer":"npm:safe-buffer@5.1.1","thirty-two":"npm:thirty-two@1.0.2",uniq:"npm:uniq@1.0.1",xtend:"npm:xtend@4.0.1"},"npm:md5.js@1.3.4":{buffer:"github:jspm/nodelibs-buffer@0.1.1","hash-base":"npm:hash-base@3.0.4",inherits:"npm:inherits@2.0.1"},"npm:miller-rabin@4.0.1":{"bn.js":"npm:bn.js@4.11.8",brorand:"npm:brorand@1.1.0"},"npm:once@1.4.0":{wrappy:"npm:wrappy@1.0.2"},"npm:parse-asn1@5.1.0":{"asn1.js":"npm:asn1.js@4.10.1","browserify-aes":"npm:browserify-aes@1.1.1",buffer:"github:jspm/nodelibs-buffer@0.1.1","create-hash":"npm:create-hash@1.1.3",evp_bytestokey:"npm:evp_bytestokey@1.0.3",pbkdf2:"npm:pbkdf2@3.0.14","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:parse-torrent-file@4.1.0":{bencode:"npm:bencode@2.0.0",buffer:"github:jspm/nodelibs-buffer@0.1.1",path:"github:jspm/nodelibs-path@0.1.0","simple-sha1":"npm:simple-sha1@2.1.0",uniq:"npm:uniq@1.0.1"},"npm:parse-torrent@5.8.3":{"blob-to-buffer":"npm:blob-to-buffer@1.2.7",buffer:"github:jspm/nodelibs-buffer@0.1.1",fs:"github:jspm/nodelibs-fs@0.1.2","get-stdin":"npm:get-stdin@5.0.1","magnet-uri":"npm:magnet-uri@5.1.7","parse-torrent-file":"npm:parse-torrent-file@4.1.0",process:"github:jspm/nodelibs-process@0.1.2","simple-get":"npm:simple-get@2.7.0","systemjs-json":"github:systemjs/plugin-json@0.1.2"},"npm:path-browserify@0.0.0":{process:"github:jspm/nodelibs-process@0.1.2"},"npm:pbkdf2@3.0.14":{buffer:"github:jspm/nodelibs-buffer@0.1.1","create-hash":"npm:create-hash@1.1.3","create-hmac":"npm:create-hmac@1.1.6",crypto:"github:jspm/nodelibs-crypto@0.1.0",process:"github:jspm/nodelibs-process@0.1.2",ripemd160:"npm:ripemd160@2.0.1","safe-buffer":"npm:safe-buffer@5.1.1","sha.js":"npm:sha.js@2.4.10"},"npm:process@0.11.10":{assert:"github:jspm/nodelibs-assert@0.1.0",fs:"github:jspm/nodelibs-fs@0.1.2",vm:"github:jspm/nodelibs-vm@0.1.0"},"npm:public-encrypt@4.0.0":{"bn.js":"npm:bn.js@4.11.8","browserify-rsa":"npm:browserify-rsa@4.0.1",buffer:"github:jspm/nodelibs-buffer@0.1.1","create-hash":"npm:create-hash@1.1.3",crypto:"github:jspm/nodelibs-crypto@0.1.0","parse-asn1":"npm:parse-asn1@5.1.0",randombytes:"npm:randombytes@2.0.6"},"npm:punycode@1.3.2":{process:"github:jspm/nodelibs-process@0.1.2"},"npm:randombytes@2.0.6":{buffer:"github:jspm/nodelibs-buffer@0.1.1",crypto:"github:jspm/nodelibs-crypto@0.1.0",process:"github:jspm/nodelibs-process@0.1.2","safe-buffer":"npm:safe-buffer@5.1.1"},"npm:randomfill@1.0.4":{buffer:"github:jspm/nodelibs-buffer@0.1.1",crypto:"github:jspm/nodelibs-crypto@0.1.0",process:"github:jspm/nodelibs-process@0.1.2",randombytes:"npm:randombytes@2.0.6","safe-buffer":"npm:safe-buffer@5.1.1"},"npm:readable-stream@1.1.14":{buffer:"github:jspm/nodelibs-buffer@0.1.1","core-util-is":"npm:core-util-is@1.0.2",events:"github:jspm/nodelibs-events@0.1.1",inherits:"npm:inherits@2.0.3",isarray:"npm:isarray@0.0.1",process:"github:jspm/nodelibs-process@0.1.2","stream-browserify":"npm:stream-browserify@1.0.0",string_decoder:"npm:string_decoder@0.10.31"},"npm:ripemd160@2.0.1":{buffer:"github:jspm/nodelibs-buffer@0.1.1","hash-base":"npm:hash-base@2.0.2",inherits:"npm:inherits@2.0.1"},"npm:rusha@0.8.13":{buffer:"github:jspm/nodelibs-buffer@0.1.1"},"npm:safe-buffer@5.1.1":{buffer:"github:jspm/nodelibs-buffer@0.1.1"},"npm:sha.js@2.4.10":{buffer:"github:jspm/nodelibs-buffer@0.1.1",fs:"github:jspm/nodelibs-fs@0.1.2",inherits:"npm:inherits@2.0.1",process:"github:jspm/nodelibs-process@0.1.2","safe-buffer":"npm:safe-buffer@5.1.1"},"npm:simple-concat@1.0.0":{buffer:"github:jspm/nodelibs-buffer@0.1.1"},"npm:simple-get@2.7.0":{buffer:"github:jspm/nodelibs-buffer@0.1.1",http:"github:jspm/nodelibs-http@1.7.1",https:"github:jspm/nodelibs-https@0.1.0",once:"npm:once@1.4.0",querystring:"github:jspm/nodelibs-querystring@0.1.0","simple-concat":"npm:simple-concat@1.0.0",url:"github:jspm/nodelibs-url@0.1.0"},"npm:simple-sha1@2.1.0":{buffer:"github:jspm/nodelibs-buffer@0.1.1",crypto:"github:jspm/nodelibs-crypto@0.1.0",process:"github:jspm/nodelibs-process@0.1.2",rusha:"npm:rusha@0.8.13"},"npm:stream-browserify@1.0.0":{events:"github:jspm/nodelibs-events@0.1.1",inherits:"npm:inherits@2.0.3","readable-stream":"npm:readable-stream@1.1.14"},"npm:string_decoder@0.10.31":{buffer:"github:jspm/nodelibs-buffer@0.1.1"},"npm:thirty-two@1.0.2":{assert:"github:jspm/nodelibs-assert@0.1.0",buffer:"github:jspm/nodelibs-buffer@0.1.1"},"npm:url@0.10.3":{assert:"github:jspm/nodelibs-assert@0.1.0",punycode:"npm:punycode@1.3.2",querystring:"npm:querystring@0.2.0",util:"github:jspm/nodelibs-util@0.1.0"},"npm:util@0.10.3":{inherits:"npm:inherits@2.0.1",process:"github:jspm/nodelibs-process@0.1.2"},"npm:vm-browserify@0.0.4":{indexof:"npm:indexof@0.0.1"}}})}(this),_retrieveGlobal()}),$__System.register("3",["4","5","6","7"],function(_export){var MasterLastMessage,_get,_inherits,_classCallCheck,SentMessage;return{setters:[function(_4){MasterLastMessage=_4.MasterLastMessage},function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]}],execute:function(){"use strict";SentMessage=function(_MasterLastMessage){function SentMessage(elID,remoteUserId){_classCallCheck(this,SentMessage),_get(Object.getPrototypeOf(SentMessage.prototype),"constructor",this).call(this,elID,remoteUserId)}return _inherits(SentMessage,_MasterLastMessage),SentMessage}(MasterLastMessage),_export("SentMessage",SentMessage)}}}),$__System.registerDynamic("8",["9"],!0,function($__require,exports){"use strict";var global=this||self,_Object$defineProperty=$__require("9")["default"];exports["default"]=function(obj,key,value){return key in obj?_Object$defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj},exports.__esModule=!0}),$__System.register("4",["7","8","a"],function(_export){var _classCallCheck,_defineProperty,_createClass,MasterLastMessage;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_defineProperty=_2["default"]},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterLastMessage=function(){function MasterLastMessage(){var elID=0>=arguments.length||void 0===arguments[0]?"sst_all":arguments[0],remoteUserId=1>=arguments.length||void 0===arguments[1]?"sst_toAll":arguments[1];_classCallCheck(this,MasterLastMessage),this.elID=elID,this.remoteUserId=remoteUserId,this.cont=_defineProperty({},this.remoteUserId,_defineProperty({},this.elID,""))}return _createClass(MasterLastMessage,[{key:"set",value:function(message){var elID=1>=arguments.length||void 0===arguments[1]?this.elID:arguments[1],remoteUserId=2>=arguments.length||void 0===arguments[2]?this.remoteUserId:arguments[2];this.cont[remoteUserId]||(this.cont[remoteUserId]={}),this.cont[remoteUserId][elID]=[new Date().getTime(),message]}},{key:"get",value:function(){var elID=0>=arguments.length||void 0===arguments[0]?this.elID:arguments[0],remoteUserId=1>=arguments.length||void 0===arguments[1]?this.remoteUserId:arguments[1];return!!(this.cont[remoteUserId]&&this.cont[remoteUserId][elID])&&this.cont[remoteUserId][elID][1]}},{key:"getLatestElIDvsToAll",value:function(){var elID=0>=arguments.length||void 0===arguments[0]?this.elID:arguments[0],remoteUserId=1>=arguments.length||void 0===arguments[1]?this.remoteUserId:arguments[1];return this.cont[remoteUserId]&&this.cont[remoteUserId][elID]&&this.cont[this.remoteUserId][elID]?this.cont[this.remoteUserId][elID][0]>this.cont[remoteUserId][elID][0]?this.cont[this.remoteUserId][elID][1]:this.cont[remoteUserId][elID][1]:this.cont[remoteUserId]&&this.cont[remoteUserId][elID]?this.cont[remoteUserId][elID][1]:this.cont[this.remoteUserId][elID][1]}},{key:"getAll",value:function(){var remoteUserId=0>=arguments.length||void 0===arguments[0]?this.remoteUserId:arguments[0],messages=[];for(var key in this.cont[remoteUserId])this.cont[remoteUserId].hasOwnProperty(key)&&0<this.cont[remoteUserId][key].length&&messages.push([this.cont[remoteUserId][key][1],key,remoteUserId]);return messages}}]),MasterLastMessage}(),_export("MasterLastMessage",MasterLastMessage)}}}),$__System.register("b",["4","5","6","7"],function(_export){var MasterLastMessage,_get,_inherits,_classCallCheck,ReceivedMessage;return{setters:[function(_4){MasterLastMessage=_4.MasterLastMessage},function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]}],execute:function(){"use strict";ReceivedMessage=function(_MasterLastMessage){function ReceivedMessage(elID,remoteUserId){_classCallCheck(this,ReceivedMessage),_get(Object.getPrototypeOf(ReceivedMessage.prototype),"constructor",this).call(this,elID,remoteUserId),this.cont={}}return _inherits(ReceivedMessage,_MasterLastMessage),ReceivedMessage}(MasterLastMessage),_export("ReceivedMessage",ReceivedMessage)}}}),$__System.register("c",["5","6","7","10","a","d","e","f"],function(_export){var _get,_inherits,_classCallCheck,_Map,_createClass,MasterOption,Diff_match_patchWorker,LZStringWorker,OptionSender;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){_Map=_4["default"]},function(_a){_createClass=_a["default"]},function(_d){MasterOption=_d.MasterOption},function(_e){Diff_match_patchWorker=_e.Diff_match_patchWorker},function(_f){LZStringWorker=_f.LZStringWorker}],execute:function(){"use strict";OptionSender=function(_MasterOption){function OptionSender(SentMessage,returnMap){var _this=this;_classCallCheck(this,OptionSender),_get(Object.getPrototypeOf(OptionSender.prototype),"constructor",this).call(this,returnMap),this.SentMessage=SentMessage,this.options=new _Map([["diffed",[0,!0]],["compressed",[1,"auto"]]]),this.Diff_match_patchWorker=new Diff_match_patchWorker,this.Diff_match_patchWorker.create(this.Diff_match_patchWorker.sendDiff,function(result){_this.returnApply("sendDiff",result)}),this.LZStringWorker=new LZStringWorker,this.LZStringWorker.create(this.LZStringWorker.sendCompress,function(result){_this.returnApply("sendCompress",result)})}return _inherits(OptionSender,_MasterOption),_createClass(OptionSender,[{key:"init",value:function(){for(var _len=arguments.length,data=Array(_len),_key=0;_key<_len;_key++)data[_key]=arguments[_key];data.push(this.optionsConvertMapToArray(data.pop())),_get(Object.getPrototypeOf(OptionSender.prototype),"init",this).apply(this,data)}},{key:"sendDiff",value:function(message,elID,remoteUserId,requestID,options){var result=5>=arguments.length||void 0===arguments[5]?[]:arguments[5];if(this.getOptions("diffed",options)){var oldMessage=this.SentMessage.get(elID,remoteUserId);if(oldMessage&&0<oldMessage.length&&message[1]!==oldMessage)return this.Diff_match_patchWorker.run([oldMessage,message,elID,remoteUserId,requestID,options,result]),!0}return result.push("sendDiff:false"),this.returnApply("sendDiff",[message,elID,remoteUserId,requestID,options,result]),!1}},{key:"sendCompress",value:function(message,elID,remoteUserId,requestID,options){var result=5>=arguments.length||void 0===arguments[5]?[]:arguments[5],compressed=this.getOptions("compressed",options);return("auto"===compressed&&(compressed=-1===message[1].indexOf("base64")&&"EncodedURIComponent",options=this.setOptions("compressed",compressed,options)),compressed)?(this.LZStringWorker.run([compressed,message,elID,remoteUserId,requestID,options,result]),!0):(result.push("sendCompress:false"),this.returnApply("sendCompress",[message,elID,remoteUserId,requestID,options,result]),!1)}},{key:"optionsConvertMapToArray",value:function(map){var _this2=this;if(map instanceof _Map){var _ret=function(){var arr=[];return map.forEach(function(value,key){var i=_this2.options.get(key)[0];arr[i]=value}),{v:arr}}();if("object"==typeof _ret)return _ret.v}return[]}},{key:"setOptions",value:function(name,prop){var options=2>=arguments.length||void 0===arguments[2]?[]:arguments[2],i=this.options.get(name)[0];return options[i]=prop,options}},{key:"getOptions",value:function(name){var options=1>=arguments.length||void 0===arguments[1]?[]:arguments[1],i=this.options.get(name)[0];return void 0===options[i]?this.options.get(name)[1]:options[i]}},{key:"getCompressedStatus",value:function(options){var compressed="auto"!==this.getOptions("compressed",options)&&this.getOptions("compressed",options);return!!compressed&&compressed}}]),OptionSender}(MasterOption),_export("OptionSender",OptionSender)}}}),$__System.register("11",["7","12","a","c"],function(_export){var _classCallCheck,Helper,_createClass,OptionSender,MasterSender;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){Helper=_2.Helper},function(_a){_createClass=_a["default"]},function(_c){OptionSender=_c.OptionSender}],execute:function(){"use strict";MasterSender=function(){function MasterSender(connection,SentMessage){_classCallCheck(this,MasterSender),this.connection=connection,this.SentMessage=SentMessage,this.Helper=new Helper,this.OptionSender=new OptionSender(this.SentMessage),this.OptionSender.returnMap.set("init",[this.OptionSender.sendDiff,this.OptionSender]),this.OptionSender.returnMap.set("sendDiff",[this.OptionSender.sendCompress,this.OptionSender]),this.OptionSender.returnMap.set("sendCompress",[this.send,this]),this.changeDelay=1e3,this.timeout=!0,this.timeoutCont=null,this.chunkSize=this.connection.chunkSize||1e3,this.chunkSizeRegEx=new RegExp("(.|[\r\n]){1,"+this.chunkSize+"}","g")}return _createClass(MasterSender,[{key:"sendEvent",value:function(message,elID,remoteUserId,requestID,timeout,options){void 0===elID&&(elID=this.SentMessage.elID),void 0===remoteUserId&&(remoteUserId=this.SentMessage.remoteUserId),void 0===requestID&&(requestID="");var _this=this;void 0===timeout&&(timeout=this.timeout),0<this.connection.getAllParticipants().length&&0<message.length?timeout?(clearTimeout(this.timeoutCont),this.timeoutCont=setTimeout(function(){message!==_this.SentMessage.get(elID,remoteUserId)&&_this.OptionSender.init([message,message],elID,remoteUserId,requestID,options)},this.changeDelay)):message!==this.SentMessage.get(elID,remoteUserId)&&this.OptionSender.init([message,message],elID,remoteUserId,requestID,options):console.info("SST: Not connected!")}},{key:"send",value:function(message,elID,remoteUserId,requestID,options){var _this2=this;this.SentMessage.set(message[0],elID,remoteUserId);var compressed=this.OptionSender.getCompressedStatus(options),chunks=message[1].toString().match(this.chunkSizeRegEx);if(0<chunks.length){var toAll=remoteUserId===this.SentMessage.remoteUserId||!remoteUserId,remoteUserIds=toAll?this.connection.getAllParticipants():[remoteUserId];remoteUserIds.forEach(function(remoteUserId){var remoteUser=_this2.connection.peers[remoteUserId];return remoteUser?(remoteUser.channels.length||(_this2.connection.peers[remoteUserId].createDataChannel(),_this2.connection.renegotiate(remoteUserId),setTimeout(function(){_this2._send(chunks,elID,remoteUserId,requestID,compressed)},3e3)),_this2._send(chunks,elID,remoteUserId,requestID,compressed),!0):void console.warn("SST: Unable to send message to "+remoteUserId+". No connection.peers found!")})}return!1}},{key:"_send",value:function(chunks,elID,remoteUserId,requestID){var compressed=!(4>=arguments.length||void 0===arguments[4])&&arguments[4],uuid=this.Helper.getRandomString();this.connection.peers[remoteUserId].channels.forEach(function(channel){chunks.forEach(function(chunk,i){var info=[uuid,elID,requestID,compressed,i+1,chunks.length,new Date().getTime()];channel.send(chunk+"(sst:"+info.toString()+")")})})}},{key:"setIgnoreOption",value:function(){this.oldInit=this.OptionSender.init,this.OptionSender.init=this.send.bind(this)}},{key:"unsetIgnoreOption",value:function(){this.OptionSender.init=this.oldInit?this.oldInit:this.OptionSender.init}}]),MasterSender}(),_export("MasterSender",MasterSender)}}}),$__System.register("13",["5","6","7","11"],function(_export){var _get,_inherits,_classCallCheck,MasterSender,Sender;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterSender=_4.MasterSender}],execute:function(){"use strict";Sender=function(_MasterSender){function Sender(connection,SentMessage){_classCallCheck(this,Sender),_get(Object.getPrototypeOf(Sender.prototype),"constructor",this).call(this,connection,SentMessage)}return _inherits(Sender,_MasterSender),Sender}(MasterSender),_export("Sender",Sender)}}}),$__System.register("14",["7","10","12","a"],function(_export){var _classCallCheck,_Map,Helper,_createClass,MasterConnectionEvent;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_Map=_2["default"]},function(_3){Helper=_3.Helper},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterConnectionEvent=function(){function MasterConnectionEvent(connection,Sender,SentMessage){var _this=this;_classCallCheck(this,MasterConnectionEvent),this.connection=connection,this.Sender=Sender,this.SentMessage=SentMessage,this.openOrJoinEventDelay=5e3,this.newParticipantDelay=1e3,this.connection.onNewParticipant=function(participantId,userPreferences){_this.newParticipant(participantId,userPreferences)},this.Helper=new Helper,this.onNewParticipant=this.Helper.getEventHandler()}return _createClass(MasterConnectionEvent,[{key:"openOrJoinEvent",value:function(roomid){var message=1>=arguments.length||void 0===arguments[1]?"":arguments[1],_this2=this,elID=2>=arguments.length||void 0===arguments[2]?"":arguments[2],send=!!(3>=arguments.length||void 0===arguments[3])||arguments[3];this.connection.openOrJoin(roomid||"predefiend-roomid"),send&&setTimeout(function(){_this2.connection.isInitiator||_this2.Sender.sendEvent(message,elID,void 0,void 0,!1,new _Map([["diffed",!1]]))},this.openOrJoinEventDelay)}},{key:"newParticipant",value:function(remoteUserId,userPreferences){var _this3=this;this.connection.acceptParticipationRequest(remoteUserId,userPreferences);var msgElID=!1;this.onNewParticipant.container.forEach(function(e){var result=e.func.apply(e.scope,[remoteUserId].concat(e.args));msgElID=result.constructor===Array&&result[0]&&result[1]?result:msgElID}),setTimeout(function(){_this3.connection.isInitiator&&(msgElID?_this3.Sender.sendEvent(msgElID[0],msgElID[1],remoteUserId,void 0,!1,new _Map([["diffed",!1]])):_this3.SentMessage.getAll().forEach(function(message){_this3.Sender.sendEvent(message[0],message[1],remoteUserId,void 0,!1,new _Map([["diffed",!1]]))}))},this.newParticipantDelay)}}]),MasterConnectionEvent}(),_export("MasterConnectionEvent",MasterConnectionEvent)}}}),$__System.register("15",["5","6","7","14"],function(_export){var _get,_inherits,_classCallCheck,MasterConnectionEvent,ConnectionEvent;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterConnectionEvent=_4.MasterConnectionEvent}],execute:function(){"use strict";ConnectionEvent=function(_MasterConnectionEvent){function ConnectionEvent(connection,Sender,SentMessage){_classCallCheck(this,ConnectionEvent),_get(Object.getPrototypeOf(ConnectionEvent.prototype),"constructor",this).call(this,connection,Sender,SentMessage)}return _inherits(ConnectionEvent,_MasterConnectionEvent),ConnectionEvent}(MasterConnectionEvent),_export("ConnectionEvent",ConnectionEvent)}}}),$__System.register("16",["7","10","12","a"],function(_export){var _classCallCheck,_Map,Helper,_createClass,MasterRequestor;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_Map=_2["default"]},function(_3){Helper=_3.Helper},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterRequestor=function(){function MasterRequestor(Sender,SentMessage){_classCallCheck(this,MasterRequestor),this.Sender=Sender,this.SentMessage=SentMessage,this.Helper=new Helper,this.initRequest="!!!@",this.request={resendMessage:"-> resendMessage!!!"},this.requests={}}return _createClass(MasterRequestor,[{key:"sendRequest",value:function(request,elID,remoteUserId){var requestID=this.Helper.getRandomString();this.requests[requestID]=request,this.Sender.sendEvent(""+this.initRequest+remoteUserId+request,elID,remoteUserId,requestID,!1,new _Map([["diffed",!1]]))}},{key:"receiveRequest",value:function(request,requestID,elID,remoteUserId,localUserId){request===""+this.initRequest+localUserId+this.request.resendMessage?this.Sender.sendEvent(this.SentMessage.getLatestElIDvsToAll(elID,remoteUserId),elID,remoteUserId,requestID,void 0,new _Map([["diffed",!1]])):void 0}},{key:"fullFilledRequest",value:function(requestID,oldMessage,dataPack){switch(this.requests[requestID]){case this.request.resendMessage:return delete this.requests[requestID],dataPack;}return!1}}]),MasterRequestor}(),_export("MasterRequestor",MasterRequestor)}}}),$__System.register("17",["5","6","7","16"],function(_export){var _get,_inherits,_classCallCheck,MasterRequestor,Requestor;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterRequestor=_4.MasterRequestor}],execute:function(){"use strict";Requestor=function(_MasterRequestor){function Requestor(Sender,SentMessage){_classCallCheck(this,Requestor),_get(Object.getPrototypeOf(Requestor.prototype),"constructor",this).call(this,Sender,SentMessage)}return _inherits(Requestor,_MasterRequestor),Requestor}(MasterRequestor),_export("Requestor",Requestor)}}}),$__System.register("e",["5","6","7","12","18","a"],function(_export){var _get,_inherits,_classCallCheck,Helper,MasterWorker,_createClass,Diff_match_patchWorker;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_5){Helper=_5.Helper},function(_4){MasterWorker=_4.MasterWorker},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";Diff_match_patchWorker=function(_MasterWorker){function Diff_match_patchWorker(){_classCallCheck(this,Diff_match_patchWorker),_get(Object.getPrototypeOf(Diff_match_patchWorker.prototype),"constructor",this).call(this,!1),this.name="Diff_match_patchWorker",this.Helper=new Helper,this.scripts=this.Helper.addBaseURL(["jspm_packages/"+System.map["tanaka-de-silva/google-diff-match-patch-js"]+"/diff_match_patch.js"],!1)}return _inherits(Diff_match_patchWorker,_MasterWorker),_createClass(Diff_match_patchWorker,[{key:"sendDiff",value:function(data){this.Diff_match_patch=new diff_match_patch;var diff=this.Diff_match_patch.diff_main(data[0],data[1][1],!0),patch=this.Diff_match_patch.patch_make(data[0],data[1][1],diff);return data[1][1]=this.Diff_match_patch.patch_toText(patch),data[6].constructor!==Array&&(data[6]=[]),data[6].push("sendDiff:true"),data.splice(0,1),data}},{key:"receiveDiff",value:function(data){this.Diff_match_patch=new diff_match_patch;var patch=this.Diff_match_patch.patch_fromText(data[0][1]),results=this.Diff_match_patch.patch_apply(patch,data[0][0]);return data[5].constructor!==Array&&(data[5]=[]),-1===results[1].indexOf(!1)?(data[0][1]=results[0],data[5].push("receiveDiff:true")):data[5].push("receiveDiff:failed"),data}}]),Diff_match_patchWorker}(MasterWorker),_export("Diff_match_patchWorker",Diff_match_patchWorker)}}}),$__System.register("12",["5","6","7","19","a"],function(_export){var _get,_inherits,_classCallCheck,MasterHelper,_createClass,Helper;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterHelper=_4.MasterHelper},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";Helper=function(_MasterHelper){function Helper(){_classCallCheck(this,Helper),_get(Object.getPrototypeOf(Helper.prototype),"constructor",this).apply(this,arguments)}return _inherits(Helper,_MasterHelper),_createClass(Helper,[{key:"getEventHandler",value:function(){return{container:[],add:function(func){var scope=1>=arguments.length||void 0===arguments[1]?this:arguments[1],args=2>=arguments.length||void 0===arguments[2]?[]:arguments[2];this.container.push({func:func,scope:scope,args:args})},remove:function(func){var scope=!(1>=arguments.length||void 0===arguments[1])&&arguments[1];this.container=this.container.filter(function(value){return func!==value.func||!1!==scope&&scope!==value.scope})}}}},{key:"arrayKeyValStrToObj",value:function(){var arr=0>=arguments.length||void 0===arguments[0]?["key:val","key:val"]:arguments[0],needle=1>=arguments.length||void 0===arguments[1]?":":arguments[1],obj={};return arr.forEach(function(e){e=e.split(needle);var val=e[1].trim();obj[e[0].trim()]="true"===val||"false"===val?"true"===val:val}),obj}}]),Helper}(MasterHelper),_export("Helper",Helper)}}}),$__System.register("f",["5","6","7","12","18","a"],function(_export){var _get,_inherits,_classCallCheck,Helper,MasterWorker,_createClass,LZStringWorker;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_5){Helper=_5.Helper},function(_4){MasterWorker=_4.MasterWorker},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";LZStringWorker=function(_MasterWorker){function LZStringWorker(){_classCallCheck(this,LZStringWorker),_get(Object.getPrototypeOf(LZStringWorker.prototype),"constructor",this).call(this,!1),this.name="LZStringWorker",this.Helper=new Helper,this.scripts=this.Helper.addBaseURL(["jspm_packages/"+System.map["pieroxy/lz-string"]+"/libs/lz-string.min.js"],!1)}return _inherits(LZStringWorker,_MasterWorker),_createClass(LZStringWorker,[{key:"sendCompress",value:function(data){var command="compress"===data[0]?"compress":"compressTo"+data[0];return data[1][1]=LZString[command](data[1][1]),data[6].constructor!==Array&&(data[6]=[]),data[6].push("sendCompress:true"),data.splice(0,1),data}},{key:"receiveDecompress",value:function(data){var command="compress"===data[0]?"decompress":"decompressFrom"+data[0];return data[1][1]=LZString[command](data[1][1]),data[6].constructor!==Array&&(data[6]=[]),data[6].push("receiveDecompress:true"),data.splice(0,1),data}}]),LZStringWorker}(MasterWorker),_export("LZStringWorker",LZStringWorker)}}}),$__System.register("1a",["5","6","7","a","d","e","f"],function(_export){var _get,_inherits,_classCallCheck,_createClass,MasterOption,Diff_match_patchWorker,LZStringWorker,OptionReceiver;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_a){_createClass=_a["default"]},function(_d){MasterOption=_d.MasterOption},function(_e){Diff_match_patchWorker=_e.Diff_match_patchWorker},function(_f){LZStringWorker=_f.LZStringWorker}],execute:function(){"use strict";OptionReceiver=function(_MasterOption){function OptionReceiver(returnMap){var _this=this;_classCallCheck(this,OptionReceiver),_get(Object.getPrototypeOf(OptionReceiver.prototype),"constructor",this).call(this,returnMap),this.LZStringWorker=new LZStringWorker,this.LZStringWorker.create(this.LZStringWorker.receiveDecompress,function(result){_this.returnApply("receiveDecompress",result)}),this.Diff_match_patchWorker=new Diff_match_patchWorker,this.Diff_match_patchWorker.create(this.Diff_match_patchWorker.receiveDiff,function(result){_this.returnApply("receiveDiff",result)})}return _inherits(OptionReceiver,_MasterOption),_createClass(OptionReceiver,[{key:"receiveDecompress",value:function(message,elID,remoteUserId,requestID,options){var result=5>=arguments.length||void 0===arguments[5]?[]:arguments[5];return"false"===options[0]?(result.push("receiveDecompress:false"),this.returnApply("receiveDecompress",[message,elID,remoteUserId,requestID,options,result]),!1):("Uint8Array"===options[0]&&(message[1]=message[1].split(",").map(Number)),this.LZStringWorker.run([options[0],message,elID,remoteUserId,requestID,options,result]),!0)}},{key:"receiveDiff",value:function(message,elID,remoteUserId,requestID,options){var result=5>=arguments.length||void 0===arguments[5]?[]:arguments[5];return"@@"===message[1].slice(0,2)?(this.Diff_match_patchWorker.run([message,elID,remoteUserId,requestID,options,result]),!0):(result.push("receiveDiff:false"),this.returnApply("receiveDiff",[message,elID,remoteUserId,requestID,options,result]),!1)}}]),OptionReceiver}(MasterOption),_export("OptionReceiver",OptionReceiver)}}}),$__System.register("1b",["7","10","12","a","1c","1a"],function(_export){var _classCallCheck,_Map,Helper,_createClass,_toConsumableArray,OptionReceiver,MasterReceiver;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_Map=_2["default"]},function(_3){Helper=_3.Helper},function(_a){_createClass=_a["default"]},function(_c){_toConsumableArray=_c["default"]},function(_a2){OptionReceiver=_a2.OptionReceiver}],execute:function(){"use strict";MasterReceiver=function(){function MasterReceiver(connection,Requestor,ReceivedMessage){_classCallCheck(this,MasterReceiver),this.connection=connection,this.Requestor=Requestor,this.ReceivedMessage=ReceivedMessage,this.connection.receive=this.receiveEvent.bind(this),this.Helper=new Helper,this.onReceive=this.Helper.getEventHandler(),this.OptionReceiver=new OptionReceiver,this.OptionReceiver.returnMap.set("init",[this.OptionReceiver.receiveDecompress,this.OptionReceiver]),this.OptionReceiver.returnMap.set("receiveDecompress",[this.OptionReceiver.receiveDiff,this.OptionReceiver]),this.OptionReceiver.returnMap.set("receiveDiff",[this.receive,this]),this.chunks={},this.loading="<p>loading...</p>"}return _createClass(MasterReceiver,[{key:"receiveEvent",value:function(message,remoteUserId){var receivingTime=new Date().getTime(),dataPack={},info=message.match(/\(sst:(.*?)\)/,"")[1].split(",");dataPack.uuid=info[0],dataPack.elID=info[1],dataPack.requestID=info[2],dataPack.compressed=info[3],dataPack.chunk=+info[4],dataPack.chunkTotal=+info[5],dataPack.latency=receivingTime-info[6],dataPack.message=message.replace(/\(sst:.*?\)/g,""),dataPack.remoteUserId=remoteUserId,this.chunks[dataPack.uuid]?(this.chunks[dataPack.uuid].message.set(dataPack.chunk,dataPack.message),this.chunks[dataPack.uuid].latency+=dataPack.latency):this.chunks[dataPack.uuid]={message:new _Map([[dataPack.chunk,dataPack.message]]),latency:dataPack.latency},this.chunks[dataPack.uuid].message.size===dataPack.chunkTotal&&(dataPack.message=[].concat(_toConsumableArray(this.chunks[dataPack.uuid].message)).sort(function(a,b){return a[0]-b[0]}).map(function(e){return e[1]}).join(""),this.OptionReceiver.init([this.ReceivedMessage.get(dataPack.elID,dataPack.remoteUserId),dataPack.message],dataPack.elID,dataPack.remoteUserId,dataPack.requestID,[dataPack.compressed]),delete this.chunks[dataPack.uuid])}},{key:"receive",value:function(message,elID,remoteUserId,requestID,options,result){if(0<message[1].length){var dataPack={message:message[1],elID:elID,remoteUserId:remoteUserId,requestID:requestID},success=!1;"failed"===this.Helper.arrayKeyValStrToObj(result).receiveDiff?(this.Requestor.sendRequest(this.Requestor.request.resendMessage,elID,remoteUserId),dataPack.message=this.loading,this._receive(dataPack)):0<requestID.length&&-1!==message[1].indexOf(""+this.Requestor.initRequest+this.connection.userid)?this.Requestor.receiveRequest(message[1],requestID,elID,remoteUserId,this.connection.userid):this.Requestor.requests[requestID]?(this._receive(this.Requestor.fullFilledRequest(requestID,message[0],dataPack)),success=!0):(this._receive(dataPack),success=!0),success&&this.ReceivedMessage.set(message[1],elID,remoteUserId)}}},{key:"_receive",value:function(){var dataPack=0>=arguments.length||void 0===arguments[0]?{message:void 0}:arguments[0];this.onReceive.container.forEach(function(e){e.func.apply(e.scope,[dataPack].concat(e.args))})}},{key:"setIgnoreOption",value:function(){this.oldInit=this.OptionReceiver.init,this.OptionReceiver.init=this.receive.bind(this)}},{key:"unsetIgnoreOption",value:function(){this.OptionReceiver.init=this.oldInit?this.oldInit:this.OptionReceiver.init}}]),MasterReceiver}(),_export("MasterReceiver",MasterReceiver)}}}),$__System.register("1d",["5","6","7","1b"],function(_export){var _get,_inherits,_classCallCheck,MasterReceiver,Receiver;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_b){MasterReceiver=_b.MasterReceiver}],execute:function(){"use strict";Receiver=function(_MasterReceiver){function Receiver(connection,Requestor,ReceivedMessage){_classCallCheck(this,Receiver),_get(Object.getPrototypeOf(Receiver.prototype),"constructor",this).call(this,connection,Requestor,ReceivedMessage)}return _inherits(Receiver,_MasterReceiver),Receiver}(MasterReceiver),_export("Receiver",Receiver)}}}),$__System.registerDynamic("1e",[],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function(){"use strict";window.RTCMultiConnection=function(roomid,forceOptions){function SocketConnection(connection,connectCallback){function isData(session){return!session.audio&&!session.video&&!session.screen&&session.data}function updateExtraBackup(remoteUserId,extra){connection.peersBackup[remoteUserId]||(connection.peersBackup[remoteUserId]={userid:remoteUserId,extra:{}}),connection.peersBackup[remoteUserId].extra=extra}function onMessageEvent(message){if(message.remoteUserId==connection.userid){if(connection.peers[message.sender]&&connection.peers[message.sender].extra!=message.message.extra&&(connection.peers[message.sender].extra=message.extra,connection.onExtraDataUpdated({userid:message.sender,extra:message.extra}),updateExtraBackup(message.sender,message.extra)),message.message.streamSyncNeeded&&connection.peers[message.sender]){var stream=connection.streamEvents[message.message.streamid];if(!stream||!stream.stream)return;var action=message.message.action;if("ended"===action||"inactive"===action||"stream-removed"===action)return connection.peersBackup[stream.userid]&&(stream.extra=connection.peersBackup[stream.userid].extra),void connection.onstreamended(stream);var type="both"==message.message.type?null:message.message.type;return void("function"==typeof stream.stream[action]&&stream.stream[action](type))}if("dropPeerConnection"===message.message)return void connection.deletePeer(message.sender);if(message.message.allParticipants)return-1===message.message.allParticipants.indexOf(message.sender)&&message.message.allParticipants.push(message.sender),void message.message.allParticipants.forEach(function(participant){mPeer[connection.peers[participant]?"renegotiatePeer":"createNewPeer"](participant,{localPeerSdpConstraints:{OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:connection.session.oneway?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.session.oneway?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!connection.session.oneway||"one-way"===connection.direction,isDataOnly:isData(connection.session)})});if(message.message.newParticipant)return message.message.newParticipant==connection.userid?void 0:connection.peers[message.message.newParticipant]?void 0:void mPeer.createNewPeer(message.message.newParticipant,message.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:connection.session.oneway?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.session.oneway?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!connection.session.oneway||"one-way"===connection.direction,isDataOnly:isData(connection.session)});if(message.message.readyForOffer&&(connection.attachStreams.length&&(connection.waitingForLocalMedia=!1),connection.waitingForLocalMedia))return void setTimeout(function(){onMessageEvent(message)},1);if(message.message.newParticipationRequest&&message.sender!==connection.userid){connection.peers[message.sender]&&connection.deletePeer(message.sender);var userPreferences={extra:message.extra||{},localPeerSdpConstraints:message.message.remotePeerSdpConstraints||{OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:message.message.localPeerSdpConstraints||{OfferToReceiveAudio:connection.session.oneway?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.session.oneway?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:"undefined"==typeof message.message.isOneWay?!!connection.session.oneway||"one-way"===connection.direction:message.message.isOneWay,isDataOnly:"undefined"==typeof message.message.isDataOnly?isData(connection.session):message.message.isDataOnly,dontGetRemoteStream:"undefined"==typeof message.message.isOneWay?!!connection.session.oneway||"one-way"===connection.direction:message.message.isOneWay,dontAttachLocalStream:!!message.message.dontGetRemoteStream,connectionDescription:message,successCallback:function(){}};return void connection.onNewParticipant(message.sender,userPreferences)}return message.message.changedUUID&&connection.peers[message.message.oldUUID]&&(connection.peers[message.message.newUUID]=connection.peers[message.message.oldUUID],delete connection.peers[message.message.oldUUID]),message.message.userLeft?(mPeer.onUserLeft(message.sender),void(!message.message.autoCloseEntireSession||connection.leave())):void mPeer.addNegotiatedMessage(message.message,message.sender)}}var parameters="";parameters+="?userid="+connection.userid,parameters+="&sessionid="+connection.sessionid,parameters+="&msgEvent="+connection.socketMessageEvent,parameters+="&socketCustomEvent="+connection.socketCustomEvent,parameters+="&autoCloseEntireSession="+!!connection.autoCloseEntireSession,!0===connection.session.broadcast&&(parameters+="&oneToMany=true"),parameters+="&maxParticipantsAllowed="+connection.maxParticipantsAllowed,connection.enableScalableBroadcast&&(parameters+="&enableScalableBroadcast=true",parameters+="&maxRelayLimitPerUser="+(connection.maxRelayLimitPerUser||2)),parameters+="&extra="+JSON.stringify(connection.extra||{}),connection.socketCustomParameters&&(parameters+=connection.socketCustomParameters);try{io.sockets={}}catch(e){}if(connection.socketURL||(connection.socketURL="/"),"/"!=connection.socketURL.substr(connection.socketURL.length-1,1))throw"\"socketURL\" MUST end with a slash.";connection.enableLogs&&("/"==connection.socketURL?console.info("socket.io url is: ",location.origin+"/"):console.info("socket.io url is: ",connection.socketURL));try{connection.socket=io(connection.socketURL+parameters)}catch(e){connection.socket=io.connect(connection.socketURL+parameters,connection.socketOptions)}var mPeer=connection.multiPeersHandler;connection.socket.on("extra-data-updated",function(remoteUserId,extra){connection.peers[remoteUserId]&&(connection.peers[remoteUserId].extra=extra,connection.onExtraDataUpdated({userid:remoteUserId,extra:extra}),updateExtraBackup(remoteUserId,extra))}),connection.socket.on(connection.socketMessageEvent,onMessageEvent);var alreadyConnected=!1;connection.socket.resetProps=function(){alreadyConnected=!1},connection.socket.on("connect",function(){alreadyConnected||(alreadyConnected=!0,connection.enableLogs&&console.info("socket.io connection is opened."),setTimeout(function(){connection.socket.emit("extra-data-updated",connection.extra)},1e3),connectCallback&&connectCallback(connection.socket))}),connection.socket.on("disconnect",function(event){connection.onSocketDisconnect(event)}),connection.socket.on("error",function(event){connection.onSocketError(event)}),connection.socket.on("user-disconnected",function(remoteUserId){remoteUserId===connection.userid||(connection.onUserStatusChanged({userid:remoteUserId,status:"offline",extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra||{}:{}}),connection.deletePeer(remoteUserId))}),connection.socket.on("user-connected",function(userid){userid===connection.userid||connection.onUserStatusChanged({userid:userid,status:"online",extra:connection.peers[userid]?connection.peers[userid].extra||{}:{}})}),connection.socket.on("closed-entire-session",function(sessionid,extra){connection.leave(),connection.onEntireSessionClosed({sessionid:sessionid,userid:sessionid,extra:extra})}),connection.socket.on("userid-already-taken",function(useridAlreadyTaken,yourNewUserId){connection.onUserIdAlreadyTaken(useridAlreadyTaken,yourNewUserId)}),connection.socket.on("logs",function(log){connection.enableLogs&&console.debug("server-logs",log)}),connection.socket.on("number-of-broadcast-viewers-updated",function(data){connection.onNumberOfBroadcastViewersUpdated(data)}),connection.socket.on("set-isInitiator-true",function(sessionid){sessionid!=connection.sessionid||(connection.isInitiator=!0)})}function MultiPeers(connection){function initFileBufferReader(){connection.fbr=new FileBufferReader,connection.fbr.onProgress=function(chunk){connection.onFileProgress(chunk)},connection.fbr.onBegin=function(file){connection.onFileStart(file)},connection.fbr.onEnd=function(file){connection.onFileEnd(file)}}var self=this,skipPeers=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];connection.peers={getLength:function(){var numberOfPeers=0;for(var peer in this)-1==skipPeers.indexOf(peer)&&numberOfPeers++;return numberOfPeers},selectFirst:function(){var firstPeer;for(var peer in this)-1==skipPeers.indexOf(peer)&&(firstPeer=this[peer]);return firstPeer},getAllParticipants:function(sender){var allPeers=[];for(var peer in this)-1==skipPeers.indexOf(peer)&&peer!=sender&&allPeers.push(peer);return allPeers},forEach:function(callbcak){this.getAllParticipants().forEach(function(participant){callbcak(connection.peers[participant])})},send:function(data,remoteUserId){var that=this;if(!isNull(data.size)&&!isNull(data.type)){if(connection.enableFileSharing)return void self.shareFile(data,remoteUserId);"string"!=typeof data&&(data=JSON.stringify(data))}if("text"!==data.type&&!(data instanceof ArrayBuffer)&&!(data instanceof DataView))return void TextSender.send({text:data,channel:this,connection:connection,remoteUserId:remoteUserId});if("text"===data.type&&(data=JSON.stringify(data)),remoteUserId){var remoteUser=connection.peers[remoteUserId];if(remoteUser)return remoteUser.channels.length?void remoteUser.channels.forEach(function(channel){channel.send(data)}):(connection.peers[remoteUserId].createDataChannel(),connection.renegotiate(remoteUserId),void setTimeout(function(){that.send(data,remoteUserId)},3e3))}this.getAllParticipants().forEach(function(participant){return that[participant].channels.length?void that[participant].channels.forEach(function(channel){channel.send(data)}):(connection.peers[participant].createDataChannel(),connection.renegotiate(participant),void setTimeout(function(){that[participant].channels.forEach(function(channel){channel.send(data)})},3e3))})}},this.uuid=connection.userid,this.getLocalConfig=function(remoteSdp,remoteUserId,userPreferences){return userPreferences||(userPreferences={}),{streamsToShare:userPreferences.streamsToShare||{},rtcMultiConnection:connection,connectionDescription:userPreferences.connectionDescription,userid:remoteUserId,localPeerSdpConstraints:userPreferences.localPeerSdpConstraints,remotePeerSdpConstraints:userPreferences.remotePeerSdpConstraints,dontGetRemoteStream:!!userPreferences.dontGetRemoteStream,dontAttachLocalStream:!!userPreferences.dontAttachLocalStream,renegotiatingPeer:!!userPreferences.renegotiatingPeer,peerRef:userPreferences.peerRef,channels:userPreferences.channels||[],onLocalSdp:function(localSdp){self.onNegotiationNeeded(localSdp,remoteUserId)},onLocalCandidate:function(localCandidate){localCandidate=OnIceCandidateHandler.processCandidates(connection,localCandidate),localCandidate&&self.onNegotiationNeeded(localCandidate,remoteUserId)},remoteSdp:remoteSdp,onDataChannelMessage:function(message){connection.receive(message,remoteUserId)},onDataChannelError:function(error){self.onDataChannelError(error,remoteUserId)},onDataChannelOpened:function(channel){self.onDataChannelOpened(channel,remoteUserId)},onDataChannelClosed:function(event){self.onDataChannelClosed(event,remoteUserId)},onRemoteStream:function(stream){connection.peers[remoteUserId]&&connection.peers[remoteUserId].streams.push(stream),self.onGettingRemoteMedia(stream,remoteUserId)},onRemoteStreamRemoved:function(stream){self.onRemovingRemoteMedia(stream,remoteUserId)},onPeerStateChanged:function(states){self.onPeerStateChanged(states),"new"===states.iceConnectionState&&self.onNegotiationStarted(remoteUserId,states),"connected"===states.iceConnectionState&&self.onNegotiationCompleted(remoteUserId,states),-1!==states.iceConnectionState.search(/closed|failed/gi)&&(self.onUserLeft(remoteUserId),self.disconnectWith(remoteUserId))}}},this.createNewPeer=function(remoteUserId,userPreferences){if(!(connection.maxParticipantsAllowed<=connection.getAllParticipants().length)){if(userPreferences=userPreferences||{},!connection.isInitiator||!connection.session.audio||"two-way"!==connection.session.audio||userPreferences.streamsToShare||(userPreferences.isOneWay=!1,userPreferences.isDataOnly=!1,userPreferences.session=connection.session),!userPreferences.isOneWay&&!userPreferences.isDataOnly)return userPreferences.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:userPreferences},remoteUserId);userPreferences=connection.setUserPreferences(userPreferences,remoteUserId);var localConfig=this.getLocalConfig(null,remoteUserId,userPreferences);connection.peers[remoteUserId]=new PeerInitiator(localConfig)}},this.createAnsweringPeer=function(remoteSdp,remoteUserId,userPreferences){userPreferences=connection.setUserPreferences(userPreferences||{},remoteUserId);var localConfig=this.getLocalConfig(remoteSdp,remoteUserId,userPreferences);connection.peers[remoteUserId]=new PeerInitiator(localConfig)},this.renegotiatePeer=function(remoteUserId,userPreferences,remoteSdp){if(!connection.peers[remoteUserId])return void(connection.enableLogs&&console.error("Peer ("+remoteUserId+") does not exist. Renegotiation skipped."));userPreferences||(userPreferences={}),userPreferences.renegotiatingPeer=!0,userPreferences.peerRef=connection.peers[remoteUserId].peer,userPreferences.channels=connection.peers[remoteUserId].channels;var localConfig=this.getLocalConfig(remoteSdp,remoteUserId,userPreferences);connection.peers[remoteUserId]=new PeerInitiator(localConfig)},this.replaceTrack=function(track,remoteUserId,isVideoTrack){if(!connection.peers[remoteUserId])throw"This peer ("+remoteUserId+") does not exist.";var peer=connection.peers[remoteUserId].peer;return!!peer.getSenders&&"function"==typeof peer.getSenders&&peer.getSenders().length?void peer.getSenders().forEach(function(rtpSender){isVideoTrack&&"video"===rtpSender.track.kind&&(connection.peers[remoteUserId].peer.lastVideoTrack=rtpSender.track,rtpSender.replaceTrack(track)),isVideoTrack||"audio"!==rtpSender.track.kind||(connection.peers[remoteUserId].peer.lastAudioTrack=rtpSender.track,rtpSender.replaceTrack(track))}):void(console.warn("RTPSender.replaceTrack is NOT supported."),this.renegotiatePeer(remoteUserId))},this.onNegotiationNeeded=function(){},this.addNegotiatedMessage=function(message,remoteUserId){if(message.type&&message.sdp)return"answer"==message.type&&connection.peers[remoteUserId]&&connection.peers[remoteUserId].addRemoteSdp(message),"offer"==message.type&&(message.renegotiatingPeer?this.renegotiatePeer(remoteUserId,null,message):this.createAnsweringPeer(message,remoteUserId)),void(connection.enableLogs&&console.log("Remote peer's sdp:",message.sdp));if(message.candidate)return connection.peers[remoteUserId]&&connection.peers[remoteUserId].addRemoteCandidate(message),void(connection.enableLogs&&console.log("Remote peer's candidate pairs:",message.candidate));if(message.enableMedia){connection.session=message.userPreferences.session||connection.session,connection.session.oneway&&connection.attachStreams.length&&(connection.attachStreams=[]),message.userPreferences.isDataOnly&&connection.attachStreams.length&&(connection.attachStreams.length=[]);var streamsToShare={};connection.attachStreams.forEach(function(stream){streamsToShare[stream.streamid]={isAudio:!!stream.isAudio,isVideo:!!stream.isVideo,isScreen:!!stream.isScreen}}),message.userPreferences.streamsToShare=streamsToShare,self.onNegotiationNeeded({readyForOffer:!0,userPreferences:message.userPreferences},remoteUserId)}message.readyForOffer&&connection.onReadyForOffer(remoteUserId,message.userPreferences)},this.onGettingRemoteMedia=function(){},this.onRemovingRemoteMedia=function(){},this.onGettingLocalMedia=function(){},this.onLocalMediaError=function(error,constraints){connection.onMediaError(error,constraints)},this.shareFile=function(file,remoteUserId){initFileBufferReader(),connection.fbr.readAsArrayBuffer(file,function(uuid){var arrayOfUsers=connection.getAllParticipants();remoteUserId&&(arrayOfUsers=[remoteUserId]),arrayOfUsers.forEach(function(participant){connection.fbr.getNextChunk(uuid,function(nextChunk){connection.peers[participant].channels.forEach(function(channel){channel.send(nextChunk)})},participant)})},{userid:connection.userid,chunkSize:"Firefox"===DetectRTC.browser.name?15000:connection.chunkSize||0})};var textReceiver=new TextReceiver(connection);this.onDataChannelMessage=function(message,remoteUserId){textReceiver.receive(JSON.parse(message),remoteUserId,connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{})},this.onDataChannelClosed=function(event,remoteUserId){event.userid=remoteUserId,event.extra=connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},connection.onclose(event)},this.onDataChannelError=function(error,remoteUserId){error.userid=remoteUserId,event.extra=connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},connection.onerror(error)},this.onDataChannelOpened=function(channel,remoteUserId){return connection.peers[remoteUserId].channels.length?void(connection.peers[remoteUserId].channels=[channel]):void(connection.peers[remoteUserId].channels.push(channel),connection.onopen({userid:remoteUserId,extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},channel:channel}))},this.onPeerStateChanged=function(state){connection.onPeerStateChanged(state)},this.onNegotiationStarted=function(){},this.onNegotiationCompleted=function(){},this.getRemoteStreams=function(remoteUserId){return remoteUserId=remoteUserId||connection.peers.getAllParticipants()[0],connection.peers[remoteUserId]?connection.peers[remoteUserId].streams:[]}}function fireEvent(obj,eventName,args){if("undefined"!=typeof CustomEvent){var event=new CustomEvent(eventName,{arguments:args,__exposedProps__:args});obj.dispatchEvent(event)}}function setHarkEvents(connection,streamEvent){if(streamEvent.stream&&getTracks(streamEvent.stream,"audio").length){if(!connection||!streamEvent)throw"Both arguments are required.";if(connection.onspeaking&&connection.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(streamEvent.stream,{onspeaking:function(){connection.onspeaking(streamEvent)},onsilence:function(){connection.onsilence(streamEvent)},onvolumechange:function(volume,threshold){connection.onvolumechange&&connection.onvolumechange(merge({volume:volume,threshold:threshold},streamEvent))}})}}}function setMuteHandlers(connection,streamEvent){streamEvent.stream&&streamEvent.stream&&streamEvent.stream.addEventListener&&(streamEvent.stream.addEventListener("mute",function(event){event=connection.streamEvents[streamEvent.streamid],event.session={audio:"audio"===event.muteType,video:"video"===event.muteType},connection.onmute(event)},!1),streamEvent.stream.addEventListener("unmute",function(event){event=connection.streamEvents[streamEvent.streamid],event.session={audio:"audio"===event.unmuteType,video:"video"===event.unmuteType},connection.onunmute(event)},!1))}function getRandomString(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var a=window.crypto.getRandomValues(new Uint32Array(3)),token="",i=0,l=a.length;i<l;i++)token+=a[i].toString(36);return token}return(Math.random()*new Date().getTime()).toString(36).replace(/\./g,"")}function getRMCMediaElement(stream,callback,connection){if(!connection.autoCreateMediaElement)return void callback({});var isAudioOnly=!1;getTracks(stream,"video").length||stream.isVideo||stream.isScreen||(isAudioOnly=!0),"Firefox"===DetectRTC.browser.name&&(connection.session.video||connection.session.screen)&&(isAudioOnly=!1);var mediaElement=document.createElement(isAudioOnly?"audio":"video");if(mediaElement.srcObject=stream,mediaElement.setAttribute("autoplay",!0),mediaElement.setAttribute("playsinline",!0),mediaElement.setAttribute("controls",!0),mediaElement.setAttribute("muted",!1),mediaElement.setAttribute("volume",1),"Firefox"===DetectRTC.browser.name){var streamEndedEvent="ended";"oninactive"in mediaElement&&(streamEndedEvent="inactive"),mediaElement.addEventListener(streamEndedEvent,function(){if(currentUserMediaRequest.remove(stream.idInstance),"local"===stream.type){streamEndedEvent="ended","oninactive"in stream&&(streamEndedEvent="inactive"),StreamsHandler.onSyncNeeded(stream.streamid,streamEndedEvent),connection.attachStreams.forEach(function(aStream,idx){stream.streamid===aStream.streamid&&delete connection.attachStreams[idx]});var newStreamsArray=[];connection.attachStreams.forEach(function(aStream){aStream&&newStreamsArray.push(aStream)}),connection.attachStreams=newStreamsArray;var streamEvent=connection.streamEvents[stream.streamid];if(streamEvent)return void connection.onstreamended(streamEvent);this.parentNode&&this.parentNode.removeChild(this)}},!1)}var played=mediaElement.play();if("undefined"!=typeof played){var cbFired=!1;setTimeout(function(){cbFired||(cbFired=!0,callback(mediaElement))},1e3),played.then(function(){cbFired||(cbFired=!0,callback(mediaElement))}).catch(function(){cbFired||(cbFired=!0,callback(mediaElement))})}else callback(mediaElement)}function listenEventHandler(eventName,eventHandler){window.removeEventListener(eventName,eventHandler),window.addEventListener(eventName,eventHandler,!1)}function removeNullEntries(array){var newArray=[];return array.forEach(function(item){item&&newArray.push(item)}),newArray}function isData(session){return!session.audio&&!session.video&&!session.screen&&session.data}function isNull(obj){return"undefined"==typeof obj}function isString(obj){return"string"==typeof obj}function isAudioPlusTab(connection,audioPlusTab){return!(connection.session.audio&&"two-way"===connection.session.audio)&&("Firefox"===DetectRTC.browser.name&&!1!==audioPlusTab||!("Chrome"!==DetectRTC.browser.name||50>DetectRTC.browser.version)&&(!0===typeof audioPlusTab||!!("undefined"==typeof audioPlusTab&&connection.session.audio&&connection.session.screen&&!connection.session.video)&&(audioPlusTab=!0,!0)))}function getTracks(stream,kind){return stream&&stream.getTracks?stream.getTracks().filter(function(t){return t.kind===(kind||"audio")}):[]}function isUnifiedPlanSupportedDefault(){var canAddTransceiver=!1;try{if("undefined"==typeof RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var tempPc=new RTCPeerConnection;try{tempPc.addTransceiver("audio"),canAddTransceiver=!0}catch(e){}tempPc.close()}catch(e){canAddTransceiver=!1}return canAddTransceiver&&isUnifiedPlanSuppored()}function isUnifiedPlanSuppored(){var isUnifiedPlanSupported=!1;try{var pc=new RTCPeerConnection({sdpSemantics:"unified-plan"});try{var config=pc.getConfiguration();isUnifiedPlanSupported="unified-plan"==config.sdpSemantics||"plan-b"!=config.sdpSemantics&&!1}catch(e){isUnifiedPlanSupported=!1}}catch(e){isUnifiedPlanSupported=!1}return isUnifiedPlanSupported}function setCordovaAPIs(){if("undefined"!=typeof cordova&&"undefined"!=typeof cordova.plugins&&"undefined"!=typeof cordova.plugins.iosrtc){var iosrtc=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=iosrtc.RTCPeerConnection,window.RTCSessionDescription=iosrtc.RTCSessionDescription,window.RTCIceCandidate=iosrtc.RTCIceCandidate,window.MediaStream=iosrtc.MediaStream,window.MediaStreamTrack=iosrtc.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=iosrtc.getUserMedia,iosrtc.debug.enable("iosrtc*"),"function"==typeof iosrtc.selectAudioOutput&&iosrtc.selectAudioOutput(window.iOSDefaultAudioOutputDevice||"speaker"),iosrtc.registerGlobals()}}function setSdpConstraints(config){var sdpConstraints={OfferToReceiveAudio:!!config.OfferToReceiveAudio,OfferToReceiveVideo:!!config.OfferToReceiveVideo};return sdpConstraints}function PeerInitiator(config){function setChannelEvents(channel){channel.binaryType="arraybuffer",channel.onmessage=function(event){config.onDataChannelMessage(event.data)},channel.onopen=function(){config.onDataChannelOpened(channel)},channel.onerror=function(error){config.onDataChannelError(error)},channel.onclose=function(event){config.onDataChannelClosed(event)},channel.internalSend=channel.send,channel.send=function(data){"open"!==channel.readyState||channel.internalSend(data)},peer.channel=channel}function createOfferOrAnswer(_method){peer[_method](defaults.sdpConstraints).then(function(localSdp){"Safari"!==DetectRTC.browser.name&&(localSdp.sdp=connection.processSdp(localSdp.sdp)),peer.setLocalDescription(localSdp).then(function(){connection.trickleIce&&(config.onLocalSdp({type:localSdp.type,sdp:localSdp.sdp,remotePeerSdpConstraints:config.remotePeerSdpConstraints||!1,renegotiatingPeer:!!config.renegotiatingPeer||!1,connectionDescription:self.connectionDescription,dontGetRemoteStream:!!config.dontGetRemoteStream,extra:connection?connection.extra:{},streamsToShare:streamsToShare}),connection.onSettingLocalDescription(self))},function(error){connection.enableLogs&&console.error("setLocalDescription error",error)})},function(error){!connection.enableLogs||console.error("sdp-error",error)})}if("undefined"==typeof window.RTCPeerConnection?"undefined"==typeof mozRTCPeerConnection?"undefined"!=typeof webkitRTCPeerConnection&&(RTCPeerConnection=webkitRTCPeerConnection):RTCPeerConnection=mozRTCPeerConnection:RTCPeerConnection=window.RTCPeerConnection,RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate,MediaStreamTrack=window.MediaStreamTrack,!RTCPeerConnection)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var connection=config.rtcMultiConnection;this.extra=config.remoteSdp?config.remoteSdp.extra:connection.extra,this.userid=config.userid,this.streams=[],this.channels=config.channels||[],this.connectionDescription=config.connectionDescription,this.addStream=function(session){connection.addStream(session,self.userid)},this.removeStream=function(streamid){connection.removeStream(streamid,self.userid)};var self=this;config.remoteSdp&&(this.connectionDescription=config.remoteSdp.connectionDescription);var allRemoteStreams={};defaults.sdpConstraints=setSdpConstraints({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var renegotiatingPeer=!!config.renegotiatingPeer,peer;config.remoteSdp&&(renegotiatingPeer=!!config.remoteSdp.renegotiatingPeer);var localStreams=[];if(connection.attachStreams.forEach(function(stream){!stream||localStreams.push(stream)}),!renegotiatingPeer){var iceTransports="all";!connection.candidates.turn&&!connection.candidates.relay||connection.candidates.stun||connection.candidates.reflexive||connection.candidates.host||(iceTransports="relay");try{var params={iceServers:connection.iceServers,iceTransportPolicy:connection.iceTransportPolicy||iceTransports};"undefined"!=typeof connection.iceCandidatePoolSize&&(params.iceCandidatePoolSize=connection.iceCandidatePoolSize),"undefined"!=typeof connection.bundlePolicy&&(params.bundlePolicy=connection.bundlePolicy),"undefined"!=typeof connection.rtcpMuxPolicy&&(params.rtcpMuxPolicy=connection.rtcpMuxPolicy),!connection.sdpSemantics||(params.sdpSemantics=connection.sdpSemantics||"unified-plan"),connection.iceServers&&connection.iceServers.length||(params=null,connection.optionalArgument=null),peer=new RTCPeerConnection(params,connection.optionalArgument)}catch(e){try{var params={iceServers:connection.iceServers};peer=new RTCPeerConnection(params)}catch(e){peer=new RTCPeerConnection}}}else peer=config.peerRef;!peer.getRemoteStreams&&peer.getReceivers&&(peer.getRemoteStreams=function(){var stream=new MediaStream;return peer.getReceivers().forEach(function(receiver){stream.addTrack(receiver.track)}),[stream]}),!peer.getLocalStreams&&peer.getSenders&&(peer.getLocalStreams=function(){var stream=new MediaStream;return peer.getSenders().forEach(function(sender){stream.addTrack(sender.track)}),[stream]}),peer.onicecandidate=function(event){if(!event.candidate){if(!connection.trickleIce){var localSdp=peer.localDescription;config.onLocalSdp({type:localSdp.type,sdp:localSdp.sdp,remotePeerSdpConstraints:config.remotePeerSdpConstraints||!1,renegotiatingPeer:!!config.renegotiatingPeer||!1,connectionDescription:self.connectionDescription,dontGetRemoteStream:!!config.dontGetRemoteStream,extra:connection?connection.extra:{},streamsToShare:streamsToShare})}return}connection.trickleIce&&config.onLocalCandidate({candidate:event.candidate.candidate,sdpMid:event.candidate.sdpMid,sdpMLineIndex:event.candidate.sdpMLineIndex})},localStreams.forEach(function(localStream){config.remoteSdp&&config.remoteSdp.remotePeerSdpConstraints&&config.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||config.dontAttachLocalStream||(localStream=connection.beforeAddingStream(localStream,self),localStream&&(peer.getLocalStreams().forEach(function(stream){localStream&&stream.id==localStream.id&&(localStream=null)}),localStream&&localStream.getTracks&&localStream.getTracks().forEach(function(track){try{peer.addTrack(track,localStream)}catch(e){}})))}),peer.oniceconnectionstatechange=peer.onsignalingstatechange=function(){if("stable"!=self.signalingState)return void console.log("Negotiation skipped in stable");var extra=self.extra;connection.peers[self.userid]&&(extra=connection.peers[self.userid].extra||extra),peer&&(config.onPeerStateChanged({iceConnectionState:peer.iceConnectionState,iceGatheringState:peer.iceGatheringState,signalingState:peer.signalingState,extra:extra,userid:self.userid}),peer&&peer.iceConnectionState&&-1!==peer.iceConnectionState.search(/closed|failed/gi)&&self.streams instanceof Array&&self.streams.forEach(function(stream){var streamEvent=connection.streamEvents[stream.id]||{streamid:stream.id,stream:stream,type:"remote"};connection.onstreamended(streamEvent)}))};var sdpConstraints={OfferToReceiveAudio:!!localStreams.length,OfferToReceiveVideo:!!localStreams.length};config.localPeerSdpConstraints&&(sdpConstraints=config.localPeerSdpConstraints),defaults.sdpConstraints=setSdpConstraints(sdpConstraints);var dontDuplicate={};peer.ontrack=function(event){if(event&&"track"===event.type){if(event.stream=event.streams[event.streams.length-1],event.stream.id||(event.stream.id=event.track.id),dontDuplicate[event.stream.id]&&"Safari"!==DetectRTC.browser.name)return void(event.track&&(event.track.onended=function(){peer&&peer.onremovestream(event)}));dontDuplicate[event.stream.id]=event.stream.id;var streamsToShare={};config.remoteSdp&&config.remoteSdp.streamsToShare?streamsToShare=config.remoteSdp.streamsToShare:config.streamsToShare&&(streamsToShare=config.streamsToShare);var streamToShare=streamsToShare[event.stream.id];streamToShare?(event.stream.isAudio=streamToShare.isAudio,event.stream.isVideo=streamToShare.isVideo,event.stream.isScreen=streamToShare.isScreen):(event.stream.isVideo=!!getTracks(event.stream,"video").length,event.stream.isAudio=!event.stream.isVideo,event.stream.isScreen=!1),event.stream.streamid=event.stream.id,allRemoteStreams[event.stream.id]=event.stream,config.onRemoteStream(event.stream),event.stream.getTracks().forEach(function(track){track.onended=function(){peer&&peer.onremovestream(event)}}),event.stream.onremovetrack=function(){peer&&peer.onremovestream(event)}}},peer.onremovestream=function(event){event.stream.streamid=event.stream.id,allRemoteStreams[event.stream.id]&&delete allRemoteStreams[event.stream.id],config.onRemoteStreamRemoved(event.stream)},"function"!=typeof peer.removeStream&&(peer.removeStream=function(stream){stream.getTracks().forEach(function(track){peer.removeTrack(track,stream)})}),this.addRemoteCandidate=function(remoteCandidate){peer.addIceCandidate(new RTCIceCandidate(remoteCandidate))},this.addRemoteSdp=function(remoteSdp,cb){cb=cb||function(){},"Safari"!==DetectRTC.browser.name&&(remoteSdp.sdp=connection.processSdp(remoteSdp.sdp)),peer.setRemoteDescription(new RTCSessionDescription(remoteSdp)).then(cb,function(error){!connection.enableLogs||console.error("setRemoteDescription failed","\n",error,"\n",remoteSdp.sdp),cb()}).catch(function(error){!connection.enableLogs||console.error("setRemoteDescription failed","\n",error,"\n",remoteSdp.sdp),cb()})};var isOfferer=!0;config.remoteSdp&&(isOfferer=!1),this.createDataChannel=function(){var channel=peer.createDataChannel("sctp",{});setChannelEvents(channel)},!0!==connection.session.data||renegotiatingPeer||(isOfferer?this.createDataChannel():peer.ondatachannel=function(event){var channel=event.channel;setChannelEvents(channel)}),this.enableDisableVideoEncoding=function(enable){var rtcp;if(peer.getSenders().forEach(function(sender){rtcp||"video"!==sender.track.kind||(rtcp=sender)}),rtcp&&rtcp.getParameters){var parameters=rtcp.getParameters();parameters.encodings[1]&&(parameters.encodings[1].active=!!enable),parameters.encodings[2]&&(parameters.encodings[2].active=!!enable),rtcp.setParameters(parameters)}},config.remoteSdp&&(config.remoteSdp.remotePeerSdpConstraints&&(sdpConstraints=config.remoteSdp.remotePeerSdpConstraints),defaults.sdpConstraints=setSdpConstraints(sdpConstraints),this.addRemoteSdp(config.remoteSdp,function(){createOfferOrAnswer("createAnswer")})),("two-way"==connection.session.audio||"two-way"==connection.session.video||"two-way"==connection.session.screen)&&(defaults.sdpConstraints=setSdpConstraints({OfferToReceiveAudio:"two-way"==connection.session.audio||config.remoteSdp&&config.remoteSdp.remotePeerSdpConstraints&&config.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==connection.session.video||"two-way"==connection.session.screen||config.remoteSdp&&config.remoteSdp.remotePeerSdpConstraints&&config.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var streamsToShare={};peer.getLocalStreams().forEach(function(stream){streamsToShare[stream.streamid]={isAudio:!!stream.isAudio,isVideo:!!stream.isVideo,isScreen:!!stream.isScreen}}),isOfferer&&createOfferOrAnswer("createOffer"),peer.nativeClose=peer.close,peer.close=function(){if(peer){try{peer.nativeClose!==peer.close&&peer.nativeClose()}catch(e){}peer=null,self.peer=null}},this.peer=peer}function setStreamType(constraints,stream){constraints.mandatory&&constraints.mandatory.chromeMediaSource?stream.isScreen=!0:constraints.mozMediaSource||constraints.mediaSource?stream.isScreen=!0:constraints.video?stream.isVideo=!0:constraints.audio&&(stream.isAudio=!0)}function getUserMediaHandler(options){function streaming(stream,returnBack){setStreamType(options.localMediaConstraints,stream);var streamEndedEvent="ended";"oninactive"in stream&&(streamEndedEvent="inactive"),stream.addEventListener(streamEndedEvent,function(){delete currentUserMediaRequest.streams[idInstance],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(options)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(options)],currentUserMediaRequest.queueRequests=removeNullEntries(currentUserMediaRequest.queueRequests))},!1),currentUserMediaRequest.streams[idInstance]={stream:stream},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&getUserMediaHandler(currentUserMediaRequest.queueRequests.shift()),options.onGettingLocalMedia(stream,returnBack)}if(!0===currentUserMediaRequest.mutex)return void currentUserMediaRequest.queueRequests.push(options);currentUserMediaRequest.mutex=!0;var idInstance=JSON.stringify(options.localMediaConstraints);if(currentUserMediaRequest.streams[idInstance])streaming(currentUserMediaRequest.streams[idInstance].stream,!0);else{var isBlackBerry=!!/BB10|BlackBerry/i.test(navigator.userAgent||"");if(isBlackBerry||"undefined"==typeof navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(options.localMediaConstraints,function(stream){stream.streamid=stream.streamid||stream.id||getRandomString(),stream.idInstance=idInstance,streaming(stream)},function(error){options.onLocalMediaError(error,options.localMediaConstraints)});if("undefined"==typeof navigator.mediaDevices){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var getUserMediaSuccess=function(){},getUserMediaFailure=function(){},getUserMediaStream,getUserMediaError;navigator.mediaDevices={getUserMedia:function(hints){return navigator.getUserMedia(hints,function(getUserMediaSuccess){getUserMediaSuccess(stream),getUserMediaStream=stream},function(error){getUserMediaFailure(error),getUserMediaError=error}),{then:function(successCB){return getUserMediaStream?void successCB(getUserMediaStream):(getUserMediaSuccess=successCB,{then:function(failureCB){return getUserMediaError?void failureCB(getUserMediaError):void(getUserMediaFailure=failureCB)}})}}}}}if(!0===options.localMediaConstraints.isScreen){if(navigator.mediaDevices.getDisplayMedia)navigator.mediaDevices.getDisplayMedia(options.localMediaConstraints).then(function(stream){stream.streamid=stream.streamid||stream.id||getRandomString(),stream.idInstance=idInstance,streaming(stream)}).catch(function(error){options.onLocalMediaError(error,options.localMediaConstraints)});else if(navigator.getDisplayMedia)navigator.getDisplayMedia(options.localMediaConstraints).then(function(stream){stream.streamid=stream.streamid||stream.id||getRandomString(),stream.idInstance=idInstance,streaming(stream)}).catch(function(error){options.onLocalMediaError(error,options.localMediaConstraints)});else throw new Error("getDisplayMedia API is not availabe in this browser.");return}navigator.mediaDevices.getUserMedia(options.localMediaConstraints).then(function(stream){stream.streamid=stream.streamid||stream.id||getRandomString(),stream.idInstance=idInstance,streaming(stream)}).catch(function(error){options.onLocalMediaError(error,options.localMediaConstraints)})}}function TextReceiver(connection){var content={};return{receive:function(data,userid,extra){var uuid=data.uuid;if(content[uuid]||(content[uuid]=[]),content[uuid].push(data.message),data.last){var message=content[uuid].join("");data.isobject&&(message=JSON.parse(message));var receivingTime=new Date().getTime(),latency=receivingTime-data.sendingTime,e={data:message,userid:userid,extra:extra,latency:latency};connection.autoTranslateText?(e.original=e.data,connection.Translator.TranslateText(e.data,function(translatedText){e.data=translatedText,connection.onmessage(e)})):connection.onmessage(e),delete content[uuid]}}}}(function(that){that&&"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},!global.console&&(global.console={}),"undefined"==typeof global.console.debug&&(global.console.debug=global.console.info=global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(that.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var obj={getContext:function(){return obj},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return obj},document.addEventListener=document.removeEventListener=that.addEventListener=that.removeEventListener=function(){},that.HTMLVideoElement=that.HTMLMediaElement=function(){}),"undefined"==typeof io&&(that.io=function(){return{on:function(eventName,callback){callback=callback||function(){},"connect"===eventName&&callback()},emit:function(eventName,data,callback){callback=callback||function(){},("open-room"===eventName||"join-room"===eventName)&&callback(!0,data.sessionid,null)}}}),"undefined"==typeof location&&(that.location={protocol:"file:",href:"",hash:"",origin:"self"}),"undefined"==typeof screen&&(that.screen={width:0,height:0}),"undefined"==typeof URL&&(that.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),that.window=global)})("undefined"==typeof global?null:global),"use strict",function(){function getBrowserInfo(){var nVer=navigator.appVersion,nAgt=navigator.userAgent,browserName=navigator.appName,fullVersion=""+parseFloat(navigator.appVersion),majorVersion=parseInt(navigator.appVersion,10),nameOffset,verOffset,ix;if(isSafari&&!isChrome&&-1!==nAgt.indexOf("CriOS")&&(isSafari=!1,isChrome=!0),isOpera){browserName="Opera";try{fullVersion=navigator.userAgent.split("OPR/")[1].split(" ")[0],majorVersion=fullVersion.split(".")[0]}catch(e){fullVersion="0.0.0.0",majorVersion=0}}else isIE?(verOffset=nAgt.indexOf("rv:"),0<verOffset?fullVersion=nAgt.substring(verOffset+3):(verOffset=nAgt.indexOf("MSIE"),fullVersion=nAgt.substring(verOffset+5)),browserName="IE"):isChrome?(verOffset=nAgt.indexOf("Chrome"),browserName="Chrome",fullVersion=nAgt.substring(verOffset+7)):isSafari?(verOffset=nAgt.indexOf("Safari"),browserName="Safari",fullVersion=nAgt.substring(verOffset+7),-1!==(verOffset=nAgt.indexOf("Version"))&&(fullVersion=nAgt.substring(verOffset+8)),-1!==navigator.userAgent.indexOf("Version/")&&(fullVersion=navigator.userAgent.split("Version/")[1].split(" ")[0])):isFirefox?(verOffset=nAgt.indexOf("Firefox"),browserName="Firefox",fullVersion=nAgt.substring(verOffset+8)):(nameOffset=nAgt.lastIndexOf(" ")+1)<(verOffset=nAgt.lastIndexOf("/"))&&(browserName=nAgt.substring(nameOffset,verOffset),fullVersion=nAgt.substring(verOffset+1),browserName.toLowerCase()===browserName.toUpperCase()&&(browserName=navigator.appName));return isEdge&&(browserName="Edge",fullVersion=navigator.userAgent.split("Edge/")[1]),-1!==(ix=fullVersion.search(/[; \)]/))&&(fullVersion=fullVersion.substring(0,ix)),majorVersion=parseInt(""+fullVersion,10),isNaN(majorVersion)&&(fullVersion=""+parseFloat(navigator.appVersion),majorVersion=parseInt(navigator.appVersion,10)),{fullVersion:fullVersion,version:majorVersion,name:browserName,isPrivateBrowsing:!1}}function retry(isDone,next){var currentTrial=0,isTimeout=!1,id=window.setInterval(function(){isDone()&&(window.clearInterval(id),next(isTimeout)),currentTrial++>50&&(window.clearInterval(id),isTimeout=!0,next(isTimeout))},10)}function isIE10OrLater(userAgent){var ua=userAgent.toLowerCase();if(0===ua.indexOf("msie")&&0===ua.indexOf("trident"))return!1;var match=/(?:msie|rv:)\s?([\d\.]+)/.exec(ua);return!!(match&&10<=parseInt(match[1],10))}function detectDesktopOS(){for(var unknown="-",nVer=navigator.appVersion,nAgt=navigator.userAgent,os=unknown,clientStrings=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],i=0,cs;cs=clientStrings[i];i++)if(cs.r.test(nAgt)){os=cs.s;break}var osVersion=unknown;return /Windows/.test(os)&&(/Windows (.*)/.test(os)&&(osVersion=/Windows (.*)/.exec(os)[1]),os="Windows"),"Mac OS X"===os?/Mac OS X (10[\.\_\d]+)/.test(nAgt)&&(osVersion=/Mac OS X (10[\.\_\d]+)/.exec(nAgt)[1]):"Android"===os?/Android ([\.\_\d]+)/.test(nAgt)&&(osVersion=/Android ([\.\_\d]+)/.exec(nAgt)[1]):"iOS"===os?/OS (\d+)_(\d+)_?(\d+)?/.test(nAgt)&&(osVersion=/OS (\d+)_(\d+)_?(\d+)?/.exec(nVer),osVersion=osVersion[1]+"."+osVersion[2]+"."+(0|osVersion[3])):void 0,{osName:os,osVersion:osVersion}}function getAndroidVersion(ua){ua=(ua||navigator.userAgent).toLowerCase();var match=ua.match(/android\s([0-9\.]*)/);return!!match&&match[1]}function getIPs(callback,stream){function handleCandidate(candidate){if(!candidate)return void callback();var match=regexIpv4.exec(candidate);if(match){var ipAddress=match[1],isPublic=candidate.match(regexIpv4Local);void 0===ipDuplicates[ipAddress]&&callback(ipAddress,isPublic,!0),ipDuplicates[ipAddress]=!0}}function afterCreateOffer(){var lines=pc.localDescription.sdp.split("\n");lines.forEach(function(line){line&&0===line.indexOf("a=candidate:")&&handleCandidate(line)})}if("undefined"!=typeof document&&"function"==typeof document.getElementById){var ipDuplicates={},RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!RTCPeerConnection){var iframe=document.getElementById("iframe");if(!iframe)return;var win=iframe.contentWindow;RTCPeerConnection=win.RTCPeerConnection||win.mozRTCPeerConnection||win.webkitRTCPeerConnection}if(RTCPeerConnection){var peerConfig=null;"Chrome"===DetectRTC.browser&&58>DetectRTC.browser.version&&(peerConfig={optional:[{RtpDataChannels:!0}]});var pc=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConfig);if(stream&&(pc.addStream?pc.addStream(stream):pc.addTrack&&stream.getTracks()[0]&&pc.addTrack(stream.getTracks()[0],stream)),pc.onicecandidate=function(event){event.candidate&&event.candidate.candidate?handleCandidate(event.candidate.candidate):handleCandidate()},!stream)try{pc.createDataChannel("sctp",{})}catch(e){}DetectRTC.isPromisesSupported?pc.createOffer().then(function(result){pc.setLocalDescription(result).then(afterCreateOffer)}):pc.createOffer(function(result){pc.setLocalDescription(result,afterCreateOffer,function(){})},function(){})}}}function checkDeviceSupport(callback){if(!canEnumerate)return void(callback&&callback());if(!navigator.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(navigator.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!navigator.enumerateDevices&&navigator.enumerateDevices&&(navigator.enumerateDevices=navigator.enumerateDevices.bind(navigator)),!navigator.enumerateDevices)return void(callback&&callback());MediaDevices=[],audioInputDevices=[],audioOutputDevices=[],videoInputDevices=[],hasMicrophone=!1,hasSpeakers=!1,hasWebcam=!1,isWebsiteHasMicrophonePermissions=!1,isWebsiteHasWebcamPermissions=!1;var alreadyUsedDevices={};navigator.enumerateDevices(function(devices){devices.forEach(function(_device){var device={};for(var d in _device)try{"function"!=typeof _device[d]&&(device[d]=_device[d])}catch(e){}alreadyUsedDevices[device.deviceId+device.label+device.kind]||("audio"===device.kind&&(device.kind="audioinput"),"video"===device.kind&&(device.kind="videoinput"),!device.deviceId&&(device.deviceId=device.id),!device.id&&(device.id=device.deviceId),device.label?("videoinput"===device.kind&&!isWebsiteHasWebcamPermissions&&(isWebsiteHasWebcamPermissions=!0),"audioinput"===device.kind&&!isWebsiteHasMicrophonePermissions&&(isWebsiteHasMicrophonePermissions=!0)):(device.isCustomLabel=!0,device.label="videoinput"===device.kind?"Camera "+(videoInputDevices.length+1):"audioinput"===device.kind?"Microphone "+(audioInputDevices.length+1):"audiooutput"===device.kind?"Speaker "+(audioOutputDevices.length+1):"Please invoke getUserMedia once.","undefined"!=typeof DetectRTC&&DetectRTC.browser.isChrome&&46<=DetectRTC.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(device.label="HTTPs is required to get label of this "+device.kind+" device.")),"audioinput"===device.kind&&(hasMicrophone=!0,-1===audioInputDevices.indexOf(device)&&audioInputDevices.push(device)),"audiooutput"===device.kind&&(hasSpeakers=!0,-1===audioOutputDevices.indexOf(device)&&audioOutputDevices.push(device)),"videoinput"===device.kind&&(hasWebcam=!0,-1===videoInputDevices.indexOf(device)&&videoInputDevices.push(device)),MediaDevices.push(device),alreadyUsedDevices[device.deviceId+device.label+device.kind]=device)}),"undefined"!=typeof DetectRTC&&(DetectRTC.MediaDevices=MediaDevices,DetectRTC.hasMicrophone=hasMicrophone,DetectRTC.hasSpeakers=hasSpeakers,DetectRTC.hasWebcam=hasWebcam,DetectRTC.isWebsiteHasWebcamPermissions=isWebsiteHasWebcamPermissions,DetectRTC.isWebsiteHasMicrophonePermissions=isWebsiteHasMicrophonePermissions,DetectRTC.audioInputDevices=audioInputDevices,DetectRTC.audioOutputDevices=audioOutputDevices,DetectRTC.videoInputDevices=videoInputDevices),callback&&callback()})}var browserFakeUserAgent="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",isNodejs="object"==typeof process&&"object"==typeof process.versions&&process.versions.node&&!process.browser;if(isNodejs){var version=process.versions.node.toString().replace("v","");browserFakeUserAgent="Nodejs/"+version+" (NodeOS) AppleWebKit/"+version+" (KHTML, like Gecko) Nodejs/"+version+" Nodejs/"+version}(function(that){"undefined"!=typeof window||("undefined"==typeof window&&"undefined"!=typeof global?(global.navigator={userAgent:browserFakeUserAgent,getUserMedia:function(){}},that.window=global):"undefined"==typeof window,"undefined"==typeof location&&(that.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(that.screen={width:0,height:0}))})("undefined"==typeof global?window:global);var navigator=window.navigator;"undefined"==typeof navigator?navigator={getUserMedia:function(){},userAgent:browserFakeUserAgent}:("undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var isMobileDevice=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(navigator.userAgent||""),isEdge=-1!==navigator.userAgent.indexOf("Edge")&&(!!navigator.msSaveOrOpenBlob||!!navigator.msSaveBlob),isOpera=!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),isFirefox="undefined"!=typeof window.InstallTrigger,isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),isChrome=!!window.chrome&&!isOpera,isIE="undefined"!=typeof document&&!!document.documentMode&&!isEdge,isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()},getOsName:function(){var osName="Unknown OS";return isMobile.Android()&&(osName="Android"),isMobile.BlackBerry()&&(osName="BlackBerry"),isMobile.iOS()&&(osName="iOS"),isMobile.Opera()&&(osName="Opera Mini"),isMobile.Windows()&&(osName="Windows"),osName}},osName="Unknown OS",osVersion="Unknown OS Version",osInfo=detectDesktopOS();osInfo&&osInfo.osName&&"-"!=osInfo.osName?(osName=osInfo.osName,osVersion=osInfo.osVersion):isMobile.any()&&(osName=isMobile.getOsName(),"Android"==osName&&(osVersion=getAndroidVersion()));var isNodejs="object"==typeof process&&"object"==typeof process.versions&&process.versions.node;"Unknown OS"===osName&&isNodejs&&(osName="Nodejs",osVersion=process.versions.node.toString().replace("v",""));var isCanvasSupportsStreamCapturing=!1,isVideoSupportsStreamCapturing=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(item){"undefined"==typeof document||"function"!=typeof document.createElement||(!isCanvasSupportsStreamCapturing&&item in document.createElement("canvas")&&(isCanvasSupportsStreamCapturing=!0),!isVideoSupportsStreamCapturing&&item in document.createElement("video")&&(isVideoSupportsStreamCapturing=!0))});var regexIpv4Local=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,regexIpv4=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,regexIpv6=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,MediaDevices=[],audioInputDevices=[],audioOutputDevices=[],videoInputDevices=[];navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=function(callback){var enumerateDevices=navigator.mediaDevices.enumerateDevices();enumerateDevices&&enumerateDevices.then?navigator.mediaDevices.enumerateDevices().then(callback).catch(function(){callback([])}):callback([])});var canEnumerate=!1;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack?canEnumerate=!0:navigator.mediaDevices&&!!navigator.mediaDevices.enumerateDevices&&(canEnumerate=!0);var hasMicrophone=!1,hasSpeakers=!1,hasWebcam=!1,isWebsiteHasMicrophonePermissions=!1,isWebsiteHasWebcamPermissions=!1,DetectRTC=window.DetectRTC||{};DetectRTC.browser=getBrowserInfo(),function(callback){var isPrivate;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){isPrivate=!1},function(){isPrivate=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var db;try{db=window.indexedDB.open("test"),db.onerror=function(){return!0}}catch(e){isPrivate=!0}"undefined"==typeof isPrivate&&retry(function(){return"done"===db.readyState},function(isTimeout){isTimeout||(isPrivate=!db.result)})}else if(isIE10OrLater(window.navigator.userAgent)){isPrivate=!1;try{window.indexedDB||(isPrivate=!0)}catch(e){isPrivate=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){isPrivate=!0}"undefined"==typeof isPrivate&&(isPrivate=!1,window.localStorage.removeItem("test"))}}catch(e){isPrivate=!1}retry(function(){return"undefined"!=typeof isPrivate},function(){callback(isPrivate)})}(function(isPrivateBrowsing){DetectRTC.browser.isPrivateBrowsing=!!isPrivateBrowsing}),DetectRTC.browser["is"+DetectRTC.browser.name]=!0,DetectRTC.osName=osName,DetectRTC.osVersion=osVersion;var isNodeWebkit="object"==typeof process&&"object"==typeof process.versions&&process.versions["node-webkit"],isWebRTCSupported=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(item){isWebRTCSupported||item in window&&(isWebRTCSupported=!0)}),DetectRTC.isWebRTCSupported=isWebRTCSupported,DetectRTC.isORTCSupported="undefined"!=typeof RTCIceGatherer;var isScreenCapturingSupported=!1;if(DetectRTC.browser.isChrome&&35<=DetectRTC.browser.version?isScreenCapturingSupported=!0:DetectRTC.browser.isFirefox&&34<=DetectRTC.browser.version?isScreenCapturingSupported=!0:DetectRTC.browser.isEdge&&17<=DetectRTC.browser.version?isScreenCapturingSupported=!0:"Android"===DetectRTC.osName&&DetectRTC.browser.isChrome&&(isScreenCapturingSupported=!0),!/^(https:|chrome-extension:)$/g.test(location.protocol||"")){var isNonLocalHost="undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g);isNonLocalHost&&(DetectRTC.browser.isChrome||DetectRTC.browser.isEdge||DetectRTC.browser.isOpera)?isScreenCapturingSupported=!1:DetectRTC.browser.isFirefox&&(isScreenCapturingSupported=!1)}DetectRTC.isScreenCapturingSupported=isScreenCapturingSupported;var webAudio={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(item){webAudio.isSupported||item in window&&(webAudio.isSupported=!0,window[item]&&"createMediaStreamSource"in window[item].prototype&&(webAudio.isCreateMediaStreamSourceSupported=!0))}),DetectRTC.isAudioContextSupported=webAudio.isSupported,DetectRTC.isCreateMediaStreamSourceSupported=webAudio.isCreateMediaStreamSourceSupported;var isRtpDataChannelsSupported=!1;DetectRTC.browser.isChrome&&31<DetectRTC.browser.version&&(isRtpDataChannelsSupported=!0),DetectRTC.isRtpDataChannelsSupported=isRtpDataChannelsSupported;var isSCTPSupportd=!1;DetectRTC.browser.isFirefox&&28<DetectRTC.browser.version?isSCTPSupportd=!0:DetectRTC.browser.isChrome&&25<DetectRTC.browser.version?isSCTPSupportd=!0:DetectRTC.browser.isOpera&&11<=DetectRTC.browser.version&&(isSCTPSupportd=!0),DetectRTC.isSctpDataChannelsSupported=isSCTPSupportd,DetectRTC.isMobileDevice=isMobileDevice;var isGetUserMediaSupported=!1;navigator.getUserMedia?isGetUserMediaSupported=!0:navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(isGetUserMediaSupported=!0),DetectRTC.browser.isChrome&&46<=DetectRTC.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(isGetUserMediaSupported="Requires HTTPs"),"Nodejs"===DetectRTC.osName&&(isGetUserMediaSupported=!1),DetectRTC.isGetUserMediaSupported=isGetUserMediaSupported;var displayResolution="";if(screen.width){var width=screen.width?screen.width:"",height=screen.height?screen.height:"";displayResolution+=""+width+" x "+height}DetectRTC.displayResolution=displayResolution,DetectRTC.displayAspectRatio=function(w,h){function gcd(a,b){return 0==b?a:gcd(b,a%b)}var r=gcd(w,h);return w/r/(h/r)}(screen.width,screen.height).toFixed(2),DetectRTC.isCanvasSupportsStreamCapturing=isCanvasSupportsStreamCapturing,DetectRTC.isVideoSupportsStreamCapturing=isVideoSupportsStreamCapturing,"Chrome"==DetectRTC.browser.name&&53<=DetectRTC.browser.version&&(!DetectRTC.isCanvasSupportsStreamCapturing&&(DetectRTC.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),!DetectRTC.isVideoSupportsStreamCapturing&&(DetectRTC.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),DetectRTC.DetectLocalIPAddress=function(callback,stream){if(DetectRTC.isWebRTCSupported){var isPublic=!0,isIpv4=!0;getIPs(function(ip){ip?ip.match(regexIpv4Local)?(isPublic=!1,callback("Local: "+ip,isPublic,isIpv4)):ip.match(regexIpv6)?(isIpv4=!1,callback("Public: "+ip,isPublic,isIpv4)):callback("Public: "+ip,isPublic,isIpv4):callback()},stream)}},DetectRTC.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,DetectRTC.isWebSocketsBlocked=!DetectRTC.isWebSocketsSupported,"Nodejs"===DetectRTC.osName&&(DetectRTC.isWebSocketsSupported=!0,DetectRTC.isWebSocketsBlocked=!1),DetectRTC.checkWebSocketsSupport=function(callback){callback=callback||function(){};try{var websocket=new WebSocket("wss://echo.websocket.org:443/"),starttime;websocket.onopen=function(){DetectRTC.isWebSocketsBlocked=!1,starttime=new Date().getTime(),websocket.send("ping")},websocket.onmessage=function(){DetectRTC.WebsocketLatency=new Date().getTime()-starttime+"ms",callback(),websocket.close(),websocket=null},websocket.onerror=function(){DetectRTC.isWebSocketsBlocked=!0,callback()}}catch(e){DetectRTC.isWebSocketsBlocked=!0,callback()}},DetectRTC.load=function(callback){callback=callback||function(){},checkDeviceSupport(callback)},"function"==typeof checkDeviceSupport,DetectRTC.MediaDevices="undefined"==typeof MediaDevices?[]:MediaDevices,DetectRTC.hasMicrophone=hasMicrophone,DetectRTC.hasSpeakers=hasSpeakers,DetectRTC.hasWebcam=hasWebcam,DetectRTC.isWebsiteHasWebcamPermissions=isWebsiteHasWebcamPermissions,DetectRTC.isWebsiteHasMicrophonePermissions=isWebsiteHasMicrophonePermissions,DetectRTC.audioInputDevices=audioInputDevices,DetectRTC.audioOutputDevices=audioOutputDevices,DetectRTC.videoInputDevices=videoInputDevices;var isSetSinkIdSupported=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(isSetSinkIdSupported=!0),DetectRTC.isSetSinkIdSupported=isSetSinkIdSupported;var isRTPSenderReplaceTracksSupported=!1;DetectRTC.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(isRTPSenderReplaceTracksSupported=!0):DetectRTC.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(isRTPSenderReplaceTracksSupported=!0),DetectRTC.isRTPSenderReplaceTracksSupported=isRTPSenderReplaceTracksSupported;var isRemoteStreamProcessingSupported=!1;DetectRTC.browser.isFirefox&&38<DetectRTC.browser.version&&(isRemoteStreamProcessingSupported=!0),DetectRTC.isRemoteStreamProcessingSupported=isRemoteStreamProcessingSupported;var isApplyConstraintsSupported=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(isApplyConstraintsSupported=!0),DetectRTC.isApplyConstraintsSupported=isApplyConstraintsSupported;var isMultiMonitorScreenCapturingSupported=!1;DetectRTC.browser.isFirefox&&43<=DetectRTC.browser.version&&(isMultiMonitorScreenCapturingSupported=!0),DetectRTC.isMultiMonitorScreenCapturingSupported=isMultiMonitorScreenCapturingSupported,DetectRTC.isPromisesSupported=!!("Promise"in window),DetectRTC.version="1.3.9","undefined"==typeof DetectRTC&&(window.DetectRTC={});var MediaStream=window.MediaStream;"undefined"==typeof MediaStream&&"undefined"!=typeof webkitMediaStream&&(MediaStream=webkitMediaStream),DetectRTC.MediaStream="undefined"!=typeof MediaStream&&"function"==typeof MediaStream&&Object.keys(MediaStream.prototype),DetectRTC.MediaStreamTrack="undefined"!=typeof MediaStreamTrack&&Object.keys(MediaStreamTrack.prototype);var RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;DetectRTC.RTCPeerConnection="undefined"!=typeof RTCPeerConnection&&Object.keys(RTCPeerConnection.prototype),window.DetectRTC=DetectRTC,"undefined"!=typeof module&&(module.exports=DetectRTC),"function"==typeof define&&define.amd&&define("DetectRTC",[],function(){return DetectRTC})}(),"undefined"!=typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),window.addEventListener||(window.addEventListener=function(el,eventName,eventHandler){el.attachEvent&&el.attachEvent("on"+eventName,eventHandler)}),window.attachEventListener=function(video,type,listener,useCapture){video.addEventListener(type,listener,useCapture)};var MediaStream=window.MediaStream;"undefined"==typeof MediaStream&&"undefined"!=typeof webkitMediaStream&&(MediaStream=webkitMediaStream),"undefined"==typeof MediaStream||"stop"in MediaStream.prototype||(MediaStream.prototype.stop=function(){this.getTracks().forEach(function(track){track.stop()})}),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||"speaker",document.addEventListener("deviceready",setCordovaAPIs,!1),setCordovaAPIs();var defaults={},RTCPeerConnection;"undefined"==typeof window.RTCPeerConnection?"undefined"==typeof mozRTCPeerConnection?"undefined"!=typeof webkitRTCPeerConnection&&(RTCPeerConnection=webkitRTCPeerConnection):RTCPeerConnection=mozRTCPeerConnection:RTCPeerConnection=window.RTCPeerConnection;var RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate,MediaStreamTrack=window.MediaStreamTrack,CodecsHandler=function(){function preferCodec(sdp,codecName){var info=splitLines(sdp);return info.videoCodecNumbers?"vp8"===codecName&&info.vp8LineNumber===info.videoCodecNumbers[0]?sdp:"vp9"===codecName&&info.vp9LineNumber===info.videoCodecNumbers[0]?sdp:"h264"===codecName&&info.h264LineNumber===info.videoCodecNumbers[0]?sdp:(sdp=preferCodecHelper(sdp,codecName,info),sdp):sdp}function preferCodecHelper(sdp,codec,info,ignore){var preferCodecNumber="";if("vp8"===codec){if(!info.vp8LineNumber)return sdp;preferCodecNumber=info.vp8LineNumber}if("vp9"===codec){if(!info.vp9LineNumber)return sdp;preferCodecNumber=info.vp9LineNumber}if("h264"===codec){if(!info.h264LineNumber)return sdp;preferCodecNumber=info.h264LineNumber}var newLine=info.videoCodecNumbersOriginal.split("SAVPF")[0]+"SAVPF ",newOrder=[preferCodecNumber];return ignore&&(newOrder=[]),info.videoCodecNumbers.forEach(function(codecNumber){codecNumber===preferCodecNumber||newOrder.push(codecNumber)}),newLine+=newOrder.join(" "),sdp=sdp.replace(info.videoCodecNumbersOriginal,newLine),sdp}function splitLines(sdp){var info={};return sdp.split("\n").forEach(function(line){0===line.indexOf("m=video")&&(info.videoCodecNumbers=[],line.split("SAVPF")[1].split(" ").forEach(function(codecNumber){codecNumber=codecNumber.trim(),codecNumber&&codecNumber.length&&(info.videoCodecNumbers.push(codecNumber),info.videoCodecNumbersOriginal=line)})),-1===line.indexOf("VP8/90000")||info.vp8LineNumber||(info.vp8LineNumber=line.replace("a=rtpmap:","").split(" ")[0]),-1===line.indexOf("VP9/90000")||info.vp9LineNumber||(info.vp9LineNumber=line.replace("a=rtpmap:","").split(" ")[0]),-1===line.indexOf("H264/90000")||info.h264LineNumber||(info.h264LineNumber=line.replace("a=rtpmap:","").split(" ")[0])}),info}function setBAS(sdp,bandwidth,isScreen){return bandwidth?"undefined"!=typeof isFirefox&&isFirefox?sdp:(isScreen&&(bandwidth.screen?300>bandwidth.screen&&console.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):console.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),bandwidth.screen&&isScreen&&(sdp=sdp.replace(/b=AS([^\r\n]+\r\n)/g,""),sdp=sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+bandwidth.screen+"\r\n")),(bandwidth.audio||bandwidth.video)&&(sdp=sdp.replace(/b=AS([^\r\n]+\r\n)/g,"")),bandwidth.audio&&(sdp=sdp.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+bandwidth.audio+"\r\n")),bandwidth.screen?sdp=sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+bandwidth.screen+"\r\n"):bandwidth.video&&(sdp=sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+bandwidth.video+"\r\n")),sdp):sdp}function findLine(sdpLines,prefix,substr){return findLineInRange(sdpLines,0,-1,prefix,substr)}function findLineInRange(sdpLines,startLine,endLine,prefix,substr){for(var realEndLine=-1===endLine?sdpLines.length:endLine,i=startLine;i<realEndLine;++i)if(0===sdpLines[i].indexOf(prefix)&&(!substr||-1!==sdpLines[i].toLowerCase().indexOf(substr.toLowerCase())))return i;return null}function getCodecPayloadType(sdpLine){var pattern=/a=rtpmap:(\d+) \w+\/\d+/,result=sdpLine.match(pattern);return result&&2===result.length?result[1]:null}function setVideoBitrates(sdp,params){params=params||{};var xgoogle_min_bitrate=params.min,xgoogle_max_bitrate=params.max,sdpLines=sdp.split("\r\n"),vp8Index=findLine(sdpLines,"a=rtpmap","VP8/90000"),vp8Payload;if(vp8Index&&(vp8Payload=getCodecPayloadType(sdpLines[vp8Index])),!vp8Payload)return sdp;var rtxIndex=findLine(sdpLines,"a=rtpmap","rtx/90000"),rtxPayload;if(rtxIndex&&(rtxPayload=getCodecPayloadType(sdpLines[rtxIndex])),!rtxIndex)return sdp;var rtxFmtpLineIndex=findLine(sdpLines,"a=fmtp:"+rtxPayload.toString());if(null!==rtxFmtpLineIndex){var appendrtxNext="\r\n";appendrtxNext+="a=fmtp:"+vp8Payload+" x-google-min-bitrate="+(xgoogle_min_bitrate||"228")+"; x-google-max-bitrate="+(xgoogle_max_bitrate||"228"),sdpLines[rtxFmtpLineIndex]=sdpLines[rtxFmtpLineIndex].concat(appendrtxNext),sdp=sdpLines.join("\r\n")}return sdp}function setOpusAttributes(sdp,params){params=params||{};var sdpLines=sdp.split("\r\n"),opusIndex=findLine(sdpLines,"a=rtpmap","opus/48000"),opusPayload;if(opusIndex&&(opusPayload=getCodecPayloadType(sdpLines[opusIndex])),!opusPayload)return sdp;var opusFmtpLineIndex=findLine(sdpLines,"a=fmtp:"+opusPayload.toString());if(null===opusFmtpLineIndex)return sdp;var appendOpusNext="";return appendOpusNext+="; stereo="+("undefined"==typeof params.stereo?"1":params.stereo),appendOpusNext+="; sprop-stereo="+("undefined"==typeof params["sprop-stereo"]?"1":params["sprop-stereo"]),"undefined"!=typeof params.maxaveragebitrate&&(appendOpusNext+="; maxaveragebitrate="+(params.maxaveragebitrate||1048576)),"undefined"!=typeof params.maxplaybackrate&&(appendOpusNext+="; maxplaybackrate="+(params.maxplaybackrate||1048576)),"undefined"!=typeof params.cbr&&(appendOpusNext+="; cbr="+("undefined"==typeof params.cbr?"1":params.cbr)),"undefined"!=typeof params.useinbandfec&&(appendOpusNext+="; useinbandfec="+params.useinbandfec),"undefined"!=typeof params.usedtx&&(appendOpusNext+="; usedtx="+params.usedtx),"undefined"!=typeof params.maxptime&&(appendOpusNext+="\r\na=maxptime:"+params.maxptime),sdpLines[opusFmtpLineIndex]=sdpLines[opusFmtpLineIndex].concat(appendOpusNext),sdp=sdpLines.join("\r\n"),sdp}return{removeVPX:function(sdp){var info=splitLines(sdp);return sdp=preferCodecHelper(sdp,"vp9",info,!0),sdp=preferCodecHelper(sdp,"vp8",info,!0),sdp},disableNACK:function(sdp){if(!sdp||"string"!=typeof sdp)throw"Invalid arguments.";return sdp=sdp.replace("a=rtcp-fb:126 nack\r\n",""),sdp=sdp.replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n"),sdp=sdp.replace("a=rtcp-fb:97 nack\r\n",""),sdp=sdp.replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n"),sdp},prioritize:function(codecMimeType,peer){if(peer&&peer.getSenders&&peer.getSenders().length){if(!codecMimeType||"string"!=typeof codecMimeType)throw"Invalid arguments.";peer.getSenders().forEach(function(sender){for(var params=sender.getParameters(),i=0;i<params.codecs.length;i++)if(params.codecs[i].mimeType==codecMimeType){params.codecs.unshift(params.codecs.splice(i,1));break}sender.setParameters(params)})}},removeNonG722:function(sdp){return sdp.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")},setApplicationSpecificBandwidth:function(sdp,bandwidth,isScreen){return setBAS(sdp,bandwidth,isScreen)},setVideoBitrates:function(sdp,params){return setVideoBitrates(sdp,params)},setOpusAttributes:function(sdp,params){return setOpusAttributes(sdp,params)},preferVP9:function(sdp){return preferCodec(sdp,"vp9")},preferCodec:preferCodec,forceStereoAudio:function(sdp){for(var sdpLines=sdp.split("\r\n"),fmtpLineIndex=null,i=0;i<sdpLines.length;i++)if(-1!==sdpLines[i].search("opus/48000")){var opusPayload=extractSdp(sdpLines[i],/:(\d+) opus\/48000/i);break}for(var i=0;i<sdpLines.length;i++)if(-1!==sdpLines[i].search("a=fmtp")){var payload=extractSdp(sdpLines[i],/a=fmtp:(\d+)/);if(payload===opusPayload){fmtpLineIndex=i;break}}return null===fmtpLineIndex?sdp:(sdpLines[fmtpLineIndex]=sdpLines[fmtpLineIndex].concat("; stereo=1; sprop-stereo=1"),sdp=sdpLines.join("\r\n"),sdp)}}}();window.BandwidthHandler=CodecsHandler;var OnIceCandidateHandler=function(){return{processCandidates:function(connection,icePair){var candidate=icePair.candidate,iceRestrictions=connection.candidates,stun=iceRestrictions.stun,turn=iceRestrictions.turn;if((isNull(iceRestrictions.reflexive)||(stun=iceRestrictions.reflexive),isNull(iceRestrictions.relay)||(turn=iceRestrictions.relay),iceRestrictions.host||!candidate.match(/typ host/g))&&(turn||!candidate.match(/typ relay/g))&&(stun||!candidate.match(/typ srflx/g))){var protocol=connection.iceProtocols;if(protocol.udp||!candidate.match(/ udp /g))return protocol.tcp||!candidate.match(/ tcp /g)?(connection.enableLogs&&console.debug("Your candidate pairs:",candidate),{candidate:candidate,sdpMid:icePair.sdpMid,sdpMLineIndex:icePair.sdpMLineIndex}):void 0}}}}(),IceServersHandler=function(){return{getIceServers:function(){return[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}]}}}();window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(idInstance){this.mutex=!1;var stream=this.streams[idInstance];if(stream){stream=stream.stream;var options=stream.currentUserMediaRequestOptions;this.queueRequests.indexOf(options)&&(delete this.queueRequests[this.queueRequests.indexOf(options)],this.queueRequests=removeNullEntries(this.queueRequests)),this.streams[idInstance].stream=null,delete this.streams[idInstance]}}};var StreamsHandler=function(){function handleType(type){return type?"string"==typeof type||"undefined"==typeof type?type:type.audio&&type.video?null:type.audio?"audio":type.video?"video":void 0:void 0}function setHandlers(stream,syncAction,connection){function graduallyIncreaseVolume(){if(connection.streamEvents[stream.streamid].mediaElement){var mediaElement=connection.streamEvents[stream.streamid].mediaElement;mediaElement.volume=0,afterEach(200,5,function(){try{mediaElement.volume+=.2}catch(e){mediaElement.volume=1}})}}if(stream&&stream.addEventListener){if("undefined"==typeof syncAction||!0==syncAction){var streamEndedEvent="ended";"oninactive"in stream&&(streamEndedEvent="inactive"),stream.addEventListener(streamEndedEvent,function(){StreamsHandler.onSyncNeeded(this.streamid,streamEndedEvent)},!1)}stream.mute=function(type,isSyncAction){type=handleType(type),"undefined"!=typeof isSyncAction&&(syncAction=isSyncAction),("undefined"==typeof type||"audio"==type)&&getTracks(stream,"audio").forEach(function(track){track.enabled=!1,connection.streamEvents[stream.streamid].isAudioMuted=!0}),("undefined"==typeof type||"video"==type)&&getTracks(stream,"video").forEach(function(track){track.enabled=!1}),("undefined"==typeof syncAction||!0==syncAction)&&StreamsHandler.onSyncNeeded(stream.streamid,"mute",type),connection.streamEvents[stream.streamid].muteType=type||"both",fireEvent(stream,"mute",type)},stream.unmute=function(type,isSyncAction){type=handleType(type),"undefined"!=typeof isSyncAction&&(syncAction=isSyncAction),graduallyIncreaseVolume(),("undefined"==typeof type||"audio"==type)&&getTracks(stream,"audio").forEach(function(track){track.enabled=!0,connection.streamEvents[stream.streamid].isAudioMuted=!1}),("undefined"==typeof type||"video"==type)&&(getTracks(stream,"video").forEach(function(track){track.enabled=!0}),"undefined"!=typeof type&&"video"==type&&connection.streamEvents[stream.streamid].isAudioMuted&&function looper(times){times||(times=0),times++,100>times&&connection.streamEvents[stream.streamid].isAudioMuted&&(stream.mute("audio"),setTimeout(function(){looper(times)},50))}()),("undefined"==typeof syncAction||!0==syncAction)&&StreamsHandler.onSyncNeeded(stream.streamid,"unmute",type),connection.streamEvents[stream.streamid].unmuteType=type||"both",fireEvent(stream,"unmute",type)}}}function afterEach(setTimeoutInteval,numberOfTimes,callback,startedTimes){startedTimes=(startedTimes||0)+1,startedTimes>=numberOfTimes||setTimeout(function(){callback(),afterEach(setTimeoutInteval,numberOfTimes,callback,startedTimes)},setTimeoutInteval)}return{setHandlers:setHandlers,onSyncNeeded:function(){}}}(),TextSender={send:function(config){function sendText(textMessage,text){var data={type:"text",uuid:uuid,sendingTime:sendingTime};textMessage&&(text=textMessage,data.packets=parseInt(text.length/packetSize)),text.length>packetSize?data.message=text.slice(0,packetSize):(data.message=text,data.last=!0,data.isobject=isobject),channel.send(data,remoteUserId),textToTransfer=text.slice(data.message.length),textToTransfer.length&&setTimeout(function(){sendText(null,textToTransfer)},connection.chunkInterval||100)}var connection=config.connection,channel=config.channel,remoteUserId=config.remoteUserId,initialText=config.text,packetSize=connection.chunkSize||1e3,textToTransfer="",isobject=!1;isString(initialText)||(isobject=!0,initialText=JSON.stringify(initialText));var uuid=getRandomString(),sendingTime=new Date().getTime();sendText(initialText)}},FileProgressBarHandler=function(){return{handle:function(connection){function updateLabel(progress,label){if(-1!==progress.position){var position=+progress.position.toFixed(2).split(".")[1]||100;label.innerHTML=position+"%"}}var progressHelper={};connection.onFileStart=function(file){var div=document.createElement("div");return div.title=file.name,div.innerHTML="<label>0%</label> <progress></progress>",file.remoteUserId&&(div.innerHTML+=" (Sharing with:"+file.remoteUserId+")"),connection.filesContainer||(connection.filesContainer=document.body||document.documentElement),connection.filesContainer.insertBefore(div,connection.filesContainer.firstChild),file.remoteUserId?void(!progressHelper[file.uuid]&&(progressHelper[file.uuid]={}),progressHelper[file.uuid][file.remoteUserId]={div:div,progress:div.querySelector("progress"),label:div.querySelector("label")},progressHelper[file.uuid][file.remoteUserId].progress.max=file.maxChunks):(progressHelper[file.uuid]={div:div,progress:div.querySelector("progress"),label:div.querySelector("label")},void(progressHelper[file.uuid].progress.max=file.maxChunks))},connection.onFileProgress=function(chunk){var helper=progressHelper[chunk.uuid];!helper||chunk.remoteUserId&&(helper=progressHelper[chunk.uuid][chunk.remoteUserId],!helper)||(helper.progress.value=chunk.currentPosition||chunk.maxChunks||helper.progress.max,updateLabel(helper.progress,helper.label))},connection.onFileEnd=function(file){var helper=progressHelper[file.uuid];if(!helper)return void console.error("No such progress-helper element exist.",file);if(!(file.remoteUserId&&(helper=progressHelper[file.uuid][file.remoteUserId],!helper))){var div=helper.div;div.innerHTML=-1==file.type.indexOf("image")?"<a href=\""+file.url+"\" download=\""+file.name+"\">Download <strong style=\"color:red;\">"+file.name+"</strong> </a><br /><iframe src=\""+file.url+"\" title=\""+file.name+"\" style=\"width: 80%;border: 0;height: inherit;margin-top:1em;\"></iframe>":"<a href=\""+file.url+"\" download=\""+file.name+"\">Download <strong style=\"color:red;\">"+file.name+"</strong> </a><br /><img src=\""+file.url+"\" title=\""+file.name+"\" style=\"max-width: 80%;\">"}}}}}(),TranslationHandler=function(){return{handle:function(connection){connection.autoTranslateText=!1,connection.language="en",connection.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",connection.Translator={TranslateText:function(text,callback){var newScript=document.createElement("script");newScript.type="text/javascript";var sourceText=encodeURIComponent(text),randomNumber="method"+connection.token();window[randomNumber]=function(response){return response.data&&response.data.translations[0]&&callback?void callback(response.data.translations[0].translatedText):response.error&&"Daily Limit Exceeded"===response.error.message?void console.error("Text translation failed. Error message: \"Daily Limit Exceeded.\""):response.error?void console.error(response.error.message):void console.error(response)};var source="https://www.googleapis.com/language/translate/v2?key="+connection.googKey+"&target="+(connection.language||"en-US")+"&callback=window."+randomNumber+"&q="+sourceText;newScript.src=source,document.getElementsByTagName("head")[0].appendChild(newScript)},getListOfLanguages:function(callback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState==XMLHttpRequest.DONE){var response=JSON.parse(xhr.responseText);if(response&&response.data&&response.data.languages)return void callback(response.data.languages);if(response.error&&"Daily Limit Exceeded"===response.error.message)return void console.error("Text translation failed. Error message: \"Daily Limit Exceeded.\"");if(response.error)return void console.error(response.error.message);console.error(response)}};var url="https://www.googleapis.com/language/translate/v2/languages?key="+connection.googKey+"&target=en";xhr.open("GET",url,!0),xhr.send(null)}}}}}();(function(connection){function connectSocket(connectCallback){if(connection.socketAutoReConnect=!0,connection.socket)return void(connectCallback&&connectCallback(connection.socket));if("undefined"==typeof SocketConnection)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else if("undefined"!=typeof PubNubConnection)window.SocketConnection=PubNubConnection;else throw"SocketConnection.js seems missed.";new SocketConnection(connection,function(){connectCallback&&connectCallback(connection.socket)})}function joinRoom(connectionDescription,cb){connection.socket.emit("join-room",{sessionid:connection.sessionid,session:connection.session,mediaConstraints:connection.mediaConstraints,sdpConstraints:connection.sdpConstraints,streams:getStreamInfoForAdmin(),extra:connection.extra,password:"undefined"!=typeof connection.password&&"object"!=typeof connection.password?connection.password:""},function(isRoomJoined,error){if(!0===isRoomJoined){if(connection.enableLogs&&console.log("isRoomJoined: ",isRoomJoined," roomid: ",connection.sessionid),!!connection.peers[connection.sessionid])return;mPeer.onNegotiationNeeded(connectionDescription)}!1===isRoomJoined&&(connection.enableLogs&&console.warn("isRoomJoined: ",error," roomid: ",connection.sessionid),!1),cb(isRoomJoined,connection.sessionid,error)})}function openRoom(callback){connection.enableLogs&&console.log("Sending open-room signal to socket.io"),connection.waitingForLocalMedia=!1,connection.socket.emit("open-room",{sessionid:connection.sessionid,session:connection.session,mediaConstraints:connection.mediaConstraints,sdpConstraints:connection.sdpConstraints,streams:getStreamInfoForAdmin(),extra:connection.extra,identifier:connection.publicRoomIdentifier,password:"undefined"!=typeof connection.password&&"object"!=typeof connection.password?connection.password:""},function(isRoomOpened,error){!0===isRoomOpened&&(connection.enableLogs&&console.log("isRoomOpened: ",isRoomOpened," roomid: ",connection.sessionid),callback(isRoomOpened,connection.sessionid)),!1===isRoomOpened&&(connection.enableLogs&&console.warn("isRoomOpened: ",error," roomid: ",connection.sessionid),callback(isRoomOpened,connection.sessionid,error))})}function getStreamInfoForAdmin(){try{return connection.streamEvents.selectAll("local").map(function(event){return{streamid:event.streamid,tracks:event.stream.getTracks().length}})}catch(e){return[]}}function beforeJoin(userPreferences,callback){if(connection.dontCaptureUserMedia||userPreferences.isDataOnly)return void callback();var localMediaConstraints={};userPreferences.localPeerSdpConstraints.OfferToReceiveAudio&&(localMediaConstraints.audio=connection.mediaConstraints.audio),userPreferences.localPeerSdpConstraints.OfferToReceiveVideo&&(localMediaConstraints.video=connection.mediaConstraints.video);var session=userPreferences.session||connection.session;return session.oneway&&"two-way"!==session.audio&&"two-way"!==session.video&&"two-way"!==session.screen?void callback():void(session.oneway&&session.audio&&"two-way"===session.audio&&(session={audio:!0}),(session.audio||session.video||session.screen)&&(session.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:isAudioPlusTab(connection)}).then(function(screen){screen.isScreen=!0,mPeer.onGettingLocalMedia(screen),(session.audio||session.video)&&!isAudioPlusTab(connection)?connection.invokeGetUserMedia(null,callback):callback(screen)},function(){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):connection.invokeGetUserMedia({audio:isAudioPlusTab(connection),video:!0,isScreen:!0},(session.audio||session.video)&&!isAudioPlusTab(connection)?connection.invokeGetUserMedia(null,callback):callback):(session.audio||session.video)&&connection.invokeGetUserMedia(null,callback,session)))}function applyConstraints(stream,mediaConstraints){return stream?void(mediaConstraints.audio&&getTracks(stream,"audio").forEach(function(track){track.applyConstraints(mediaConstraints.audio)}),mediaConstraints.video&&getTracks(stream,"video").forEach(function(track){track.applyConstraints(mediaConstraints.video)})):void(!connection.enableLogs||console.error("No stream to applyConstraints."))}function replaceTrack(track,remoteUserId,isVideoTrack){return remoteUserId?void mPeer.replaceTrack(track,remoteUserId,isVideoTrack):void connection.peers.getAllParticipants().forEach(function(participant){mPeer.replaceTrack(track,participant,isVideoTrack)})}forceOptions=forceOptions||{useDefaultDevices:!0},connection.channel=connection.sessionid=(roomid||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var mPeer=new MultiPeers(connection),preventDuplicateOnStreamEvents={};mPeer.onGettingLocalMedia=function(stream,callback){if(callback=callback||function(){},preventDuplicateOnStreamEvents[stream.streamid])return void callback();preventDuplicateOnStreamEvents[stream.streamid]=!0;try{stream.type="local"}catch(e){}connection.setStreamEndHandler(stream),getRMCMediaElement(stream,function(mediaElement){mediaElement.id=stream.streamid,mediaElement.muted=!0,mediaElement.volume=0,-1===connection.attachStreams.indexOf(stream)&&connection.attachStreams.push(stream),"undefined"!=typeof StreamsHandler&&StreamsHandler.setHandlers(stream,!0,connection),connection.streamEvents[stream.streamid]={stream:stream,type:"local",mediaElement:mediaElement,userid:connection.userid,extra:connection.extra,streamid:stream.streamid,isAudioMuted:!0};try{setHarkEvents(connection,connection.streamEvents[stream.streamid]),setMuteHandlers(connection,connection.streamEvents[stream.streamid]),connection.onstream(connection.streamEvents[stream.streamid])}catch(e){}callback()},connection)},mPeer.onGettingRemoteMedia=function(stream,remoteUserId){try{stream.type="remote"}catch(e){}connection.setStreamEndHandler(stream,"remote-stream"),getRMCMediaElement(stream,function(mediaElement){mediaElement.id=stream.streamid,"undefined"!=typeof StreamsHandler&&StreamsHandler.setHandlers(stream,!1,connection),connection.streamEvents[stream.streamid]={stream:stream,type:"remote",userid:remoteUserId,extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},mediaElement:mediaElement,streamid:stream.streamid},setMuteHandlers(connection,connection.streamEvents[stream.streamid]),connection.onstream(connection.streamEvents[stream.streamid])},connection)},mPeer.onRemovingRemoteMedia=function(stream,remoteUserId){var streamEvent=connection.streamEvents[stream.streamid];streamEvent||(streamEvent={stream:stream,type:"remote",userid:remoteUserId,extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},streamid:stream.streamid,mediaElement:connection.streamEvents[stream.streamid]?connection.streamEvents[stream.streamid].mediaElement:null}),connection.peersBackup[streamEvent.userid]&&(streamEvent.extra=connection.peersBackup[streamEvent.userid].extra),connection.onstreamended(streamEvent),delete connection.streamEvents[stream.streamid]},mPeer.onNegotiationNeeded=function(message,remoteUserId,callback){callback=callback||function(){},remoteUserId=remoteUserId||message.remoteUserId,message=message||"";var messageToDeliver={remoteUserId:remoteUserId,message:message,sender:connection.userid};message.remoteUserId&&message.message&&message.sender&&(messageToDeliver=message),connectSocket(function(){connection.socket.emit(connection.socketMessageEvent,messageToDeliver,callback)})},mPeer.onUserLeft=function(remoteUserId){connection.deletePeer(remoteUserId)},mPeer.disconnectWith=function(remoteUserId,callback){connection.socket&&connection.socket.emit("disconnect-with",remoteUserId,callback||function(){}),connection.deletePeer(remoteUserId)},connection.socketOptions={transport:"polling"},connection.openOrJoin=function(roomid,callback){callback=callback||function(){},connection.checkPresence(roomid,function(isRoomExist,roomid){if(isRoomExist){connection.sessionid=roomid;var localPeerSdpConstraints=!1,remotePeerSdpConstraints=!1,isOneWay=!!connection.session.oneway,isDataOnly=isData(connection.session);remotePeerSdpConstraints={OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},localPeerSdpConstraints={OfferToReceiveAudio:isOneWay?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:isOneWay?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo};var connectionDescription={remoteUserId:connection.sessionid,message:{newParticipationRequest:!0,isOneWay:isOneWay,isDataOnly:isDataOnly,localPeerSdpConstraints:localPeerSdpConstraints,remotePeerSdpConstraints:remotePeerSdpConstraints},sender:connection.userid};return void beforeJoin(connectionDescription.message,function(){joinRoom(connectionDescription,callback)})}return connection.waitingForLocalMedia=!0,connection.isInitiator=!0,connection.sessionid=roomid||connection.sessionid,isData(connection.session)?void openRoom(callback):void connection.captureUserMedia(function(){openRoom(callback)})})},connection.waitingForLocalMedia=!1,connection.open=function(roomid,callback){callback=callback||function(){},connection.waitingForLocalMedia=!0,connection.isInitiator=!0,connection.sessionid=roomid||connection.sessionid,connectSocket(function(){return isData(connection.session)?void openRoom(callback):void connection.captureUserMedia(function(){openRoom(callback)})})},connection.peersBackup={},connection.deletePeer=function(remoteUserId){if(remoteUserId&&connection.peers[remoteUserId]){var eventObject={userid:remoteUserId,extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{}};if(connection.peersBackup[eventObject.userid]&&(eventObject.extra=connection.peersBackup[eventObject.userid].extra),connection.onleave(eventObject),!!connection.peers[remoteUserId]){connection.peers[remoteUserId].streams.forEach(function(stream){stream.stop()});var peer=connection.peers[remoteUserId].peer;if(peer&&"closed"!==peer.iceConnectionState)try{peer.close()}catch(e){}connection.peers[remoteUserId]&&(connection.peers[remoteUserId].peer=null,delete connection.peers[remoteUserId])}}},connection.rejoin=function(connectionDescription){if(!connection.isInitiator&&connectionDescription&&Object.keys(connectionDescription).length){var extra={};connection.peers[connectionDescription.remoteUserId]&&(extra=connection.peers[connectionDescription.remoteUserId].extra,connection.deletePeer(connectionDescription.remoteUserId)),connectionDescription&&connectionDescription.remoteUserId&&(connection.join(connectionDescription.remoteUserId),connection.onReConnecting({userid:connectionDescription.remoteUserId,extra:extra}))}},connection.join=function(remoteUserId,options){connection.sessionid=!!remoteUserId&&(remoteUserId.sessionid||remoteUserId.remoteUserId||remoteUserId)||connection.sessionid,connection.sessionid+="";var localPeerSdpConstraints=!1,remotePeerSdpConstraints=!1,isOneWay=!1,isDataOnly=!1;if(remoteUserId&&remoteUserId.session||!remoteUserId||"string"==typeof remoteUserId){var session=remoteUserId?remoteUserId.session||connection.session:connection.session;isOneWay=!!session.oneway,isDataOnly=isData(session),remotePeerSdpConstraints={OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},localPeerSdpConstraints={OfferToReceiveAudio:isOneWay?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:isOneWay?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo}}options=options||{};var cb=function(){};"function"==typeof options&&(cb=options,options={}),"undefined"!=typeof options.localPeerSdpConstraints&&(localPeerSdpConstraints=options.localPeerSdpConstraints),"undefined"!=typeof options.remotePeerSdpConstraints&&(remotePeerSdpConstraints=options.remotePeerSdpConstraints),"undefined"!=typeof options.isOneWay&&(isOneWay=options.isOneWay),"undefined"!=typeof options.isDataOnly&&(isDataOnly=options.isDataOnly);var connectionDescription={remoteUserId:connection.sessionid,message:{newParticipationRequest:!0,isOneWay:isOneWay,isDataOnly:isDataOnly,localPeerSdpConstraints:localPeerSdpConstraints,remotePeerSdpConstraints:remotePeerSdpConstraints},sender:connection.userid};return beforeJoin(connectionDescription.message,function(){connectSocket(function(){joinRoom(connectionDescription,cb)})}),connectionDescription},connection.publicRoomIdentifier="",connection.getUserMedia=connection.captureUserMedia=function(callback,sessionForced){callback=callback||function(){};var session=sessionForced||connection.session;return connection.dontCaptureUserMedia||isData(session)?void callback():void((session.audio||session.video||session.screen)&&(session.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:isAudioPlusTab(connection)}).then(function(screen){if(screen.isScreen=!0,mPeer.onGettingLocalMedia(screen),(session.audio||session.video)&&!isAudioPlusTab(connection)){var nonScreenSession={};for(var s in session)"screen"!==s&&(nonScreenSession[s]=session[s]);return void connection.invokeGetUserMedia(sessionForced,callback,nonScreenSession)}callback(screen)},function(){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):connection.invokeGetUserMedia({audio:isAudioPlusTab(connection),video:!0,isScreen:!0},function(stream){if((session.audio||session.video)&&!isAudioPlusTab(connection)){var nonScreenSession={};for(var s in session)"screen"!==s&&(nonScreenSession[s]=session[s]);return void connection.invokeGetUserMedia(sessionForced,callback,nonScreenSession)}callback(stream)}):(session.audio||session.video)&&connection.invokeGetUserMedia(sessionForced,callback,session)))},connection.onbeforeunload=function(arg1,dontCloseSocket){connection.closeBeforeUnload&&(connection.peers.getAllParticipants().forEach(function(participant){mPeer.onNegotiationNeeded({userLeft:!0},participant),connection.peers[participant]&&connection.peers[participant].peer&&connection.peers[participant].peer.close(),delete connection.peers[participant]}),!dontCloseSocket&&connection.closeSocket(),connection.isInitiator=!1)},window.ignoreBeforeUnload?connection.closeBeforeUnload=!1:(connection.closeBeforeUnload=!0,window.addEventListener("beforeunload",connection.onbeforeunload,!1)),connection.userid=getRandomString(),connection.changeUserId=function(newUserId,callback){callback=callback||function(){},connection.userid=newUserId||getRandomString(),connection.socket.emit("changed-uuid",connection.userid,callback)},connection.extra={},connection.attachStreams=[],connection.session={audio:!0,video:!0},connection.enableFileSharing=!1,connection.bandwidth={screen:!1,audio:!1,video:!1},connection.codecs={audio:"opus",video:"VP9"},connection.processSdp=function(sdp){return isUnifiedPlanSupportedDefault()?sdp:"Safari"===DetectRTC.browser.name?sdp:("VP8"===connection.codecs.video.toUpperCase()&&(sdp=CodecsHandler.preferCodec(sdp,"vp8")),"VP9"===connection.codecs.video.toUpperCase()&&(sdp=CodecsHandler.preferCodec(sdp,"vp9")),"H264"===connection.codecs.video.toUpperCase()&&(sdp=CodecsHandler.preferCodec(sdp,"h264")),"G722"===connection.codecs.audio&&(sdp=CodecsHandler.removeNonG722(sdp)),"Firefox"===DetectRTC.browser.name)?sdp:((connection.bandwidth.video||connection.bandwidth.screen)&&(sdp=CodecsHandler.setApplicationSpecificBandwidth(sdp,connection.bandwidth,!!connection.session.screen)),connection.bandwidth.video&&(sdp=CodecsHandler.setVideoBitrates(sdp,{min:1024*(8*connection.bandwidth.video),max:1024*(8*connection.bandwidth.video)})),connection.bandwidth.audio&&(sdp=CodecsHandler.setOpusAttributes(sdp,{maxaveragebitrate:1024*(8*connection.bandwidth.audio),maxplaybackrate:1024*(8*connection.bandwidth.audio),stereo:1,maxptime:3})),sdp)},"undefined"!=typeof CodecsHandler&&(connection.BandwidthHandler=connection.CodecsHandler=CodecsHandler),connection.mediaConstraints={audio:{mandatory:{},optional:connection.bandwidth.audio?[{bandwidth:1024*(8*connection.bandwidth.audio)||1048576}]:[]},video:{mandatory:{},optional:connection.bandwidth.video?[{bandwidth:1024*(8*connection.bandwidth.video)||1048576},{facingMode:"user"}]:[{facingMode:"user"}]}},"Firefox"===DetectRTC.browser.name&&(connection.mediaConstraints={audio:!0,video:!0}),forceOptions.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load(function(){var lastAudioDevice,lastVideoDevice;if(DetectRTC.MediaDevices.forEach(function(device){"audioinput"===device.kind&&!1!==connection.mediaConstraints.audio&&(lastAudioDevice=device),"videoinput"===device.kind&&!1!==connection.mediaConstraints.video&&(lastVideoDevice=device)}),lastAudioDevice){if("Firefox"===DetectRTC.browser.name)return void(!0===connection.mediaConstraints.audio?connection.mediaConstraints.audio={deviceId:lastAudioDevice.id}:connection.mediaConstraints.audio.deviceId=lastAudioDevice.id);!0==connection.mediaConstraints.audio&&(connection.mediaConstraints.audio={mandatory:{},optional:[]}),connection.mediaConstraints.audio.optional||(connection.mediaConstraints.audio.optional=[]);var optional=[{sourceId:lastAudioDevice.id}];connection.mediaConstraints.audio.optional=optional.concat(connection.mediaConstraints.audio.optional)}if(lastVideoDevice){if("Firefox"===DetectRTC.browser.name)return void(!0===connection.mediaConstraints.video?connection.mediaConstraints.video={deviceId:lastVideoDevice.id}:connection.mediaConstraints.video.deviceId=lastVideoDevice.id);!0==connection.mediaConstraints.video&&(connection.mediaConstraints.video={mandatory:{},optional:[]}),connection.mediaConstraints.video.optional||(connection.mediaConstraints.video.optional=[]);var optional=[{sourceId:lastVideoDevice.id}];connection.mediaConstraints.video.optional=optional.concat(connection.mediaConstraints.video.optional)}}),connection.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},connection.sdpSemantics=null,connection.iceCandidatePoolSize=null,connection.bundlePolicy=null,connection.rtcpMuxPolicy=null,connection.iceTransportPolicy=null,connection.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},connection.iceServers=IceServersHandler.getIceServers(connection),connection.candidates={host:!0,stun:!0,turn:!0},connection.iceProtocols={tcp:!0,udp:!0},connection.onopen=function(event){!connection.enableLogs||console.info("Data connection has been opened between you & ",event.userid)},connection.onclose=function(event){!connection.enableLogs||console.warn("Data connection has been closed between you & ",event.userid)},connection.onerror=function(error){!connection.enableLogs||console.error(error.userid,"data-error",error)},connection.onmessage=function(event){!connection.enableLogs||console.debug("data-message",event.userid,event.data)},connection.send=function(data,remoteUserId){connection.peers.send(data,remoteUserId)},connection.close=connection.disconnect=connection.leave=function(){connection.onbeforeunload(!1,!0)},connection.closeEntireSession=function(callback){callback=callback||function(){},connection.socket.emit("close-entire-session",function looper(){return connection.getAllParticipants().length?void setTimeout(looper,100):void(connection.onEntireSessionClosed({sessionid:connection.sessionid,userid:connection.userid,extra:connection.extra}),connection.changeUserId(null,function(){connection.close(),callback()}))})},connection.onEntireSessionClosed=function(event){connection.enableLogs&&console.info("Entire session is closed: ",event.sessionid,event.extra)},connection.onstream=function(e){var parentNode=connection.videosContainer;parentNode.insertBefore(e.mediaElement,parentNode.firstChild);var played=e.mediaElement.play();return"undefined"==typeof played?void setTimeout(function(){e.mediaElement.play()},2e3):void played.catch(function(){}).then(function(){setTimeout(function(){e.mediaElement.play()},2e3)})},connection.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},connection.direction="many-to-many",connection.removeStream=function(streamid,remoteUserId){var stream;return connection.attachStreams.forEach(function(localStream){localStream.id===streamid&&(stream=localStream)}),stream?void(connection.peers.getAllParticipants().forEach(function(participant){if(!(remoteUserId&&participant!==remoteUserId)){var user=connection.peers[participant];try{user.peer.removeStream(stream)}catch(e){}}}),connection.renegotiate()):void console.warn("No such stream exist.",streamid)},connection.addStream=function(session,remoteUserId){function gumCallback(stream){session.streamCallback&&session.streamCallback(stream),connection.renegotiate(remoteUserId)}return session.getTracks?(-1===connection.attachStreams.indexOf(session)&&(!session.streamid&&(session.streamid=session.id),connection.attachStreams.push(session)),void connection.renegotiate(remoteUserId)):isData(session)?void connection.renegotiate(remoteUserId):void((session.audio||session.video||session.screen)&&(session.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:isAudioPlusTab(connection)}).then(function(screen){screen.isScreen=!0,mPeer.onGettingLocalMedia(screen),(session.audio||session.video)&&!isAudioPlusTab(connection)?connection.invokeGetUserMedia(null,function(stream){gumCallback(stream)}):gumCallback(screen)},function(){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):connection.invokeGetUserMedia({audio:isAudioPlusTab(connection),video:!0,isScreen:!0},function(stream){(session.audio||session.video)&&!isAudioPlusTab(connection)?connection.invokeGetUserMedia(null,function(stream){gumCallback(stream)}):gumCallback(stream)}):(session.audio||session.video)&&connection.invokeGetUserMedia(null,gumCallback)))},connection.invokeGetUserMedia=function(localMediaConstraints,callback,session){session||(session=connection.session),localMediaConstraints||(localMediaConstraints=connection.mediaConstraints),getUserMediaHandler({onGettingLocalMedia:function(stream){var videoConstraints=localMediaConstraints.video;videoConstraints&&(videoConstraints.mediaSource||videoConstraints.mozMediaSource?stream.isScreen=!0:videoConstraints.mandatory&&videoConstraints.mandatory.chromeMediaSource&&(stream.isScreen=!0)),stream.isScreen||(stream.isVideo=!!getTracks(stream,"video").length,stream.isAudio=!stream.isVideo&&getTracks(stream,"audio").length),mPeer.onGettingLocalMedia(stream,function(){"function"==typeof callback&&callback(stream)})},onLocalMediaError:function(error,constraints){mPeer.onLocalMediaError(error,constraints)},localMediaConstraints:localMediaConstraints||{audio:!!session.audio&&localMediaConstraints.audio,video:!!session.video&&localMediaConstraints.video}})},connection.applyConstraints=function(mediaConstraints,streamid){if(!MediaStreamTrack||!MediaStreamTrack.prototype.applyConstraints)return void alert("track.applyConstraints is NOT supported in your browser.");if(streamid){var stream;return connection.streamEvents[streamid]&&(stream=connection.streamEvents[streamid].stream),void applyConstraints(stream,mediaConstraints)}connection.attachStreams.forEach(function(stream){applyConstraints(stream,mediaConstraints)})},connection.replaceTrack=function(session,remoteUserId,isVideoTrack){function gumCallback(stream){connection.replaceTrack(stream,remoteUserId,isVideoTrack||session.video||session.screen)}if(session=session||{},!RTCPeerConnection.prototype.getSenders)return void connection.addStream(session);if(session instanceof MediaStreamTrack)return void replaceTrack(session,remoteUserId,isVideoTrack);if(session instanceof MediaStream)return getTracks(session,"video").length&&replaceTrack(getTracks(session,"video")[0],remoteUserId,!0),void(getTracks(session,"audio").length&&replaceTrack(getTracks(session,"audio")[0],remoteUserId,!1));if(isData(session)){throw"connection.replaceTrack requires audio and/or video and/or screen."}(session.audio||session.video||session.screen)&&(session.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:isAudioPlusTab(connection)}).then(function(screen){screen.isScreen=!0,mPeer.onGettingLocalMedia(screen),(session.audio||session.video)&&!isAudioPlusTab(connection)?connection.invokeGetUserMedia(null,gumCallback):gumCallback(screen)},function(){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):connection.invokeGetUserMedia({audio:isAudioPlusTab(connection),video:!0,isScreen:!0},(session.audio||session.video)&&!isAudioPlusTab(connection)?connection.invokeGetUserMedia(null,gumCallback):gumCallback):(session.audio||session.video)&&connection.invokeGetUserMedia(null,gumCallback))},connection.resetTrack=function(remoteUsersIds,isVideoTrack){remoteUsersIds||(remoteUsersIds=connection.getAllParticipants()),"string"==typeof remoteUsersIds&&(remoteUsersIds=[remoteUsersIds]),remoteUsersIds.forEach(function(participant){var peer=connection.peers[participant].peer;("undefined"==typeof isVideoTrack||!0===isVideoTrack)&&peer.lastVideoTrack&&connection.replaceTrack(peer.lastVideoTrack,participant,!0),("undefined"==typeof isVideoTrack||!1===isVideoTrack)&&peer.lastAudioTrack&&connection.replaceTrack(peer.lastAudioTrack,participant,!1)})},connection.renegotiate=function(remoteUserId){return remoteUserId?void mPeer.renegotiatePeer(remoteUserId):void connection.peers.getAllParticipants().forEach(function(participant){mPeer.renegotiatePeer(participant)})},connection.setStreamEndHandler=function(stream,isRemote){if(stream&&stream.addEventListener&&(isRemote=!!isRemote,!stream.alreadySetEndHandler)){stream.alreadySetEndHandler=!0;var streamEndedEvent="ended";"oninactive"in stream&&(streamEndedEvent="inactive"),stream.addEventListener(streamEndedEvent,function(){if(stream.idInstance&&currentUserMediaRequest.remove(stream.idInstance),!isRemote){var streams=[];connection.attachStreams.forEach(function(s){s.id!=stream.id&&streams.push(s)}),connection.attachStreams=streams}var streamEvent=connection.streamEvents[stream.streamid];if(streamEvent||(streamEvent={stream:stream,streamid:stream.streamid,type:isRemote?"remote":"local",userid:connection.userid,extra:connection.extra,mediaElement:connection.streamEvents[stream.streamid]?connection.streamEvents[stream.streamid].mediaElement:null}),isRemote&&connection.peers[streamEvent.userid]){var peer=connection.peers[streamEvent.userid].peer,streams=[];peer.getRemoteStreams().forEach(function(s){s.id!=stream.id&&streams.push(s)}),connection.peers[streamEvent.userid].streams=streams}streamEvent.userid===connection.userid&&"remote"===streamEvent.type||(connection.peersBackup[streamEvent.userid]&&(streamEvent.extra=connection.peersBackup[streamEvent.userid].extra),connection.onstreamended(streamEvent),delete connection.streamEvents[stream.streamid])},!1)}},connection.onMediaError=function(error,constraints){!connection.enableLogs||console.error(error,constraints)},connection.autoCloseEntireSession=!1,connection.filesContainer=connection.videosContainer=document.body||document.documentElement,connection.isInitiator=!1,connection.shareFile=mPeer.shareFile,"undefined"!=typeof FileProgressBarHandler&&FileProgressBarHandler.handle(connection),"undefined"!=typeof TranslationHandler&&TranslationHandler.handle(connection),connection.token=getRandomString,connection.onNewParticipant=function(participantId,userPreferences){connection.acceptParticipationRequest(participantId,userPreferences)},connection.acceptParticipationRequest=function(participantId,userPreferences){userPreferences.successCallback&&(userPreferences.successCallback(),delete userPreferences.successCallback),mPeer.createNewPeer(participantId,userPreferences)},"undefined"!=typeof StreamsHandler&&(connection.StreamsHandler=StreamsHandler),connection.onleave=function(){},connection.invokeSelectFileDialog=function(callback){var selector=new FileSelector;selector.accept="*.*",selector.selectSingleFile(callback)},connection.onmute=function(e){if(e&&e.mediaElement)if("both"===e.muteType||"video"===e.muteType){e.mediaElement.src=null;var paused=e.mediaElement.pause();"undefined"==typeof paused?e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png":paused.then(function(){e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"})}else"audio"===e.muteType&&(e.mediaElement.muted=!0)},connection.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.srcObject=e.stream,e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},connection.onExtraDataUpdated=function(event){event.status="online",connection.onUserStatusChanged(event,!0)},connection.getAllParticipants=function(sender){return connection.peers.getAllParticipants(sender)},"undefined"!=typeof StreamsHandler&&(StreamsHandler.onSyncNeeded=function(streamid,action,type){connection.peers.getAllParticipants().forEach(function(participant){mPeer.onNegotiationNeeded({streamid:streamid,action:action,streamSyncNeeded:!0,type:type||"both"},participant)})}),connection.connectSocket=function(callback){connectSocket(callback)},connection.closeSocket=function(){try{io.sockets={}}catch(e){}connection.socket&&("function"==typeof connection.socket.disconnect&&connection.socket.disconnect(),"function"==typeof connection.socket.resetProps&&connection.socket.resetProps(),connection.socket=null)},connection.getSocket=function(callback){return!callback&&connection.enableLogs&&console.warn("getSocket.callback paramter is required."),callback=callback||function(){},connection.socket?callback(connection.socket):connectSocket(function(){callback(connection.socket)}),connection.socket},connection.getRemoteStreams=mPeer.getRemoteStreams;var skipStreams=["selectFirst","selectAll","forEach"];if(connection.streamEvents={selectFirst:function(options){return connection.streamEvents.selectAll(options)[0]},selectAll:function(options){options||(options={local:!0,remote:!0,isScreen:!0,isAudio:!0,isVideo:!0}),"local"==options&&(options={local:!0}),"remote"==options&&(options={remote:!0}),"screen"==options&&(options={isScreen:!0}),"audio"==options&&(options={isAudio:!0}),"video"==options&&(options={isVideo:!0});var streams=[];return Object.keys(connection.streamEvents).forEach(function(key){var event=connection.streamEvents[key];if(-1===skipStreams.indexOf(key)){var ignore=!0;options.local&&"local"===event.type&&(ignore=!1),options.remote&&"remote"===event.type&&(ignore=!1),options.isScreen&&event.stream.isScreen&&(ignore=!1),options.isVideo&&event.stream.isVideo&&(ignore=!1),options.isAudio&&event.stream.isAudio&&(ignore=!1),options.userid&&event.userid===options.userid&&(ignore=!1),!1==ignore&&streams.push(event)}}),streams}},connection.socketURL="/",connection.socketMessageEvent="RTCMultiConnection-Message",connection.socketCustomEvent="RTCMultiConnection-Custom-Message",connection.DetectRTC=DetectRTC,connection.setCustomSocketEvent=function(customEvent){customEvent&&(connection.socketCustomEvent=customEvent),connection.socket&&connection.socket.emit("set-custom-socket-event-listener",connection.socketCustomEvent)},connection.getNumberOfBroadcastViewers=function(broadcastId,callback){connection.socket&&broadcastId&&callback&&connection.socket.emit("get-number-of-users-in-specific-broadcast",broadcastId,callback)},connection.onNumberOfBroadcastViewersUpdated=function(event){connection.enableLogs&&connection.isInitiator&&console.info("Number of broadcast (",event.broadcastId,") viewers",event.numberOfBroadcastViewers)},connection.onUserStatusChanged=function(event,dontWriteLogs){!connection.enableLogs||dontWriteLogs||console.info(event.userid,event.status)},connection.getUserMediaHandler=getUserMediaHandler,connection.multiPeersHandler=mPeer,connection.enableLogs=!0,connection.setCustomSocketHandler=function(customSocketHandler){"undefined"!=typeof SocketConnection&&(SocketConnection=customSocketHandler)},connection.chunkSize=40000,connection.maxParticipantsAllowed=1e3,connection.disconnectWith=mPeer.disconnectWith,connection.checkPresence=function(roomid,callback){return roomid=roomid||connection.sessionid,"SSEConnection"===SocketConnection.name?void SSEConnection.checkPresence(roomid,function(isRoomExist,_roomid,extra){return connection.socket?void callback(isRoomExist,_roomid):(isRoomExist||(connection.userid=_roomid),void connection.connectSocket(function(){callback(isRoomExist,_roomid,extra)}))}):connection.socket?void connection.socket.emit("check-presence",roomid+"",function(isRoomExist,_roomid,extra){connection.enableLogs&&console.log("checkPresence.isRoomExist: ",isRoomExist," roomid: ",_roomid),callback(isRoomExist,_roomid,extra)}):void connection.connectSocket(function(){connection.checkPresence(roomid,callback)})},connection.onReadyForOffer=function(remoteUserId,userPreferences){connection.multiPeersHandler.createNewPeer(remoteUserId,userPreferences)},connection.setUserPreferences=function(userPreferences){return connection.dontAttachStream&&(userPreferences.dontAttachLocalStream=!0),connection.dontGetRemoteStream&&(userPreferences.dontGetRemoteStream=!0),userPreferences},connection.updateExtraData=function(){connection.socket.emit("extra-data-updated",connection.extra)},connection.enableScalableBroadcast=!1,connection.maxRelayLimitPerUser=3,connection.dontCaptureUserMedia=!1,connection.dontAttachStream=!1,connection.dontGetRemoteStream=!1,connection.onReConnecting=function(event){connection.enableLogs&&console.info("ReConnecting with",event.userid,"...")},connection.beforeAddingStream=function(stream){return stream},connection.beforeRemovingStream=function(stream){return stream},"undefined"!=typeof isChromeExtensionAvailable&&(connection.checkIfChromeExtensionAvailable=isChromeExtensionAvailable),"undefined"!=typeof isFirefoxExtensionAvailable&&(connection.checkIfChromeExtensionAvailable=isFirefoxExtensionAvailable),"undefined"!=typeof getChromeExtensionStatus&&(connection.getChromeExtensionStatus=getChromeExtensionStatus),connection.modifyScreenConstraints=function(screen_constraints){return screen_constraints},connection.onPeerStateChanged=function(state){connection.enableLogs&&-1!==state.iceConnectionState.search(/closed|failed/gi)&&console.error("Peer connection is closed between you & ",state.userid,state.extra,"state:",state.iceConnectionState)},connection.isOnline=!0,listenEventHandler("online",function(){connection.isOnline=!0}),listenEventHandler("offline",function(){connection.isOnline=!1}),connection.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(connection.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),connection.isLowBandwidth)){if(connection.bandwidth={audio:!1,video:!1,screen:!1},connection.mediaConstraints.audio&&connection.mediaConstraints.audio.optional&&connection.mediaConstraints.audio.optional.length){var newArray=[];connection.mediaConstraints.audio.optional.forEach(function(opt){"undefined"==typeof opt.bandwidth&&newArray.push(opt)}),connection.mediaConstraints.audio.optional=newArray}if(connection.mediaConstraints.video&&connection.mediaConstraints.video.optional&&connection.mediaConstraints.video.optional.length){var newArray=[];connection.mediaConstraints.video.optional.forEach(function(opt){"undefined"==typeof opt.bandwidth&&newArray.push(opt)}),connection.mediaConstraints.video.optional=newArray}}connection.getExtraData=function(remoteUserId,callback){if(!remoteUserId)throw"remoteUserId is required.";return"function"==typeof callback?void connection.socket.emit("get-remote-user-extra-data",remoteUserId,function(extra,remoteUserId,error){callback(extra,remoteUserId,error)}):connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:connection.peersBackup[remoteUserId]?connection.peersBackup[remoteUserId].extra:{}},!forceOptions.autoOpenOrJoin||connection.openOrJoin(connection.sessionid),connection.onUserIdAlreadyTaken=function(useridAlreadyTaken){connection.close(),connection.closeSocket(),connection.isInitiator=!1,connection.userid=connection.token(),connection.join(connection.sessionid),connection.enableLogs&&console.warn("Userid already taken.",useridAlreadyTaken,"Your new userid:",connection.userid)},connection.trickleIce=!0,connection.version="3.6.9",connection.onSettingLocalDescription=function(event){connection.enableLogs&&console.info("Set local description for remote user",event.userid)},connection.resetScreen=function(){sourceId=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},connection.autoCreateMediaElement=!0,connection.password=null,connection.setPassword=function(password,callback){callback=callback||function(){},connection.socket?connection.socket.emit("set-password",password,callback):(connection.password=password,callback(!0,connection.sessionid,null))},connection.onSocketDisconnect=function(){connection.enableLogs&&console.warn("socket.io connection is closed")},connection.onSocketError=function(){connection.enableLogs&&console.warn("socket.io connection is failed")},connection.errors={ROOM_NOT_AVAILABLE:"Room not available",INVALID_PASSWORD:"Invalid password",USERID_NOT_AVAILABLE:"User ID does not exist",ROOM_PERMISSION_DENIED:"Room permission denied",ROOM_FULL:"Room full",DID_NOT_JOIN_ANY_ROOM:"Did not join any room yet",INVALID_SOCKET:"Invalid socket",PUBLIC_IDENTIFIER_MISSING:"publicRoomIdentifier is required",INVALID_ADMIN_CREDENTIAL:"Invalid username or password attempted"}})(this)},"undefined"!=typeof module&&(module.exports=exports=RTCMultiConnection),"function"==typeof define&&define.amd&&define("RTCMultiConnection",[],function(){return RTCMultiConnection})}(this),_retrieveGlobal()}),function(){var define=$__System.amdDefine;(function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("1f",[],factory):"object"==typeof exports?exports.io=factory():root.io=factory()})(this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function lookup(uri,opts){"object"===("undefined"==typeof uri?"undefined":_typeof(uri))&&(opts=uri,uri=void 0),opts=opts||{};var parsed=url(uri),source=parsed.source,id=parsed.id,path=parsed.path,sameNamespace=cache[id]&&path in cache[id].nsps,newConnection=opts.forceNew||opts["force new connection"]||!1===opts.multiplex||sameNamespace,io;return newConnection?(debug("ignoring socket cache for %s",source),io=Manager(source,opts)):(!cache[id]&&(debug("new io instance for %s",source),cache[id]=Manager(source,opts)),io=cache[id]),parsed.query&&!opts.query?opts.query=parsed.query:opts&&"object"===_typeof(opts.query)&&(opts.query=encodeQueryString(opts.query)),io.socket(parsed.path,opts)}function encodeQueryString(obj){var str=[];for(var p in obj)obj.hasOwnProperty(p)&&str.push(encodeURIComponent(p)+"="+encodeURIComponent(obj[p]));return str.join("&")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},url=__webpack_require__(1),parser=__webpack_require__(7),Manager=__webpack_require__(17),debug=__webpack_require__(3)("socket.io-client");module.exports=exports=lookup;var cache=exports.managers={};exports.protocol=parser.protocol,exports.connect=lookup,exports.Manager=__webpack_require__(17),exports.Socket=__webpack_require__(44)},function(module,exports,__webpack_require__){(function(global){"use strict";var parseuri=__webpack_require__(2),debug=__webpack_require__(3)("socket.io-client:url");module.exports=function(uri,loc){var obj=uri;loc=loc||global.location,null==uri&&(uri=loc.protocol+"//"+loc.host),"string"==typeof uri&&("/"===uri.charAt(0)&&("/"===uri.charAt(1)?uri=loc.protocol+uri:uri=loc.host+uri),!/^(https?|wss?):\/\//.test(uri)&&(debug("protocol-less url %s",uri),uri="undefined"==typeof loc?"https://"+uri:loc.protocol+"//"+uri),debug("parse %s",uri),obj=parseuri(uri)),obj.port||(/^(http|ws)$/.test(obj.protocol)?obj.port="80":/^(http|ws)s$/.test(obj.protocol)&&(obj.port="443")),obj.path=obj.path||"/";var ipv6=-1!==obj.host.indexOf(":"),host=ipv6?"["+obj.host+"]":obj.host;return obj.id=obj.protocol+"://"+host+":"+obj.port,obj.href=obj.protocol+"://"+host+(loc&&loc.port===obj.port?"":":"+obj.port),obj}}).call(exports,function(){return this}())},function(module){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function(str){var src=str,b=str.indexOf("["),e=str.indexOf("]");-1!=b&&-1!=e&&(str=str.substring(0,b)+str.substring(b,e).replace(/:/g,";")+str.substring(e,str.length));for(var m=re.exec(str||""),uri={},i=14;i--;)uri[parts[i]]=m[i]||"";return-1!=b&&-1!=e&&(uri.source=src,uri.host=uri.host.substring(1,uri.host.length-1).replace(/;/g,":"),uri.authority=uri.authority.replace("[","").replace("]","").replace(/;/g,":"),uri.ipv6uri=!0),uri}},function(module,exports,__webpack_require__){(function(process){function useColors(){return"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)}function formatArgs(){var args=arguments,useColors=this.useColors;if(args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff),!useColors)return args;var c="color: "+this.color;args=[args[0],c,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0,lastC=0;return args[0].replace(/%[a-z%]/g,function(match){"%%"===match||(index++,"%c"===match&&(lastC=index))}),args.splice(lastC,0,c),args}function save(namespaces){try{null==namespaces?exports.storage.removeItem("debug"):exports.storage.debug=namespaces}catch(e){}}function load(){try{return exports.storage.debug}catch(e){}if("undefined"!=typeof process&&"env"in process)return process.env.DEBUG}exports=module.exports=__webpack_require__(5),exports.log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(v){try{return JSON.stringify(v)}catch(err){return"[UnexpectedJSONParseError]: "+err.message}},exports.enable(load())}).call(exports,__webpack_require__(4))},function(module){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;(function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}})();var queue=[],draining=!1,queueIndex=-1,currentQueue;process.nextTick=function(fun){var args=Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},function(module,exports,__webpack_require__){function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(namespace){function disabled(){}function enabled(){var self=enabled,curr=+new Date,ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,null==self.useColors&&(self.useColors=exports.useColors()),null==self.color&&self.useColors&&(self.color=selectColor());for(var args=Array(arguments.length),i=0;i<args.length;i++)args[i]=arguments[i];args[0]=exports.coerce(args[0]),"string"!=typeof args[0]&&(args=["%o"].concat(args));var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if("%%"===match)return match;index++;var formatter=exports.formatters[format];if("function"==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),args=exports.formatArgs.apply(self,args);var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}disabled.enabled=!1,enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;return fn.namespace=namespace,fn}function enable(namespaces){exports.save(namespaces);for(var split=(namespaces||"").split(/[\s,]+/),len=split.length,i=0;i<len;i++)split[i]&&(namespaces=split[i].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),"-"===namespaces[0]?exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):exports.names.push(new RegExp("^"+namespaces+"$")))}function disable(){exports.enable("")}function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++)if(exports.skips[i].test(name))return!1;for(i=0,len=exports.names.length;i<len;i++)if(exports.names[i].test(name))return!0;return!1}exports=module.exports=debug.debug=debug,exports.coerce=function(val){return val instanceof Error?val.stack||val.message:val},exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=__webpack_require__(6),exports.names=[],exports.skips=[],exports.formatters={};var prevColor=0,prevTime},function(module){function parse(str){if(str+="",!(1e4<str.length)){var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(match){var n=parseFloat(match[1]),type=(match[2]||"ms").toLowerCase();return"years"===type||"year"===type||"yrs"===type||"yr"===type||"y"===type?n*y:"days"===type||"day"===type||"d"===type?n*d:"hours"===type||"hour"===type||"hrs"===type||"hr"===type||"h"===type?n*h:"minutes"===type||"minute"===type||"mins"===type||"min"===type||"m"===type?n*m:"seconds"===type||"second"===type||"secs"===type||"sec"===type||"s"===type?n*s:"milliseconds"===type||"millisecond"===type||"msecs"===type||"msec"===type||"ms"===type?n:void 0}}}function fmtShort(ms){return ms>=d?_Mathround(ms/d)+"d":ms>=h?_Mathround(ms/h)+"h":ms>=m?_Mathround(ms/m)+"m":ms>=s?_Mathround(ms/s)+"s":ms+"ms"}function fmtLong(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){return ms<n?void 0:ms<1.5*n?_Mathfloor(ms/n)+" "+name:_Mathceil(ms/n)+" "+name+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(val,options){options=options||{};var type=typeof val;if("string"==type&&0<val.length)return parse(val);if("number"==type&&!1===isNaN(val))return options.long?fmtLong(val):fmtShort(val);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))}},function(module,exports,__webpack_require__){function Encoder(){}function encodeAsString(obj){var str="",nsp=!1;return str+=obj.type,(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type)&&(str+=obj.attachments,str+="-"),obj.nsp&&"/"!=obj.nsp&&(nsp=!0,str+=obj.nsp),null!=obj.id&&(nsp&&(str+=",",nsp=!1),str+=obj.id),null!=obj.data&&(nsp&&(str+=","),str+=json.stringify(obj.data)),debug("encoded %j as %s",obj,str),str}function encodeAsBinary(obj,callback){binary.removeBlobs(obj,function(bloblessData){var deconstruction=binary.deconstructPacket(bloblessData),pack=encodeAsString(deconstruction.packet),buffers=deconstruction.buffers;buffers.unshift(pack),callback(buffers)})}function Decoder(){this.reconstructor=null}function decodeString(str){var p={},i=0;if(p.type=+str.charAt(0),null==exports.types[p.type])return error();if(exports.BINARY_EVENT==p.type||exports.BINARY_ACK==p.type){for(var buf="";"-"!=str.charAt(++i)&&(buf+=str.charAt(i),i!=str.length););if(buf!=+buf||"-"!=str.charAt(i))throw new Error("Illegal attachments");p.attachments=+buf}if("/"==str.charAt(i+1))for(p.nsp="";++i;){var c=str.charAt(i);if(","==c)break;if(p.nsp+=c,i==str.length)break}else p.nsp="/";var next=str.charAt(i+1);if(""!==next&&+next==next){for(p.id="";++i;){var c=str.charAt(i);if(null==c||+c!=c){--i;break}if(p.id+=str.charAt(i),i==str.length)break}p.id=+p.id}return str.charAt(++i)&&(p=tryParse(p,str.substr(i))),debug("decoded %s as %j",str,p),p}function tryParse(p,str){try{p.data=json.parse(str)}catch(e){return error()}return p}function BinaryReconstructor(packet){this.reconPack=packet,this.buffers=[]}function error(){return{type:exports.ERROR,data:"parser error"}}var debug=__webpack_require__(8)("socket.io-parser"),json=__webpack_require__(11),Emitter=__webpack_require__(13),binary=__webpack_require__(14),isBuf=__webpack_require__(16);exports.protocol=4,exports.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],exports.CONNECT=0,exports.DISCONNECT=1,exports.EVENT=2,exports.ACK=3,exports.ERROR=4,exports.BINARY_EVENT=5,exports.BINARY_ACK=6,exports.Encoder=Encoder,exports.Decoder=Decoder,Encoder.prototype.encode=function(obj,callback){if(debug("encoding packet %j",obj),exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type)encodeAsBinary(obj,callback);else{var encoding=encodeAsString(obj);callback([encoding])}},Emitter(Decoder.prototype),Decoder.prototype.add=function(obj){var packet;if("string"==typeof obj)packet=decodeString(obj),exports.BINARY_EVENT==packet.type||exports.BINARY_ACK==packet.type?(this.reconstructor=new BinaryReconstructor(packet),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",packet)):this.emit("decoded",packet);else if(!(isBuf(obj)||obj.base64))throw new Error("Unknown type: "+obj);else if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");else packet=this.reconstructor.takeBinaryData(obj),packet&&(this.reconstructor=null,this.emit("decoded",packet))};Decoder.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},BinaryReconstructor.prototype.takeBinaryData=function(binData){if(this.buffers.push(binData),this.buffers.length==this.reconPack.attachments){var packet=binary.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),packet}return null},BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(module,exports,__webpack_require__){function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)}function formatArgs(){var args=arguments,useColors=this.useColors;if(args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff),!useColors)return args;var c="color: "+this.color;args=[args[0],c,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0,lastC=0;return args[0].replace(/%[a-z%]/g,function(match){"%%"===match||(index++,"%c"===match&&(lastC=index))}),args.splice(lastC,0,c),args}function save(namespaces){try{null==namespaces?exports.storage.removeItem("debug"):exports.storage.debug=namespaces}catch(e){}}function load(){var r;try{r=exports.storage.debug}catch(e){}return r}exports=module.exports=__webpack_require__(9),exports.log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(v){return JSON.stringify(v)},exports.enable(load())},function(module,exports,__webpack_require__){function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(namespace){function disabled(){}function enabled(){var self=enabled,curr=+new Date,ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,null==self.useColors&&(self.useColors=exports.useColors()),null==self.color&&self.useColors&&(self.color=selectColor());var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]),"string"!=typeof args[0]&&(args=["%o"].concat(args));var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if("%%"===match)return match;index++;var formatter=exports.formatters[format];if("function"==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),"function"==typeof exports.formatArgs&&(args=exports.formatArgs.apply(self,args));var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}disabled.enabled=!1,enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;return fn.namespace=namespace,fn}function enable(namespaces){exports.save(namespaces);for(var split=(namespaces||"").split(/[\s,]+/),len=split.length,i=0;i<len;i++)split[i]&&(namespaces=split[i].replace(/\*/g,".*?"),"-"===namespaces[0]?exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):exports.names.push(new RegExp("^"+namespaces+"$")))}function disable(){exports.enable("")}function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++)if(exports.skips[i].test(name))return!1;for(i=0,len=exports.names.length;i<len;i++)if(exports.names[i].test(name))return!0;return!1}exports=module.exports=debug,exports.coerce=function(val){return val instanceof Error?val.stack||val.message:val},exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=__webpack_require__(10),exports.names=[],exports.skips=[],exports.formatters={};var prevColor=0,prevTime},function(module){function parse(str){if(str=""+str,!(1e4<str.length)){var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(match){var n=parseFloat(match[1]),type=(match[2]||"ms").toLowerCase();return"years"===type||"year"===type||"yrs"===type||"yr"===type||"y"===type?n*y:"days"===type||"day"===type||"d"===type?n*d:"hours"===type||"hour"===type||"hrs"===type||"hr"===type||"h"===type?n*h:"minutes"===type||"minute"===type||"mins"===type||"min"===type||"m"===type?n*m:"seconds"===type||"second"===type||"secs"===type||"sec"===type||"s"===type?n*s:"milliseconds"===type||"millisecond"===type||"msecs"===type||"msec"===type||"ms"===type?n:void 0}}}function short(ms){return ms>=d?_Mathround(ms/d)+"d":ms>=h?_Mathround(ms/h)+"h":ms>=m?_Mathround(ms/m)+"m":ms>=s?_Mathround(ms/s)+"s":ms+"ms"}function long(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){return ms<n?void 0:ms<1.5*n?_Mathfloor(ms/n)+" "+name:_Mathceil(ms/n)+" "+name+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(val,options){return options=options||{},"string"==typeof val?parse(val):options.long?long(val):short(val)}},function(module,exports,__webpack_require__){(function(module,global){(function(){function runInContext(context,exports){function has(name){if(has[name]!==undef)return has[name];var isSupported;if("bug-string-char-index"==name)isSupported=!1;else if("json"==name)isSupported=has("json-stringify")&&has("json-parse");else{var serialized="{\"a\":[1,true,false,null,\"\\u0000\\b\\n\\f\\r\\t\"]}",value;if("json-stringify"==name){var stringify=exports.stringify,stringifySupported="function"==typeof stringify&&isExtended;if(stringifySupported){(value=function(){return 1}).toJSON=value;try{stringifySupported="0"===stringify(0)&&"0"===stringify(new Number)&&"\"\""==stringify(new String)&&stringify(getClass)===undef&&stringify(undef)===undef&&stringify()===undef&&"1"===stringify(value)&&"[1]"==stringify([value])&&"[null]"==stringify([undef])&&"null"==stringify(null)&&"[null,null,null]"==stringify([undef,getClass,null])&&stringify({a:[value,!0,!1,null,"\0\b\n\f\r\t"]})==serialized&&"1"===stringify(null,value)&&"[\n 1,\n 2\n]"==stringify([1,2],null,1)&&"\"-271821-04-20T00:00:00.000Z\""==stringify(new Date(-864e13))&&"\"+275760-09-13T00:00:00.000Z\""==stringify(new Date(864e13))&&"\"-000001-01-01T00:00:00.000Z\""==stringify(new Date(-621987552e5))&&"\"1969-12-31T23:59:59.999Z\""==stringify(new Date(-1))}catch(exception){stringifySupported=!1}}isSupported=stringifySupported}if("json-parse"==name){var parse=exports.parse;if("function"==typeof parse)try{if(0===parse("0")&&!parse(!1)){value=parse(serialized);var parseSupported=5==value.a.length&&1===value.a[0];if(parseSupported){try{parseSupported=!parse("\"\t\"")}catch(exception){}if(parseSupported)try{parseSupported=1!==parse("01")}catch(exception){}if(parseSupported)try{parseSupported=1!==parse("1.")}catch(exception){}}}}catch(exception){parseSupported=!1}isSupported=parseSupported}}return has[name]=!!isSupported}context||(context=root.Object()),exports||(exports=root.Object());var Number=context.Number||root.Number,String=context.String||root.String,Object=context.Object||root.Object,Date=context.Date||root.Date,SyntaxError=context.SyntaxError||root.SyntaxError,TypeError=context.TypeError||root.TypeError,Math=context.Math||root.Math,nativeJSON=context.JSON||root.JSON;"object"==typeof nativeJSON&&nativeJSON&&(exports.stringify=nativeJSON.stringify,exports.parse=nativeJSON.parse);var objectProto=Object.prototype,getClass=objectProto.toString,isExtended=new Date(-3509827334573292),isProperty,forEach,undef;try{isExtended=-109252==isExtended.getUTCFullYear()&&0===isExtended.getUTCMonth()&&1===isExtended.getUTCDate()&&10==isExtended.getUTCHours()&&37==isExtended.getUTCMinutes()&&6==isExtended.getUTCSeconds()&&708==isExtended.getUTCMilliseconds()}catch(exception){}if(!has("json")){var functionClass="[object Function]",numberClass="[object Number]",stringClass="[object String]",arrayClass="[object Array]",charIndexBuggy=has("bug-string-char-index");if(!isExtended)var floor=_Mathfloor,Months=[0,31,59,90,120,151,181,212,243,273,304,334],getDay=function(year,month){return Months[month]+365*(year-1970)+floor((year-1969+(month=+(1<month)))/4)-floor((year-1901+month)/100)+floor((year-1601+month)/400)};if((isProperty=objectProto.hasOwnProperty)||(isProperty=function(property){var members={},constructor;return(members.__proto__=null,members.__proto__={toString:1},members).toString==getClass?(constructor=members.constructor,isProperty=function(property){var parent=(this.constructor||constructor).prototype;return property in this&&!(property in parent&&this[property]===parent[property])}):isProperty=function(property){var original=this.__proto__,result=property in(this.__proto__=null,this);return this.__proto__=original,result},members=null,isProperty.call(this,property)}),forEach=function(object,callback){var size=0,Properties,members,property;for(property in(Properties=function(){this.valueOf=0}).prototype.valueOf=0,members=new Properties,members)isProperty.call(members,property)&&size++;return Properties=members=null,size?2==size?forEach=function(object,callback){var members={},isFunction=getClass.call(object)==functionClass,property;for(property in object)!(isFunction&&"prototype"==property)&&!isProperty.call(members,property)&&(members[property]=1)&&isProperty.call(object,property)&&callback(property)}:forEach=function(object,callback){var isFunction=getClass.call(object)==functionClass,property,isConstructor;for(property in object)isFunction&&"prototype"==property||!isProperty.call(object,property)||(isConstructor="constructor"===property)||callback(property);(isConstructor||isProperty.call(object,property="constructor"))&&callback(property)}:(members=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],forEach=function(object,callback){var isFunction=getClass.call(object)==functionClass,hasProperty=!isFunction&&"function"!=typeof object.constructor&&objectTypes[typeof object.hasOwnProperty]&&object.hasOwnProperty||isProperty,property,length;for(property in object)!(isFunction&&"prototype"==property)&&hasProperty.call(object,property)&&callback(property);for(length=members.length;property=members[--length];hasProperty.call(object,property)&&callback(property));}),forEach(object,callback)},!has("json-stringify")){var Escapes={92:"\\\\",34:"\\\"",8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},toPaddedString=function(width,value){return("000000"+(value||0)).slice(-width)},quote=function(value){for(var result="\"",index=0,length=value.length,useCharIndex=!charIndexBuggy||10<length,symbols=useCharIndex&&(charIndexBuggy?value.split(""):value),charCode;index<length;index++)switch(charCode=value.charCodeAt(index),charCode){case 8:case 9:case 10:case 12:case 13:case 34:case 92:result+=Escapes[charCode];break;default:if(32>charCode){result+="\\u00"+toPaddedString(2,charCode.toString(16));break}result+=useCharIndex?symbols[index]:value.charAt(index);}return result+"\""},serialize=function(property,object,callback,properties,whitespace,indentation,stack){var value,className,year,month,date,time,hours,minutes,seconds,milliseconds,results,element,index,length,prefix,result;try{value=object[property]}catch(exception){}if("object"==typeof value&&value)if(className=getClass.call(value),className!="[object Date]"||isProperty.call(value,"toJSON"))"function"==typeof value.toJSON&&(className!=numberClass&&className!=stringClass&&className!=arrayClass||isProperty.call(value,"toJSON"))&&(value=value.toJSON(property));else if(value>-1/0&&value<1/0){if(getDay){for(date=floor(value/864e5),year=floor(date/365.2425)+1970-1;getDay(year+1,0)<=date;year++);for(month=floor((date-getDay(year,0))/30.42);getDay(year,month+1)<=date;month++);date=1+date-getDay(year,month),time=(value%864e5+864e5)%864e5,hours=floor(time/36e5)%24,minutes=floor(time/6e4)%60,seconds=floor(time/1e3)%60,milliseconds=time%1e3}else year=value.getUTCFullYear(),month=value.getUTCMonth(),date=value.getUTCDate(),hours=value.getUTCHours(),minutes=value.getUTCMinutes(),seconds=value.getUTCSeconds(),milliseconds=value.getUTCMilliseconds();value=(0>=year||1e4<=year?(0>year?"-":"+")+toPaddedString(6,0>year?-year:year):toPaddedString(4,year))+"-"+toPaddedString(2,month+1)+"-"+toPaddedString(2,date)+"T"+toPaddedString(2,hours)+":"+toPaddedString(2,minutes)+":"+toPaddedString(2,seconds)+"."+toPaddedString(3,milliseconds)+"Z"}else value=null;if(callback&&(value=callback.call(object,property,value)),null===value)return"null";if(className=getClass.call(value),className=="[object Boolean]")return""+value;if(className==numberClass)return value>-1/0&&value<1/0?""+value:"null";if(className==stringClass)return quote(""+value);if("object"==typeof value){for(length=stack.length;length--;)if(stack[length]===value)throw TypeError();if(stack.push(value),results=[],prefix=indentation,indentation+=whitespace,className==arrayClass){for(index=0,length=value.length;index<length;index++)element=serialize(index,value,callback,properties,whitespace,indentation,stack),results.push(element===undef?"null":element);result=results.length?whitespace?"[\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"]":"["+results.join(",")+"]":"[]"}else forEach(properties||value,function(property){var element=serialize(property,value,callback,properties,whitespace,indentation,stack);element!==undef&&results.push(quote(property)+":"+(whitespace?" ":"")+element)}),result=results.length?whitespace?"{\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"}":"{"+results.join(",")+"}":"{}";return stack.pop(),result}};exports.stringify=function(source,filter,width){var whitespace,callback,properties,className;if(objectTypes[typeof filter]&&filter)if((className=getClass.call(filter))==functionClass)callback=filter;else if(className==arrayClass){properties={};for(var index=0,length=filter.length,value;index<length;value=filter[index++],(className=getClass.call(value),className==stringClass||className==numberClass)&&(properties[value]=1));}if(width)if((className=getClass.call(width))!=numberClass)className==stringClass&&(whitespace=10>=width.length?width:width.slice(0,10));else if(0<(width-=width%1))for(whitespace="",10<width&&(width=10);whitespace.length<width;whitespace+=" ");return serialize("",(value={},value[""]=source,value),callback,properties,whitespace,"",[])}}if(!has("json-parse")){var Unescapes={92:"\\",34:"\"",47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},abort=function(){throw Index=Source=null,SyntaxError()},lex=function(){for(var source=Source,length=source.length,value,begin,position,isSigned,charCode;Index<length;)switch(charCode=source.charCodeAt(Index),charCode){case 9:case 10:case 13:case 32:Index++;break;case 123:case 125:case 91:case 93:case 58:case 44:return value=charIndexBuggy?source.charAt(Index):source[Index],Index++,value;case 34:for(value="@",Index++;Index<length;)if(charCode=source.charCodeAt(Index),32>charCode)abort();else if(92==charCode)switch(charCode=source.charCodeAt(++Index),charCode){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:value+=Unescapes[charCode],Index++;break;case 117:for(begin=++Index,position=Index+4;Index<position;Index++)charCode=source.charCodeAt(Index),48<=charCode&&57>=charCode||97<=charCode&&102>=charCode||65<=charCode&&70>=charCode||abort();value+=_StringfromCharCode("0x"+source.slice(begin,Index));break;default:abort();}else{if(34==charCode)break;for(charCode=source.charCodeAt(Index),begin=Index;32<=charCode&&92!=charCode&&34!=charCode;)charCode=source.charCodeAt(++Index);value+=source.slice(begin,Index)}if(34==source.charCodeAt(Index))return Index++,value;abort();default:if(begin=Index,45==charCode&&(isSigned=!0,charCode=source.charCodeAt(++Index)),48<=charCode&&57>=charCode){for(48==charCode&&(charCode=source.charCodeAt(Index+1),48<=charCode&&57>=charCode)&&abort(),isSigned=!1;Index<length&&(charCode=source.charCodeAt(Index),48<=charCode&&57>=charCode);Index++);if(46==source.charCodeAt(Index)){for(position=++Index;position<length&&(charCode=source.charCodeAt(position),48<=charCode&&57>=charCode);position++);position==Index&&abort(),Index=position}if(charCode=source.charCodeAt(Index),101==charCode||69==charCode){for(charCode=source.charCodeAt(++Index),(43==charCode||45==charCode)&&Index++,position=Index;position<length&&(charCode=source.charCodeAt(position),48<=charCode&&57>=charCode);position++);position==Index&&abort(),Index=position}return+source.slice(begin,Index)}if(isSigned&&abort(),"true"==source.slice(Index,Index+4))return Index+=4,!0;if("false"==source.slice(Index,Index+5))return Index+=5,!1;if("null"==source.slice(Index,Index+4))return Index+=4,null;abort();}return"$"},get=function(value){var results,hasMembers;if("$"==value&&abort(),"string"==typeof value){if("@"==(charIndexBuggy?value.charAt(0):value[0]))return value.slice(1);if("["==value){for(results=[];;hasMembers||(hasMembers=!0)){if(value=lex(),"]"==value)break;hasMembers&&(","==value?(value=lex(),"]"==value&&abort()):abort()),","==value&&abort(),results.push(get(value))}return results}if("{"==value){for(results={};;hasMembers||(hasMembers=!0)){if(value=lex(),"}"==value)break;hasMembers&&(","==value?(value=lex(),"}"==value&&abort()):abort()),(","==value||"string"!=typeof value||"@"!=(charIndexBuggy?value.charAt(0):value[0])||":"!=lex())&&abort(),results[value.slice(1)]=get(lex())}return results}abort()}return value},update=function(source,property,callback){var element=walk(source,property,callback);element===undef?delete source[property]:source[property]=element},walk=function(source,property,callback){var value=source[property],length;if("object"==typeof value&&value)if(getClass.call(value)==arrayClass)for(length=value.length;length--;)update(value,length,callback);else forEach(value,function(property){update(value,property,callback)});return callback.call(source,property,value)},Index,Source;exports.parse=function(source,callback){var result,value;return Index=0,Source=""+source,result=get(lex()),"$"!=lex()&&abort(),Index=Source=null,callback&&getClass.call(callback)==functionClass?walk((value={},value[""]=result,value),"",callback):result}}}return exports.runInContext=runInContext,exports}var isLoader="function"==typeof!1,objectTypes={function:!0,object:!0},freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,root=objectTypes[typeof window]&&window||this,freeGlobal=freeExports&&objectTypes[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(freeGlobal&&(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal)&&(root=freeGlobal),freeExports&&!isLoader)runInContext(root,freeExports);else{var nativeJSON=root.JSON,previousJSON=root.JSON3,isRestored=!1,JSON3=runInContext(root,root.JSON3={noConflict:function(){return isRestored||(isRestored=!0,root.JSON=nativeJSON,root.JSON3=previousJSON,nativeJSON=previousJSON=null),JSON3}});root.JSON={parse:JSON3.parse,stringify:JSON3.stringify}}}).call(this)}).call(exports,__webpack_require__(12)(module),function(){return this}())},function(module){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children=[],module.webpackPolyfill=1),module}},function(module){function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}module.exports=Emitter;Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks[event]=this._callbacks[event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){self.off(event,on),fn.apply(this,arguments)}var self=this;return this._callbacks=this._callbacks||{},on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks[event],this;for(var i=0,cb;i<callbacks.length;i++)if(cb=callbacks[i],cb===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks[event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},function(module,exports,__webpack_require__){(function(global){var isArray=__webpack_require__(15),isBuf=__webpack_require__(16);exports.deconstructPacket=function(packet){function _deconstructPacket(data){if(!data)return data;if(isBuf(data)){var placeholder={_placeholder:!0,num:buffers.length};return buffers.push(data),placeholder}if(isArray(data)){for(var newData=Array(data.length),i=0;i<data.length;i++)newData[i]=_deconstructPacket(data[i]);return newData}if("object"==typeof data&&!(data instanceof Date)){var newData={};for(var key in data)newData[key]=_deconstructPacket(data[key]);return newData}return data}var buffers=[],packetData=packet.data,pack=packet;return pack.data=_deconstructPacket(packetData),pack.attachments=buffers.length,{packet:pack,buffers:buffers}},exports.reconstructPacket=function(packet,buffers){function _reconstructPacket(data){if(data&&data._placeholder){var buf=buffers[data.num];return buf}if(isArray(data)){for(var i=0;i<data.length;i++)data[i]=_reconstructPacket(data[i]);return data}if(data&&"object"==typeof data){for(var key in data)data[key]=_reconstructPacket(data[key]);return data}return data}return packet.data=_reconstructPacket(packet.data),packet.attachments=void 0,packet},exports.removeBlobs=function(data,callback){function _removeBlobs(obj,curKey,containingObject){if(!obj)return obj;if(global.Blob&&obj instanceof Blob||global.File&&obj instanceof File){pendingBlobs++;var fileReader=new FileReader;fileReader.onload=function(){containingObject?containingObject[curKey]=this.result:bloblessData=this.result,--pendingBlobs||callback(bloblessData)},fileReader.readAsArrayBuffer(obj)}else if(isArray(obj))for(var i=0;i<obj.length;i++)_removeBlobs(obj[i],i,obj);else if(obj&&"object"==typeof obj&&!isBuf(obj))for(var key in obj)_removeBlobs(obj[key],key,obj)}var pendingBlobs=0,bloblessData=data;_removeBlobs(bloblessData),pendingBlobs||callback(bloblessData)}}).call(exports,function(){return this}())},function(module){module.exports=Array.isArray||function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}},function(module,exports){(function(global){module.exports=function(obj){return global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){"use strict";function Manager(uri,opts){return this instanceof Manager?void(uri&&"object"===("undefined"==typeof uri?"undefined":_typeof(uri))&&(opts=uri,uri=void 0),opts=opts||{},opts.path=opts.path||"/socket.io",this.nsps={},this.subs=[],this.opts=opts,this.reconnection(!1!==opts.reconnection),this.reconnectionAttempts(opts.reconnectionAttempts||Infinity),this.reconnectionDelay(opts.reconnectionDelay||1e3),this.reconnectionDelayMax(opts.reconnectionDelayMax||5e3),this.randomizationFactor(opts.randomizationFactor||.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==opts.timeout?2e4:opts.timeout),this.readyState="closed",this.uri=uri,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new parser.Encoder,this.decoder=new parser.Decoder,this.autoConnect=!1!==opts.autoConnect,this.autoConnect&&this.open()):new Manager(uri,opts)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},eio=__webpack_require__(18),Socket=__webpack_require__(44),Emitter=__webpack_require__(35),parser=__webpack_require__(7),on=__webpack_require__(46),bind=__webpack_require__(47),debug=__webpack_require__(3)("socket.io-client:manager"),indexOf=__webpack_require__(42),Backoff=__webpack_require__(48),has=Object.prototype.hasOwnProperty;module.exports=Manager,Manager.prototype.emitAll=function(){for(var nsp in this.emit.apply(this,arguments),this.nsps)has.call(this.nsps,nsp)&&this.nsps[nsp].emit.apply(this.nsps[nsp],arguments)},Manager.prototype.updateSocketIds=function(){for(var nsp in this.nsps)has.call(this.nsps,nsp)&&(this.nsps[nsp].id=this.engine.id)},Emitter(Manager.prototype),Manager.prototype.reconnection=function(v){return arguments.length?(this._reconnection=!!v,this):this._reconnection},Manager.prototype.reconnectionAttempts=function(v){return arguments.length?(this._reconnectionAttempts=v,this):this._reconnectionAttempts},Manager.prototype.reconnectionDelay=function(v){return arguments.length?(this._reconnectionDelay=v,this.backoff&&this.backoff.setMin(v),this):this._reconnectionDelay},Manager.prototype.randomizationFactor=function(v){return arguments.length?(this._randomizationFactor=v,this.backoff&&this.backoff.setJitter(v),this):this._randomizationFactor},Manager.prototype.reconnectionDelayMax=function(v){return arguments.length?(this._reconnectionDelayMax=v,this.backoff&&this.backoff.setMax(v),this):this._reconnectionDelayMax},Manager.prototype.timeout=function(v){return arguments.length?(this._timeout=v,this):this._timeout},Manager.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},Manager.prototype.open=Manager.prototype.connect=function(fn){if(debug("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;debug("opening %s",this.uri),this.engine=eio(this.uri,this.opts);var socket=this.engine,self=this;this.readyState="opening",this.skipReconnect=!1;var openSub=on(socket,"open",function(){self.onopen(),fn&&fn()}),errorSub=on(socket,"error",function(data){if(debug("connect_error"),self.cleanup(),self.readyState="closed",self.emitAll("connect_error",data),fn){var err=new Error("Connection error");err.data=data,fn(err)}else self.maybeReconnectOnOpen()});if(!1!==this._timeout){var timeout=this._timeout;debug("connect attempt will timeout after %d",timeout);var timer=setTimeout(function(){debug("connect attempt timed out after %d",timeout),openSub.destroy(),socket.close(),socket.emit("error","timeout"),self.emitAll("connect_timeout",timeout)},timeout);this.subs.push({destroy:function(){clearTimeout(timer)}})}return this.subs.push(openSub),this.subs.push(errorSub),this},Manager.prototype.onopen=function(){debug("open"),this.cleanup(),this.readyState="open",this.emit("open");var socket=this.engine;this.subs.push(on(socket,"data",bind(this,"ondata"))),this.subs.push(on(socket,"ping",bind(this,"onping"))),this.subs.push(on(socket,"pong",bind(this,"onpong"))),this.subs.push(on(socket,"error",bind(this,"onerror"))),this.subs.push(on(socket,"close",bind(this,"onclose"))),this.subs.push(on(this.decoder,"decoded",bind(this,"ondecoded")))},Manager.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},Manager.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},Manager.prototype.ondata=function(data){this.decoder.add(data)},Manager.prototype.ondecoded=function(packet){this.emit("packet",packet)},Manager.prototype.onerror=function(err){debug("error",err),this.emitAll("error",err)},Manager.prototype.socket=function(nsp,opts){function onConnecting(){~indexOf(self.connecting,socket)||self.connecting.push(socket)}var socket=this.nsps[nsp];if(!socket){socket=new Socket(this,nsp,opts),this.nsps[nsp]=socket;var self=this;socket.on("connecting",onConnecting),socket.on("connect",function(){socket.id=self.engine.id}),this.autoConnect&&onConnecting()}return socket},Manager.prototype.destroy=function(socket){var index=indexOf(this.connecting,socket);~index&&this.connecting.splice(index,1);this.connecting.length||this.close()},Manager.prototype.packet=function(packet){debug("writing packet %j",packet);var self=this;packet.query&&0===packet.type&&(packet.nsp+="?"+packet.query),self.encoding?self.packetBuffer.push(packet):(self.encoding=!0,this.encoder.encode(packet,function(encodedPackets){for(var i=0;i<encodedPackets.length;i++)self.engine.write(encodedPackets[i],packet.options);self.encoding=!1,self.processPacketQueue()}))},Manager.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var pack=this.packetBuffer.shift();this.packet(pack)}},Manager.prototype.cleanup=function(){debug("cleanup");for(var subsLength=this.subs.length,i=0,sub;i<subsLength;i++)sub=this.subs.shift(),sub.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},Manager.prototype.close=Manager.prototype.disconnect=function(){debug("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},Manager.prototype.onclose=function(reason){debug("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",reason),this._reconnection&&!this.skipReconnect&&this.reconnect()},Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var self=this;if(this.backoff.attempts>=this._reconnectionAttempts)debug("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var delay=this.backoff.duration();debug("will wait %dms before reconnect attempt",delay),this.reconnecting=!0;var timer=setTimeout(function(){self.skipReconnect||(debug("attempting reconnect"),self.emitAll("reconnect_attempt",self.backoff.attempts),self.emitAll("reconnecting",self.backoff.attempts),self.skipReconnect||self.open(function(err){err?(debug("reconnect attempt error"),self.reconnecting=!1,self.reconnect(),self.emitAll("reconnect_error",err.data)):(debug("reconnect success"),self.onreconnect())}))},delay);this.subs.push({destroy:function(){clearTimeout(timer)}})}},Manager.prototype.onreconnect=function(){var attempt=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",attempt)}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(19)},function(module,exports,__webpack_require__){module.exports=__webpack_require__(20),module.exports.parser=__webpack_require__(27)},function(module,exports,__webpack_require__){(function(global){function Socket(uri,opts){if(!(this instanceof Socket))return new Socket(uri,opts);opts=opts||{},uri&&"object"==typeof uri&&(opts=uri,uri=null),uri?(uri=parseuri(uri),opts.hostname=uri.host,opts.secure="https"===uri.protocol||"wss"===uri.protocol,opts.port=uri.port,uri.query&&(opts.query=uri.query)):opts.host&&(opts.hostname=parseuri(opts.host).host),this.secure=null==opts.secure?global.location&&"https:"===location.protocol:opts.secure,opts.hostname&&!opts.port&&(opts.port=this.secure?"443":"80"),this.agent=opts.agent||!1,this.hostname=opts.hostname||(global.location?location.hostname:"localhost"),this.port=opts.port||(global.location&&location.port?location.port:this.secure?443:80),this.query=opts.query||{},"string"==typeof this.query&&(this.query=parseqs.decode(this.query)),this.upgrade=!1!==opts.upgrade,this.path=(opts.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!opts.forceJSONP,this.jsonp=!1!==opts.jsonp,this.forceBase64=!!opts.forceBase64,this.enablesXDR=!!opts.enablesXDR,this.timestampParam=opts.timestampParam||"t",this.timestampRequests=opts.timestampRequests,this.transports=opts.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=opts.policyPort||843,this.rememberUpgrade=opts.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=opts.onlyBinaryUpgrades,this.perMessageDeflate=!1!==opts.perMessageDeflate&&(opts.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=opts.pfx||null,this.key=opts.key||null,this.passphrase=opts.passphrase||null,this.cert=opts.cert||null,this.ca=opts.ca||null,this.ciphers=opts.ciphers||null,this.rejectUnauthorized=opts.rejectUnauthorized===void 0?null:opts.rejectUnauthorized,this.forceNode=!!opts.forceNode;var freeGlobal="object"==typeof global&&global;freeGlobal.global===freeGlobal&&(opts.extraHeaders&&0<Object.keys(opts.extraHeaders).length&&(this.extraHeaders=opts.extraHeaders),opts.localAddress&&(this.localAddress=opts.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function clone(obj){var o={};for(var i in obj)obj.hasOwnProperty(i)&&(o[i]=obj[i]);return o}var transports=__webpack_require__(21),Emitter=__webpack_require__(35),debug=__webpack_require__(3)("engine.io-client:socket"),index=__webpack_require__(42),parser=__webpack_require__(27),parseuri=__webpack_require__(2),parsejson=__webpack_require__(43),parseqs=__webpack_require__(36);module.exports=Socket,Socket.priorWebsocketSuccess=!1,Emitter(Socket.prototype),Socket.protocol=parser.protocol,Socket.Socket=Socket,Socket.Transport=__webpack_require__(26),Socket.transports=__webpack_require__(21),Socket.parser=__webpack_require__(27),Socket.prototype.createTransport=function(name){debug("creating transport \"%s\"",name);var query=clone(this.query);query.EIO=parser.protocol,query.transport=name,this.id&&(query.sid=this.id);var transport=new transports[name]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:query,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return transport},Socket.prototype.open=function(){var transport;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))transport="websocket";else{if(0===this.transports.length){var self=this;return void setTimeout(function(){self.emit("error","No transports available")},0)}transport=this.transports[0]}this.readyState="opening";try{transport=this.createTransport(transport)}catch(e){return this.transports.shift(),void this.open()}transport.open(),this.setTransport(transport)},Socket.prototype.setTransport=function(transport){debug("setting transport %s",transport.name);var self=this;this.transport&&(debug("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=transport,transport.on("drain",function(){self.onDrain()}).on("packet",function(packet){self.onPacket(packet)}).on("error",function(e){self.onError(e)}).on("close",function(){self.onClose("transport close")})},Socket.prototype.probe=function(name){function onTransportOpen(){if(self.onlyBinaryUpgrades){var upgradeLosesBinary=!this.supportsBinary&&self.transport.supportsBinary;failed=failed||upgradeLosesBinary}failed||(debug("probe transport \"%s\" opened",name),transport.send([{type:"ping",data:"probe"}]),transport.once("packet",function(msg){if(!failed)if("pong"===msg.type&&"probe"===msg.data){if(debug("probe transport \"%s\" pong",name),self.upgrading=!0,self.emit("upgrading",transport),!transport)return;Socket.priorWebsocketSuccess="websocket"===transport.name,debug("pausing current transport \"%s\"",self.transport.name),self.transport.pause(function(){failed||"closed"===self.readyState||(debug("changing transport and sending upgrade packet"),cleanup(),self.setTransport(transport),transport.send([{type:"upgrade"}]),self.emit("upgrade",transport),transport=null,self.upgrading=!1,self.flush())})}else{debug("probe transport \"%s\" failed",name);var err=new Error("probe error");err.transport=transport.name,self.emit("upgradeError",err)}}))}function freezeTransport(){failed||(failed=!0,cleanup(),transport.close(),transport=null)}function onerror(err){var error=new Error("probe error: "+err);error.transport=transport.name,freezeTransport(),debug("probe transport \"%s\" failed because of error: %s",name,err),self.emit("upgradeError",error)}function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(to){transport&&to.name!==transport.name&&(debug("\"%s\" works - aborting \"%s\"",to.name,transport.name),freezeTransport())}function cleanup(){transport.removeListener("open",onTransportOpen),transport.removeListener("error",onerror),transport.removeListener("close",onTransportClose),self.removeListener("close",onclose),self.removeListener("upgrading",onupgrade)}debug("probing transport \"%s\"",name);var transport=this.createTransport(name,{probe:1}),failed=!1,self=this;Socket.priorWebsocketSuccess=!1,transport.once("open",onTransportOpen),transport.once("error",onerror),transport.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),transport.open()},Socket.prototype.onOpen=function(){if(debug("socket open"),this.readyState="open",Socket.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){debug("starting upgrade probes");for(var i=0,l=this.upgrades.length;i<l;i++)this.probe(this.upgrades[i])}},Socket.prototype.onPacket=function(packet){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(debug("socket receive: type \"%s\", data \"%s\"",packet.type,packet.data),this.emit("packet",packet),this.emit("heartbeat"),packet.type){case"open":this.onHandshake(parsejson(packet.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var err=new Error("server error");err.code=packet.data,this.onError(err);break;case"message":this.emit("data",packet.data),this.emit("message",packet.data);}else debug("packet received with socket readyState \"%s\"",this.readyState)},Socket.prototype.onHandshake=function(data){this.emit("handshake",data),this.id=data.sid,this.transport.query.sid=data.sid,this.upgrades=this.filterUpgrades(data.upgrades),this.pingInterval=data.pingInterval,this.pingTimeout=data.pingTimeout,this.onOpen();"closed"===this.readyState||(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Socket.prototype.onHeartbeat=function(timeout){clearTimeout(this.pingTimeoutTimer);var self=this;self.pingTimeoutTimer=setTimeout(function(){"closed"===self.readyState||self.onClose("ping timeout")},timeout||self.pingInterval+self.pingTimeout)},Socket.prototype.setPing=function(){var self=this;clearTimeout(self.pingIntervalTimer),self.pingIntervalTimer=setTimeout(function(){debug("writing ping packet - expecting pong within %sms",self.pingTimeout),self.ping(),self.onHeartbeat(self.pingTimeout)},self.pingInterval)},Socket.prototype.ping=function(){var self=this;this.sendPacket("ping",function(){self.emit("ping")})},Socket.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},Socket.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(debug("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Socket.prototype.write=Socket.prototype.send=function(msg,options,fn){return this.sendPacket("message",msg,options,fn),this},Socket.prototype.sendPacket=function(type,data,options,fn){if("function"==typeof data&&(fn=data,data=void 0),"function"==typeof options&&(fn=options,options=null),"closing"!==this.readyState&&"closed"!==this.readyState){options=options||{},options.compress=!1!==options.compress;var packet={type:type,data:data,options:options};this.emit("packetCreate",packet),this.writeBuffer.push(packet),fn&&this.once("flush",fn),this.flush()}},Socket.prototype.close=function(){function close(){self.onClose("forced close"),debug("socket closing - telling transport to close"),self.transport.close()}function cleanupAndClose(){self.removeListener("upgrade",cleanupAndClose),self.removeListener("upgradeError",cleanupAndClose),close()}function waitForUpgrade(){self.once("upgrade",cleanupAndClose),self.once("upgradeError",cleanupAndClose)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var self=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?waitForUpgrade():close()}):this.upgrading?waitForUpgrade():close()}return this},Socket.prototype.onError=function(err){debug("socket error %j",err),Socket.priorWebsocketSuccess=!1,this.emit("error",err),this.onClose("transport error",err)},Socket.prototype.onClose=function(reason,desc){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){debug("socket close with reason: \"%s\"",reason);var self=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",reason,desc),self.writeBuffer=[],self.prevBufferLen=0}},Socket.prototype.filterUpgrades=function(upgrades){for(var filteredUpgrades=[],i=0,j=upgrades.length;i<j;i++)~index(this.transports,upgrades[i])&&filteredUpgrades.push(upgrades[i]);return filteredUpgrades}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){(function(global){function polling(opts){var xd=!1,xs=!1,jsonp=!1!==opts.jsonp,xhr;if(global.location){var isSSL="https:"===location.protocol,port=location.port;port||(port=isSSL?443:80),xd=opts.hostname!==location.hostname||port!==opts.port,xs=opts.secure!==isSSL}if(opts.xdomain=xd,opts.xscheme=xs,xhr=new XMLHttpRequest(opts),"open"in xhr&&!opts.forceJSONP)return new XHR(opts);if(!jsonp)throw new Error("JSONP disabled");return new JSONP(opts)}var XMLHttpRequest=__webpack_require__(22),XHR=__webpack_require__(24),JSONP=__webpack_require__(39),websocket=__webpack_require__(40);exports.polling=polling,exports.websocket=websocket}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){(function(global){var hasCORS=__webpack_require__(23);module.exports=function(opts){var xdomain=opts.xdomain,xscheme=opts.xscheme,enablesXDR=opts.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!xdomain||hasCORS))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!xscheme&&enablesXDR)return new XDomainRequest}catch(e){}if(!xdomain)try{return new global[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}}).call(exports,function(){return this}())},function(module){try{module.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(err){module.exports=!1}},function(module,exports,__webpack_require__){(function(global){function empty(){}function XHR(opts){if(Polling.call(this,opts),this.requestTimeout=opts.requestTimeout,global.location){var isSSL="https:"===location.protocol,port=location.port;port||(port=isSSL?443:80),this.xd=opts.hostname!==global.location.hostname||port!==opts.port,this.xs=opts.secure!==isSSL}else this.extraHeaders=opts.extraHeaders}function Request(opts){this.method=opts.method||"GET",this.uri=opts.uri,this.xd=!!opts.xd,this.xs=!!opts.xs,this.async=!1!==opts.async,this.data=void 0===opts.data?null:opts.data,this.agent=opts.agent,this.isBinary=opts.isBinary,this.supportsBinary=opts.supportsBinary,this.enablesXDR=opts.enablesXDR,this.requestTimeout=opts.requestTimeout,this.pfx=opts.pfx,this.key=opts.key,this.passphrase=opts.passphrase,this.cert=opts.cert,this.ca=opts.ca,this.ciphers=opts.ciphers,this.rejectUnauthorized=opts.rejectUnauthorized,this.extraHeaders=opts.extraHeaders,this.create()}function unloadHandler(){for(var i in Request.requests)Request.requests.hasOwnProperty(i)&&Request.requests[i].abort()}var XMLHttpRequest=__webpack_require__(22),Polling=__webpack_require__(25),Emitter=__webpack_require__(35),inherit=__webpack_require__(37),debug=__webpack_require__(3)("engine.io-client:polling-xhr");module.exports=XHR,module.exports.Request=Request,inherit(XHR,Polling),XHR.prototype.supportsBinary=!0,XHR.prototype.request=function(opts){return opts=opts||{},opts.uri=this.uri(),opts.xd=this.xd,opts.xs=this.xs,opts.agent=this.agent||!1,opts.supportsBinary=this.supportsBinary,opts.enablesXDR=this.enablesXDR,opts.pfx=this.pfx,opts.key=this.key,opts.passphrase=this.passphrase,opts.cert=this.cert,opts.ca=this.ca,opts.ciphers=this.ciphers,opts.rejectUnauthorized=this.rejectUnauthorized,opts.requestTimeout=this.requestTimeout,opts.extraHeaders=this.extraHeaders,new Request(opts)},XHR.prototype.doWrite=function(data,fn){var req=this.request({method:"POST",data:data,isBinary:"string"!=typeof data&&data!==void 0}),self=this;req.on("success",fn),req.on("error",function(err){self.onError("xhr post error",err)}),this.sendXhr=req},XHR.prototype.doPoll=function(){debug("xhr poll");var req=this.request(),self=this;req.on("data",function(data){self.onData(data)}),req.on("error",function(err){self.onError("xhr poll error",err)}),this.pollXhr=req},Emitter(Request.prototype),Request.prototype.create=function(){var opts={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized},xhr=this.xhr=new XMLHttpRequest(opts),self=this;try{debug("xhr open %s: %s",this.method,this.uri),xhr.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in xhr.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&xhr.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if(this.supportsBinary&&(xhr.responseType="arraybuffer"),"POST"===this.method)try{this.isBinary?xhr.setRequestHeader("Content-type","application/octet-stream"):xhr.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{xhr.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in xhr&&(xhr.withCredentials=!0),this.requestTimeout&&(xhr.timeout=this.requestTimeout),this.hasXDR()?(xhr.onload=function(){self.onLoad()},xhr.onerror=function(){self.onError(xhr.responseText)}):xhr.onreadystatechange=function(){4!==xhr.readyState||(200===xhr.status||1223===xhr.status?self.onLoad():setTimeout(function(){self.onError(xhr.status)},0))},debug("xhr data %s",this.data),xhr.send(this.data)}catch(e){return void setTimeout(function(){self.onError(e)},0)}global.document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)},Request.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Request.prototype.onData=function(data){this.emit("data",data),this.onSuccess()},Request.prototype.onError=function(err){this.emit("error",err),this.cleanup(!0)},Request.prototype.cleanup=function(fromError){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=empty:this.xhr.onreadystatechange=empty,fromError)try{this.xhr.abort()}catch(e){}global.document&&delete Request.requests[this.index],this.xhr=null}},Request.prototype.onLoad=function(){var data;try{var contentType;try{contentType=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if("application/octet-stream"===contentType)data=this.xhr.response||this.xhr.responseText;else if(!this.supportsBinary)data=this.xhr.responseText;else try{data=_StringfromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(e){for(var ui8Arr=new Uint8Array(this.xhr.response),dataArray=[],idx=0,length=ui8Arr.length;idx<length;idx++)dataArray.push(ui8Arr[idx]);data=_StringfromCharCode.apply(null,dataArray)}}catch(e){this.onError(e)}null!=data&&this.onData(data)},Request.prototype.hasXDR=function(){return"undefined"!=typeof global.XDomainRequest&&!this.xs&&this.enablesXDR},Request.prototype.abort=function(){this.cleanup()},Request.requestsCount=0,Request.requests={},global.document&&(global.attachEvent?global.attachEvent("onunload",unloadHandler):global.addEventListener&&global.addEventListener("beforeunload",unloadHandler,!1))}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){function Polling(opts){var forceBase64=opts&&opts.forceBase64;(!hasXHR2||forceBase64)&&(this.supportsBinary=!1),Transport.call(this,opts)}var Transport=__webpack_require__(26),parseqs=__webpack_require__(36),parser=__webpack_require__(27),inherit=__webpack_require__(37),yeast=__webpack_require__(38),debug=__webpack_require__(3)("engine.io-client:polling");module.exports=Polling;var hasXHR2=function(){var XMLHttpRequest=__webpack_require__(22),xhr=new XMLHttpRequest({xdomain:!1});return null!=xhr.responseType}();inherit(Polling,Transport),Polling.prototype.name="polling",Polling.prototype.doOpen=function(){this.poll()},Polling.prototype.pause=function(onPause){function pause(){debug("paused"),self.readyState="paused",onPause()}var self=this;if(this.readyState="pausing",this.polling||!this.writable){var total=0;this.polling&&(debug("we are currently polling - waiting to pause"),total++,this.once("pollComplete",function(){debug("pre-pause polling complete"),--total||pause()})),this.writable||(debug("we are currently writing - waiting to pause"),total++,this.once("drain",function(){debug("pre-pause writing complete"),--total||pause()}))}else pause()},Polling.prototype.poll=function(){debug("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Polling.prototype.onData=function(data){var self=this;debug("polling got data %s",data);parser.decodePayload(data,this.socket.binaryType,function(packet){return"opening"===self.readyState&&self.onOpen(),"close"===packet.type?(self.onClose(),!1):void self.onPacket(packet)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():debug("ignoring poll - transport state \"%s\"",this.readyState))},Polling.prototype.doClose=function(){function close(){debug("writing close packet"),self.write([{type:"close"}])}var self=this;"open"===this.readyState?(debug("transport open - closing"),close()):(debug("transport not open - deferring close"),this.once("open",close))},Polling.prototype.write=function(packets){var self=this;this.writable=!1;var callbackfn=function(){self.writable=!0,self.emit("drain")};parser.encodePayload(packets,this.supportsBinary,function(data){self.doWrite(data,callbackfn)})},Polling.prototype.uri=function(){var query=this.query||{},schema=this.secure?"https":"http",port="";!1!==this.timestampRequests&&(query[this.timestampParam]=yeast()),this.supportsBinary||query.sid||(query.b64=1),query=parseqs.encode(query),this.port&&("https"==schema&&443!==+this.port||"http"==schema&&80!==+this.port)&&(port=":"+this.port),query.length&&(query="?"+query);var ipv6=-1!==this.hostname.indexOf(":");return schema+"://"+(ipv6?"["+this.hostname+"]":this.hostname)+port+this.path+query}},function(module,exports,__webpack_require__){function Transport(opts){this.path=opts.path,this.hostname=opts.hostname,this.port=opts.port,this.secure=opts.secure,this.query=opts.query,this.timestampParam=opts.timestampParam,this.timestampRequests=opts.timestampRequests,this.readyState="",this.agent=opts.agent||!1,this.socket=opts.socket,this.enablesXDR=opts.enablesXDR,this.pfx=opts.pfx,this.key=opts.key,this.passphrase=opts.passphrase,this.cert=opts.cert,this.ca=opts.ca,this.ciphers=opts.ciphers,this.rejectUnauthorized=opts.rejectUnauthorized,this.forceNode=opts.forceNode,this.extraHeaders=opts.extraHeaders,this.localAddress=opts.localAddress}var parser=__webpack_require__(27),Emitter=__webpack_require__(35);module.exports=Transport,Emitter(Transport.prototype),Transport.prototype.onError=function(msg,desc){var err=new Error(msg);return err.type="TransportError",err.description=desc,this.emit("error",err),this},Transport.prototype.open=function(){return("closed"===this.readyState||""===this.readyState)&&(this.readyState="opening",this.doOpen()),this},Transport.prototype.close=function(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this},Transport.prototype.send=function(packets){if("open"===this.readyState)this.write(packets);else throw new Error("Transport not open")},Transport.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},Transport.prototype.onData=function(data){var packet=parser.decodePacket(data,this.socket.binaryType);this.onPacket(packet)},Transport.prototype.onPacket=function(packet){this.emit("packet",packet)},Transport.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(module,exports,__webpack_require__){(function(global){function encodeBase64Object(packet,callback){var message="b"+exports.packets[packet.type]+packet.data.data;return callback(message)}function encodeArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);var data=packet.data,contentArray=new Uint8Array(data),resultBuffer=new Uint8Array(1+data.byteLength);resultBuffer[0]=packets[packet.type];for(var i=0;i<contentArray.length;i++)resultBuffer[i+1]=contentArray[i];return callback(resultBuffer.buffer)}function encodeBlobAsArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);var fr=new FileReader;return fr.onload=function(){packet.data=fr.result,exports.encodePacket(packet,supportsBinary,!0,callback)},fr.readAsArrayBuffer(packet.data)}function encodeBlob(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);if(dontSendBlobs)return encodeBlobAsArrayBuffer(packet,supportsBinary,callback);var length=new Uint8Array(1);length[0]=packets[packet.type];var blob=new Blob([length.buffer,packet.data]);return callback(blob)}function tryDecode(data){try{data=utf8.decode(data)}catch(e){return!1}return data}function map(ary,each,done){for(var result=Array(ary.length),next=after(ary.length,done),eachWithIndex=function(i,el,cb){each(el,function(error,msg){result[i]=msg,cb(error,result)})},i=0;i<ary.length;i++)eachWithIndex(i,ary[i],next)}var keys=__webpack_require__(28),hasBinary=__webpack_require__(29),sliceBuffer=__webpack_require__(30),after=__webpack_require__(31),utf8=__webpack_require__(32),base64encoder;global&&global.ArrayBuffer&&(base64encoder=__webpack_require__(33));var isAndroid="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),isPhantomJS="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),dontSendBlobs=isAndroid||isPhantomJS;exports.protocol=3;var packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},packetslist=keys(packets),err={type:"error",data:"parser error"},Blob=__webpack_require__(34);exports.encodePacket=function(packet,supportsBinary,utf8encode,callback){"function"==typeof supportsBinary&&(callback=supportsBinary,supportsBinary=!1),"function"==typeof utf8encode&&(callback=utf8encode,utf8encode=null);var data=void 0===packet.data?void 0:packet.data.buffer||packet.data;if(global.ArrayBuffer&&data instanceof ArrayBuffer)return encodeArrayBuffer(packet,supportsBinary,callback);if(Blob&&data instanceof global.Blob)return encodeBlob(packet,supportsBinary,callback);if(data&&data.base64)return encodeBase64Object(packet,callback);var encoded=packets[packet.type];return void 0!==packet.data&&(encoded+=utf8encode?utf8.encode(packet.data+""):packet.data+""),callback(""+encoded)},exports.encodeBase64Packet=function(packet,callback){var message="b"+exports.packets[packet.type];if(Blob&&packet.data instanceof global.Blob){var fr=new FileReader;return fr.onload=function(){var b64=fr.result.split(",")[1];callback(message+b64)},fr.readAsDataURL(packet.data)}var b64data;try{b64data=_StringfromCharCode.apply(null,new Uint8Array(packet.data))}catch(e){for(var typed=new Uint8Array(packet.data),basic=Array(typed.length),i=0;i<typed.length;i++)basic[i]=typed[i];b64data=_StringfromCharCode.apply(null,basic)}return message+=global.btoa(b64data),callback(message)},exports.decodePacket=function(data,binaryType,utf8decode){if(void 0===data)return err;if("string"==typeof data){if("b"==data.charAt(0))return exports.decodeBase64Packet(data.substr(1),binaryType);if(utf8decode&&(data=tryDecode(data),!1===data))return err;var type=data.charAt(0);return+type==type&&packetslist[type]?1<data.length?{type:packetslist[type],data:data.substring(1)}:{type:packetslist[type]}:err}var asArray=new Uint8Array(data),type=asArray[0],rest=sliceBuffer(data,1);return Blob&&"blob"===binaryType&&(rest=new Blob([rest])),{type:packetslist[type],data:rest}},exports.decodeBase64Packet=function(msg,binaryType){var type=packetslist[msg.charAt(0)];if(!base64encoder)return{type:type,data:{base64:!0,data:msg.substr(1)}};var data=base64encoder.decode(msg.substr(1));return"blob"===binaryType&&Blob&&(data=new Blob([data])),{type:type,data:data}},exports.encodePayload=function(packets,supportsBinary,callback){function setLengthHeader(message){return message.length+":"+message}function encodeOne(packet,doneCallback){exports.encodePacket(packet,!!isBinary&&supportsBinary,!0,function(message){doneCallback(null,setLengthHeader(message))})}"function"==typeof supportsBinary&&(callback=supportsBinary,supportsBinary=null);var isBinary=hasBinary(packets);return supportsBinary&&isBinary?Blob&&!dontSendBlobs?exports.encodePayloadAsBlob(packets,callback):exports.encodePayloadAsArrayBuffer(packets,callback):packets.length?void map(packets,encodeOne,function(err,results){return callback(results.join(""))}):callback("0:")},exports.decodePayload=function(data,binaryType,callback){if("string"!=typeof data)return exports.decodePayloadAsBinary(data,binaryType,callback);"function"==typeof binaryType&&(callback=binaryType,binaryType=null);var packet;if(""==data)return callback(err,0,1);for(var length="",i=0,l=data.length,n,msg,chr;i<l;i++)if(chr=data.charAt(i),":"!=chr)length+=chr;else{if(""==length||length!=(n=+length))return callback(err,0,1);if(msg=data.substr(i+1,n),length!=msg.length)return callback(err,0,1);if(msg.length){if(packet=exports.decodePacket(msg,binaryType,!0),err.type==packet.type&&err.data==packet.data)return callback(err,0,1);var ret=callback(packet,i+n,l);if(!1===ret)return}i+=n,length=""}if(""!=length)return callback(err,0,1)},exports.encodePayloadAsArrayBuffer=function(packets,callback){return packets.length?void map(packets,function(packet,doneCallback){exports.encodePacket(packet,!0,!0,function(data){return doneCallback(null,data)})},function(err,encodedPackets){var totalLength=encodedPackets.reduce(function(acc,p){var len;return len="string"==typeof p?p.length:p.byteLength,acc+len.toString().length+len+2},0),resultArray=new Uint8Array(totalLength),bufferIndex=0;return encodedPackets.forEach(function(p){var isString="string"==typeof p,ab=p;if(isString){for(var view=new Uint8Array(p.length),i=0;i<p.length;i++)view[i]=p.charCodeAt(i);ab=view.buffer}resultArray[bufferIndex++]=isString?0:1;for(var lenStr=ab.byteLength.toString(),i=0;i<lenStr.length;i++)resultArray[bufferIndex++]=parseInt(lenStr[i]);resultArray[bufferIndex++]=255;for(var view=new Uint8Array(ab),i=0;i<view.length;i++)resultArray[bufferIndex++]=view[i]}),callback(resultArray.buffer)}):callback(new ArrayBuffer(0))},exports.encodePayloadAsBlob=function(packets,callback){map(packets,function(packet,doneCallback){exports.encodePacket(packet,!0,!0,function(encoded){var binaryIdentifier=new Uint8Array(1);if(binaryIdentifier[0]=1,"string"==typeof encoded){for(var view=new Uint8Array(encoded.length),i=0;i<encoded.length;i++)view[i]=encoded.charCodeAt(i);encoded=view.buffer,binaryIdentifier[0]=0}for(var len=encoded instanceof ArrayBuffer?encoded.byteLength:encoded.size,lenStr=len.toString(),lengthAry=new Uint8Array(lenStr.length+1),i=0;i<lenStr.length;i++)lengthAry[i]=parseInt(lenStr[i]);if(lengthAry[lenStr.length]=255,Blob){var blob=new Blob([binaryIdentifier.buffer,lengthAry.buffer,encoded]);doneCallback(null,blob)}})},function(err,results){return callback(new Blob(results))})},exports.decodePayloadAsBinary=function(data,binaryType,callback){"function"==typeof binaryType&&(callback=binaryType,binaryType=null);for(var bufferTail=data,buffers=[],numberTooLong=!1;0<bufferTail.byteLength;){for(var tailArray=new Uint8Array(bufferTail),isString=0===tailArray[0],msgLength="",i=1;;i++){if(255==tailArray[i])break;if(310<msgLength.length){numberTooLong=!0;break}msgLength+=tailArray[i]}if(numberTooLong)return callback(err,0,1);bufferTail=sliceBuffer(bufferTail,2+msgLength.length),msgLength=parseInt(msgLength);var msg=sliceBuffer(bufferTail,0,msgLength);if(isString)try{msg=_StringfromCharCode.apply(null,new Uint8Array(msg))}catch(e){var typed=new Uint8Array(msg);msg="";for(var i=0;i<typed.length;i++)msg+=_StringfromCharCode(typed[i])}buffers.push(msg),bufferTail=sliceBuffer(bufferTail,msgLength)}var total=buffers.length;buffers.forEach(function(buffer,i){callback(exports.decodePacket(buffer,binaryType,!0),i,total)})}}).call(exports,function(){return this}())},function(module){module.exports=Object.keys||function(obj){var arr=[],has=Object.prototype.hasOwnProperty;for(var i in obj)has.call(obj,i)&&arr.push(i);return arr}},function(module,exports,__webpack_require__){(function(global){var isArray=__webpack_require__(15);module.exports=function(data){function _hasBinary(obj){if(!obj)return!1;if(global.Buffer&&global.Buffer.isBuffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer||global.Blob&&obj instanceof Blob||global.File&&obj instanceof File)return!0;if(isArray(obj)){for(var i=0;i<obj.length;i++)if(_hasBinary(obj[i]))return!0;}else if(obj&&"object"==typeof obj)for(var key in obj.toJSON&&"function"==typeof obj.toJSON&&(obj=obj.toJSON()),obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&_hasBinary(obj[key]))return!0;return!1}return _hasBinary(data)}}).call(exports,function(){return this}())},function(module){module.exports=function(arraybuffer,start,end){var bytes=arraybuffer.byteLength;if(start=start||0,end=end||bytes,arraybuffer.slice)return arraybuffer.slice(start,end);if(0>start&&(start+=bytes),0>end&&(end+=bytes),end>bytes&&(end=bytes),start>=bytes||start>=end||0===bytes)return new ArrayBuffer(0);for(var abv=new Uint8Array(arraybuffer),result=new Uint8Array(end-start),i=start,ii=0;i<end;i++,ii++)result[ii]=abv[i];return result.buffer}},function(module){function noop(){}module.exports=function(count,callback,err_cb){function proxy(err,result){if(0>=proxy.count)throw new Error("after called too many times");--proxy.count,err?(bail=!0,callback(err),callback=err_cb):0===proxy.count&&!bail&&callback(null,result)}var bail=!1;return err_cb=err_cb||noop,proxy.count=count,0===count?callback():proxy}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(function(module,global){(function(root){function ucs2decode(string){for(var output=[],counter=0,length=string.length,value,extra;counter<length;)value=string.charCodeAt(counter++),55296<=value&&56319>=value&&counter<length?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){for(var length=array.length,index=-1,output="",value;++index<length;)value=array[index],65535<value&&(value-=65536,output+=stringFromCharCode(55296|1023&value>>>10),value=56320|1023&value),output+=stringFromCharCode(value);return output}function createByte(codePoint,shift){return stringFromCharCode(128|63&codePoint>>shift)}function encodeCodePoint(codePoint){if(0==(4294967168&codePoint))return stringFromCharCode(codePoint);var symbol="";return 0==(4294965248&codePoint)?symbol=stringFromCharCode(192|31&codePoint>>6):0==(4294901760&codePoint)?(symbol=stringFromCharCode(224|15&codePoint>>12),symbol+=createByte(codePoint,6)):0==(4292870144&codePoint)&&(symbol=stringFromCharCode(240|7&codePoint>>18),symbol+=createByte(codePoint,12),symbol+=createByte(codePoint,6)),symbol+=stringFromCharCode(128|63&codePoint),symbol}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var continuationByte=255&byteArray[byteIndex];if(byteIndex++,128==(192&continuationByte))return 63&continuationByte;throw Error("Invalid continuation byte")}function decodeSymbol(){var byte1,byte2,byte3,byte4,codePoint;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(byte1=255&byteArray[byteIndex],byteIndex++,0==(128&byte1))return byte1;if(192==(224&byte1)){var byte2=readContinuationByte();if(codePoint=(31&byte1)<<6|byte2,128<=codePoint)return codePoint;throw Error("Invalid continuation byte")}if(224==(240&byte1)){if(byte2=readContinuationByte(),byte3=readContinuationByte(),codePoint=(15&byte1)<<12|byte2<<6|byte3,2048<=codePoint)return codePoint;throw Error("Invalid continuation byte")}if(240==(248&byte1)&&(byte2=readContinuationByte(),byte3=readContinuationByte(),byte4=readContinuationByte(),codePoint=(15&byte1)<<18|byte2<<12|byte3<<6|byte4,65536<=codePoint&&1114111>=codePoint))return codePoint;throw Error("Invalid WTF-8 detected")}function wtf8decode(byteString){byteArray=ucs2decode(byteString),byteCount=byteArray.length,byteIndex=0;for(var codePoints=[],tmp;!1!==(tmp=decodeSymbol());)codePoints.push(tmp);return ucs2encode(codePoints)}var freeModule="object"==typeof module&&module&&module.exports==("object"==typeof exports&&exports)&&module,freeGlobal="object"==typeof global&&global;(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal)&&(root=freeGlobal);var stringFromCharCode=_StringfromCharCode,wtf8={version:"1.0.0",encode:function(string){for(var codePoints=ucs2decode(string),length=codePoints.length,index=-1,byteString="",codePoint;++index<length;)codePoint=codePoints[index],byteString+=encodeCodePoint(codePoint);return byteString},decode:wtf8decode},byteArray,byteCount,byteIndex;__WEBPACK_AMD_DEFINE_RESULT__=function(){return wtf8}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})(this)}).call(exports,__webpack_require__(12)(module),function(){return this}())},function(module,exports){(function(){"use strict";for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;exports.encode=function(arraybuffer){var bytes=new Uint8Array(arraybuffer),len=bytes.length,base64="",i;for(i=0;i<len;i+=3)base64+=chars[bytes[i]>>2],base64+=chars[(3&bytes[i])<<4|bytes[i+1]>>4],base64+=chars[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64+=chars[63&bytes[i+2]];return 2==len%3?base64=base64.substring(0,base64.length-1)+"=":1==len%3&&(base64=base64.substring(0,base64.length-2)+"=="),base64},exports.decode=function(base64){var bufferLength=.75*base64.length,len=base64.length,p=0,i,encoded1,encoded2,encoded3,encoded4;"="===base64[base64.length-1]&&(bufferLength--,"="===base64[base64.length-2]&&bufferLength--);var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;i<len;i+=4)encoded1=lookup[base64.charCodeAt(i)],encoded2=lookup[base64.charCodeAt(i+1)],encoded3=lookup[base64.charCodeAt(i+2)],encoded4=lookup[base64.charCodeAt(i+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return arraybuffer}})()},function(module,exports){(function(global){function mapArrayBufferViews(ary){for(var i=0,chunk;i<ary.length;i++)if(chunk=ary[i],chunk.buffer instanceof ArrayBuffer){var buf=chunk.buffer;if(chunk.byteLength!==buf.byteLength){var copy=new Uint8Array(chunk.byteLength);copy.set(new Uint8Array(buf,chunk.byteOffset,chunk.byteLength)),buf=copy.buffer}ary[i]=buf}}function BlobBuilderConstructor(ary,options){options=options||{};var bb=new BlobBuilder;mapArrayBufferViews(ary);for(var i=0;i<ary.length;i++)bb.append(ary[i]);return options.type?bb.getBlob(options.type):bb.getBlob()}function BlobConstructor(ary,options){return mapArrayBufferViews(ary),new Blob(ary,options||{})}var BlobBuilder=global.BlobBuilder||global.WebKitBlobBuilder||global.MSBlobBuilder||global.MozBlobBuilder,blobSupported=function(){try{var a=new Blob(["hi"]);return 2===a.size}catch(e){return!1}}(),blobSupportsArrayBufferView=blobSupported&&function(){try{var b=new Blob([new Uint8Array([1,2])]);return 2===b.size}catch(e){return!1}}(),blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;module.exports=function(){return blobSupported?blobSupportsArrayBufferView?global.Blob:BlobConstructor:blobBuilderSupported?BlobBuilderConstructor:void 0}()}).call(exports,function(){return this}())},function(module){function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}module.exports=Emitter;Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){this.off(event,on),fn.apply(this,arguments)}return on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks["$"+event],this;for(var i=0,cb;i<callbacks.length;i++)if(cb=callbacks[i],cb===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks["$"+event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},function(module,exports){exports.encode=function(obj){var str="";for(var i in obj)obj.hasOwnProperty(i)&&(str.length&&(str+="&"),str+=encodeURIComponent(i)+"="+encodeURIComponent(obj[i]));return str},exports.decode=function(qs){for(var qry={},pairs=qs.split("&"),i=0,l=pairs.length,pair;i<l;i++)pair=pairs[i].split("="),qry[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1]);return qry}},function(module){module.exports=function(a,b){var fn=function(){};fn.prototype=b.prototype,a.prototype=new fn,a.prototype.constructor=a}},function(module){"use strict";function encode(num){var encoded="";do encoded=alphabet[num%length]+encoded,num=_Mathfloor(num/length);while(0<num);return encoded}function decode(str){var decoded=0;for(i=0;i<str.length;i++)decoded=decoded*length+map[str.charAt(i)];return decoded}function yeast(){var now=encode(+new Date);return now===prev?now+"."+encode(seed++):(seed=0,prev=now)}for(var alphabet=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","-","_"],length=64,map={},seed=0,i=0,prev;i<length;i++)map[alphabet[i]]=i;yeast.encode=encode,yeast.decode=decode,module.exports=yeast},function(module,exports,__webpack_require__){(function(global){function empty(){}function JSONPPolling(opts){Polling.call(this,opts),this.query=this.query||{},callbacks||(!global.___eio&&(global.___eio=[]),callbacks=global.___eio),this.index=callbacks.length;var self=this;callbacks.push(function(msg){self.onData(msg)}),this.query.j=this.index,global.document&&global.addEventListener&&global.addEventListener("beforeunload",function(){self.script&&(self.script.onerror=empty)},!1)}var Polling=__webpack_require__(25),inherit=__webpack_require__(37);module.exports=JSONPPolling;var rNewline=/\n/g,rEscapedNewline=/\\n/g,callbacks;inherit(JSONPPolling,Polling),JSONPPolling.prototype.supportsBinary=!1,JSONPPolling.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Polling.prototype.doClose.call(this)},JSONPPolling.prototype.doPoll=function(){var self=this,script=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),script.async=!0,script.src=this.uri(),script.onerror=function(e){self.onError("jsonp poll error",e)};var insertAt=document.getElementsByTagName("script")[0];insertAt?insertAt.parentNode.insertBefore(script,insertAt):(document.head||document.body).appendChild(script),this.script=script;var isUAgecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);isUAgecko&&setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe),document.body.removeChild(iframe)},100)},JSONPPolling.prototype.doWrite=function(data,fn){function complete(){initIframe(),fn()}function initIframe(){if(self.iframe)try{self.form.removeChild(self.iframe)}catch(e){self.onError("jsonp polling iframe removal error",e)}try{var html="<iframe src=\"javascript:0\" name=\""+self.iframeId+"\">";iframe=document.createElement(html)}catch(e){iframe=document.createElement("iframe"),iframe.name=self.iframeId,iframe.src="javascript:0"}iframe.id=self.iframeId,self.form.appendChild(iframe),self.iframe=iframe}var self=this;if(!this.form){var form=document.createElement("form"),area=document.createElement("textarea"),id=this.iframeId="eio_iframe_"+this.index,iframe;form.className="socketio",form.style.position="absolute",form.style.top="-1000px",form.style.left="-1000px",form.target=id,form.method="POST",form.setAttribute("accept-charset","utf-8"),area.name="d",form.appendChild(area),document.body.appendChild(form),this.form=form,this.area=area}this.form.action=this.uri(),initIframe(),data=data.replace(rEscapedNewline,"\\\n"),this.area.value=data.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===self.iframe.readyState&&complete()}:this.iframe.onload=complete}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){(function(global){function WS(opts){var forceBase64=opts&&opts.forceBase64;forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=opts.perMessageDeflate,this.usingBrowserWebSocket=BrowserWebSocket&&!opts.forceNode,this.usingBrowserWebSocket||(WebSocket=NodeWebSocket),Transport.call(this,opts)}var Transport=__webpack_require__(26),parser=__webpack_require__(27),parseqs=__webpack_require__(36),inherit=__webpack_require__(37),yeast=__webpack_require__(38),debug=__webpack_require__(3)("engine.io-client:websocket"),BrowserWebSocket=global.WebSocket||global.MozWebSocket,NodeWebSocket;if("undefined"==typeof window)try{NodeWebSocket=__webpack_require__(41)}catch(e){}var WebSocket=BrowserWebSocket;WebSocket||"undefined"!=typeof window||(WebSocket=NodeWebSocket),module.exports=WS,inherit(WS,Transport),WS.prototype.name="websocket",WS.prototype.supportsBinary=!0,WS.prototype.doOpen=function(){if(this.check()){var uri=this.uri(),opts={agent:this.agent,perMessageDeflate:this.perMessageDeflate},protocols;opts.pfx=this.pfx,opts.key=this.key,opts.passphrase=this.passphrase,opts.cert=this.cert,opts.ca=this.ca,opts.ciphers=this.ciphers,opts.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(opts.headers=this.extraHeaders),this.localAddress&&(opts.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?new WebSocket(uri):new WebSocket(uri,protocols,opts)}catch(err){return this.emit("error",err)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},WS.prototype.addEventListeners=function(){var self=this;this.ws.onopen=function(){self.onOpen()},this.ws.onclose=function(){self.onClose()},this.ws.onmessage=function(ev){self.onData(ev.data)},this.ws.onerror=function(e){self.onError("websocket error",e)}},WS.prototype.write=function(packets){function done(){self.emit("flush"),setTimeout(function(){self.writable=!0,self.emit("drain")},0)}var self=this;this.writable=!1;for(var total=packets.length,i=0,l=total;i<l;i++)(function(packet){parser.encodePacket(packet,self.supportsBinary,function(data){if(!self.usingBrowserWebSocket){var opts={};if(packet.options&&(opts.compress=packet.options.compress),self.perMessageDeflate){var len="string"==typeof data?global.Buffer.byteLength(data):data.length;len<self.perMessageDeflate.threshold&&(opts.compress=!1)}}try{self.usingBrowserWebSocket?self.ws.send(data):self.ws.send(data,opts)}catch(e){debug("websocket closed before onclose event")}--total||done()})})(packets[i])},WS.prototype.onClose=function(){Transport.prototype.onClose.call(this)},WS.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},WS.prototype.uri=function(){var query=this.query||{},schema=this.secure?"wss":"ws",port="";this.port&&("wss"==schema&&443!==+this.port||"ws"==schema&&80!==+this.port)&&(port=":"+this.port),this.timestampRequests&&(query[this.timestampParam]=yeast()),this.supportsBinary||(query.b64=1),query=parseqs.encode(query),query.length&&(query="?"+query);var ipv6=-1!==this.hostname.indexOf(":");return schema+"://"+(ipv6?"["+this.hostname+"]":this.hostname)+port+this.path+query},WS.prototype.check=function(){return!!WebSocket&&!("__initialize"in WebSocket&&this.name===WS.prototype.name)}}).call(exports,function(){return this}())},function(){},function(module){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},function(module,exports){(function(global){var rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rtrimLeft=/^\s+/,rtrimRight=/\s+$/;module.exports=function(data){return"string"==typeof data&&data?(data=data.replace(rtrimLeft,"").replace(rtrimRight,""),global.JSON&&JSON.parse?JSON.parse(data):rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))?new Function("return "+data)():void 0):null}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){"use strict";function Socket(io,nsp,opts){this.io=io,this.nsp=nsp,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,opts&&opts.query&&(this.query=opts.query),this.io.autoConnect&&this.open()}var parser=__webpack_require__(7),Emitter=__webpack_require__(35),toArray=__webpack_require__(45),on=__webpack_require__(46),bind=__webpack_require__(47),debug=__webpack_require__(3)("socket.io-client:socket"),hasBin=__webpack_require__(29);module.exports=exports=Socket;var events={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},emit=Emitter.prototype.emit;Emitter(Socket.prototype),Socket.prototype.subEvents=function(){if(!this.subs){var io=this.io;this.subs=[on(io,"open",bind(this,"onopen")),on(io,"packet",bind(this,"onpacket")),on(io,"close",bind(this,"onclose"))]}},Socket.prototype.open=Socket.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},Socket.prototype.send=function(){var args=toArray(arguments);return args.unshift("message"),this.emit.apply(this,args),this},Socket.prototype.emit=function(ev){if(events.hasOwnProperty(ev))return emit.apply(this,arguments),this;var args=toArray(arguments),parserType=parser.EVENT;hasBin(args)&&(parserType=parser.BINARY_EVENT);var packet={type:parserType,data:args};return packet.options={},packet.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof args[args.length-1]&&(debug("emitting packet with ack id %d",this.ids),this.acks[this.ids]=args.pop(),packet.id=this.ids++),this.connected?this.packet(packet):this.sendBuffer.push(packet),delete this.flags,this},Socket.prototype.packet=function(packet){packet.nsp=this.nsp,this.io.packet(packet)},Socket.prototype.onopen=function(){debug("transport is open - connecting"),"/"!==this.nsp&&(this.query?this.packet({type:parser.CONNECT,query:this.query}):this.packet({type:parser.CONNECT}))},Socket.prototype.onclose=function(reason){debug("close (%s)",reason),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",reason)},Socket.prototype.onpacket=function(packet){if(packet.nsp===this.nsp)switch(packet.type){case parser.CONNECT:this.onconnect();break;case parser.EVENT:this.onevent(packet);break;case parser.BINARY_EVENT:this.onevent(packet);break;case parser.ACK:this.onack(packet);break;case parser.BINARY_ACK:this.onack(packet);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit("error",packet.data);}},Socket.prototype.onevent=function(packet){var args=packet.data||[];debug("emitting event %j",args),null!=packet.id&&(debug("attaching ack callback to event"),args.push(this.ack(packet.id))),this.connected?emit.apply(this,args):this.receiveBuffer.push(args)},Socket.prototype.ack=function(id){var self=this,sent=!1;return function(){if(!sent){sent=!0;var args=toArray(arguments);debug("sending ack %j",args);var type=hasBin(args)?parser.BINARY_ACK:parser.ACK;self.packet({type:type,id:id,data:args})}}},Socket.prototype.onack=function(packet){var ack=this.acks[packet.id];"function"==typeof ack?(debug("calling ack %s with %j",packet.id,packet.data),ack.apply(this,packet.data),delete this.acks[packet.id]):debug("bad ack %s",packet.id)},Socket.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},Socket.prototype.emitBuffered=function(){var i;for(i=0;i<this.receiveBuffer.length;i++)emit.apply(this,this.receiveBuffer[i]);for(this.receiveBuffer=[],i=0;i<this.sendBuffer.length;i++)this.packet(this.sendBuffer[i]);this.sendBuffer=[]},Socket.prototype.ondisconnect=function(){debug("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},Socket.prototype.destroy=function(){if(this.subs){for(var i=0;i<this.subs.length;i++)this.subs[i].destroy();this.subs=null}this.io.destroy(this)},Socket.prototype.close=Socket.prototype.disconnect=function(){return this.connected&&(debug("performing disconnect (%s)",this.nsp),this.packet({type:parser.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},Socket.prototype.compress=function(compress){return this.flags=this.flags||{},this.flags.compress=compress,this}},function(module){module.exports=function(list,index){var array=[];index=index||0;for(var i=index||0;i<list.length;i++)array[i-index]=list[i];return array}},function(module){"use strict";module.exports=function(obj,ev,fn){return obj.on(ev,fn),{destroy:function(){obj.removeListener(ev,fn)}}}},function(module){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn&&(fn=obj[fn]),"function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}},function(module){function Backoff(opts){opts=opts||{},this.ms=opts.min||100,this.max=opts.max||1e4,this.factor=opts.factor||2,this.jitter=0<opts.jitter&&1>=opts.jitter?opts.jitter:0,this.attempts=0}module.exports=Backoff,Backoff.prototype.duration=function(){var ms=this.ms*_Mathpow(this.factor,this.attempts++);if(this.jitter){var rand=Math.random(),deviation=_Mathfloor(rand*this.jitter*ms);ms=0==(1&_Mathfloor(10*rand))?ms-deviation:ms+deviation}return 0|_Mathmin(ms,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(min){this.ms=min},Backoff.prototype.setMax=function(max){this.max=max},Backoff.prototype.setJitter=function(jitter){this.jitter=jitter}}])})}(),function(){var define=$__System.amdDefine;define("20",["1f"],function(main){return main})}(),$__System.register("21",["3","7","13","15","17","20","a","b","1d","1e"],function(_export){var SentMessage,_classCallCheck,Sender,ConnectionEvent,Requestor,io,_createClass,ReceivedMessage,Receiver,MasterWebRTC;return{setters:[function(_2){SentMessage=_2.SentMessage},function(_){_classCallCheck=_["default"]},function(_3){Sender=_3.Sender},function(_4){ConnectionEvent=_4.ConnectionEvent},function(_5){Requestor=_5.Requestor},function(_6){io=_6["default"]},function(_a){_createClass=_a["default"]},function(_b){ReceivedMessage=_b.ReceivedMessage},function(_d){Receiver=_d.Receiver},function(){}],execute:function(){"use strict";MasterWebRTC=function(){function MasterWebRTC(){_classCallCheck(this,MasterWebRTC),window.io=io,this.connection=window.sst&&window.sst.isDebug&&window.WebRTC&&window.WebRTC.connection?window.WebRTC.connection:new RTCMultiConnection,this.connection.socketURL="https://rtcmulticonnection.herokuapp.com:443/",this.connection.session={data:!0,audio:!1,video:!1,screen:!1},this.SentMessage=new SentMessage,this.ReceivedMessage=new ReceivedMessage,this.Sender=new Sender(this.connection,this.SentMessage),this.ConnectionEvent=new ConnectionEvent(this.connection,this.Sender,this.SentMessage),this.Requestor=new Requestor(this.Sender,this.SentMessage),this.Receiver=new Receiver(this.connection,this.Requestor,this.ReceivedMessage),window.sst&&window.sst.isDebug&&(window.WebRTC=this)}return _createClass(MasterWebRTC,[{key:"setIgnoreOption",value:function(){this.Sender.setIgnoreOption(),this.Receiver.setIgnoreOption()}},{key:"unsetIgnoreOption",value:function(){this.Sender.unsetIgnoreOption(),this.Receiver.unsetIgnoreOption()}}]),MasterWebRTC}(),_export("MasterWebRTC",MasterWebRTC)}}}),$__System.register("22",["5","6","7","21"],function(_export){var _get,_inherits,_classCallCheck,MasterWebRTC,WebRTC;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterWebRTC=_4.MasterWebRTC}],execute:function(){"use strict";WebRTC=function(_MasterWebRTC){function WebRTC(){_classCallCheck(this,WebRTC),_get(Object.getPrototypeOf(WebRTC.prototype),"constructor",this).call(this),this.api={openOrJoinEvent:this.ConnectionEvent.openOrJoinEvent.bind(this.ConnectionEvent),sendEvent:this.Sender.sendEvent.bind(this.Sender),onNewParticipant:this.ConnectionEvent.onNewParticipant,onReceive:this.Receiver.onReceive,setIgnoreOption:this.setIgnoreOption.bind(this),unsetIgnoreOption:this.unsetIgnoreOption.bind(this),options:this.Sender.OptionSender.options}}return _inherits(WebRTC,_MasterWebRTC),WebRTC}(MasterWebRTC),_export("WebRTC",WebRTC)}}}),function(){var define=$__System.amdDefine;(function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define("23",[],f);else{var g;g="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,g.dom2hscript=f()}})(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var parser=require("./parser"),parseStyle=function(el){for(var style=el.style,output={},i=0,item;i<style.length;++i)item=style.item(i),output[item]=style[item];return output},parseDOM=function(el){if(!el.tagName&&el.nodeType===Node.TEXT_NODE)return JSON.stringify(el.textContent);if(el.attributes){for(var attributes={},i=0,attr;i<el.attributes.length;i++)attr=el.attributes[i],attr.name&&"undefined"!=typeof attr.value&&("style"==attr.name?attributes.style=parseStyle(el):attributes[attr.name]=attr.value);var output="h('"+el.tagName;attributes.id&&(output=output+"#"+attributes.id,delete attributes.id),attributes.class&&(output=output+"."+attributes.class.replace(/ /g,"."),delete attributes.class),output+="',",output+=JSON.stringify(attributes);output+=",[";for(var i=0;i<el.childNodes.length;i++)output+=parseDOM(el.childNodes[i])+",";return output+="])",output}};exports.parseDOM=parseDOM,exports.parseHTML=function(html){return parseDOM(parser(html))},module.exports=exports},{"./parser":2}],2:[function(require,module){var parser;if(!window.DOMParser)throw new Error("DOMParser required");(function(DOMParser){"use strict";var proto=DOMParser.prototype,nativeParse=proto.parseFromString;try{if(new DOMParser().parseFromString("","text/html"))return}catch(ex){}proto.parseFromString=function(markup,type){if(/^\s*text\/html\s*(?:;|$)/i.test(type)){var doc=document.implementation.createHTMLDocument("");return-1<markup.toLowerCase().indexOf("<!doctype")?doc.documentElement.innerHTML=markup:doc.body.innerHTML=markup,doc}return nativeParse.apply(this,arguments)}})(DOMParser),parser=new DOMParser,module.exports=function(html,strictChecking){var result=parser.parseFromString(html,"text/html"),el;el=html.substring(0,10).match(/\<body.+/ig)?result.getElementsByTagName("body")[0]:result.getElementsByTagName("body")[0].firstChild;var errors=el.getElementsByTagName("parsererror");if(errors&&0<errors.length){if(!0===strictChecking)throw new Error(errors[0].textContent);for(var i=0;i<errors.length;i++)errors[i].parentElement.removeChild(errors[i])}return el}},{}]},{},[1])(1)})}(),function(){var define=$__System.amdDefine;!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("24",[],e);else{var f;"undefined"==typeof window?"undefined"==typeof global?"undefined"!=typeof self&&(f=self):f=global:f=window,f.virtualDom=e()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){var createElement=require("./vdom/create-element.js");module.exports=createElement},{"./vdom/create-element.js":15}],2:[function(require,module){var diff=require("./vtree/diff.js");module.exports=diff},{"./vtree/diff.js":35}],3:[function(require,module){var h=require("./virtual-hyperscript/index.js");module.exports=h},{"./virtual-hyperscript/index.js":22}],4:[function(require,module){var diff=require("./diff.js"),patch=require("./patch.js"),h=require("./h.js"),create=require("./create-element.js"),VNode=require("./vnode/vnode.js"),VText=require("./vnode/vtext.js");module.exports={diff:diff,patch:patch,h:h,create:create,VNode:VNode,VText:VText}},{"./create-element.js":1,"./diff.js":2,"./h.js":3,"./patch.js":13,"./vnode/vnode.js":31,"./vnode/vtext.js":33}],5:[function(require,module){module.exports=function(undef){var nativeSplit=String.prototype.split,compliantExecNpcg=/()??/.exec("")[1]===undef,self;return self=function(str,separator,limit){if("[object RegExp]"!==Object.prototype.toString.call(separator))return nativeSplit.call(str,separator,limit);var output=[],flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.extended?"x":"")+(separator.sticky?"y":""),lastLastIndex=0,separator=new RegExp(separator.source,flags+"g"),separator2,match,lastIndex,lastLength;for(str+="",compliantExecNpcg||(separator2=new RegExp("^"+separator.source+"$(?!\\s)",flags)),limit=limit===undef?4294967295:limit>>>0;(match=separator.exec(str))&&(lastIndex=match.index+match[0].length,!(lastIndex>lastLastIndex&&(output.push(str.slice(lastLastIndex,match.index)),!compliantExecNpcg&&1<match.length&&match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++)arguments[i]===undef&&(match[i]=undef)}),1<match.length&&match.index<str.length&&Array.prototype.push.apply(output,match.slice(1)),lastLength=match[0].length,lastLastIndex=lastIndex,output.length>=limit)));)separator.lastIndex===match.index&&separator.lastIndex++;return lastLastIndex===str.length?(lastLength||!separator.test(""))&&output.push(""):output.push(str.slice(lastLastIndex)),output.length>limit?output.slice(0,limit):output},self}()},{}],6:[function(){},{}],7:[function(require,module){"use strict";var OneVersionConstraint=require("individual/one-version"),MY_VERSION="7";OneVersionConstraint("ev-store",MY_VERSION);var hashKey="__EV_STORE_KEY@"+MY_VERSION;module.exports=function(elem){var hash=elem[hashKey];return hash||(hash=elem[hashKey]={}),hash}},{"individual/one-version":9}],8:[function(require,module){(function(global){"use strict";function Individual(key,value){return key in root?root[key]:(root[key]=value,value)}var root="undefined"==typeof window?"undefined"==typeof global?{}:global:window;module.exports=Individual}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],9:[function(require,module){"use strict";var Individual=require("./index.js");module.exports=function(moduleName,version,defaultValue){var key="__INDIVIDUAL_ONE_VERSION_"+moduleName,versionValue=Individual(key+"_ENFORCE_SINGLETON",version);if(versionValue!==version)throw new Error("Can only have one copy of "+moduleName+".\nYou already have version "+versionValue+" installed.\nThis means you cannot install version "+version);return Individual(key,defaultValue)}},{"./index.js":8}],10:[function(require,module){(function(global){var topLevel="undefined"==typeof global?"undefined"==typeof window?{}:window:global,minDoc=require("min-document");if("undefined"!=typeof document)module.exports=document;else{var doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"];doccy||(doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc),module.exports=doccy}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"min-document":6}],11:[function(require,module){"use strict";module.exports=function(x){return"object"==typeof x&&null!==x}},{}],12:[function(require,module){var nativeIsArray=Array.isArray,toString=Object.prototype.toString;module.exports=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)}},{}],13:[function(require,module){var patch=require("./vdom/patch.js");module.exports=patch},{"./vdom/patch.js":18}],14:[function(require,module){function removeProperty(node,propName,propValue,previous){if(previous){var previousValue=previous[propName];if(!!isHook(previousValue))previousValue.unhook&&previousValue.unhook(node,propName,propValue);else if("attributes"===propName)for(var attrName in previousValue)node.removeAttribute(attrName);else if("style"===propName)for(var i in previousValue)node.style[i]="";else node[propName]="string"==typeof previousValue?"":null}}function patchObject(node,props,previous,propName,propValue){var previousValue=previous?previous[propName]:void 0;if("attributes"===propName){for(var attrName in propValue){var attrValue=propValue[attrName];attrValue===void 0?node.removeAttribute(attrName):node.setAttribute(attrName,attrValue)}return}if(previousValue&&isObject(previousValue)&&getPrototype(previousValue)!==getPrototype(propValue))return void(node[propName]=propValue);isObject(node[propName])||(node[propName]={});var replacer="style"===propName?"":void 0;for(var k in propValue){var value=propValue[k];node[propName][k]=value===void 0?replacer:value}}function getPrototype(value){if(Object.getPrototypeOf)return Object.getPrototypeOf(value);return value.__proto__?value.__proto__:value.constructor?value.constructor.prototype:void 0}var isObject=require("is-object"),isHook=require("../vnode/is-vhook.js");module.exports=function(node,props,previous){for(var propName in props){var propValue=props[propName];propValue===void 0?removeProperty(node,propName,propValue,previous):isHook(propValue)?(removeProperty(node,propName,propValue,previous),propValue.hook&&propValue.hook(node,propName,previous?previous[propName]:void 0)):isObject(propValue)?patchObject(node,props,previous,propName,propValue):"className"==propName?node[propName]=propValue:node.setAttribute(propName,propValue)}}},{"../vnode/is-vhook.js":26,"is-object":11}],15:[function(require,module){function createElement(vnode,opts){var doc=opts?opts.document||document:document,warn=opts?opts.warn:null;if(vnode=handleThunk(vnode).a,isWidget(vnode))return vnode.init();if(isVText(vnode))return doc.createTextNode(vnode.text);if(!isVNode(vnode))return warn&&warn("Item is not a valid virtual dom node",vnode),null;var node=null===vnode.namespace?doc.createElement(vnode.tagName):doc.createElementNS(vnode.namespace,vnode.tagName),props=vnode.properties;applyProperties(node,props);for(var children=vnode.children,i=0,childNode;i<children.length;i++)childNode=createElement(children[i],opts),childNode&&node.appendChild(childNode);return node}var document=require("global/document"),applyProperties=require("./apply-properties"),isVNode=require("../vnode/is-vnode.js"),isVText=require("../vnode/is-vtext.js"),isWidget=require("../vnode/is-widget.js"),handleThunk=require("../vnode/handle-thunk.js");module.exports=createElement},{"../vnode/handle-thunk.js":24,"../vnode/is-vnode.js":27,"../vnode/is-vtext.js":28,"../vnode/is-widget.js":29,"./apply-properties":14,"global/document":10}],16:[function(require,module){function recurse(rootNode,tree,indices,nodes,rootIndex){if(nodes=nodes||{},rootNode){indexInRange(indices,rootIndex,rootIndex)&&(nodes[rootIndex]=rootNode);var vChildren=tree.children;if(vChildren)for(var childNodes=rootNode.childNodes,i=0;i<tree.children.length;i++){rootIndex+=1;var vChild=vChildren[i]||noChild,nextIndex=rootIndex+(vChild.count||0);indexInRange(indices,rootIndex,nextIndex)&&recurse(childNodes[i],vChild,indices,nodes,rootIndex),rootIndex=nextIndex}}return nodes}function indexInRange(indices,left,right){if(0===indices.length)return!1;for(var minIndex=0,maxIndex=indices.length-1,currentIndex,currentItem;minIndex<=maxIndex;){if(currentIndex=(maxIndex+minIndex)/2>>0,currentItem=indices[currentIndex],minIndex==maxIndex)return currentItem>=left&&currentItem<=right;if(currentItem<left)minIndex=currentIndex+1;else if(currentItem>right)maxIndex=currentIndex-1;else return!0}return!1}function ascending(a,b){return a>b?1:-1}var noChild={};module.exports=function(rootNode,tree,indices,nodes){return indices&&0!==indices.length?(indices.sort(ascending),recurse(rootNode,tree,indices,nodes,0)):{}}},{}],17:[function(require,module){function removeNode(domNode,vNode){var parentNode=domNode.parentNode;return parentNode&&parentNode.removeChild(domNode),destroyWidget(domNode,vNode),null}function insertNode(parentNode,vNode,renderOptions){var newNode=renderOptions.render(vNode,renderOptions);return parentNode&&parentNode.appendChild(newNode),parentNode}function stringPatch(domNode,leftVNode,vText,renderOptions){var newNode;if(3===domNode.nodeType)domNode.replaceData(0,domNode.length,vText.text),newNode=domNode;else{var parentNode=domNode.parentNode;newNode=renderOptions.render(vText,renderOptions),parentNode&&newNode!==domNode&&parentNode.replaceChild(newNode,domNode)}return newNode}function widgetPatch(domNode,leftVNode,widget,renderOptions){var updating=updateWidget(leftVNode,widget),newNode;newNode=updating?widget.update(leftVNode,domNode)||domNode:renderOptions.render(widget,renderOptions);var parentNode=domNode.parentNode;return parentNode&&newNode!==domNode&&parentNode.replaceChild(newNode,domNode),updating||destroyWidget(domNode,leftVNode),newNode}function vNodePatch(domNode,leftVNode,vNode,renderOptions){var parentNode=domNode.parentNode,newNode=renderOptions.render(vNode,renderOptions);return parentNode&&newNode!==domNode&&parentNode.replaceChild(newNode,domNode),newNode}function destroyWidget(domNode,w){"function"==typeof w.destroy&&isWidget(w)&&w.destroy(domNode)}function reorderChildren(domNode,moves){for(var childNodes=domNode.childNodes,keyMap={},i=0,node,remove,insert;i<moves.removes.length;i++)remove=moves.removes[i],node=childNodes[remove.from],remove.key&&(keyMap[remove.key]=node),domNode.removeChild(node);for(var length=childNodes.length,j=0;j<moves.inserts.length;j++)insert=moves.inserts[j],node=keyMap[insert.key],domNode.insertBefore(node,insert.to>=length++?null:childNodes[insert.to])}function replaceRoot(oldRoot,newRoot){return oldRoot&&newRoot&&oldRoot!==newRoot&&oldRoot.parentNode&&oldRoot.parentNode.replaceChild(newRoot,oldRoot),newRoot}var applyProperties=require("./apply-properties"),isWidget=require("../vnode/is-widget.js"),VPatch=require("../vnode/vpatch.js"),updateWidget=require("./update-widget");module.exports=function(vpatch,domNode,renderOptions){var type=vpatch.type,vNode=vpatch.vNode,patch=vpatch.patch;return type===VPatch.REMOVE?removeNode(domNode,vNode):type===VPatch.INSERT?insertNode(domNode,patch,renderOptions):type===VPatch.VTEXT?stringPatch(domNode,vNode,patch,renderOptions):type===VPatch.WIDGET?widgetPatch(domNode,vNode,patch,renderOptions):type===VPatch.VNODE?vNodePatch(domNode,vNode,patch,renderOptions):type===VPatch.ORDER?(reorderChildren(domNode,patch),domNode):type===VPatch.PROPS?(applyProperties(domNode,patch,vNode.properties),domNode):type===VPatch.THUNK?replaceRoot(domNode,renderOptions.patch(domNode,patch,renderOptions)):domNode}},{"../vnode/is-widget.js":29,"../vnode/vpatch.js":32,"./apply-properties":14,"./update-widget":19}],18:[function(require,module){function patch(rootNode,patches,renderOptions){return renderOptions=renderOptions||{},renderOptions.patch=renderOptions.patch&&renderOptions.patch!==patch?renderOptions.patch:patchRecursive,renderOptions.render=renderOptions.render||render,renderOptions.patch(rootNode,patches,renderOptions)}function patchRecursive(rootNode,patches,renderOptions){var indices=patchIndices(patches);if(0===indices.length)return rootNode;var index=domIndex(rootNode,patches.a,indices),ownerDocument=rootNode.ownerDocument;renderOptions.document||ownerDocument===document||(renderOptions.document=ownerDocument);for(var i=0,nodeIndex;i<indices.length;i++)nodeIndex=indices[i],rootNode=applyPatch(rootNode,index[nodeIndex],patches[nodeIndex],renderOptions);return rootNode}function applyPatch(rootNode,domNode,patchList,renderOptions){if(!domNode)return rootNode;var newNode;if(isArray(patchList))for(var i=0;i<patchList.length;i++)newNode=patchOp(patchList[i],domNode,renderOptions),domNode===rootNode&&(rootNode=newNode);else newNode=patchOp(patchList,domNode,renderOptions),domNode===rootNode&&(rootNode=newNode);return rootNode}function patchIndices(patches){var indices=[];for(var key in patches)"a"!==key&&indices.push(+key);return indices}var document=require("global/document"),isArray=require("x-is-array"),render=require("./create-element"),domIndex=require("./dom-index"),patchOp=require("./patch-op");module.exports=patch},{"./create-element":15,"./dom-index":16,"./patch-op":17,"global/document":10,"x-is-array":12}],19:[function(require,module){function updateWidget(a,b){return!!(isWidget(a)&&isWidget(b))&&("name"in a&&"name"in b?a.id===b.id:a.init===b.init)}var isWidget=require("../vnode/is-widget.js");module.exports=updateWidget},{"../vnode/is-widget.js":29}],20:[function(require,module){"use strict";function EvHook(value){return this instanceof EvHook?void(this.value=value):new EvHook(value)}var EvStore=require("ev-store");module.exports=EvHook,EvHook.prototype.hook=function(node,propertyName){var es=EvStore(node),propName=propertyName.substr(3);es[propName]=this.value},EvHook.prototype.unhook=function(node,propertyName){var es=EvStore(node),propName=propertyName.substr(3);es[propName]=void 0}},{"ev-store":7}],21:[function(require,module){"use strict";function SoftSetHook(value){return this instanceof SoftSetHook?void(this.value=value):new SoftSetHook(value)}module.exports=SoftSetHook,SoftSetHook.prototype.hook=function(node,propertyName){node[propertyName]!==this.value&&(node[propertyName]=this.value)}},{}],22:[function(require,module){"use strict";function addChild(c,childNodes,tag,props){if("string"==typeof c)childNodes.push(new VText(c));else if("number"==typeof c)childNodes.push(new VText(c+""));else if(isChild(c))childNodes.push(c);else if(isArray(c))for(var i=0;i<c.length;i++)addChild(c[i],childNodes,tag,props);else{if(null===c||c===void 0)return;throw UnexpectedVirtualElement({foreignObject:c,parentVnode:{tagName:tag,properties:props}})}}function transformProperties(props){for(var propName in props)if(props.hasOwnProperty(propName)){var value=props[propName];if(isHook(value))continue;"ev-"===propName.substr(0,3)&&(props[propName]=evHook(value))}}function isChild(x){return isVNode(x)||isVText(x)||isWidget(x)||isVThunk(x)}function isChildren(x){return"string"==typeof x||isArray(x)||isChild(x)}function UnexpectedVirtualElement(data){var err=new Error;return err.type="virtual-hyperscript.unexpected.virtual-element",err.message="Unexpected virtual child passed to h().\nExpected a VNode / Vthunk / VWidget / string but:\ngot:\n"+errorString(data.foreignObject)+".\nThe parent vnode is:\n"+errorString(data.parentVnode),"\nSuggested fix: change your `h(..., [ ... ])` callsite.",err.foreignObject=data.foreignObject,err.parentVnode=data.parentVnode,err}function errorString(obj){try{return JSON.stringify(obj,null,"    ")}catch(e){return obj+""}}var isArray=require("x-is-array"),VNode=require("../vnode/vnode.js"),VText=require("../vnode/vtext.js"),isVNode=require("../vnode/is-vnode"),isVText=require("../vnode/is-vtext"),isWidget=require("../vnode/is-widget"),isHook=require("../vnode/is-vhook"),isVThunk=require("../vnode/is-thunk"),parseTag=require("./parse-tag.js"),softSetHook=require("./hooks/soft-set-hook.js"),evHook=require("./hooks/ev-hook.js");module.exports=function(tagName,properties,children){var childNodes=[],tag,props,key,namespace;return!children&&isChildren(properties)&&(children=properties,props={}),props=props||properties||{},tag=parseTag(tagName,props),props.hasOwnProperty("key")&&(key=props.key,props.key=void 0),props.hasOwnProperty("namespace")&&(namespace=props.namespace,props.namespace=void 0),"INPUT"!==tag||namespace||!props.hasOwnProperty("value")||void 0===props.value||isHook(props.value)||(props.value=softSetHook(props.value)),transformProperties(props),void 0!==children&&null!==children&&addChild(children,childNodes,tag,props),new VNode(tag,props,childNodes,key,namespace)}},{"../vnode/is-thunk":25,"../vnode/is-vhook":26,"../vnode/is-vnode":27,"../vnode/is-vtext":28,"../vnode/is-widget":29,"../vnode/vnode.js":31,"../vnode/vtext.js":33,"./hooks/ev-hook.js":20,"./hooks/soft-set-hook.js":21,"./parse-tag.js":23,"x-is-array":12}],23:[function(require,module){"use strict";var split=require("browser-split"),classIdSplit=/([\.#]?[a-zA-Z0-9\u007F-\uFFFF_:-]+)/,notClassId=/^\.|#/;module.exports=function(tag,props){if(!tag)return"DIV";var noId=!props.hasOwnProperty("id"),tagParts=split(tag,classIdSplit),tagName=null;notClassId.test(tagParts[1])&&(tagName="DIV");var classes,part,type,i;for(i=0;i<tagParts.length;i++)(part=tagParts[i],!!part)&&(type=part.charAt(0),tagName?"."===type?(classes=classes||[],classes.push(part.substring(1,part.length))):"#"===type&&noId&&(props.id=part.substring(1,part.length)):tagName=part);return classes&&(props.className&&classes.push(props.className),props.className=classes.join(" ")),props.namespace?tagName:tagName.toUpperCase()}},{"browser-split":5}],24:[function(require,module){function renderThunk(thunk,previous){var renderedThunk=thunk.vnode;if(renderedThunk||(renderedThunk=thunk.vnode=thunk.render(previous)),!(isVNode(renderedThunk)||isVText(renderedThunk)||isWidget(renderedThunk)))throw new Error("thunk did not return a valid node");return renderedThunk}var isVNode=require("./is-vnode"),isVText=require("./is-vtext"),isWidget=require("./is-widget"),isThunk=require("./is-thunk");module.exports=function(a,b){var renderedA=a,renderedB=b;return isThunk(b)&&(renderedB=renderThunk(b,a)),isThunk(a)&&(renderedA=renderThunk(a,null)),{a:renderedA,b:renderedB}}},{"./is-thunk":25,"./is-vnode":27,"./is-vtext":28,"./is-widget":29}],25:[function(require,module){module.exports=function(t){return t&&"Thunk"===t.type}},{}],26:[function(require,module){module.exports=function(hook){return hook&&("function"==typeof hook.hook&&!hook.hasOwnProperty("hook")||"function"==typeof hook.unhook&&!hook.hasOwnProperty("unhook"))}},{}],27:[function(require,module){var version=require("./version");module.exports=function(x){return x&&"VirtualNode"===x.type&&x.version===version}},{"./version":30}],28:[function(require,module){var version=require("./version");module.exports=function(x){return x&&"VirtualText"===x.type&&x.version===version}},{"./version":30}],29:[function(require,module){module.exports=function(w){return w&&"Widget"===w.type}},{}],30:[function(require,module){module.exports="2"},{}],31:[function(require,module){function VirtualNode(tagName,properties,children,key,namespace){this.tagName=tagName,this.properties=properties||noProperties,this.children=children||noChildren,this.key=null==key?void 0:key+"",this.namespace="string"==typeof namespace?namespace:null;var count=children&&children.length||0,descendants=0,hasWidgets=!1,hasThunks=!1,descendantHooks=!1,hooks;for(var propName in properties)if(properties.hasOwnProperty(propName)){var property=properties[propName];isVHook(property)&&property.unhook&&(!hooks&&(hooks={}),hooks[propName]=property)}for(var i=0,child;i<count;i++)child=children[i],isVNode(child)?(descendants+=child.count||0,!hasWidgets&&child.hasWidgets&&(hasWidgets=!0),!hasThunks&&child.hasThunks&&(hasThunks=!0),!descendantHooks&&(child.hooks||child.descendantHooks)&&(descendantHooks=!0)):!hasWidgets&&isWidget(child)?"function"==typeof child.destroy&&(hasWidgets=!0):!hasThunks&&isThunk(child)&&(hasThunks=!0);this.count=count+descendants,this.hasWidgets=hasWidgets,this.hasThunks=hasThunks,this.hooks=hooks,this.descendantHooks=descendantHooks}var version=require("./version"),isVNode=require("./is-vnode"),isWidget=require("./is-widget"),isThunk=require("./is-thunk"),isVHook=require("./is-vhook");module.exports=VirtualNode;var noProperties={},noChildren=[];VirtualNode.prototype.version=version,VirtualNode.prototype.type="VirtualNode"},{"./is-thunk":25,"./is-vhook":26,"./is-vnode":27,"./is-widget":29,"./version":30}],32:[function(require,module){function VirtualPatch(type,vNode,patch){this.type=+type,this.vNode=vNode,this.patch=patch}var version=require("./version");VirtualPatch.NONE=0,VirtualPatch.VTEXT=1,VirtualPatch.VNODE=2,VirtualPatch.WIDGET=3,VirtualPatch.PROPS=4,VirtualPatch.ORDER=5,VirtualPatch.INSERT=6,VirtualPatch.REMOVE=7,VirtualPatch.THUNK=8,module.exports=VirtualPatch,VirtualPatch.prototype.version=version,VirtualPatch.prototype.type="VirtualPatch"},{"./version":30}],33:[function(require,module){function VirtualText(text){this.text=text+""}var version=require("./version");module.exports=VirtualText,VirtualText.prototype.version=version,VirtualText.prototype.type="VirtualText"},{"./version":30}],34:[function(require,module){function diffProps(a,b){var diff;for(var aKey in a){aKey in b||(diff=diff||{},diff[aKey]=void 0);var aValue=a[aKey],bValue=b[aKey];if(aValue===bValue)continue;else if(!(isObject(aValue)&&isObject(bValue)))diff=diff||{},diff[aKey]=bValue;else if(getPrototype(bValue)!==getPrototype(aValue))diff=diff||{},diff[aKey]=bValue;else if(isHook(bValue))diff=diff||{},diff[aKey]=bValue;else{var objectDiff=diffProps(aValue,bValue);objectDiff&&(diff=diff||{},diff[aKey]=objectDiff)}}for(var bKey in b)bKey in a||(diff=diff||{},diff[bKey]=b[bKey]);return diff}function getPrototype(value){if(Object.getPrototypeOf)return Object.getPrototypeOf(value);return value.__proto__?value.__proto__:value.constructor?value.constructor.prototype:void 0}var isObject=require("is-object"),isHook=require("../vnode/is-vhook");module.exports=diffProps},{"../vnode/is-vhook":26,"is-object":11}],35:[function(require,module){function diff(a,b){var patch={a:a};return walk(a,b,patch,0),patch}function walk(a,b,patch,index){if(a!==b){var apply=patch[index],applyClear=!1;if(isThunk(a)||isThunk(b))thunks(a,b,patch,index);else if(null==b)isWidget(a)||(clearState(a,patch,index),apply=patch[index]),apply=appendPatch(apply,new VPatch(VPatch.REMOVE,a,b));else if(!isVNode(b))isVText(b)?isVText(a)?a.text!==b.text&&(apply=appendPatch(apply,new VPatch(VPatch.VTEXT,a,b))):(apply=appendPatch(apply,new VPatch(VPatch.VTEXT,a,b)),applyClear=!0):isWidget(b)&&(isWidget(a)||(applyClear=!0),apply=appendPatch(apply,new VPatch(VPatch.WIDGET,a,b)));else if(!isVNode(a))apply=appendPatch(apply,new VPatch(VPatch.VNODE,a,b)),applyClear=!0;else if(a.tagName===b.tagName&&a.namespace===b.namespace&&a.key===b.key){var propsPatch=diffProps(a.properties,b.properties);propsPatch&&(apply=appendPatch(apply,new VPatch(VPatch.PROPS,a,propsPatch))),apply=diffChildren(a,b,patch,apply,index)}else apply=appendPatch(apply,new VPatch(VPatch.VNODE,a,b)),applyClear=!0;apply&&(patch[index]=apply),applyClear&&clearState(a,patch,index)}}function diffChildren(a,b,patch,apply,index){for(var aChildren=a.children,orderedSet=reorder(aChildren,b.children),bChildren=orderedSet.children,aLen=aChildren.length,bLen=bChildren.length,len=aLen>bLen?aLen:bLen,i=0;i<len;i++){var leftNode=aChildren[i],rightNode=bChildren[i];index+=1,leftNode?walk(leftNode,rightNode,patch,index):rightNode&&(apply=appendPatch(apply,new VPatch(VPatch.INSERT,null,rightNode))),isVNode(leftNode)&&leftNode.count&&(index+=leftNode.count)}return orderedSet.moves&&(apply=appendPatch(apply,new VPatch(VPatch.ORDER,a,orderedSet.moves))),apply}function clearState(vNode,patch,index){unhook(vNode,patch,index),destroyWidgets(vNode,patch,index)}function destroyWidgets(vNode,patch,index){if(isWidget(vNode))"function"==typeof vNode.destroy&&(patch[index]=appendPatch(patch[index],new VPatch(VPatch.REMOVE,vNode,null)));else if(isVNode(vNode)&&(vNode.hasWidgets||vNode.hasThunks))for(var children=vNode.children,len=children.length,i=0,child;i<len;i++)child=children[i],index+=1,destroyWidgets(child,patch,index),isVNode(child)&&child.count&&(index+=child.count);else isThunk(vNode)&&thunks(vNode,null,patch,index)}function thunks(a,b,patch,index){var nodes=handleThunk(a,b),thunkPatch=diff(nodes.a,nodes.b);hasPatches(thunkPatch)&&(patch[index]=new VPatch(VPatch.THUNK,null,thunkPatch))}function hasPatches(patch){for(var index in patch)if("a"!==index)return!0;return!1}function unhook(vNode,patch,index){if(!isVNode(vNode))isThunk(vNode)&&thunks(vNode,null,patch,index);else if(vNode.hooks&&(patch[index]=appendPatch(patch[index],new VPatch(VPatch.PROPS,vNode,undefinedKeys(vNode.hooks)))),vNode.descendantHooks||vNode.hasThunks)for(var children=vNode.children,len=children.length,i=0,child;i<len;i++)child=children[i],index+=1,unhook(child,patch,index),isVNode(child)&&child.count&&(index+=child.count)}function undefinedKeys(obj){var result={};for(var key in obj)result[key]=void 0;return result}function reorder(aChildren,bChildren){var bChildIndex=keyIndex(bChildren),bKeys=bChildIndex.keys,bFree=bChildIndex.free;if(bFree.length===bChildren.length)return{children:bChildren,moves:null};var aChildIndex=keyIndex(aChildren),aKeys=aChildIndex.keys,aFree=aChildIndex.free;if(aFree.length===aChildren.length)return{children:bChildren,moves:null};for(var newChildren=[],freeIndex=0,freeCount=bFree.length,deletedItems=0,i=0;i<aChildren.length;i++){var aItem=aChildren[i],itemIndex;aItem.key?bKeys.hasOwnProperty(aItem.key)?(itemIndex=bKeys[aItem.key],newChildren.push(bChildren[itemIndex])):(itemIndex=i-deletedItems++,newChildren.push(null)):freeIndex<freeCount?(itemIndex=bFree[freeIndex++],newChildren.push(bChildren[itemIndex])):(itemIndex=i-deletedItems++,newChildren.push(null))}for(var lastFreeIndex=freeIndex>=bFree.length?bChildren.length:bFree[freeIndex],j=0,newItem;j<bChildren.length;j++)newItem=bChildren[j],newItem.key?!aKeys.hasOwnProperty(newItem.key)&&newChildren.push(newItem):j>=lastFreeIndex&&newChildren.push(newItem);for(var simulate=newChildren.slice(),simulateIndex=0,removes=[],inserts=[],k=0,simulateItem,wantedItem;k<bChildren.length;){for(wantedItem=bChildren[k],simulateItem=simulate[simulateIndex];null===simulateItem&&simulate.length;)removes.push(remove(simulate,simulateIndex,null)),simulateItem=simulate[simulateIndex];simulateItem&&simulateItem.key===wantedItem.key?(simulateIndex++,k++):wantedItem.key?(simulateItem&&simulateItem.key?bKeys[simulateItem.key]===k+1?inserts.push({key:wantedItem.key,to:k}):(removes.push(remove(simulate,simulateIndex,simulateItem.key)),simulateItem=simulate[simulateIndex],simulateItem&&simulateItem.key===wantedItem.key?simulateIndex++:inserts.push({key:wantedItem.key,to:k})):inserts.push({key:wantedItem.key,to:k}),k++):simulateItem&&simulateItem.key&&removes.push(remove(simulate,simulateIndex,simulateItem.key))}for(;simulateIndex<simulate.length;)simulateItem=simulate[simulateIndex],removes.push(remove(simulate,simulateIndex,simulateItem&&simulateItem.key));return removes.length!==deletedItems||inserts.length?{children:newChildren,moves:{removes:removes,inserts:inserts}}:{children:newChildren,moves:null}}function remove(arr,index,key){return arr.splice(index,1),{from:index,key:key}}function keyIndex(children){for(var keys={},free=[],length=children.length,i=0,child;i<length;i++)child=children[i],child.key?keys[child.key]=i:free.push(i);return{keys:keys,free:free}}function appendPatch(apply,patch){return apply?(isArray(apply)?apply.push(patch):apply=[apply,patch],apply):patch}var isArray=require("x-is-array"),VPatch=require("../vnode/vpatch"),isVNode=require("../vnode/is-vnode"),isVText=require("../vnode/is-vtext"),isWidget=require("../vnode/is-widget"),isThunk=require("../vnode/is-thunk"),handleThunk=require("../vnode/handle-thunk"),diffProps=require("./diff-props");module.exports=diff},{"../vnode/handle-thunk":24,"../vnode/is-thunk":25,"../vnode/is-vnode":27,"../vnode/is-vtext":28,"../vnode/is-widget":29,"../vnode/vpatch":32,"./diff-props":34,"x-is-array":12}]},{},[4])(4)})}(),$__System.register("25",["7","23","24","a"],function(_export){var _classCallCheck,dom2hscript,diff,patch,h,_createClass,MasterDom;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){dom2hscript=_2["default"]},function(_3){diff=_3.diff,patch=_3.patch,h=_3.h},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterDom=function(){function MasterDom(){_classCallCheck(this,MasterDom)}return _createClass(MasterDom,[{key:"setData",value:function(container,oldContent,newContent){if(oldContent&&newContent){var newTree=eval(dom2hscript.parseHTML("<div>"+newContent+"</div>")),oldTree=eval(dom2hscript.parseHTML("<div>"+oldContent+"</div>")),patches=diff(oldTree,newTree);return patch(container[0],patches)}return container.html(newContent)}}]),MasterDom}(),_export("MasterDom",MasterDom)}}}),$__System.register("26",["5","6","7","25"],function(_export){var _get,_inherits,_classCallCheck,MasterDom,Dom;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterDom=_4.MasterDom}],execute:function(){"use strict";Dom=function(_MasterDom){function Dom(){_classCallCheck(this,Dom),_get(Object.getPrototypeOf(Dom.prototype),"constructor",this).apply(this,arguments)}return _inherits(Dom,_MasterDom),Dom}(MasterDom),_export("Dom",Dom)}}}),$__System.register("27",["7","10","26","28","a"],function(_export){var _classCallCheck,_Map,Dom,$,_createClass,MasterHTML;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_Map=_2["default"]},function(_4){Dom=_4.Dom},function(_3){$=_3["default"]},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterHTML=function(){function MasterHTML(WebTorrent){_classCallCheck(this,MasterHTML),this.Dom=new Dom,this.WebTorrent=WebTorrent}return _createClass(MasterHTML,[{key:"removeElements",value:function(){this.idNames.forEach(function(e){$("#"+e).remove()})}},{key:"getData",value:function(container){return container.html()}},{key:"setData",value:function(container,dataPack){var _this=this;this.lastData=[container,dataPack];var oldMessage=this.getData(container);this.WebTorrent.api.addByText(dataPack.message,[new _Map([["function",this.Dom.setData],["scope",this],["attributes",[container,oldMessage]]]),new _Map([["function",this.WebTorrent.api.removeDeletedNodes],["scope",this.WebTorrent],["attributes",[this.WebTorrent.api.container]]])],void 0,void 0,void 0,function(){return _this.reTriggerSetData()})}},{key:"reTriggerSetData",value:function(){var _this2=this;clearTimeout(this.reTriggerTimeOutID),this.reTriggerTimeOutID=setTimeout(function(){_this2.lastData&&_this2.setData.apply(_this2,_this2.lastData)},1e3)}},{key:"attachButtonEvent",value:function(button,sendCont,getDataFunc,event,send){var _this3=this;button.on("click",function(){event($("#"+_this3.idNames[0]).val(),getDataFunc(sendCont),_this3.idNames[2],send)})}}]),MasterHTML}(),_export("MasterHTML",MasterHTML)}}}),$__System.register("29",["5","6","7","27","a"],function(_export){var _get,_inherits,_classCallCheck,MasterHTML,_createClass,HTML;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterHTML=_4.MasterHTML},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";HTML=function(_MasterHTML){function HTML(WebTorrent){_classCallCheck(this,HTML),_get(Object.getPrototypeOf(HTML.prototype),"constructor",this).call(this,WebTorrent)}return _inherits(HTML,_MasterHTML),_createClass(HTML,[{key:"createElements",value:function(name){var _this=this,attach=1>=arguments.length||void 0===arguments[1]?"#body":arguments[1],connection=2>=arguments.length||void 0===arguments[2]?null:arguments[2];switch(attach=0<$(attach).length?attach:"body",name){case"open-or-join-room":this.idNames=["txt-roomid","open-or-join-room","sender","receiver"],this.containers=[$("<iframe class=\"gh-button\" src=\"https://ghbtns.com/github-btn.html?user=Weedshaker&amp;repo=PeerWebSite&amp;type=star&amp;count=true&amp;size=large\" scrolling=\"0\" width=\"160px\" height=\"30px\" frameborder=\"0\"></iframe>")];var controls=$("<div id=\"controls\"></div>"),input=$("<input id=\""+this.idNames[0]+"\" class=\"mui-panel\" placeholder=\""+connection.token()+"\">");controls.append(input);var button=$("<button id=\""+this.idNames[1]+"\" class=\"mui-btn mui-btn--primary\">Auto Open Or Join Room</button>");controls.append(button);var clipboard=$("<input type=\"text\" class=\"mui-panel\" id=\"clipboardInput\"><button class=\"mui-btn mui-btn--primary\" id=\"clipboardBtn\">Copy URL</button>").hide();controls.append(clipboard),this.containers.push(controls);var sender=$("<div id=\""+this.idNames[2]+"\">"+(window.sst&&window.sst.karma?"":"Your message...")+"</div>");this.containers.push(sender);var receiver=$("<div id=\""+this.idNames[3]+"\">"+(window.sst&&window.sst.karma?"":"Waiting for response...")+"</div>");return this.containers.push(receiver),button.on("click",function(){_this.disabled=!0,$("#txt-roomid").val($("#txt-roomid").val().replace(/\s/g,"")),location.hash=$("#txt-roomid").val()||$("#txt-roomid").attr("placeholder"),input.hide(),button.hide(),clipboard.show(),clipboard.click(_this.copyToCipBoard),$("#clipboardInput").val(location.href)}),window.sst&&window.sst.isDebug&&(input.val($("#"+this.idNames[0]).val()),button.disabled=connection.sessionid==$("#"+this.idNames[0]).val(),$.summernote&&$("#"+this.idNames[2]).summernote("destroy"),this.removeElements()),this.containers.forEach(function(e){$(attach).append(e)}),[sender,receiver,button];}return!1}},{key:"copyToCipBoard",value:function(){var copyText=document.getElementById("clipboardInput");copyText.select(),copyText.setSelectionRange(0,99999),document.execCommand("copy")}}]),HTML}(MasterHTML),_export("HTML",HTML)}}}),$__System.register("2a",["5","6","7","2c","2b"],function(_export){var _get,_inherits,_classCallCheck,_Object$assign,MasterWebTorrent,WebTorrentSeeder;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_c){_Object$assign=_c["default"]},function(_b){MasterWebTorrent=_b.MasterWebTorrent}],execute:function(){"use strict";WebTorrentSeeder=function(_MasterWebTorrent){function WebTorrentSeeder(container){_classCallCheck(this,WebTorrentSeeder),_get(Object.getPrototypeOf(WebTorrentSeeder.prototype),"constructor",this).call(this,container),this.appended_onerror="window.sst_WebTorrentSeeder_blobsRefresh",window.sst_WebTorrentSeeder_blobsRefresh=this.blobsRefresh.bind(this),this.api=_Object$assign(this.api,{seed:this.seed.bind(this),areTorrentsLoading:this.areTorrentsLoading.bind(this)})}return _inherits(WebTorrentSeeder,_MasterWebTorrent),WebTorrentSeeder}(MasterWebTorrent),_export("WebTorrentSeeder",WebTorrentSeeder)}}}),$__System.registerDynamic("2d",["2e","2f","30","31"],!0,function($__require,exports,module){var global=this||self,$=$__require("2e"),toObject=$__require("2f"),IObject=$__require("30");module.exports=$__require("31")(function(){var a=Object.assign,A={},B={},S=Symbol(),K="abcdefghijklmnopqrst";return A[S]=7,K.split("").forEach(function(k){B[k]=k}),7!=a({},A)[S]||Object.keys(a({},B)).join("")!=K})?function(target){for(var T=toObject(target),$$=arguments,$$len=$$.length,index=1,getKeys=$.getKeys,getSymbols=$.getSymbols,isEnum=$.isEnum;$$len>index;)for(var S=IObject($$[index++]),keys=getSymbols?getKeys(S).concat(getSymbols(S)):getKeys(S),length=keys.length,j=0,key;length>j;)isEnum.call(S,key=keys[j++])&&(T[key]=S[key]);return T}:Object.assign}),$__System.registerDynamic("32",["33","2d"],!0,function($__require){var global=this||self,$export=$__require("33");$export($export.S+$export.F,"Object",{assign:$__require("2d")})}),$__System.registerDynamic("34",["32","35"],!0,function($__require,exports,module){var global=this||self;$__require("32"),module.exports=$__require("35").Object.assign}),$__System.registerDynamic("2c",["34"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("34"),__esModule:!0}}),$__System.registerDynamic("36",[],!0,function($__require,exports,module){var global=this||self;module.exports=Object.is||function(x,y){return x===y?0!==x||1/x==1/y:x!=x&&y!=y}}),$__System.registerDynamic("37",["38","39","3a"],!0,function($__require,exports,module){var global=this||self,anObject=$__require("38"),aFunction=$__require("39"),SPECIES=$__require("3a")("species");module.exports=function(O,D){var C=anObject(O).constructor,S;return C===void 0||(S=anObject(C)[SPECIES])==void 0?D:aFunction(S)}}),$__System.registerDynamic("3b",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(fn,args,that){var un=that===void 0;switch(args.length){case 0:return un?fn():fn.call(that);case 1:return un?fn(args[0]):fn.call(that,args[0]);case 2:return un?fn(args[0],args[1]):fn.call(that,args[0],args[1]);case 3:return un?fn(args[0],args[1],args[2]):fn.call(that,args[0],args[1],args[2]);case 4:return un?fn(args[0],args[1],args[2],args[3]):fn.call(that,args[0],args[1],args[2],args[3]);}return fn.apply(that,args)}}),$__System.registerDynamic("3c",["3d"],!0,function($__require,exports,module){var global=this||self;module.exports=$__require("3d").document&&document.documentElement}),$__System.registerDynamic("3e",["3f","3d"],!0,function($__require,exports,module){var global=this||self,isObject=$__require("3f"),document=$__require("3d").document,is=isObject(document)&&isObject(document.createElement);module.exports=function(it){return is?document.createElement(it):{}}}),$__System.registerDynamic("40",["41","3b","3c","3e","3d","42","43"],!0,function($__require,exports,module){var global=this||self;(function(process){var ctx=$__require("41"),invoke=$__require("3b"),html=$__require("3c"),cel=$__require("3e"),global=$__require("3d"),process=global.process,setTask=global.setImmediate,clearTask=global.clearImmediate,MessageChannel=global.MessageChannel,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",run=function(){var id=+this;if(queue.hasOwnProperty(id)){var fn=queue[id];delete queue[id],fn()}},listner=function(event){run.call(event.data)},defer,channel,port;setTask&&clearTask||(setTask=function(fn){for(var args=[],i=1;arguments.length>i;)args.push(arguments[i++]);return queue[++counter]=function(){invoke("function"==typeof fn?fn:Function(fn),args)},defer(counter),counter},clearTask=function(id){delete queue[id]},"process"==$__require("42")(process)?defer=function(id){process.nextTick(ctx(run,id,1))}:MessageChannel?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listner,defer=ctx(port.postMessage,port,1)):global.addEventListener&&"function"==typeof postMessage&&!global.importScripts?(defer=function(id){global.postMessage(id+"","*")},global.addEventListener("message",listner,!1)):ONREADYSTATECHANGE in cel("script")?defer=function(id){html.appendChild(cel("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run.call(id)}}:defer=function(id){setTimeout(ctx(run,id,1),0)}),module.exports={set:setTask,clear:clearTask}})($__require("43"))}),$__System.registerDynamic("44",["3d","40","42","43"],!0,function($__require,exports,module){var global=this||self;(function(process){var global=$__require("3d"),macrotask=$__require("40").set,Observer=global.MutationObserver||global.WebKitMutationObserver,process=global.process,Promise=global.Promise,isNode="process"==$__require("42")(process),flush=function(){var parent,domain,fn;for(isNode&&(parent=process.domain)&&(process.domain=null,parent.exit());head;)domain=head.domain,fn=head.fn,domain&&domain.enter(),fn(),domain&&domain.exit(),head=head.next;last=void 0,parent&&parent.enter()},head,last,notify;if(isNode)notify=function(){process.nextTick(flush)};else if(Observer){var toggle=1,node=document.createTextNode("");new Observer(flush).observe(node,{characterData:!0}),notify=function(){node.data=toggle=-toggle}}else notify=Promise&&Promise.resolve?function(){Promise.resolve().then(flush)}:function(){macrotask.call(global,flush)};module.exports=function(fn){var task={fn:fn,next:void 0,domain:isNode&&process.domain};last&&(last.next=task),head||(head=task,notify()),last=task}})($__require("43"))}),$__System.registerDynamic("45",[],!0,function($__require,exports,module){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var global=this||self,process=module.exports={},cachedSetTimeout,cachedClearTimeout;(function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}})();var queue=[],draining=!1,queueIndex=-1,currentQueue;process.nextTick=function(fun){var args=Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(){return[]},process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}}),$__System.registerDynamic("46",["45"],!0,function($__require,exports,module){var global=this||self;module.exports=$__require("45")}),$__System.registerDynamic("47",["46"],!0,function($__require,exports,module){var global=this||self;module.exports=$__System._nodeRequire?process:$__require("46")}),$__System.registerDynamic("43",["47"],!0,function($__require,exports,module){var global=this||self;module.exports=$__require("47")}),$__System.registerDynamic("48",["2e","49","3d","41","4a","33","3f","38","39","4b","4c","4d","36","3a","37","44","4e","4f","50","51","35","52","43"],!0,function($__require){var global=this||self;(function(process){"use strict";var $=$__require("2e"),LIBRARY=$__require("49"),global=$__require("3d"),ctx=$__require("41"),classof=$__require("4a"),$export=$__require("33"),isObject=$__require("3f"),anObject=$__require("38"),aFunction=$__require("39"),strictNew=$__require("4b"),forOf=$__require("4c"),setProto=$__require("4d").set,same=$__require("36"),SPECIES=$__require("3a")("species"),speciesConstructor=$__require("37"),asap=$__require("44"),PROMISE="Promise",process=global.process,isNode="process"==classof(process),P=global[PROMISE],empty=function(){},testResolve=function(sub){var test=new P(empty),promise;return sub&&(test.constructor=function(exec){exec(empty,empty)}),(promise=P.resolve(test))["catch"](empty),promise===test},USE_NATIVE=function(){function P2(x){var self=new P(x);return setProto(self,P2.prototype),self}var works=!1;try{if(works=P&&P.resolve&&testResolve(),setProto(P2,P),P2.prototype=$.create(P.prototype,{constructor:{value:P2}}),P2.resolve(5).then(function(){})instanceof P2||(works=!1),works&&$__require("4e")){var thenableThenGotten=!1;P.resolve($.setDesc({},"then",{get:function(){thenableThenGotten=!0}})),works=thenableThenGotten}}catch(e){works=!1}return works}(),sameConstructor=function(a,b){return!!(LIBRARY&&a===P&&b===Wrapper)||same(a,b)},getConstructor=function(C){var S=anObject(C)[SPECIES];return S==void 0?C:S},isThenable=function(it){var then;return!!(isObject(it)&&"function"==typeof(then=it.then))&&then},PromiseCapability=function(C){var resolve,reject;this.promise=new C(function($$resolve,$$reject){if(resolve!==void 0||reject!==void 0)throw TypeError("Bad Promise constructor");resolve=$$resolve,reject=$$reject}),this.resolve=aFunction(resolve),this.reject=aFunction(reject)},perform=function(exec){try{exec()}catch(e){return{error:e}}},notify=function(record,isReject){if(!record.n){record.n=!0;var chain=record.c;asap(function(){for(var value=record.v,ok=1==record.s,i=0,run=function(reaction){var handler=ok?reaction.ok:reaction.fail,resolve=reaction.resolve,reject=reaction.reject,result,then;try{handler?(!ok&&(record.h=!0),result=!0===handler?value:handler(value),result===reaction.promise?reject(TypeError("Promise-chain cycle")):(then=isThenable(result))?then.call(result,resolve,reject):resolve(result)):reject(value)}catch(e){reject(e)}};chain.length>i;)run(chain[i++]);chain.length=0,record.n=!1,isReject&&setTimeout(function(){var promise=record.p,handler,console;isUnhandled(promise)&&(isNode?process.emit("unhandledRejection",value,promise):(handler=global.onunhandledrejection)?handler({promise:promise,reason:value}):(console=global.console)&&console.error&&console.error("Unhandled promise rejection",value)),record.a=void 0},1)})}},isUnhandled=function(promise){var record=promise._d,chain=record.a||record.c,i=0,reaction;if(record.h)return!1;for(;chain.length>i;)if(reaction=chain[i++],reaction.fail||!isUnhandled(reaction.promise))return!1;return!0},$reject=function(value){var record=this;record.d||(record.d=!0,record=record.r||record,record.v=value,record.s=2,record.a=record.c.slice(),notify(record,!0))},$resolve=function(value){var record=this,then;if(!record.d){record.d=!0,record=record.r||record;try{if(record.p===value)throw TypeError("Promise can't be resolved itself");(then=isThenable(value))?asap(function(){var wrapper={r:record,d:!1};try{then.call(value,ctx($resolve,wrapper,1),ctx($reject,wrapper,1))}catch(e){$reject.call(wrapper,e)}}):(record.v=value,record.s=1,notify(record,!1))}catch(e){$reject.call({r:record,d:!1},e)}}},Wrapper;USE_NATIVE||(P=function(executor){aFunction(executor);var record=this._d={p:strictNew(this,P,PROMISE),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{executor(ctx($resolve,record,1),ctx($reject,record,1))}catch(err){$reject.call(record,err)}},$__require("4f")(P.prototype,{then:function(onFulfilled,onRejected){var reaction=new PromiseCapability(speciesConstructor(this,P)),promise=reaction.promise,record=this._d;return reaction.ok="function"!=typeof onFulfilled||onFulfilled,reaction.fail="function"==typeof onRejected&&onRejected,record.c.push(reaction),record.a&&record.a.push(reaction),record.s&&notify(record,!1),promise},catch:function(onRejected){return this.then(void 0,onRejected)}})),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Promise:P}),$__require("50")(P,PROMISE),$__require("51")(PROMISE),Wrapper=$__require("35")[PROMISE],$export($export.S+$export.F*!USE_NATIVE,PROMISE,{reject:function(r){var capability=new PromiseCapability(this),$$reject=capability.reject;return $$reject(r),capability.promise}}),$export($export.S+$export.F*(!USE_NATIVE||testResolve(!0)),PROMISE,{resolve:function(x){if(x instanceof P&&sameConstructor(x.constructor,this))return x;var capability=new PromiseCapability(this),$$resolve=capability.resolve;return $$resolve(x),capability.promise}}),$export($export.S+$export.F*!(USE_NATIVE&&$__require("52")(function(iter){P.all(iter)["catch"](function(){})})),PROMISE,{all:function(iterable){var C=getConstructor(this),capability=new PromiseCapability(C),resolve=capability.resolve,reject=capability.reject,values=[],abrupt=perform(function(){forOf(iterable,!1,values.push,values);var remaining=values.length,results=Array(remaining);remaining?$.each.call(values,function(promise,index){var alreadyCalled=!1;C.resolve(promise).then(function(value){alreadyCalled||(alreadyCalled=!0,results[index]=value,--remaining||resolve(results))},reject)}):resolve(results)});return abrupt&&reject(abrupt.error),capability.promise},race:function(iterable){var C=getConstructor(this),capability=new PromiseCapability(C),reject=capability.reject,abrupt=perform(function(){forOf(iterable,!1,function(promise){C.resolve(promise).then(capability.resolve,reject)})});return abrupt&&reject(abrupt.error),capability.promise}})})($__require("43"))}),$__System.registerDynamic("53",["54","55","56","48","35"],!0,function($__require,exports,module){var global=this||self;$__require("54"),$__require("55"),$__require("56"),$__require("48"),module.exports=$__require("35").Promise}),$__System.registerDynamic("57",["53"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("53"),__esModule:!0}}),$__System.register("d",["7","10","a"],function(_export){var _classCallCheck,_Map,_createClass,MasterOption;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_Map=_2["default"]},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterOption=function(){function MasterOption(){var returnMap=0>=arguments.length||void 0===arguments[0]?new _Map:arguments[0];_classCallCheck(this,MasterOption),this.returnMap=returnMap}return _createClass(MasterOption,[{key:"init",value:function(){for(var _len=arguments.length,data=Array(_len),_key=0;_key<_len;_key++)data[_key]=arguments[_key];this.returnApply("init",data)}},{key:"returnApply",value:function(name){var result=1>=arguments.length||void 0===arguments[1]?[]:arguments[1],funcScope=this.returnMap.get(name);return funcScope?(funcScope[0].apply(funcScope[1],result),!0):(console.warn("SST: set returnMap at MasterOption to handle action: "+name),!1)}}]),MasterOption}(),_export("MasterOption",MasterOption)}}}),$__System.register("18",["7","a"],function(_export){var _classCallCheck,_createClass,MasterWorker;return{setters:[function(_){_classCallCheck=_["default"]},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterWorker=function(){function MasterWorker(){var spreadArgs=!!(0>=arguments.length||void 0===arguments[0])||arguments[0];_classCallCheck(this,MasterWorker),this.spreadArgs=spreadArgs,this.name="MasterWorker",this.workers=[],this.callbacks=[],this.trackers=[],this.scripts=[]}return _createClass(MasterWorker,[{key:"create",value:function(workerFunc,callback,scripts){void 0===workerFunc&&(workerFunc=this.workerFunc),void 0===callback&&(callback=this.callbackFunc);var index=this.trackers.indexOf(workerFunc);return-1===index?(this.workers.push(this.getWebWorker(workerFunc,scripts)),this.callbacks.push(callback),this.trackers.push(workerFunc),this.trackers.length-1):index}},{key:"run",value:function(){var data=0>=arguments.length||void 0===arguments[0]?[]:arguments[0],_this=this,worker=1>=arguments.length||void 0===arguments[1]?this.workers[0]:arguments[1],callback=2>=arguments.length||void 0===arguments[2]?this.callbacks[0]:arguments[2];worker(data,function(err,result){return err?console.warn("SST: Error at "+_this.name+" -> "+err.message):void callback(result)})}},{key:"workerFunc",value:function(data){return data}},{key:"callbackFunc",value:function(result){console.log(result)}},{key:"getWebWorker",value:function(workerFunc){var scripts=1>=arguments.length||void 0===arguments[1]?this.scripts:arguments[1];window.URL=window.URL||window.webkitURL,scripts=Array.isArray(scripts)&&scripts.length?"importScripts('"+scripts.join("','")+"');\n":"","string"!=typeof workerFunc&&(workerFunc=workerFunc.toLocaleString(),workerFunc=workerFunc.replace(/this\./g,""),/^\(.*?\).*?\=\>.*?\{/.test(workerFunc)?workerFunc="("+workerFunc+")":!/^function/.test(workerFunc)&&(workerFunc="function "+workerFunc));var response="onmessage=(event)=>{postMessage("+workerFunc+"("+(this.spreadArgs?"...":"")+"event.data));}",blob;try{blob=new Blob([scripts,response],{type:"application/javascript"})}catch(e){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,blob=new BlobBuilder,blob.append(scripts),blob.append(response),blob=blob.getBlob()}var worker=new Worker(URL.createObjectURL(blob));return function(){var data=0>=arguments.length||void 0===arguments[0]?[]:arguments[0],callback=1>=arguments.length||void 0===arguments[1]?function(){}:arguments[1],ran;worker.onmessage=function(e){ran||(ran=!0,callback(null,e.data))},worker.onerror=function(e){if(!ran)return ran=!0,callback(e),!1},worker.postMessage.apply(worker,[data])}}}]),MasterWorker}(),_export("MasterWorker",MasterWorker)}}}),$__System.register("58",["5","6","7","18","a"],function(_export){var _get,_inherits,_classCallCheck,MasterWorker,_createClass,RegexWorker;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterWorker=_4.MasterWorker},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";RegexWorker=function(_MasterWorker){function RegexWorker(){_classCallCheck(this,RegexWorker),_get(Object.getPrototypeOf(RegexWorker.prototype),"constructor",this).call(this,!1),this.name="RegexWorker"}return _inherits(RegexWorker,_MasterWorker),_createClass(RegexWorker,[{key:"getMagnetURL",value:function(data){for(var txt=data[0],attributes=data[1][0],re=new RegExp("<(\\w*?)\\s[^<>]*?"+attributes[0]+"=\"(\\d*?)\"[^<>]*?"+attributes[1]+"=\"([^\"]*?)\"[^<>]*?"+attributes[2]+"=\"([^\"]*?)\"","gui"),match=null,magnetURLs=[];match=re.exec(txt);){var id=match[2],val=[match[3],[match[4].split(","),[]],match[1]];magnetURLs.push([id,val])}return[[data,magnetURLs]]}},{key:"replaceBlobURL",value:function(data){var txt=data[0][0],attributes=data[0][1][0],downloadedTorrents=data[1][2];return downloadedTorrents.forEach(function(e){var id=e[0],remoteBlobs=e[1][1][0],localBlobs=e[1][1][1],onerror=e[1][1][2];if(remoteBlobs.length===localBlobs.length)for(var i=0,_re;i<remoteBlobs.length;i++)_re=new RegExp(""+remoteBlobs[i].replace(/[-[\]{}()*+?.,\\/^$|#\s]/g,"\\$&"),"g"),txt=txt.replace(_re,localBlobs[i]);else console.warn("remoteBlobs and localBlobs length is uneven:",data);var re=new RegExp(attributes[3]+"=\"[^\"]*?"+id+"[^\"]*?\"","gui");txt=txt.replace(re,attributes[3]+"=\""+onerror+"\"")}),data[0][0]=txt,[data]}},{key:"addProgressBar",value:function(data){var txt=data[0][0],attributes=data[0][1][0],classes=data[0][1][1],inProgressTorrents=data[1][0].concat(data[1][1]);return inProgressTorrents.forEach(function(e){var id=e[0],val=e[1],re=new RegExp("(<"+val[2]+"\\s[^<>]*?class=\")[^\"]*?(\"[^<>]*?"+attributes[0]+"=\""+id+"\"[^<>]*?>).*?(</"+val[2]+">)","gui");txt=txt.replace(re,"$1"+classes[0]+" "+classes[2]+"$2$3")}),data[0][0]=txt,[data]}}]),RegexWorker}(MasterWorker),_export("RegexWorker",RegexWorker)}}}),$__System.register("59",["5","6","7","10","58","a","d"],function(_export){var _get,_inherits,_classCallCheck,_Map,RegexWorker,_createClass,MasterOption,OptionRegex;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){_Map=_4["default"]},function(_5){RegexWorker=_5.RegexWorker},function(_a){_createClass=_a["default"]},function(_d){MasterOption=_d.MasterOption}],execute:function(){"use strict";OptionRegex=function(_MasterOption){function OptionRegex(WebTorrent,client,returnMap,addByTextReturn){var _this=this;_classCallCheck(this,OptionRegex),_get(Object.getPrototypeOf(OptionRegex.prototype),"constructor",this).call(this,returnMap),this.WebTorrent=WebTorrent,this.client=client,this.addByTextReturn=addByTextReturn,this.RegexWorker=new RegexWorker,this.RegexWorker.create(this.RegexWorker.getMagnetURL,function(result){_this.returnApply("getMagnetURL",result)}),this.RegexWorker.create(this.RegexWorker.replaceBlobURL,function(result){_this.returnApply("replaceBlobURL",result)}),this.RegexWorker.create(this.RegexWorker.addProgressBar,function(result){_this.returnApply("addProgressBar",result)})}return _inherits(OptionRegex,_MasterOption),_createClass(OptionRegex,[{key:"getMagnetURL",value:function(txt,attributes){void 0===txt&&(txt="");var workerID=2>=arguments.length||void 0===arguments[2]?1:arguments[2];return this.RegexWorker.run([txt,attributes,workerID]),!0}},{key:"mapFoundMagnetURL",value:function(data){var _this2=this,magnetURLs=data[1],nonExistingTorrents=[],inProgressTorrents=[],downloadedTorrents=[];magnetURLs.forEach(function(e){var torrent=_this2.client.get(e[1][0]);torrent?torrent.sst_localBlobs?(e[1][1][1]=torrent.sst_localBlobs,e[1][1][2]=torrent.sst_onerror,-1===downloadedTorrents.indexOf(e)&&downloadedTorrents.push(e)):-1===inProgressTorrents.indexOf(e)&&inProgressTorrents.push(e):-1===nonExistingTorrents.indexOf(e)&&nonExistingTorrents.push(e)}),data[1]=[nonExistingTorrents,inProgressTorrents,downloadedTorrents],this.returnApply("mapFoundMagnetURL",[data])}},{key:"replaceBlobURL",value:function(data){return this.RegexWorker.run(data,this.RegexWorker.workers[1],this.RegexWorker.callbacks[1]),!0}},{key:"addProgressBar",value:function(data){return this.RegexWorker.run(data,this.RegexWorker.workers[2],this.RegexWorker.callbacks[2]),!0}},{key:"addTorrent",value:function(data){var workerID=data[0][2],returnAndOptions=this.addByTextReturn.get(workerID);returnAndOptions&&returnAndOptions[0].push(new _Map([["function",function(){var _this3=this;setTimeout(function(){data[1][0].forEach(function(nonExistingTorrent){var torrent=_this3.WebTorrent.add(nonExistingTorrent[1][0].replace(/amp;/g,""),nonExistingTorrent[0],void 0,returnAndOptions[1][0],returnAndOptions[1][1],returnAndOptions[1][2],returnAndOptions[1][3]);torrent&&(torrent.sst_remoteBlobs=nonExistingTorrent[1][1][0])})},50)}],["scope",this],["attributes",[]]])),this.returnApply("addTorrent",[data])}}]),OptionRegex}(MasterOption),_export("OptionRegex",OptionRegex)}}}),function(){var define=$__System.amdDefine;(function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("5a",[],e);else{var t;t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,t.WebTorrent=e()}})(function(){var t=_Mathabs,n=_Mathpow,r=_Mathfloor,e=_StringfromCharCode,o=_Mathceil,s=_Mathmax,d=_Mathmin,i;return function(){function d(c,e,t){function r(s,o){if(!e[s]){if(!c[s]){var i="function"==typeof require&&require;if(!o&&i)return i(s,!0);if(n)return n(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var p=e[s]={exports:{}};c[s][0].call(p.exports,function(t){var e=c[s][1][t];return r(e?e:t)},p,p.exports,d,c,e,t)}return e[s].exports}for(var n="function"==typeof require&&require,s=0;s<t.length;s++)r(t[s]);return r}return d}()({1:[function(e,t){function n(e,t){s.Readable.call(this,t),this.destroyed=!1,this._torrent=e._torrent;var n=t&&t.start||0,r=t&&t.end&&t.end<e.length?t.end:e.length-1,o=e._torrent.pieceLength;this._startPiece=0|(n+e.offset)/o,this._endPiece=0|(r+e.offset)/o,this._piece=this._startPiece,this._offset=n+e.offset-this._startPiece*o,this._missing=r-n+1,this._reading=!1,this._notifying=!1,this._criticalLength=d(0|1048576/o,2)}t.exports=n;var r=e("debug")("webtorrent:file-stream"),o=e("inherits"),s=e("readable-stream");o(n,s.Readable),n.prototype._read=function(){this._reading||(this._reading=!0,this._notify())},n.prototype._notify=function(){var e=this;if(e._reading&&0!==e._missing){if(!e._torrent.bitfield.get(e._piece))return e._torrent.critical(e._piece,e._piece+e._criticalLength);if(!e._notifying){if(e._notifying=!0,e._torrent.destroyed)return e._destroy(new Error("Torrent removed"));var t=e._piece;e._torrent.store.get(t,function(n,o){return e._notifying=!1,e.destroyed?void 0:n?e._destroy(n):void(r("read %s (length %s) (err %s)",t,o.length,n&&n.message),e._offset&&(o=o.slice(e._offset),e._offset=0),e._missing<o.length&&(o=o.slice(0,e._missing)),e._missing-=o.length,r("pushing buffer of length %s",o.length),e._reading=!1,e.push(o),0===e._missing&&e.push(null))}),e._piece+=1}}},n.prototype.destroy=function(e){this._destroy(null,e)},n.prototype._destroy=function(e,t){this.destroyed||(this.destroyed=!0,!this._torrent.destroyed&&this._torrent.deselect(this._startPiece,this._endPiece,!0),e&&this.emit("error",e),this.emit("close"),t&&t())}},{debug:29,inherits:40,"readable-stream":82}],2:[function(e,t){(function(n){function r(e,t){s.call(this),this._torrent=e,this._destroyed=!1,this.name=t.name,this.path=t.path,this.length=t.length,this.offset=t.offset,this.done=!1;var n=t.offset,r=n+t.length-1;this._startPiece=0|n/this._torrent.pieceLength,this._endPiece=0|r/this._torrent.pieceLength,0===this.length&&(this.done=!0,this.emit("done"))}t.exports=r;var o=e("end-of-stream"),s=e("events").EventEmitter,i=e("./file-stream"),d=e("inherits"),a=e("path"),c=e("render-media"),l=e("readable-stream"),p=e("stream-to-blob"),u=e("stream-to-blob-url"),f=e("stream-with-known-length-to-buffer");d(r,s),Object.defineProperty(r.prototype,"downloaded",{get:function(){if(!this._torrent.bitfield)return 0;for(var e=0,t=this._startPiece;t<=this._endPiece;++t)if(this._torrent.bitfield.get(t))e+=t===this._endPiece?this._torrent.lastPieceLength:this._torrent.pieceLength;else{var n=this._torrent.pieces[t];e+=n.length-n.missing}return e}}),Object.defineProperty(r.prototype,"progress",{get:function(){return this.length?this.downloaded/this.length:0}}),r.prototype.select=function(e){0===this.length||this._torrent.select(this._startPiece,this._endPiece,e)},r.prototype.deselect=function(){0===this.length||this._torrent.deselect(this._startPiece,this._endPiece,!1)},r.prototype.createReadStream=function(e){var t=this;if(0===this.length){var r=new l.PassThrough;return n.nextTick(function(){r.end()}),r}var s=new i(t,e);return t._torrent.select(s._startPiece,s._endPiece,!0,function(){s._notify()}),o(s,function(){t._destroyed||!t._torrent.destroyed&&t._torrent.deselect(s._startPiece,s._endPiece,!0)}),s},r.prototype.getBuffer=function(e){f(this.createReadStream(),this.length,e)},r.prototype.getBlob=function(e){if("undefined"==typeof window)throw new Error("browser-only method");p(this.createReadStream(),this._getMimeType(),e)},r.prototype.getBlobURL=function(e){if("undefined"==typeof window)throw new Error("browser-only method");u(this.createReadStream(),this._getMimeType(),e)},r.prototype.appendTo=function(e,t,n){if("undefined"==typeof window)throw new Error("browser-only method");c.append(this,e,t,n)},r.prototype.renderTo=function(e,t,n){if("undefined"==typeof window)throw new Error("browser-only method");c.render(this,e,t,n)},r.prototype._getMimeType=function(){return c.mime[a.extname(this.name).toLowerCase()]},r.prototype._destroy=function(){this._destroyed=!0,this._torrent=null}}).call(this,e("_process"))},{"./file-stream":1,_process:65,"end-of-stream":32,events:33,inherits:40,path:62,"readable-stream":82,"render-media":83,"stream-to-blob":102,"stream-to-blob-url":101,"stream-with-known-length-to-buffer":103}],3:[function(e,t,n){function r(e,t){var n=this;n.id=e,n.type=t,i("new Peer %s",e),n.addr=null,n.conn=null,n.swarm=null,n.wire=null,n.connected=!1,n.destroyed=!1,n.timeout=null,n.retries=0,n.sentHandshake=!1}function o(){}var s=e("unordered-array-remove"),i=e("debug")("webtorrent:peer"),d=e("bittorrent-protocol"),a=e("./webconn");n.createWebRTCPeer=function(e,t){var n=new r(e.id,"webrtc");return n.conn=e,n.swarm=t,n.conn.connected?n.onConnect():(n.conn.once("connect",function(){n.onConnect()}),n.conn.once("error",function(e){n.destroy(e)}),n.startConnectTimeout()),n},n.createTCPIncomingPeer=function(e){var t=e.remoteAddress+":"+e.remotePort,n=new r(t,"tcpIncoming");return n.conn=e,n.addr=t,n.onConnect(),n},n.createTCPOutgoingPeer=function(e,t){var n=new r(e,"tcpOutgoing");return n.addr=e,n.swarm=t,n},n.createWebSeedPeer=function(e,t){var n=new r(e,"webSeed");return n.swarm=t,n.conn=new a(e,t),n.onConnect(),n},r.prototype.onConnect=function(){var e=this;if(!e.destroyed){e.connected=!0,i("Peer %s connected",e.id),clearTimeout(e.connectTimeout);var t=e.conn;t.once("end",function(){e.destroy()}),t.once("close",function(){e.destroy()}),t.once("finish",function(){e.destroy()}),t.once("error",function(t){e.destroy(t)});var n=e.wire=new d;n.type=e.type,n.once("end",function(){e.destroy()}),n.once("close",function(){e.destroy()}),n.once("finish",function(){e.destroy()}),n.once("error",function(t){e.destroy(t)}),n.once("handshake",function(t,n){e.onHandshake(t,n)}),e.startHandshakeTimeout(),t.pipe(n).pipe(t),e.swarm&&!e.sentHandshake&&e.handshake()}},r.prototype.onHandshake=function(e,t){var n=this;if(n.swarm&&!n.destroyed){if(n.swarm.destroyed)return n.destroy(new Error("swarm already destroyed"));if(e!==n.swarm.infoHash)return n.destroy(new Error("unexpected handshake info hash for this swarm"));if(t===n.swarm.peerId)return n.destroy(new Error("refusing to connect to ourselves"));i("Peer %s got handshake %s",n.id,e),clearTimeout(n.handshakeTimeout),n.retries=0;var r=n.addr;!r&&n.conn.remoteAddress&&(r=n.conn.remoteAddress+":"+n.conn.remotePort),n.swarm._onWire(n.wire,r),n.swarm&&!n.swarm.destroyed&&(n.sentHandshake||n.handshake())}},r.prototype.handshake=function(){var e=this,t={dht:!e.swarm.private&&!!e.swarm.client.dht};e.wire.handshake(e.swarm.infoHash,e.swarm.client.peerId,t),e.sentHandshake=!0},r.prototype.startConnectTimeout=function(){var e=this;clearTimeout(e.connectTimeout),e.connectTimeout=setTimeout(function(){e.destroy(new Error("connect timeout"))},"webrtc"===e.type?25e3:5e3),e.connectTimeout.unref&&e.connectTimeout.unref()},r.prototype.startHandshakeTimeout=function(){var e=this;clearTimeout(e.handshakeTimeout),e.handshakeTimeout=setTimeout(function(){e.destroy(new Error("handshake timeout"))},25e3),e.handshakeTimeout.unref&&e.handshakeTimeout.unref()},r.prototype.destroy=function(e){var t=this;if(!t.destroyed){t.destroyed=!0,t.connected=!1,i("destroy %s (error: %s)",t.id,e&&(e.message||e)),clearTimeout(t.connectTimeout),clearTimeout(t.handshakeTimeout);var n=t.swarm,r=t.conn,d=t.wire;t.swarm=null,t.conn=null,t.wire=null,n&&d&&s(n.wires,n.wires.indexOf(d)),r&&(r.on("error",o),r.destroy()),d&&d.destroy(),n&&n.removePeer(t.id)}}},{"./webconn":6,"bittorrent-protocol":14,debug:29,"unordered-array-remove":113}],4:[function(e,t){function n(e){var t=this;t._torrent=e,t._numPieces=e.pieces.length,t._pieces=[],t._onWire=function(e){t.recalculate(),t._initWire(e)},t._onWireHave=function(e){t._pieces[e]+=1},t._onWireBitfield=function(){t.recalculate()},t._torrent.wires.forEach(function(e){t._initWire(e)}),t._torrent.on("wire",t._onWire),t.recalculate()}function r(){return!0}t.exports=n,n.prototype.getRarestPiece=function(e){e||(e=r);for(var t=[],n=Infinity,o=0;o<this._numPieces;++o)if(e(o)){var s=this._pieces[o];s===n?t.push(o):s<n&&(t=[o],n=s)}return 0<t.length?t[0|Math.random()*t.length]:-1},n.prototype.destroy=function(){var e=this;e._torrent.removeListener("wire",e._onWire),e._torrent.wires.forEach(function(t){e._cleanupWireEvents(t)}),e._torrent=null,e._pieces=null,e._onWire=null,e._onWireHave=null,e._onWireBitfield=null},n.prototype._initWire=function(e){var t=this;e._onClose=function(){t._cleanupWireEvents(e);for(var n=0;n<this._numPieces;++n)t._pieces[n]-=e.peerPieces.get(n)},e.on("have",t._onWireHave),e.on("bitfield",t._onWireBitfield),e.once("close",e._onClose)},n.prototype.recalculate=function(){var e;for(e=0;e<this._numPieces;++e)this._pieces[e]=0;var t=this._torrent.wires.length;for(e=0;e<t;++e)for(var n=this._torrent.wires[e],r=0;r<this._numPieces;++r)this._pieces[r]+=n.peerPieces.get(r)},n.prototype._cleanupWireEvents=function(e){e.removeListener("have",this._onWireHave),e.removeListener("bitfield",this._onWireBitfield),e._onClose&&e.removeListener("close",e._onClose),e._onClose=null}},{}],5:[function(e,t){(function(n,r){function i(e,t,n){_.call(this),this._debugId="unknown infohash",this.client=t,this.announce=n.announce,this.urlList=n.urlList,this.path=n.path,this._store=n.store||k,this._getAnnounceOpts=n.getAnnounceOpts,this.strategy=n.strategy||"sequential",this.maxWebConns=n.maxWebConns||4,this._rechokeNumSlots=!1===n.uploads||0===n.uploads?0:+n.uploads||10,this._rechokeOptimisticWire=null,this._rechokeOptimisticTime=0,this._rechokeIntervalId=null,this.ready=!1,this.destroyed=!1,this.paused=!1,this.done=!1,this.metadata=null,this.store=null,this.files=[],this.pieces=[],this._amInterested=!1,this._selections=[],this._critical=[],this.wires=[],this._queue=[],this._peers={},this._peersLength=0,this.received=0,this.uploaded=0,this._downloadSpeed=H(),this._uploadSpeed=H(),this._servers=[],this._xsRequests=[],this._fileModtimes=n.fileModtimes,null!==e&&this._onTorrentId(e),this._debug("new torrent")}function a(e,t){return 2+o(t*e.downloadSpeed()/U.BLOCK_LENGTH)}function c(e,t,n){return 1+o(t*e.downloadSpeed()/n)}function l(e){return 0|Math.random()*e}function p(){}t.exports=i;var u=e("addr-to-ip-port"),f=e("bitfield"),h=e("chunk-store-stream/write"),m=e("debug")("webtorrent:torrent"),g=e("torrent-discovery"),_=e("events").EventEmitter,y=e("xtend"),b=e("xtend/mutable"),w=e("fs"),k=e("fs-chunk-store"),x=e("simple-get"),v=e("immediate-chunk-store"),S=e("inherits"),C=e("multistream"),E=e("net"),B=e("os"),I=e("run-parallel"),L=e("run-parallel-limit"),T=e("parse-torrent"),A=e("path"),U=e("torrent-piece"),R=e("pump"),P=e("random-iterate"),O=e("simple-sha1"),H=e("speedometer"),M=e("uniq"),q=e("ut_metadata"),j=e("ut_pex"),F=e("./file"),N=e("./peer"),D=e("./rarity-map"),W=e("./server"),z=5e3,V=3*U.BLOCK_LENGTH,G=1,K=2,X=[1e3,5e3,15e3],Y=e("../package.json").version,$="WebTorrent/"+Y+" (https://webtorrent.io)",J;try{J=A.join(w.statSync("/tmp")&&"/tmp","webtorrent")}catch(e){J=A.join("function"==typeof B.tmpdir?B.tmpdir():"/","webtorrent")}S(i,_),Object.defineProperty(i.prototype,"timeRemaining",{get:function(){return this.done?0:0===this.downloadSpeed?Infinity:1e3*((this.length-this.downloaded)/this.downloadSpeed)}}),Object.defineProperty(i.prototype,"downloaded",{get:function(){if(!this.bitfield)return 0;for(var e=0,t=0,n=this.pieces.length;t<n;++t)if(this.bitfield.get(t))e+=t===n-1?this.lastPieceLength:this.pieceLength;else{var r=this.pieces[t];e+=r.length-r.missing}return e}}),Object.defineProperty(i.prototype,"downloadSpeed",{get:function(){return this._downloadSpeed()}}),Object.defineProperty(i.prototype,"uploadSpeed",{get:function(){return this._uploadSpeed()}}),Object.defineProperty(i.prototype,"progress",{get:function(){return this.length?this.downloaded/this.length:0}}),Object.defineProperty(i.prototype,"ratio",{get:function(){return this.uploaded/(this.received||1)}}),Object.defineProperty(i.prototype,"numPeers",{get:function(){return this.wires.length}}),Object.defineProperty(i.prototype,"torrentFileBlobURL",{get:function(){if("undefined"==typeof window)throw new Error("browser-only property");return this.torrentFile?URL.createObjectURL(new Blob([this.torrentFile],{type:"application/x-bittorrent"})):null}}),Object.defineProperty(i.prototype,"_numQueued",{get:function(){return this._queue.length+(this._peersLength-this._numConns)}}),Object.defineProperty(i.prototype,"_numConns",{get:function(){var e=this,t=0;for(var n in e._peers)e._peers[n].connected&&(t+=1);return t}}),Object.defineProperty(i.prototype,"swarm",{get:function(){return console.warn("WebTorrent: `torrent.swarm` is deprecated. Use `torrent` directly instead."),this}}),i.prototype._onTorrentId=function(e){var t=this;if(!t.destroyed){var r;try{r=T(e)}catch(e){}r?(t.infoHash=r.infoHash,t._debugId=r.infoHash.toString("hex").substring(0,7),n.nextTick(function(){t.destroyed||t._onParsedTorrent(r)})):T.remote(e,function(e,n){return t.destroyed?void 0:e?t._destroy(e):void t._onParsedTorrent(n)})}},i.prototype._onParsedTorrent=function(e){var t=this;if(!t.destroyed){if(t._processParsedTorrent(e),!t.infoHash)return t._destroy(new Error("Malformed torrent data: No info hash"));(t.path||(t.path=A.join(J,t.infoHash)),t._rechokeIntervalId=setInterval(function(){t._rechoke()},1e4),t._rechokeIntervalId.unref&&t._rechokeIntervalId.unref(),t.emit("_infoHash",t.infoHash),!t.destroyed)&&(t.emit("infoHash",t.infoHash),t.destroyed||(t.client.listening?t._onListening():t.client.once("listening",function(){t._onListening()})))}},i.prototype._processParsedTorrent=function(e){this._debugId=e.infoHash.toString("hex").substring(0,7),this.announce&&(e.announce=e.announce.concat(this.announce)),this.client.tracker&&r.WEBTORRENT_ANNOUNCE&&!this.private&&(e.announce=e.announce.concat(r.WEBTORRENT_ANNOUNCE)),this.urlList&&(e.urlList=e.urlList.concat(this.urlList)),M(e.announce),M(e.urlList),b(this,e),this.magnetURI=T.toMagnetURI(e),this.torrentFile=T.toTorrentFile(e)},i.prototype._onListening=function(){function e(e){i._destroy(e)}function t(e){"string"==typeof e&&i.done||i.addPeer(e)}function n(){i.emit("trackerAnnounce"),0===i.numPeers&&i.emit("noPeers","tracker")}function r(){i.emit("dhtAnnounce"),0===i.numPeers&&i.emit("noPeers","dht")}function o(e){i.emit("warning",e)}var i=this;if(!(i.discovery||i.destroyed)){var d=i.client.tracker;d&&(d=y(i.client.tracker,{getAnnounceOpts:function(){var e={uploaded:i.uploaded,downloaded:i.downloaded,left:s(i.length-i.downloaded,0)};return i.client.tracker.getAnnounceOpts&&b(e,i.client.tracker.getAnnounceOpts()),i._getAnnounceOpts&&b(e,i._getAnnounceOpts()),e}})),i.discovery=new g({infoHash:i.infoHash,announce:i.announce,peerId:i.client.peerId,dht:!i.private&&i.client.dht,tracker:d,port:i.client.torrentPort,userAgent:$}),i.discovery.on("error",e),i.discovery.on("peer",t),i.discovery.on("trackerAnnounce",n),i.discovery.on("dhtAnnounce",r),i.discovery.on("warning",o),i.info?i._onMetadata(i):i.xs&&i._getMetadataFromServer()}},i.prototype._getMetadataFromServer=function(){function e(e,n){function r(r,o,s){if(t.destroyed)return n(null);if(t.metadata)return n(null);if(r)return t.emit("warning",new Error("http error from xs param: "+e)),n(null);if(200!==o.statusCode)return t.emit("warning",new Error("non-200 status code "+o.statusCode+" from xs param: "+e)),n(null);var i;try{i=T(s)}catch(e){}return i?i.infoHash===t.infoHash?void(t._onMetadata(i),n(null)):(t.emit("warning",new Error("got torrent file with incorrect info hash from xs param: "+e)),n(null)):(t.emit("warning",new Error("got invalid torrent file from xs param: "+e)),n(null))}if(0!==e.indexOf("http://")&&0!==e.indexOf("https://"))return t.emit("warning",new Error("skipping non-http xs param: "+e)),n(null);var o;try{o=x.concat({url:e,method:"GET",headers:{"user-agent":$}},r)}catch(r){return t.emit("warning",new Error("skipping invalid url xs param: "+e)),n(null)}t._xsRequests.push(o)}var t=this,n=Array.isArray(t.xs)?t.xs:[t.xs],r=n.map(function(t){return function(n){e(t,n)}});I(r)},i.prototype._onMetadata=function(e){var t=this;if(!(t.metadata||t.destroyed)){t._debug("got metadata"),t._xsRequests.forEach(function(e){e.abort()}),t._xsRequests=[];var n;if(e&&e.infoHash)n=e;else try{n=T(e)}catch(e){return t._destroy(e)}t._processParsedTorrent(n),t.metadata=t.torrentFile,t.client.enableWebSeeds&&t.urlList.forEach(function(e){t.addWebSeed(e)}),0!==t.pieces.length&&t.select(0,t.pieces.length-1,!1),t._rarityMap=new D(t),t.store=new v(new t._store(t.pieceLength,{torrent:{infoHash:t.infoHash},files:t.files.map(function(e){return{path:A.join(t.path,e.path),length:e.length,offset:e.offset}}),length:t.length})),t.files=t.files.map(function(e){return new F(t,e)}),t._hashes=t.pieces,t.pieces=t.pieces.map(function(e,n){var r=n===t.pieces.length-1?t.lastPieceLength:t.pieceLength;return new U(r)}),t._reservations=t.pieces.map(function(){return[]}),t.bitfield=new f(t.pieces.length),t.wires.forEach(function(e){e.ut_metadata&&e.ut_metadata.setMetadata(t.metadata),t._onWireWithMetadata(e)}),t._debug("verifying existing torrent data"),t._fileModtimes&&t._store===k?t.getFileModtimes(function(e,n){if(e)return t._destroy(e);var r=t.files.map(function(e,r){return n[r]===t._fileModtimes[r]}).every(function(e){return e});if(r){for(var o=0;o<t.pieces.length;o++)t._markVerified(o);t._onStore()}else t._verifyPieces()}):t._verifyPieces(),t.emit("metadata")}},i.prototype.getFileModtimes=function(e){var t=this,n=[];L(t.files.map(function(e,r){return function(o){w.stat(A.join(t.path,e.path),function(e,t){return e&&"ENOENT"!==e.code?o(e):void(n[r]=t&&t.mtime.getTime(),o(null))})}}),K,function(r){t._debug("done getting file modtimes"),e(r,n)})},i.prototype._verifyPieces=function(){var e=this;L(e.pieces.map(function(t,r){return function(t){return e.destroyed?t(new Error("torrent is destroyed")):void e.store.get(r,function(o,s){return e.destroyed?t(new Error("torrent is destroyed")):o?n.nextTick(t,null):void O(s,function(n){if(e.destroyed)return t(new Error("torrent is destroyed"));if(n===e._hashes[r]){if(!e.pieces[r])return;e._debug("piece verified %s",r),e._markVerified(r)}else e._debug("piece invalid %s",r);t(null)})})}}),K,function(t){return t?e._destroy(t):void(e._debug("done verifying"),e._onStore())})},i.prototype._markVerified=function(e){this.pieces[e]=null,this._reservations[e]=null,this.bitfield.set(e,!0)},i.prototype._onStore=function(){var e=this;e.destroyed||(e._debug("on store"),e.ready=!0,e.emit("ready"),e._checkDone(),e._updateSelections())},i.prototype.destroy=function(e){var t=this;t._destroy(null,e)},i.prototype._destroy=function(e,t){var n=this;if(!n.destroyed){for(var r in n.destroyed=!0,n._debug("destroy"),n.client._remove(n),clearInterval(n._rechokeIntervalId),n._xsRequests.forEach(function(e){e.abort()}),n._rarityMap&&n._rarityMap.destroy(),n._peers)n.removePeer(r);n.files.forEach(function(e){e instanceof F&&e._destroy()});var o=n._servers.map(function(e){return function(t){e.destroy(t)}});n.discovery&&o.push(function(e){n.discovery.destroy(e)}),n.store&&o.push(function(e){n.store.close(e)}),I(o,t),e&&(0===n.listenerCount("error")?n.client.emit("error",e):n.emit("error",e)),n.emit("close"),n.client=null,n.files=[],n.discovery=null,n.store=null,n._rarityMap=null,n._peers=null,n._servers=null,n._xsRequests=null}},i.prototype.addPeer=function(e){var t=this;if(t.destroyed)throw new Error("torrent is destroyed");if(!t.infoHash)throw new Error("addPeer() must not be called before the `infoHash` event");if(t.client.blocked){var n;if("string"==typeof e){var r;try{r=u(e)}catch(n){return t._debug("ignoring peer: invalid %s",e),t.emit("invalidPeer",e),!1}n=r[0]}else"string"==typeof e.remoteAddress&&(n=e.remoteAddress);if(n&&t.client.blocked.contains(n))return t._debug("ignoring peer: blocked %s",e),"string"!=typeof e&&e.destroy(),t.emit("blockedPeer",e),!1}var o=!!t._addPeer(e);return o?t.emit("peer",e):t.emit("invalidPeer",e),o},i.prototype._addPeer=function(e){var t=this;if(t.destroyed)return"string"!=typeof e&&e.destroy(),null;if("string"==typeof e&&!t._validAddr(e))return t._debug("ignoring peer: invalid %s",e),null;var n=e&&e.id||e;if(t._peers[n])return t._debug("ignoring peer: duplicate (%s)",n),"string"!=typeof e&&e.destroy(),null;if(t.paused)return t._debug("ignoring peer: torrent is paused"),"string"!=typeof e&&e.destroy(),null;t._debug("add peer %s",n);var r;return r="string"==typeof e?N.createTCPOutgoingPeer(e,t):N.createWebRTCPeer(e,t),t._peers[r.id]=r,t._peersLength+=1,"string"==typeof e&&(t._queue.push(r),t._drain()),r},i.prototype.addWebSeed=function(e){if(this.destroyed)throw new Error("torrent is destroyed");if(!/^https?:\/\/.+/.test(e))return this.emit("warning",new Error("ignoring invalid web seed: "+e)),void this.emit("invalidPeer",e);if(this._peers[e])return this.emit("warning",new Error("ignoring duplicate web seed: "+e)),void this.emit("invalidPeer",e);this._debug("add web seed %s",e);var t=N.createWebSeedPeer(e,this);this._peers[t.id]=t,this._peersLength+=1,this.emit("peer",e)},i.prototype._addIncomingPeer=function(e){var t=this;return t.destroyed?e.destroy(new Error("torrent is destroyed")):t.paused?e.destroy(new Error("torrent is paused")):void(this._debug("add incoming peer %s",e.id),t._peers[e.id]=e,t._peersLength+=1)},i.prototype.removePeer=function(e){var t=this,n=e&&e.id||e;e=t._peers[n],e&&(this._debug("removePeer %s",n),delete t._peers[n],t._peersLength-=1,e.destroy(),t._drain())},i.prototype.select=function(e,t,n,r){var o=this;if(o.destroyed)throw new Error("torrent is destroyed");if(0>e||t<e||o.pieces.length<=t)throw new Error("invalid selection ",e,":",t);n=+n||0,o._debug("select %s-%s (priority %s)",e,t,n),o._selections.push({from:e,to:t,offset:0,priority:n,notify:r||p}),o._selections.sort(function(e,t){return t.priority-e.priority}),o._updateSelections()},i.prototype.deselect=function(e,t,n){var r=this;if(r.destroyed)throw new Error("torrent is destroyed");n=+n||0,r._debug("deselect %s-%s (priority %s)",e,t,n);for(var o=0,i;o<r._selections.length;++o)if(i=r._selections[o],i.from===e&&i.to===t&&i.priority===n){r._selections.splice(o,1);break}r._updateSelections()},i.prototype.critical=function(e,t){var n=this;if(n.destroyed)throw new Error("torrent is destroyed");n._debug("critical %s-%s",e,t);for(var r=e;r<=t;++r)n._critical[r]=!0;n._updateSelections()},i.prototype._onWire=function(e,t){var r=this;if(r._debug("got wire %s (%s)",e._debugId,t||"Unknown"),e.on("download",function(e){r.destroyed||(r.received+=e,r._downloadSpeed(e),r.client._downloadSpeed(e),r.emit("download",e),r.client.emit("download",e))}),e.on("upload",function(e){r.destroyed||(r.uploaded+=e,r._uploadSpeed(e),r.client._uploadSpeed(e),r.emit("upload",e),r.client.emit("upload",e))}),r.wires.push(e),t){var o=u(t);e.remoteAddress=o[0],e.remotePort=o[1]}r.client.dht&&r.client.dht.listening&&e.on("port",function(n){return r.destroyed||r.client.dht.destroyed?void 0:e.remoteAddress?0===n||65536<n?r._debug("ignoring invalid PORT from peer"):void(r._debug("port: %s (from %s)",n,t),r.client.dht.addNode({host:e.remoteAddress,port:n})):r._debug("ignoring PORT from peer with no address")}),e.on("timeout",function(){r._debug("wire timeout (%s)",t),e.destroy()}),e.setTimeout(3e4,!0),e.setKeepAlive(!0),e.use(q(r.metadata)),e.ut_metadata.on("warning",function(e){r._debug("ut_metadata warning: %s",e.message)}),r.metadata||(e.ut_metadata.on("metadata",function(e){r._debug("got metadata via ut_metadata"),r._onMetadata(e)}),e.ut_metadata.fetch()),"function"!=typeof j||r.private||(e.use(j()),e.ut_pex.on("peer",function(e){r.done||(r._debug("ut_pex: got peer: %s (from %s)",e,t),r.addPeer(e))}),e.ut_pex.on("dropped",function(e){var n=r._peers[e];n&&!n.connected&&(r._debug("ut_pex: dropped peer: %s (from %s)",e,t),r.removePeer(e))}),e.once("close",function(){e.ut_pex.reset()})),r.emit("wire",e,t),r.metadata&&n.nextTick(function(){r._onWireWithMetadata(e)})},i.prototype._onWireWithMetadata=function(e){function t(){r.destroyed||e.destroyed||(r._numQueued>2*(r._numConns-r.numPeers)&&e.amInterested?e.destroy():(o=setTimeout(t,z),o.unref&&o.unref()))}function n(){if(e.peerPieces.buffer.length===r.bitfield.buffer.length){for(s=0;s<r.pieces.length;++s)if(!e.peerPieces.get(s))return;e.isSeeder=!0,e.choke()}}var r=this,o=null,s;e.on("bitfield",function(){n(),r._update()}),e.on("have",function(){n(),r._update()}),e.once("interested",function(){e.unchoke()}),e.once("close",function(){clearTimeout(o)}),e.on("choke",function(){clearTimeout(o),o=setTimeout(t,z),o.unref&&o.unref()}),e.on("unchoke",function(){clearTimeout(o),r._update()}),e.on("request",function(t,n,o,s){return 131072<o?e.destroy():void(r.pieces[t]||r.store.get(t,{offset:n,length:o},s))}),e.bitfield(r.bitfield),e.interested(),e.peerExtensions.dht&&r.client.dht&&r.client.dht.listening&&e.port(r.client.dht.address().port),"webSeed"!==e.type&&(o=setTimeout(t,z),o.unref&&o.unref()),e.isSeeder=!1,n()},i.prototype._updateSelections=function(){var e=this;!e.ready||e.destroyed||(n.nextTick(function(){e._gcSelections()}),e._updateInterest(),e._update())},i.prototype._gcSelections=function(){for(var e=this,t=0;t<e._selections.length;++t){for(var n=e._selections[t],r=n.offset;e.bitfield.get(n.from+n.offset)&&n.from+n.offset<n.to;)n.offset+=1;r!==n.offset&&n.notify(),n.to===n.from+n.offset&&e.bitfield.get(n.from+n.offset)&&(e._selections.splice(t,1),t-=1,n.notify(),e._updateInterest())}e._selections.length||e.emit("idle")},i.prototype._updateInterest=function(){var e=this,t=e._amInterested;e._amInterested=!!e._selections.length,e.wires.forEach(function(t){e._amInterested?t.interested():t.uninterested()}),t===e._amInterested||(e._amInterested?e.emit("interested"):e.emit("uninterested"))},i.prototype._update=function(){var e=this;if(!e.destroyed)for(var t=P(e.wires),n;n=t();)e._updateWire(n)},i.prototype._updateWire=function(e){function t(t,n,r,o){return function(s){return s>=t&&s<=n&&!(s in r)&&e.peerPieces.get(s)&&(!o||o(s))}}function n(){if(!e.requests.length)for(var n=d._selections.length;n--;){var r=d._selections[n],o;if("rarest"===d.strategy)for(var s=r.from+r.offset,i=r.to,a={},c=0,l=t(s,i,a);c<i-s+1&&(o=d._rarityMap.getRarestPiece(l),!(0>o));){if(d._request(e,o,!1))return;a[o]=!0,c+=1}else for(o=r.to;o>=r.from+r.offset;--o)if(e.peerPieces.get(o)&&d._request(e,o,!1))return}}function r(){var t=e.downloadSpeed()||1;if(t>V)return function(){return!0};var n=s(1,e.requests.length)*U.BLOCK_LENGTH/t,r=10,o=0;return function(e){if(!r||d.bitfield.get(e))return!0;for(var s=d.pieces[e].missing;o<d.wires.length;o++){var i=d.wires[o],a=i.downloadSpeed();if(!(a<V)&&!(a<=t)&&i.peerPieces.get(e)&&!(0<(s-=a*n)))return r--,!1}return!0}}function o(e){for(var t=e,n=e;n<d._selections.length&&d._selections[n].priority;n++)t=n;var r=d._selections[e];d._selections[e]=d._selections[t],d._selections[t]=r}function i(n){if(e.requests.length>=l)return!0;for(var s=r(),a=0;a<d._selections.length;a++){var i=d._selections[a],c;if("rarest"===d.strategy)for(var p=i.from+i.offset,u=i.to,f={},h=0,m=t(p,u,f,s);h<u-p+1&&(c=d._rarityMap.getRarestPiece(m),!(0>c));){for(;d._request(e,c,d._critical[c]||n););if(e.requests.length<l){f[c]=!0,h++;continue}return i.priority&&o(a),!0}else for(c=i.from+i.offset;c<=i.to;c++)if(e.peerPieces.get(c)&&s(c)){for(;d._request(e,c,d._critical[c]||n););if(!(e.requests.length<l))return i.priority&&o(a),!0}}return!1}var d=this;if(!e.peerChoking){if(!e.downloaded)return n();var c=a(e,.5);if(!(e.requests.length>=c)){var l=a(e,G);i(!1)||i(!0)}}},i.prototype._rechoke=function(){function e(e,t){return e.downloadSpeed===t.downloadSpeed?e.uploadSpeed===t.uploadSpeed?e.wire.amChoking===t.wire.amChoking?e.salt-t.salt:e.wire.amChoking?1:-1:t.uploadSpeed-e.uploadSpeed:t.downloadSpeed-e.downloadSpeed}var t=this;if(t.ready){0<t._rechokeOptimisticTime?t._rechokeOptimisticTime-=1:t._rechokeOptimisticWire=null;var n=[];t.wires.forEach(function(e){e.isSeeder||e===t._rechokeOptimisticWire||n.push({wire:e,downloadSpeed:e.downloadSpeed(),uploadSpeed:e.uploadSpeed(),salt:Math.random(),isChoked:!0})}),n.sort(e);for(var r=0,o=0;o<n.length&&r<t._rechokeNumSlots;++o)n[o].isChoked=!1,n[o].wire.peerInterested&&(r+=1);if(!t._rechokeOptimisticWire&&o<n.length&&t._rechokeNumSlots){var s=n.slice(o).filter(function(e){return e.wire.peerInterested}),i=s[l(s.length)];i&&(i.isChoked=!1,t._rechokeOptimisticWire=i.wire,t._rechokeOptimisticTime=2)}n.forEach(function(e){e.wire.amChoking!==e.isChoked&&(e.isChoked?e.wire.choke():e.wire.unchoke())})}},i.prototype._hotswap=function(e,t){var n=this,o=e.downloadSpeed();if(o<U.BLOCK_LENGTH)return!1;if(!n._reservations[t])return!1;var s=n._reservations[t];if(!s)return!1;var d=Infinity,a,c;for(c=0;c<s.length;c++){var i=s[c];if(i&&i!==e){var l=i.downloadSpeed();l>=V||2*l>o||l>d||(a=i,d=l)}}if(!a)return!1;for(c=0;c<s.length;c++)s[c]===a&&(s[c]=null);for(c=0;c<a.requests.length;c++){var p=a.requests[c];p.piece===t&&n.pieces[t].cancel(0|p.offset/U.BLOCK_LENGTH)}return n.emit("hotswap",a,e,t),!0},i.prototype._request=function(e,t,o){function s(){n.nextTick(function(){l._update()})}var l=this,p=e.requests.length,u="webSeed"===e.type;if(l.bitfield.get(t))return!1;var f=u?d(c(e,G,l.pieceLength),l.maxWebConns):a(e,G);if(p>=f)return!1;var h=l.pieces[t],m=u?h.reserveRemaining():h.reserve();if(-1===m&&o&&l._hotswap(e,t)&&(m=u?h.reserveRemaining():h.reserve()),-1===m)return!1;var g=l._reservations[t];g||(g=l._reservations[t]=[]);var r=g.indexOf(null);-1===r&&(r=g.length),g[r]=e;var i=h.chunkOffset(m),_=u?h.chunkLengthRemaining(m):h.chunkLength(m);return e.request(t,i,_,function n(o,d){if(!l.destroyed){if(!l.ready)return l.once("ready",function(){n(o,d)});if(g[r]===e&&(g[r]=null),h!==l.pieces[t])return s();if(o)return l._debug("error getting piece %s (offset: %s length: %s) from %s: %s",t,i,_,e.remoteAddress+":"+e.remotePort,o.message),u?h.cancelRemaining(m):h.cancel(m),void s();if(l._debug("got piece %s (offset: %s length: %s) from %s",t,i,_,e.remoteAddress+":"+e.remotePort),!h.set(m,d,e))return s();var a=h.flush();O(a,function(e){if(!l.destroyed){if(e===l._hashes[t]){if(!l.pieces[t])return;l._debug("piece verified %s",t),l.pieces[t]=null,l._reservations[t]=null,l.bitfield.set(t,!0),l.store.put(t,a),l.wires.forEach(function(e){e.have(t)}),l._checkDone()&&!l.destroyed&&l.discovery.complete()}else l.pieces[t]=new U(h.length),l.emit("warning",new Error("Piece "+t+" failed verification"));s()}})}}),!0},i.prototype._checkDone=function(){var e=this;if(!e.destroyed){e.files.forEach(function(t){if(!t.done){for(var n=t._startPiece;n<=t._endPiece;++n)if(!e.bitfield.get(n))return;t.done=!0,t.emit("done"),e._debug("file done: "+t.name)}});for(var t=!0,n=0,r;n<e._selections.length;n++){r=e._selections[n];for(var o=r.from;o<=r.to;o++)if(!e.bitfield.get(o)){t=!1;break}if(!t)break}return!e.done&&t&&(e.done=!0,e._debug("torrent done: "+e.infoHash),e.emit("done")),e._gcSelections(),t}},i.prototype.load=function(e,t){var n=this;if(n.destroyed)throw new Error("torrent is destroyed");if(!n.ready)return n.once("ready",function(){n.load(e,t)});Array.isArray(e)||(e=[e]),t||(t=p);var r=new C(e),o=new h(n.store,n.pieceLength);R(r,o,function(e){return e?t(e):void(n.pieces.forEach(function(e,t){n.pieces[t]=null,n._reservations[t]=null,n.bitfield.set(t,!0)}),n._checkDone(),t(null))})},i.prototype.createServer=function(e){if("function"!=typeof W)throw new Error("node.js-only method");if(this.destroyed)throw new Error("torrent is destroyed");var t=new W(this,e);return this._servers.push(t),t},i.prototype.pause=function(){this.destroyed||(this._debug("pause"),this.paused=!0)},i.prototype.resume=function(){this.destroyed||(this._debug("resume"),this.paused=!1,this._drain())},i.prototype._debug=function(){if(!this.destroyed){var e=[].slice.call(arguments);e[0]="["+this.client._debugId+"] ["+this._debugId+"] "+e[0],m.apply(null,e)}},i.prototype._drain=function(){var e=this;if(this._debug("_drain numConns %s maxConns %s",e._numConns,e.client.maxConns),!("function"!=typeof E.connect||e.destroyed||e.paused||e._numConns>=e.client.maxConns)){this._debug("drain (%s queued, %s/%s peers)",e._numQueued,e.numPeers,e.client.maxConns);var t=e._queue.shift();if(t){this._debug("tcp connect attempt to %s",t.addr);var n=u(t.addr),r={host:n[0],port:n[1]},o=t.conn=E.connect(r);o.once("connect",function(){t.onConnect()}),o.once("error",function(e){t.destroy(e)}),t.startConnectTimeout(),o.on("close",function(){if(!e.destroyed){if(t.retries>=X.length)return void e._debug("conn %s closed: will not re-add (max %s attempts)",t.addr,X.length);var n=X[t.retries];e._debug("conn %s closed: will re-add to queue in %sms (attempt %s)",t.addr,n,t.retries+1);var r=setTimeout(function(){var n=e._addPeer(t.addr);n&&(n.retries=t.retries+1)},n);r.unref&&r.unref()}})}}},i.prototype._validAddr=function(e){var t;try{t=u(e)}catch(t){return!1}var n=t[0],r=t[1];return 0<r&&65535>r&&("127.0.0.1"!==n||r!==this.client.torrentPort)}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"../package.json":125,"./file":2,"./peer":3,"./rarity-map":4,"./server":21,_process:65,"addr-to-ip-port":7,bitfield:13,"chunk-store-stream/write":25,debug:29,events:33,fs:22,"fs-chunk-store":49,"immediate-chunk-store":39,inherits:40,multistream:57,net:21,os:21,"parse-torrent":61,path:62,pump:66,"random-iterate":71,"run-parallel":88,"run-parallel-limit":87,"simple-get":92,"simple-sha1":94,speedometer:96,"torrent-discovery":108,"torrent-piece":109,uniq:112,ut_metadata:116,ut_pex:21,xtend:122,"xtend/mutable":123}],6:[function(e,t){function n(e,t){p.call(this),this.url=e,this.webPeerId=l.sync(e),this._torrent=t,this._init()}t.exports=n;var r=e("bitfield"),o=e("safe-buffer").Buffer,i=e("debug")("webtorrent:webconn"),a=e("simple-get"),c=e("inherits"),l=e("simple-sha1"),p=e("bittorrent-protocol"),u=e("../package.json").version;c(n,p),n.prototype._init=function(){var e=this;e.setKeepAlive(!0),e.once("handshake",function(t){if(!e.destroyed){e.handshake(t,e.webPeerId);for(var n=e._torrent.pieces.length,o=new r(n),s=0;s<=n;s++)o.set(s,!0);e.bitfield(o)}}),e.once("interested",function(){i("interested"),e.unchoke()}),e.on("uninterested",function(){i("uninterested")}),e.on("choke",function(){i("choke")}),e.on("unchoke",function(){i("unchoke")}),e.on("bitfield",function(){i("bitfield")}),e.on("request",function(t,n,r,o){i("request pieceIndex=%d offset=%d length=%d",t,n,r),e.httpRequest(t,n,r,o)})},n.prototype.httpRequest=function(e,t,n,r){var c=this,l=e*c._torrent.pieceLength,p=l+t,f=p+n-1,h=c._torrent.files,m;if(1>=h.length)m=[{url:c.url,start:p,end:f}];else{var g=h.filter(function(e){return e.offset<=f&&e.offset+e.length>p});if(1>g.length)return r(new Error("Could not find file corresponnding to web seed range request"));m=g.map(function(e){var t=e.offset+e.length-1,n=c.url+("/"===c.url[c.url.length-1]?"":"/")+e.path;return{url:n,fileOffsetInRange:s(e.offset-p,0),start:s(p-e.offset,0),end:d(t,f-e.offset)}})}var _=0,y=!1,b;1<m.length&&(b=o.alloc(n)),m.forEach(function(o){function s(e,t){return 200>e.statusCode||300<=e.statusCode?(y=!0,r(new Error("Unexpected HTTP status code "+e.statusCode))):void(i("Got data of length %d",t.length),1===m.length?r(null,t):(t.copy(b,o.fileOffsetInRange),++_===m.length&&r(null,b)))}var d=o.url,c=o.start,l=o.end;i("Requesting url=%s pieceIndex=%d offset=%d length=%d start=%d end=%d",d,e,t,n,c,l);var p={url:d,method:"GET",headers:{"user-agent":"WebTorrent/"+u+" (https://webtorrent.io)",range:"bytes="+c+"-"+l}};a.concat(p,function(e,t,n){return y?void 0:e?"undefined"==typeof window||d.startsWith(window.location.origin+"/")?(y=!0,r(e)):a.head(d,function(t,n){return y?void 0:t?(y=!0,r(t)):200>n.statusCode||300<=n.statusCode?(y=!0,r(new Error("Unexpected HTTP status code "+n.statusCode))):n.url===d?(y=!0,r(e)):void(p.url=n.url,a.concat(p,function(e,t,n){return y?void 0:e?(y=!0,r(e)):void s(t,n)}))}):void s(t,n)})})},n.prototype.destroy=function(){p.prototype.destroy.call(this),this._torrent=null}},{"../package.json":125,bitfield:13,"bittorrent-protocol":14,debug:29,inherits:40,"safe-buffer":90,"simple-get":92,"simple-sha1":94}],7:[function(e,t){var n=/^\[?([^\]]+)\]?:(\d+)$/,r={},o=0;t.exports=function(e){if(1e5==o&&t.exports.reset(),!r[e]){var s=n.exec(e);if(!s)throw new Error("invalid addr: "+e);r[e]=[s[1],+s[2]],o+=1}return r[e]},t.exports.reset=function(){r={},o=0}},{}],8:[function(e,t,n){"use strict";function r(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function o(e){return d[63&e>>18]+d[63&e>>12]+d[63&e>>6]+d[63&e]}function s(e,t,n){for(var r=[],s=t,i;s<n;s+=3)i=(16711680&e[s]<<16)+(65280&e[s+1]<<8)+(255&e[s+2]),r.push(o(i));return r.join("")}n.byteLength=function(e){return 3*e.length/4-r(e)},n.toByteArray=function(e){var t=e.length,n,o,s,i,d;i=r(e),d=new c(3*t/4-i),o=0<i?t-4:t;var l=0;for(n=0;n<o;n+=4)s=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],d[l++]=255&s>>16,d[l++]=255&s>>8,d[l++]=255&s;return 2===i?(s=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,d[l++]=255&s):1===i&&(s=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,d[l++]=255&s>>8,d[l++]=255&s),d},n.fromByteArray=function(e){for(var t=e.length,n=t%3,r="",o=[],a=16383,c=0,i=t-n,l;c<i;c+=a)o.push(s(e,c,c+a>i?i:c+a));return 1==n?(l=e[t-1],r+=d[l>>2],r+=d[63&l<<4],r+="=="):2==n&&(l=(e[t-2]<<8)+e[t-1],r+=d[l>>10],r+=d[63&l>>4],r+=d[63&l<<2],r+="="),o.push(r),o.join("")};for(var d=[],a=[],c="undefined"==typeof Uint8Array?Array:Uint8Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,i=l.length;p<i;++p)d[p]=l[p],a[l.charCodeAt(p)]=p;a[45]=62,a[95]=63},{}],9:[function(t,n){(function(t){function r(e,t,n){for(var r=0,o=1,s=t,i;s<n;s++){if(i=e[s],58>i&&48<=i){r=10*r+(i-48);continue}if(s!==t||43!==i){if(s===t&&45===i){o=-1;continue}if(46===i)break;throw new Error("not a number: buffer["+s+"] = "+i)}}return r*o}function o(e,n,r,s){return null==e||0===e.length?null:("number"!=typeof n&&null==s&&(s=n,n=void 0),"number"!=typeof r&&null==s&&(s=r,r=void 0),o.position=0,o.encoding=s||null,o.data=t.isBuffer(e)?e.slice(n,r):new t(e),o.bytes=o.data.length,o.next())}const s=101;o.bytes=0,o.position=0,o.data=null,o.encoding=null,o.next=function(){switch(o.data[o.position]){case 100:return o.dictionary();case 108:return o.list();case 105:return o.integer();default:return o.buffer();}},o.find=function(t){for(var n=o.position,r=o.data.length,s=o.data;n<r;){if(s[n]===t)return n;n++}throw new Error("Invalid data: Missing delimiter \""+e(t)+"\" [0x"+t.toString(16)+"]")},o.dictionary=function(){o.position++;for(var e={};o.data[o.position]!==s;)e[o.buffer()]=o.next();return o.position++,e},o.list=function(){o.position++;for(var e=[];o.data[o.position]!==s;)e.push(o.next());return o.position++,e},o.integer=function(){var e=o.find(s),t=r(o.data,o.position+1,e);return o.position+=e+1-o.position,t},o.buffer=function(){var e=o.find(58),t=r(o.data,o.position,e),n=++e+t;return o.position=n,o.encoding?o.data.toString(o.encoding,e,n):o.data.slice(e,n)},n.exports=o}).call(this,t("buffer").Buffer)},{buffer:23}],10:[function(e,t){function n(e,t,o){var s=[],i=null;return n._encode(s,e),i=r.concat(s),n.bytes=i.length,r.isBuffer(t)?(i.copy(t,o),t):i}var r=e("safe-buffer").Buffer;n.bytes=-1,n._floatConversionDetected=!1,n._encode=function(e,t){if(r.isBuffer(t))return e.push(r.from(t.length+":")),void e.push(t);if(null!=t)switch(typeof t){case"string":n.buffer(e,t);break;case"number":n.number(e,t);break;case"object":t.constructor===Array?n.list(e,t):n.dict(e,t);break;case"boolean":n.number(e,t?1:0);}};var o=r.from("e"),s=r.from("d"),d=r.from("l");n.buffer=function(e,t){e.push(r.from(r.byteLength(t)+":"+t))},n.number=function(e,t){var o=2147483648,s=(t/o<<0)*o+(t%o<<0);e.push(r.from("i"+s+"e")),s===t||n._floatConversionDetected||(n._floatConversionDetected=!0,console.warn("WARNING: Possible data corruption detected with value \""+t+"\":","Bencoding only defines support for integers, value was converted to \""+s+"\""),console.trace())},n.dict=function(e,t){e.push(s);for(var r=0,i=Object.keys(t).sort(),d=i.length,a;r<d;r++)a=i[r],null==t[a]||(n.buffer(e,a),n._encode(e,t[a]));e.push(o)},n.list=function(e,t){var r=0,s=t.length;for(e.push(d);r<s;r++)null!=t[r]&&n._encode(e,t[r]);e.push(o)},t.exports=n},{"safe-buffer":90}],11:[function(e,t){var n=t.exports;n.encode=e("./encode"),n.decode=e("./decode"),n.byteLength=n.encodingLength=function(e){return n.encode(e).length}},{"./decode":9,"./encode":10}],12:[function(e,t){t.exports=function(e,t,n,r,o){var s,i;if(void 0===r)r=0;else if(r|=0,0>r||r>=e.length)throw new RangeError("invalid lower bound");if(void 0===o)o=e.length-1;else if(o|=0,o<r||o>=e.length)throw new RangeError("invalid upper bound");for(;r<=o;)if(s=r+(o-r>>1),i=+n(e[s],t,s,e),0>i)r=s+1;else if(0<i)o=s-1;else return s;return~r}},{}],13:[function(e,t){(function(e){function n(e,t){return this instanceof n?void(0===arguments.length&&(e=0),this.grow=t&&(isFinite(t.grow)&&r(t.grow)||t.grow)||0,("number"==typeof e||void 0===e)&&(e=new o(r(e)),e.fill&&!e._isBuffer&&e.fill(0)),this.buffer=e):new n(e,t)}function r(e){var t=e>>3;return 0!=e%8&&t++,t}var o="undefined"==typeof e?Uint8Array:e;n.prototype.get=function(e){var t=e>>3;return t<this.buffer.length&&!!(this.buffer[t]&128>>e%8)},n.prototype.set=function(e,t){var n=e>>3;t||1===arguments.length?(this.buffer.length<n+1&&this._grow(s(n+1,d(2*this.buffer.length,this.grow))),this.buffer[n]|=128>>e%8):n<this.buffer.length&&(this.buffer[n]&=~(128>>e%8))},n.prototype._grow=function(e){if(this.buffer.length<e&&e<=this.grow){var t=new o(e);if(t.fill&&t.fill(0),this.buffer.copy)this.buffer.copy(t,0);else for(var n=0;n<this.buffer.length;n++)t[n]=this.buffer[n];this.buffer=t}},"undefined"!=typeof t&&(t.exports=n)}).call(this,e("buffer").Buffer)},{buffer:23}],14:[function(e,t){function n(e,t,n,r){this.piece=e,this.offset=t,this.length=n,this.callback=r}function r(){return this instanceof r?void(h.Duplex.call(this),this._debugId=u(4).toString("hex"),this._debug("new wire"),this.peerId=null,this.peerIdBuffer=null,this.type=null,this.amChoking=!0,this.amInterested=!1,this.peerChoking=!0,this.peerInterested=!1,this.peerPieces=new d(0,{grow:m}),this.peerExtensions={},this.requests=[],this.peerRequests=[],this.extendedMapping={},this.peerExtendedMapping={},this.extendedHandshake={},this.peerExtendedHandshake={},this._ext={},this._nextExt=1,this.uploaded=0,this.downloaded=0,this.uploadSpeed=f(),this.downloadSpeed=f(),this._keepAliveInterval=null,this._timeout=null,this._timeoutMs=0,this.destroyed=!1,this._finished=!1,this._parserSize=0,this._parser=null,this._buffer=[],this._bufferSize=0,this.on("finish",this._onFinish),this._parseHandshake()):new r}function o(e,t,n,r){for(var o=0,i;o<e.length;o++)if(i=e[o],i.piece===t&&i.offset===n&&i.length===r)return s(e,o),i;return null}t.exports=r;var s=e("unordered-array-remove"),i=e("bencode"),d=e("bitfield"),a=e("safe-buffer").Buffer,c=e("debug")("bittorrent-protocol"),l=e("xtend"),p=e("inherits"),u=e("randombytes"),f=e("speedometer"),h=e("readable-stream"),m=4e5,g=a.from("\x13BitTorrent protocol"),_=a.from([0,0,0,0]),y=a.from([0,0,0,1,0]),b=a.from([0,0,0,1,1]),w=a.from([0,0,0,1,2]),k=a.from([0,0,0,1,3]),x=[0,0,0,0,0,0,0,0],v=[0,0,0,3,9,0,0];p(r,h.Duplex),r.prototype.setKeepAlive=function(e){var t=this;t._debug("setKeepAlive %s",e),clearInterval(t._keepAliveInterval),!1===e||(t._keepAliveInterval=setInterval(function(){t.keepAlive()},55e3))},r.prototype.setTimeout=function(e,t){this._debug("setTimeout ms=%d unref=%s",e,t),this._clearTimeout(),this._timeoutMs=e,this._timeoutUnref=!!t,this._updateTimeout()},r.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this._debug("destroy"),this.emit("close"),this.end())},r.prototype.end=function(){this._debug("end"),this._onUninterested(),this._onChoke(),h.Duplex.prototype.end.apply(this,arguments)},r.prototype.use=function(e){function t(){}var n=e.prototype.name;if(!n)throw new Error("Extension class requires a \"name\" property on the prototype");this._debug("use extension.name=%s",n);var r=this._nextExt,o=new e(this);"function"!=typeof o.onHandshake&&(o.onHandshake=t),"function"!=typeof o.onExtendedHandshake&&(o.onExtendedHandshake=t),"function"!=typeof o.onMessage&&(o.onMessage=t),this.extendedMapping[r]=n,this._ext[n]=o,this[n]=o,this._nextExt+=1},r.prototype.keepAlive=function(){this._debug("keep-alive"),this._push(_)},r.prototype.handshake=function(e,t,n){var r,o;if("string"==typeof e?r=a.from(e,"hex"):(r=e,e=r.toString("hex")),"string"==typeof t?o=a.from(t,"hex"):(o=t,t=o.toString("hex")),20!==r.length||20!==o.length)throw new Error("infoHash and peerId MUST have length 20");this._debug("handshake i=%s p=%s exts=%o",e,t,n);var s=a.from(x);s[5]|=16,n&&n.dht&&(s[7]|=1),this._push(a.concat([g,s,r,o])),this._handshakeSent=!0,this.peerExtensions.extended&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()},r.prototype._sendExtendedHandshake=function(){var e=l(this.extendedHandshake);for(var t in e.m={},this.extendedMapping){var n=this.extendedMapping[t];e.m[n]=+t}this.extended(0,i.encode(e)),this._extendedHandshakeSent=!0},r.prototype.choke=function(){if(!this.amChoking){for(this.amChoking=!0,this._debug("choke");this.peerRequests.length;)this.peerRequests.pop();this._push(y)}},r.prototype.unchoke=function(){this.amChoking&&(this.amChoking=!1,this._debug("unchoke"),this._push(b))},r.prototype.interested=function(){this.amInterested||(this.amInterested=!0,this._debug("interested"),this._push(w))},r.prototype.uninterested=function(){this.amInterested&&(this.amInterested=!1,this._debug("uninterested"),this._push(k))},r.prototype.have=function(e){this._debug("have %d",e),this._message(4,[e],null)},r.prototype.bitfield=function(e){this._debug("bitfield"),a.isBuffer(e)||(e=e.buffer),this._message(5,[],e)},r.prototype.request=function(e,t,r,o){return o||(o=function(){}),this._finished?o(new Error("wire is closed")):this.peerChoking?o(new Error("peer is choking")):void(this._debug("request index=%d offset=%d length=%d",e,t,r),this.requests.push(new n(e,t,r,o)),this._updateTimeout(),this._message(6,[e,t,r],null))},r.prototype.piece=function(e,t,n){this._debug("piece index=%d offset=%d",e,t),this.uploaded+=n.length,this.uploadSpeed(n.length),this.emit("upload",n.length),this._message(7,[e,t],n)},r.prototype.cancel=function(e,t,n){this._debug("cancel index=%d offset=%d length=%d",e,t,n),this._callback(o(this.requests,e,t,n),new Error("request was cancelled"),null),this._message(8,[e,t,n],null)},r.prototype.port=function(e){this._debug("port %d",e);var t=a.from(v);t.writeUInt16BE(e,5),this._push(t)},r.prototype.extended=function(e,t){if(this._debug("extended ext=%s",e),"string"==typeof e&&this.peerExtendedMapping[e]&&(e=this.peerExtendedMapping[e]),"number"==typeof e){var n=a.from([e]),r=a.isBuffer(t)?t:i.encode(t);this._message(20,[],a.concat([n,r]))}else throw new Error("Unrecognized extension: "+e)},r.prototype._read=function(){},r.prototype._message=function(e,t,n){var r=n?n.length:0,o=a.allocUnsafe(5+4*t.length);o.writeUInt32BE(o.length+r-4,0),o[4]=e;for(var s=0;s<t.length;s++)o.writeUInt32BE(t[s],5+4*s);this._push(o),n&&this._push(n)},r.prototype._push=function(e){return this._finished?void 0:this.push(e)},r.prototype._onKeepAlive=function(){this._debug("got keep-alive"),this.emit("keep-alive")},r.prototype._onHandshake=function(e,t,n){var r=e.toString("hex"),o=t.toString("hex");for(var s in this._debug("got handshake i=%s p=%s exts=%o",r,o,n),this.peerId=o,this.peerIdBuffer=t,this.peerExtensions=n,this.emit("handshake",r,o,n),this._ext)this._ext[s].onHandshake(r,o,n);n.extended&&this._handshakeSent&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()},r.prototype._onChoke=function(){for(this.peerChoking=!0,this._debug("got choke"),this.emit("choke");this.requests.length;)this._callback(this.requests.pop(),new Error("peer is choking"),null)},r.prototype._onUnchoke=function(){this.peerChoking=!1,this._debug("got unchoke"),this.emit("unchoke")},r.prototype._onInterested=function(){this.peerInterested=!0,this._debug("got interested"),this.emit("interested")},r.prototype._onUninterested=function(){this.peerInterested=!1,this._debug("got uninterested"),this.emit("uninterested")},r.prototype._onHave=function(e){this.peerPieces.get(e)||(this._debug("got have %d",e),this.peerPieces.set(e,!0),this.emit("have",e))},r.prototype._onBitField=function(e){this.peerPieces=new d(e),this._debug("got bitfield"),this.emit("bitfield",this.peerPieces)},r.prototype._onRequest=function(e,t,r){var s=this;if(!s.amChoking){s._debug("got request index=%d offset=%d length=%d",e,t,r);var i=function(n,i){return d===o(s.peerRequests,e,t,r)?n?s._debug("error satisfying request index=%d offset=%d length=%d (%s)",e,t,r,n.message):void s.piece(e,t,i):void 0},d=new n(e,t,r,i);s.peerRequests.push(d),s.emit("request",e,t,r,i)}},r.prototype._onPiece=function(e,t,n){this._debug("got piece index=%d offset=%d",e,t),this._callback(o(this.requests,e,t,n.length),null,n),this.downloaded+=n.length,this.downloadSpeed(n.length),this.emit("download",n.length),this.emit("piece",e,t,n)},r.prototype._onCancel=function(e,t,n){this._debug("got cancel index=%d offset=%d length=%d",e,t,n),o(this.peerRequests,e,t,n),this.emit("cancel",e,t,n)},r.prototype._onPort=function(e){this._debug("got port %d",e),this.emit("port",e)},r.prototype._onExtended=function(e,t){if(0===e){var n;try{n=i.decode(t)}catch(e){this._debug("ignoring invalid extended handshake: %s",e.message||e)}if(!n)return;if(this.peerExtendedHandshake=n,"object"==typeof n.m)for(var r in n.m)this.peerExtendedMapping[r]=+n.m[r].toString();for(r in this._ext)this.peerExtendedMapping[r]&&this._ext[r].onExtendedHandshake(this.peerExtendedHandshake);this._debug("got extended handshake"),this.emit("extended","handshake",this.peerExtendedHandshake)}else this.extendedMapping[e]&&(e=this.extendedMapping[e],this._ext[e]&&this._ext[e].onMessage(t)),this._debug("got extended message ext=%s",e),this.emit("extended",e,t)},r.prototype._onTimeout=function(){this._debug("request timed out"),this._callback(this.requests.shift(),new Error("request has timed out"),null),this.emit("timeout")},r.prototype._write=function(e,t,n){for(this._bufferSize+=e.length,this._buffer.push(e);this._bufferSize>=this._parserSize;){var r=1===this._buffer.length?this._buffer[0]:a.concat(this._buffer);this._bufferSize-=this._parserSize,this._buffer=this._bufferSize?[r.slice(this._parserSize)]:[],this._parser(r.slice(0,this._parserSize))}n(null)},r.prototype._callback=function(e,t,n){e&&(this._clearTimeout(),!this.peerChoking&&!this._finished&&this._updateTimeout(),e.callback(t,n))},r.prototype._clearTimeout=function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)},r.prototype._updateTimeout=function(){var e=this;e._timeoutMs&&e.requests.length&&!e._timeout&&(e._timeout=setTimeout(function(){e._onTimeout()},e._timeoutMs),e._timeoutUnref&&e._timeout.unref&&e._timeout.unref())},r.prototype._parse=function(e,t){this._parserSize=e,this._parser=t},r.prototype._onMessageLength=function(e){var t=e.readUInt32BE(0);0<t?this._parse(t,this._onMessage):(this._onKeepAlive(),this._parse(4,this._onMessageLength))},r.prototype._onMessage=function(e){switch(this._parse(4,this._onMessageLength),e[0]){case 0:return this._onChoke();case 1:return this._onUnchoke();case 2:return this._onInterested();case 3:return this._onUninterested();case 4:return this._onHave(e.readUInt32BE(1));case 5:return this._onBitField(e.slice(1));case 6:return this._onRequest(e.readUInt32BE(1),e.readUInt32BE(5),e.readUInt32BE(9));case 7:return this._onPiece(e.readUInt32BE(1),e.readUInt32BE(5),e.slice(9));case 8:return this._onCancel(e.readUInt32BE(1),e.readUInt32BE(5),e.readUInt32BE(9));case 9:return this._onPort(e.readUInt16BE(1));case 20:return this._onExtended(e.readUInt8(1),e.slice(2));default:return this._debug("got unknown message"),this.emit("unknownmessage",e);}},r.prototype._parseHandshake=function(){var e=this;e._parse(1,function(t){var n=t.readUInt8(0);e._parse(n+48,function(t){var r=t.slice(0,n);return"BitTorrent protocol"===r.toString()?void(t=t.slice(n),e._onHandshake(t.slice(8,28),t.slice(28,48),{dht:!!(1&t[7]),extended:!!(16&t[5])}),e._parse(4,e._onMessageLength)):(e._debug("Error: wire not speaking BitTorrent protocol (%s)",r.toString()),void e.end())})})},r.prototype._onFinish=function(){for(this._finished=!0,this.push(null);this.read(););for(clearInterval(this._keepAliveInterval),this._parse(Number.MAX_VALUE,function(){});this.peerRequests.length;)this.peerRequests.pop();for(;this.requests.length;)this._callback(this.requests.pop(),new Error("wire was closed"),null)},r.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._debugId+"] "+e[0],c.apply(null,e)}},{bencode:11,bitfield:13,debug:29,inherits:40,randombytes:72,"readable-stream":82,"safe-buffer":90,speedometer:96,"unordered-array-remove":113,xtend:122}],15:[function(e,t){(function(n){function r(e){function t(e){n.nextTick(function(){d.emit("warning",e)})}var d=this;if(!(d instanceof r))return new r(e);if(i.call(d),e||(e={}),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");if(!n.browser&&!e.port)throw new Error("Option `port` is required");d.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),d._peerIdBuffer=o.from(d.peerId,"hex"),d._peerIdBinary=d._peerIdBuffer.toString("binary"),d.infoHash="string"==typeof e.infoHash?e.infoHash:e.infoHash.toString("hex"),d._infoHashBuffer=o.from(d.infoHash,"hex"),d._infoHashBinary=d._infoHashBuffer.toString("binary"),s("new client %s",d.infoHash),d.destroyed=!1,d._port=e.port,d._getAnnounceOpts=e.getAnnounceOpts,d._rtcConfig=e.rtcConfig,d._userAgent=e.userAgent,d._wrtc="function"==typeof e.wrtc?e.wrtc():e.wrtc;var a="string"==typeof e.announce?[e.announce]:null==e.announce?[]:e.announce;a=a.map(function(e){return e=e.toString(),"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),e}),a=u(a);var c=!1!==d._wrtc&&(!!d._wrtc||p.WEBRTC_SUPPORT);d._trackers=a.map(function(e){var n=f.parse(e).protocol;return("http:"===n||"https:"===n)&&"function"==typeof m?new m(d,e):"udp:"===n&&"function"==typeof g?new g(d,e):("ws:"===n||"wss:"===n)&&c?"ws:"===n&&"undefined"!=typeof window&&"https:"===window.location.protocol?(t(new Error("Unsupported tracker protocol: "+e)),null):new _(d,e):(t(new Error("Unsupported tracker protocol: "+e)),null)}).filter(Boolean)}t.exports=r;var o=e("safe-buffer").Buffer,s=e("debug")("bittorrent-tracker:client"),i=e("events").EventEmitter,d=e("xtend"),a=e("inherits"),c=e("once"),l=e("run-parallel"),p=e("simple-peer"),u=e("uniq"),f=e("url"),h=e("./lib/common"),m=e("./lib/client/http-tracker"),g=e("./lib/client/udp-tracker"),_=e("./lib/client/websocket-tracker");a(r,i),r.scrape=function(e,t){if(t=c(t),!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");var n=d(e,{infoHash:Array.isArray(e.infoHash)?e.infoHash[0]:e.infoHash,peerId:o.from("01234567890123456789"),port:6881}),s=new r(n);s.once("error",t),s.once("warning",t);var i=Array.isArray(e.infoHash)?e.infoHash.length:1,a={};return s.on("scrape",function(e){if(i-=1,a[e.infoHash]=e,0===i){s.destroy();var n=Object.keys(a);1===n.length?t(null,a[n[0]]):t(null,a)}}),e.infoHash=Array.isArray(e.infoHash)?e.infoHash.map(function(e){return o.from(e,"hex")}):o.from(e.infoHash,"hex"),s.scrape({infoHash:e.infoHash}),s},r.prototype.start=function(e){var t=this;s("send `start`"),e=t._defaultAnnounceOpts(e),e.event="started",t._announce(e),t._trackers.forEach(function(e){e.setInterval()})},r.prototype.stop=function(e){var t=this;s("send `stop`"),e=t._defaultAnnounceOpts(e),e.event="stopped",t._announce(e)},r.prototype.complete=function(e){var t=this;s("send `complete`"),e||(e={}),e=t._defaultAnnounceOpts(e),e.event="completed",t._announce(e)},r.prototype.update=function(e){var t=this;s("send `update`"),e=t._defaultAnnounceOpts(e),e.event&&delete e.event,t._announce(e)},r.prototype._announce=function(e){var t=this;t._trackers.forEach(function(t){t.announce(e)})},r.prototype.scrape=function(e){var t=this;s("send `scrape`"),e||(e={}),t._trackers.forEach(function(t){t.scrape(e)})},r.prototype.setInterval=function(e){var t=this;s("setInterval %d",e),t._trackers.forEach(function(t){t.setInterval(e)})},r.prototype.destroy=function(e){var t=this;if(!t.destroyed){t.destroyed=!0,s("destroy");var n=t._trackers.map(function(e){return function(t){e.destroy(t)}});l(n,e),t._trackers=[],t._getAnnounceOpts=null}},r.prototype._defaultAnnounceOpts=function(e){var t=this;return e||(e={}),null==e.numwant&&(e.numwant=h.DEFAULT_ANNOUNCE_PEERS),null==e.uploaded&&(e.uploaded=0),null==e.downloaded&&(e.downloaded=0),t._getAnnounceOpts&&(e=d(e,t._getAnnounceOpts())),e}}).call(this,e("_process"))},{"./lib/client/http-tracker":21,"./lib/client/udp-tracker":21,"./lib/client/websocket-tracker":17,"./lib/common":18,_process:65,debug:29,events:33,inherits:40,once:59,"run-parallel":88,"safe-buffer":90,"simple-peer":93,uniq:112,url:114,xtend:122}],16:[function(e,t){function n(e,t){var n=this;r.call(n),n.client=e,n.announceUrl=t,n.interval=null,n.destroyed=!1}t.exports=n;var r=e("events").EventEmitter,o=e("inherits");o(n,r),n.prototype.setInterval=function(e){var t=this;null==e&&(e=t.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(t.interval),e&&(t.interval=setInterval(function(){t.announce(t.client._defaultAnnounceOpts())},e),t.interval.unref&&t.interval.unref())}},{events:33,inherits:40}],17:[function(e,t){function o(e,t){var n=this;h.call(n,e,t),a("new websocket tracker %s",t),n.peers={},n.socket=null,n.reconnecting=!1,n.retries=0,n.reconnectTimer=null,n.expectingResponse=!1,n._openSocket()}function s(){}t.exports=o;var a=e("debug")("bittorrent-tracker:websocket-tracker"),i=e("xtend"),c=e("inherits"),l=e("simple-peer"),p=e("randombytes"),u=e("simple-websocket"),f=e("../common"),h=e("./tracker"),m={};c(o,h),o.prototype.DEFAULT_ANNOUNCE_INTERVAL=3e4,o.prototype.announce=function(e){var t=this;if(!(t.destroyed||t.reconnecting)){if(!t.socket.connected)return void t.socket.once("connect",function(){t.announce(e)});var n=i(e,{action:"announce",info_hash:t.client._infoHashBinary,peer_id:t.client._peerIdBinary});if(t._trackerId&&(n.trackerid=t._trackerId),"stopped"===e.event||"completed"===e.event)t._send(n);else{var r=d(e.numwant,10);t._generateOffers(r,function(e){n.numwant=r,n.offers=e,t._send(n)})}}},o.prototype.scrape=function(e){var t=this;if(!(t.destroyed||t.reconnecting)){if(!t.socket.connected)return void t.socket.once("connect",function(){t.scrape(e)});var n=Array.isArray(e.infoHash)&&0<e.infoHash.length?e.infoHash.map(function(e){return e.toString("binary")}):e.infoHash&&e.infoHash.toString("binary")||t.client._infoHashBinary;t._send({action:"scrape",info_hash:n})}},o.prototype.destroy=function(e){function t(){d&&(clearTimeout(d),d=null),i.removeListener("data",t),i.destroy(),i=null}var n=this;if(e||(e=s),n.destroyed)return e(null);for(var r in n.destroyed=!0,clearInterval(n.interval),clearTimeout(n.reconnectTimer),n.peers){var o=n.peers[r];clearTimeout(o.trackerTimeout),o.destroy()}if(n.peers=null,n.socket&&(n.socket.removeListener("connect",n._onSocketConnectBound),n.socket.removeListener("data",n._onSocketDataBound),n.socket.removeListener("close",n._onSocketCloseBound),n.socket.removeListener("error",n._onSocketErrorBound),n.socket=null),n._onSocketConnectBound=null,n._onSocketErrorBound=null,n._onSocketDataBound=null,n._onSocketCloseBound=null,m[n.announceUrl]&&(m[n.announceUrl].consumers-=1),0<m[n.announceUrl].consumers)return e();var i=m[n.announceUrl];if(delete m[n.announceUrl],i.on("error",s),i.once("close",e),!n.expectingResponse)return t();var d=setTimeout(t,f.DESTROY_TIMEOUT);i.once("data",t)},o.prototype._openSocket=function(){var e=this;e.destroyed=!1,e.peers||(e.peers={}),e._onSocketConnectBound=function(){e._onSocketConnect()},e._onSocketErrorBound=function(t){e._onSocketError(t)},e._onSocketDataBound=function(t){e._onSocketData(t)},e._onSocketCloseBound=function(){e._onSocketClose()},e.socket=m[e.announceUrl],e.socket?m[e.announceUrl].consumers+=1:(e.socket=m[e.announceUrl]=new u(e.announceUrl),e.socket.consumers=1,e.socket.once("connect",e._onSocketConnectBound)),e.socket.on("data",e._onSocketDataBound),e.socket.once("close",e._onSocketCloseBound),e.socket.once("error",e._onSocketErrorBound)},o.prototype._onSocketConnect=function(){var e=this;e.destroyed||e.reconnecting&&(e.reconnecting=!1,e.retries=0,e.announce(e.client._defaultAnnounceOpts()))},o.prototype._onSocketData=function(e){var t=this;if(!t.destroyed){t.expectingResponse=!1;try{e=JSON.parse(e)}catch(e){return void t.client.emit("warning",new Error("Invalid tracker response"))}"announce"===e.action?t._onAnnounceResponse(e):"scrape"===e.action?t._onScrapeResponse(e):t._onSocketError(new Error("invalid action in WS response: "+e.action))}},o.prototype._onAnnounceResponse=function(e){var t=this;if(e.info_hash!==t.client._infoHashBinary)return void a("ignoring websocket data from %s for %s (looking for %s: reused socket)",t.announceUrl,f.binaryToHex(e.info_hash),t.client.infoHash);if(!(e.peer_id&&e.peer_id===t.client._peerIdBinary)){a("received %s from %s for %s",JSON.stringify(e),t.announceUrl,t.client.infoHash);var n=e["failure reason"];if(n)return t.client.emit("warning",new Error(n));var r=e["warning message"];r&&t.client.emit("warning",new Error(r));var o=e.interval||e["min interval"];o&&t.setInterval(1e3*o);var s=e["tracker id"];if(s&&(t._trackerId=s),null!=e.complete){var i=Object.assign({},e,{announce:t.announceUrl,infoHash:f.binaryToHex(e.info_hash)});t.client.emit("update",i)}var d;if(e.offer&&e.peer_id&&(a("creating peer (from remote offer)"),d=t._createPeer(),d.id=f.binaryToHex(e.peer_id),d.once("signal",function(n){var r={action:"announce",info_hash:t.client._infoHashBinary,peer_id:t.client._peerIdBinary,to_peer_id:e.peer_id,answer:n,offer_id:e.offer_id};t._trackerId&&(r.trackerid=t._trackerId),t._send(r)}),d.signal(e.offer),t.client.emit("peer",d)),e.answer&&e.peer_id){var c=f.binaryToHex(e.offer_id);d=t.peers[c],d?(d.id=f.binaryToHex(e.peer_id),d.signal(e.answer),t.client.emit("peer",d),clearTimeout(d.trackerTimeout),d.trackerTimeout=null,delete t.peers[c]):a("got unexpected answer: "+JSON.stringify(e.answer))}}},o.prototype._onScrapeResponse=function(e){var t=this;e=e.files||{};var n=Object.keys(e);return 0===n.length?void t.client.emit("warning",new Error("invalid scrape response")):void n.forEach(function(n){var r=Object.assign(e[n],{announce:t.announceUrl,infoHash:f.binaryToHex(n)});t.client.emit("scrape",r)})},o.prototype._onSocketClose=function(){var e=this;e.destroyed||(e.destroy(),e._startReconnectTimer())},o.prototype._onSocketError=function(e){var t=this;t.destroyed||(t.destroy(),t.client.emit("warning",e),t._startReconnectTimer())},o.prototype._startReconnectTimer=function(){var e=this,t=r(3e4*Math.random())+d(15e3*n(2,e.retries),18e5);e.reconnecting=!0,clearTimeout(e.reconnectTimer),e.reconnectTimer=setTimeout(function(){e.retries++,e._openSocket()},t),e.reconnectTimer.unref&&e.reconnectTimer.unref(),a("reconnecting socket in %s ms",t)},o.prototype._send=function(e){var t=this;if(!t.destroyed){t.expectingResponse=!0;var n=JSON.stringify(e);a("send %s",n),t.socket.send(n)}},o.prototype._generateOffers=function(e,t){function n(){var e=p(20).toString("hex");a("creating peer (from _generateOffers)");var t=o.peers[e]=o._createPeer({initiator:!0});t.once("signal",function(t){s.push({offer:t,offer_id:f.hexToBinary(e)}),r()}),t.trackerTimeout=setTimeout(function(){a("tracker timeout: destroying peer"),t.trackerTimeout=null,delete o.peers[e],t.destroy()},5e4),t.trackerTimeout.unref&&t.trackerTimeout.unref()}function r(){s.length===e&&(a("generated %s offers",e),t(s))}var o=this,s=[];a("generating %s offers",e);for(var d=0;d<e;++d)n();r()},o.prototype._createPeer=function(e){function t(e){r.client.emit("warning",new Error("Connection error: "+e.message)),o.destroy()}function n(){o.removeListener("error",t),o.removeListener("connect",n)}var r=this;e=Object.assign({trickle:!1,config:r.client._rtcConfig,wrtc:r.client._wrtc},e);var o=new l(e);return o.once("error",t),o.once("connect",n),o}},{"../common":18,"./tracker":16,debug:29,inherits:40,randombytes:72,"simple-peer":93,"simple-websocket":95,xtend:122}],18:[function(e,t,n){var r=e("safe-buffer").Buffer,o=e("xtend/mutable");n.DEFAULT_ANNOUNCE_PEERS=50,n.MAX_ANNOUNCE_PEERS=82,n.binaryToHex=function(e){return"string"!=typeof e&&(e+=""),r.from(e,"binary").toString("hex")},n.hexToBinary=function(e){return"string"!=typeof e&&(e+=""),r.from(e,"hex").toString("binary")};var s=e("./common-node");o(n,s)},{"./common-node":21,"safe-buffer":90,"xtend/mutable":123}],19:[function(e,t){(function(n){t.exports=function(e,t){function r(s){o.removeEventListener("loadend",r,!1),s.error?t(s.error):t(null,n.from(o.result))}if("undefined"==typeof Blob||!(e instanceof Blob))throw new Error("first argument must be a Blob");if("function"!=typeof t)throw new Error("second argument must be a function");var o=new FileReader;o.addEventListener("loadend",r,!1),o.readAsArrayBuffer(e)}}).call(this,e("buffer").Buffer)},{buffer:23}],20:[function(e,t){(function(n){function r(e,t){return this instanceof r?void(s.call(this),!t&&(t={}),"object"==typeof e&&(t=e,e=t.size),this.size=e||512,this._zeroPadding=!t.nopad&&i(t.zeroPadding,!0),this._buffered=[],this._bufferedBytes=0):new r(e,t)}var o=e("inherits"),s=e("readable-stream").Transform,i=e("defined");t.exports=r,o(r,s),r.prototype._transform=function(e,t,r){for(this._bufferedBytes+=e.length,this._buffered.push(e);this._bufferedBytes>=this.size;){var o=n.concat(this._buffered);this._bufferedBytes-=this.size,this.push(o.slice(0,this.size)),this._buffered=[o.slice(this.size,o.length)]}r()},r.prototype._flush=function(){if(this._bufferedBytes&&this._zeroPadding){var e=new n(this.size-this._bufferedBytes);e.fill(0),this._buffered.push(e),this.push(n.concat(this._buffered)),this._buffered=null}else this._bufferedBytes&&(this.push(n.concat(this._buffered)),this._buffered=null);this.push(null)}}).call(this,e("buffer").Buffer)},{buffer:23,defined:31,inherits:40,"readable-stream":82}],21:[function(){},{}],22:[function(e,t,n){arguments[4][21][0].apply(n,arguments)},{dup:21}],23:[function(t,r,o){"use strict";function s(e){if(e>J)throw new RangeError("Invalid typed array length");var t=new Uint8Array(e);return t.__proto__=c.prototype,t}function c(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return p(e)}return i(e,t,n)}function i(e,t,n){if("number"==typeof e)throw new TypeError("\"value\" argument must not be a number");return K(e)||e&&K(e.buffer)?h(e,t,n):"string"==typeof e?u(e,t):m(e)}function a(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be of type number");else if(0>e)throw new RangeError("\"size\" argument must not be negative")}function l(e,t,n){return a(e),0>=e?s(e):void 0===t?s(e):"string"==typeof n?s(e).fill(t,n):s(e).fill(t)}function p(e){return a(e),s(0>e?0:0|g(e))}function u(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|_(e,t),r=s(n),o=r.write(e,t);return o!==n&&(r=r.slice(0,o)),r}function f(e){for(var t=0>e.length?0:0|g(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e,t,n){if(0>t||e.byteLength<t)throw new RangeError("\"offset\" is outside of buffer bounds");if(e.byteLength<t+(n||0))throw new RangeError("\"length\" is outside of buffer bounds");var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),r.__proto__=c.prototype,r}function m(e){if(c.isBuffer(e)){var t=0|g(e.length),n=s(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}if(e){if(ArrayBuffer.isView(e)||"length"in e)return"number"!=typeof e.length||X(e.length)?s(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}function g(e){if(e>=J)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+J.toString(16)+" bytes");return 0|e}function _(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(r)return D(e).length;t=(""+t).toLowerCase(),r=!0;}}function y(e,t,n){var r=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),0>=n)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return L(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return U(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0;}}function b(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function w(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,X(n)&&(n=o?0:e.length-1),0>n&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(0>n)if(o)n=0;else return-1;if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:k(e,t,n,r,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):k(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function k(e,t,n,r,o){function s(e,t){return 1==d?e[t]:e.readUInt16BE(t*d)}var d=1,a=e.length,c=t.length;if(void 0!==r&&(r=(r+"").toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(2>e.length||2>t.length)return-1;d=2,a/=2,c/=2,n/=2}var l;if(o){var i=-1;for(l=n;l<a;l++)if(s(e,l)!==s(t,-1==i?0:l-i))-1!=i&&(l-=l-i),i=-1;else if(-1==i&&(i=l),l-i+1===c)return i*d}else for(n+c>a&&(n=a-c),l=n;0<=l;l--){for(var p=!0,u=0;u<c;u++)if(s(e,l+u)!==s(t,u)){p=!1;break}if(p)return l}return-1}function x(e,t,n,r){n=+n||0;var o=e.length-n;r?(r=+r,r>o&&(r=o)):r=o;var s=t.length;r>s/2&&(r=s/2);for(var d=0,i;d<r;++d){if(i=parseInt(t.substr(2*d,2),16),X(i))return d;e[n+d]=i}return d}function v(e,t,n,r){return G(D(t,e.length-n),e,n,r)}function S(e,t,n,r){return G(W(t),e,n,r)}function C(e,t,n,r){return S(e,t,n,r)}function E(e,t,n,r){return G(V(t),e,n,r)}function B(e,t,n,r){return G(z(t,e.length-n),e,n,r)}function I(e,t,n){return 0===t&&n===e.length?Y.fromByteArray(e):Y.fromByteArray(e.slice(t,n))}function L(e,t,n){n=d(e.length,n);for(var r=[],o=t;o<n;){var s=e[o],i=null,a=239<s?4:223<s?3:191<s?2:1;if(o+a<=n){var c,l,p,u;1==a?128>s&&(i=s):2==a?(c=e[o+1],128==(192&c)&&(u=(31&s)<<6|63&c,127<u&&(i=u))):3==a?(c=e[o+1],l=e[o+2],128==(192&c)&&128==(192&l)&&(u=(15&s)<<12|(63&c)<<6|63&l,2047<u&&(55296>u||57343<u)&&(i=u))):4==a?(c=e[o+1],l=e[o+2],p=e[o+3],128==(192&c)&&128==(192&l)&&128==(192&p)&&(u=(15&s)<<18|(63&c)<<12|(63&l)<<6|63&p,65535<u&&1114112>u&&(i=u))):void 0}null===i?(i=65533,a=1):65535<i&&(i-=65536,r.push(55296|1023&i>>>10),i=56320|1023&i),r.push(i),o+=a}return T(r)}function T(t){var n=t.length;if(n<=Q)return e.apply(String,t);for(var r="",o=0;o<n;)r+=e.apply(String,t.slice(o,o+=Q));return r}function A(t,n,r){var o="";r=d(t.length,r);for(var s=n;s<r;++s)o+=e(127&t[s]);return o}function U(t,n,r){var o="";r=d(t.length,r);for(var s=n;s<r;++s)o+=e(t[s]);return o}function R(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var o="",s=t;s<n;++s)o+=N(e[s]);return o}function P(t,n,r){for(var o=t.slice(n,r),s="",d=0;d<o.length;d+=2)s+=e(o[d]+256*o[d+1]);return s}function O(e,t,n){if(0!=e%1||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function H(e,t,n,r,o,s){if(!c.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(t>o||t<s)throw new RangeError("\"value\" argument is out of bounds");if(n+r>e.length)throw new RangeError("Index out of range")}function M(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function q(e,t,n,r,o){return t=+t,n>>>=0,o||M(e,t,n,4,34028234663852886e22,-34028234663852886e22),$.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,o){return t=+t,n>>>=0,o||M(e,t,n,8,17976931348623157e292,-17976931348623157e292),$.write(e,t,n,r,52,8),n+8}function F(e){if(e=e.split("=")[0],e=e.trim().replace(Z,""),2>e.length)return"";for(;0!=e.length%4;)e+="=";return e}function N(e){return 16>e?"0"+e.toString(16):e.toString(16)}function D(e,t){t=t||Infinity;for(var n=e.length,r=null,o=[],s=0,i;s<n;++s){if(i=e.charCodeAt(s),55295<i&&57344>i){if(!r){if(56319<i){-1<(t-=3)&&o.push(239,191,189);continue}else if(s+1===n){-1<(t-=3)&&o.push(239,191,189);continue}r=i;continue}if(56320>i){-1<(t-=3)&&o.push(239,191,189),r=i;continue}i=(r-55296<<10|i-56320)+65536}else r&&-1<(t-=3)&&o.push(239,191,189);if(r=null,128>i){if(0>(t-=1))break;o.push(i)}else if(2048>i){if(0>(t-=2))break;o.push(192|i>>6,128|63&i)}else if(65536>i){if(0>(t-=3))break;o.push(224|i>>12,128|63&i>>6,128|63&i)}else if(1114112>i){if(0>(t-=4))break;o.push(240|i>>18,128|63&i>>12,128|63&i>>6,128|63&i)}else throw new Error("Invalid code point")}return o}function W(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function z(e,t){for(var n=[],r=0,o,s,i;r<e.length&&!(0>(t-=2));++r)o=e.charCodeAt(r),s=o>>8,i=o%256,n.push(i),n.push(s);return n}function V(e){return Y.toByteArray(F(e))}function G(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function K(e){return e instanceof ArrayBuffer||null!=e&&null!=e.constructor&&"ArrayBuffer"===e.constructor.name&&"number"==typeof e.byteLength}function X(e){return e!==e}var Y=t("base64-js"),$=t("ieee754");o.Buffer=c,o.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},o.INSPECT_MAX_BYTES=50;var J=2147483647;o.kMaxLength=J,c.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{get:function(){return this instanceof c?this.buffer:void 0}}),Object.defineProperty(c.prototype,"offset",{get:function(){return this instanceof c?this.byteOffset:void 0}}),"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),c.poolSize=8192,c.from=function(e,t,n){return i(e,t,n)},c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,c.alloc=function(e,t,n){return l(e,t,n)},c.allocUnsafe=function(e){return p(e)},c.allocUnsafeSlow=function(e){return p(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,s=d(n,r);o<s;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(ArrayBuffer.isView(s)&&(s=c.from(s)),!c.isBuffer(s))throw new TypeError("\"list\" argument must be an Array of Buffers");s.copy(r,o),o+=s.length}return r},c.byteLength=_,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},c.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?L(this,0,e):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",t=o.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),0>t||n>e.length||0>r||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var s=o-r,a=n-t,l=d(s,a),p=this.slice(r,o),u=e.slice(t,n),f=0;f<l;++f)if(p[f]!==u[f]){s=p[f],a=u[f];break}return s<a?-1:a<s?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return w(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return w(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-t;if((void 0===n||n>o)&&(n=o),0<e.length&&(0>n||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return x(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return S(this,e,t,n);case"latin1":case"binary":return C(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0;}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;c.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=c.prototype,r},c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],o=1,s=0;++s<t&&(o*=256);)r+=this[e+s]*o;return r},c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e+--t],o=1;0<t&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var o=this[e],s=1,d=0;++d<t&&(s*=256);)o+=this[e+d]*s;return s*=128,o>=s&&(o-=n(2,8*t)),o},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var o=t,s=1,i=this[e+--o];0<o&&(s*=256);)i+=this[e+--o]*s;return s*=128,i>=s&&(i-=n(2,8*t)),i},c.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),$.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),$.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),$.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),$.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,o){if(e=+e,t>>>=0,r>>>=0,!o){var s=n(2,8*r)-1;H(this,e,t,r,s,0)}var d=1,a=0;for(this[t]=255&e;++a<r&&(d*=256);)this[t+a]=255&e/d;return t+r},c.prototype.writeUIntBE=function(e,t,r,o){if(e=+e,t>>>=0,r>>>=0,!o){var s=n(2,8*r)-1;H(this,e,t,r,s,0)}var d=r-1,i=1;for(this[t+d]=255&e;0<=--d&&(i*=256);)this[t+d]=255&e/i;return t+r},c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeIntLE=function(e,t,r,o){if(e=+e,t>>>=0,!o){var s=n(2,8*r-1);H(this,e,t,r,s-1,-s)}var d=0,i=1,a=0;for(this[t]=255&e;++d<r&&(i*=256);)0>e&&0==a&&0!==this[t+d-1]&&(a=1),this[t+d]=255&(e/i>>0)-a;return t+r},c.prototype.writeIntBE=function(e,t,r,o){if(e=+e,t>>>=0,!o){var s=n(2,8*r-1);H(this,e,t,r,s-1,-s)}var d=r-1,i=1,a=0;for(this[t+d]=255&e;0<=--d&&(i*=256);)0>e&&0==a&&0!==this[t+d+1]&&(a=1),this[t+d]=255&(e/i>>0)-a;return t+r},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||H(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeFloatLE=function(e,t,n){return q(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return q(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var s=o-1;0<=s;--s)e[s+t]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var o=e.charCodeAt(0);("utf8"===r&&128>o||"latin1"===r)&&(e=o)}}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var i=c.isBuffer(e)?e:new c(e,r),d=i.length;if(0===d)throw new TypeError("The value \""+e+"\" is invalid for argument \"value\"");for(s=0;s<n-t;++s)this[s+t]=i[s%d]}return this};var Z=/[^+/0-9A-Za-z-_]/g},{"base64-js":8,ieee754:38}],24:[function(e,t){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],25:[function(e,t){function n(e,t,o){var i=this;if(!(i instanceof n))return new n(e,t,o);if(s.Writable.call(i,o),o||(o={}),!e||!e.put||!e.get)throw new Error("First argument must be an abstract-chunk-store compliant store");if(t=+t,!t)throw new Error("Second argument must be a chunk length");i._blockstream=new r(t,{zeroPadding:!1}),i._blockstream.on("data",function(t){i.destroyed||(e.put(d,t),d+=1)}).on("error",function(e){i.destroy(e)});var d=0;i.on("finish",function(){this._blockstream.end()})}t.exports=n;var r=e("block-stream2"),o=e("inherits"),s=e("readable-stream");o(n,s.Writable),n.prototype._write=function(e,t,n){this._blockstream.write(e,t,n)},n.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,e&&this.emit("error",e),this.emit("close"))}},{"block-stream2":20,inherits:40,"readable-stream":82}],26:[function(e,n){n.exports=function(e,n,r){for(var o=Infinity,s=0,d=n.length-1,a,i,c;s<=d&&(a=s+(d-s>>1),c=n[a]-e,0>c?s=a+1:0<c?d=a-1:void 0,c=t(c),c<o&&(o=c,i=a),n[a]!==e););return r?i:n[i]}},{}],27:[function(e,t,n){(function(e){function t(e){return Object.prototype.toString.call(e)}n.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},n.isBoolean=function(e){return"boolean"==typeof e},n.isNull=function(e){return null===e},n.isNullOrUndefined=function(e){return null==e},n.isNumber=function(e){return"number"==typeof e},n.isString=function(e){return"string"==typeof e},n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=function(e){return void 0===e},n.isRegExp=function(e){return"[object RegExp]"===t(e)},n.isObject=function(e){return"object"==typeof e&&null!==e},n.isDate=function(e){return"[object Date]"===t(e)},n.isError=function(n){return"[object Error]"===t(n)||n instanceof Error},n.isFunction=function(e){return"function"==typeof e},n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e},n.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":42}],28:[function(e,t){(function(n,r,s){function i(e,t,n){return"function"==typeof t?i(e,null,t):void(t=t?B(t):{},a(e,t,function(e,r,o){return e?n(e):void(t.singleFileTorrent=o,h(r,t,n))}))}function d(e,t,n){return"function"==typeof t?d(e,null,t):void(t=t?B(t):{},a(e,t,n))}function a(e,t,r){function o(){O(e.map(function(e){return function(t){var n={};if(g(e))n.getStream=b(e),n.length=e.size;else if(s.isBuffer(e))n.getStream=w(e),n.length=e.length;else if(y(e))n.getStream=x(e,n),n.length=0;else{if("string"==typeof e){if("function"!=typeof T.stat)throw new Error("filesystem paths do not work in the browser");var r=1<i||a;return void c(e,r,t)}throw new Error("invalid input type")}n.path=e.path,t(null,n)}}),function(e,t){return e?r(e):void(t=L(t),r(null,t,a))})}if(Array.isArray(e)&&0===e.length)throw new Error("invalid input type");_(e)&&(e=Array.prototype.slice.call(e)),Array.isArray(e)||(e=[e]),e=e.map(function(e){return g(e)&&"string"==typeof e.path&&"function"==typeof T.stat?e.path:e}),1!==e.length||"string"==typeof e[0]||e[0].name||(e[0].name=t.name);var d=null;e.forEach(function(t,n){if("string"!=typeof t){var r=t.fullPath||t.name;r||(r="Unknown File "+(n+1),t.unknownName=!0),t.path=r.split("/"),t.path[0]||t.path.shift(),2>t.path.length?d=null:0===n&&1<e.length?d=t.path[0]:t.path[0]!==d&&(d=null)}}),e=e.filter(function(e){if("string"==typeof e)return!0;var t=e.path[e.path.length-1];return u(t)&&U.not(t)}),d&&e.forEach(function(e){var t=(s.isBuffer(e)||y(e))&&!e.path;"string"==typeof e||t||e.path.shift()}),!t.name&&d&&(t.name=d),t.name||e.some(function(e){return"string"==typeof e?(t.name=E.basename(e),!0):e.unknownName?void 0:(t.name=e.path[e.path.length-1],!0)}),t.name||(t.name="Unnamed Torrent "+Date.now());var i=e.reduce(function(e,t){return e+ +("string"==typeof t)},0),a=1===e.length;if(1===e.length&&"string"==typeof e[0]){if("function"!=typeof T.stat)throw new Error("filesystem paths do not work in the browser");A(e[0],function(e,t){return e?r(e):void(a=t,o())})}else n.nextTick(function(){o()})}function c(e,t,n){p(e,l,function(r,o){return r?n(r):void(o=Array.isArray(o)?L(o):[o],e=E.normalize(e),t&&(e=e.slice(0,e.lastIndexOf(E.sep)+1)),e[e.length-1]!==E.sep&&(e+=E.sep),o.forEach(function(t){t.getStream=k(t.path),t.path=t.path.replace(e,"").split(E.sep)}),n(null,o))})}function l(e,t){t=P(t),T.stat(e,function(n,r){if(n)return t(n);var o={length:r.size,path:e};t(null,o)})}function p(e,t,n){T.stat(e,function(r,o){return r?n(r):void(o.isDirectory()?T.readdir(e,function(r,o){return r?n(r):void O(o.filter(u).filter(U.not).map(function(n){return function(r){p(E.join(e,n),t,r)}}),n)}):o.isFile()&&t(e,n))})}function u(e){return"."!==e[0]}function f(e,t,n){function r(e){l+=e.length;var t=f;H(e,function(e){c[t]=e,u-=1,a()}),u+=1,f+=1}function o(){h=!0,a()}function i(e){d(),n(e)}function d(){m.removeListener("error",i),g.removeListener("data",r),g.removeListener("end",o),g.removeListener("error",i)}function a(){h&&0==u&&(d(),n(null,s.from(c.join(""),"hex"),l))}n=P(n);var c=[],l=0,p=e.map(function(e){return e.getStream}),u=0,f=0,h=!1,m=new R(p),g=new S(t,{zeroPadding:!1});m.on("error",i),m.pipe(g).on("data",r).on("end",o).on("error",i)}function h(e,n,s){var i=n.announceList;i||("string"==typeof n.announce?i=[[n.announce]]:Array.isArray(n.announce)&&(i=n.announce.map(function(e){return[e]}))),i||(i=[]),r.WEBTORRENT_ANNOUNCE&&("string"==typeof r.WEBTORRENT_ANNOUNCE?i.push([[r.WEBTORRENT_ANNOUNCE]]):Array.isArray(r.WEBTORRENT_ANNOUNCE)&&(i=i.concat(r.WEBTORRENT_ANNOUNCE.map(function(e){return[e]})))),void 0===n.announce&&void 0===n.announceList&&(i=i.concat(t.exports.announceList)),"string"==typeof n.urlList&&(n.urlList=[n.urlList]);var d={info:{name:n.name},"creation date":o((+n.creationDate||Date.now())/1e3),encoding:"UTF-8"};0!==i.length&&(d.announce=i[0][0],d["announce-list"]=i),void 0!==n.comment&&(d.comment=n.comment),void 0!==n.createdBy&&(d["created by"]=n.createdBy),void 0!==n.private&&(d.info.private=+n.private),void 0!==n.sslCert&&(d.info["ssl-cert"]=n.sslCert),void 0!==n.urlList&&(d["url-list"]=n.urlList);var a=n.pieceLength||C(e.reduce(m,0));d.info["piece length"]=a,f(e,a,function(t,r,o){return t?s(t):void(d.info.pieces=r,e.forEach(function(e){delete e.getStream}),n.singleFileTorrent?d.info.length=o:d.info.files=e,s(null,v.encode(d)))})}function m(e,t){return e+t.length}function g(e){return"undefined"!=typeof Blob&&e instanceof Blob}function _(e){return"undefined"!=typeof FileList&&e instanceof FileList}function y(e){return"object"==typeof e&&null!=e&&"function"==typeof e.pipe}function b(e){return function(){return new I(e)}}function w(e){return function(){var t=new M.PassThrough;return t.end(e),t}}function k(e){return function(){return T.createReadStream(e)}}function x(e,t){return function(){var n=new M.Transform;return n._transform=function(e,n,r){t.length+=e.length,this.push(e),r()},e.pipe(n),n}}t.exports=i,t.exports.parseInput=d,t.exports.announceList=[["udp://tracker.leechers-paradise.org:6969"],["udp://tracker.coppersurfer.tk:6969"],["udp://tracker.opentrackr.org:1337"],["udp://explodie.org:6969"],["udp://tracker.empire-js.us:1337"],["wss://tracker.btorrent.xyz"],["wss://tracker.openwebtorrent.com"],["wss://tracker.fastcast.nz"]];var v=e("bencode"),S=e("block-stream2"),C=e("piece-length"),E=e("path"),B=e("xtend"),I=e("filestream/read"),L=e("flatten"),T=e("fs"),A=e("is-file"),U=e("junk"),R=e("multistream"),P=e("once"),O=e("run-parallel"),H=e("simple-sha1"),M=e("readable-stream")}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,e("buffer").Buffer)},{_process:65,bencode:11,"block-stream2":20,buffer:23,"filestream/read":34,flatten:35,fs:22,"is-file":43,junk:46,multistream:57,once:59,path:62,"piece-length":63,"readable-stream":82,"run-parallel":88,"simple-sha1":94,xtend:122}],29:[function(e,t,n){(function(o){function r(){var e;try{e=n.storage.debug}catch(t){}return!e&&"undefined"!=typeof o&&"env"in o&&(e=o.env.DEBUG),e}n=t.exports=e("./debug"),n.log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!!t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"===e||(o++,"%c"===e&&(s=o))}),e.splice(s,0,r)}},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(t){}},n.load=r,n.useColors=function(){return"undefined"!=typeof window&&window.process&&"renderer"===window.process.type||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},n.enable(r())}).call(this,e("_process"))},{"./debug":30,_process:65}],30:[function(e,n,r){function o(e){var n=0,o;for(o in e)n=(n<<5)-n+e.charCodeAt(o),n|=0;return r.colors[t(n)%r.colors.length]}function s(e){function t(){if(t.enabled){var e=t,o=+new Date,s=o-(n||o);e.diff=s,e.prev=n,e.curr=o,n=o;for(var d=Array(arguments.length),a=0;a<d.length;a++)d[a]=arguments[a];d[0]=r.coerce(d[0]),"string"!=typeof d[0]&&d.unshift("%O");var i=0;d[0]=d[0].replace(/%([a-zA-Z%])/g,function(t,n){if("%%"===t)return t;i++;var o=r.formatters[n];if("function"==typeof o){var s=d[i];t=o.call(e,s),d.splice(i,1),i--}return t}),r.formatArgs.call(e,d);var c=t.log||r.log||console.log.bind(console);c.apply(e,d)}}var n;return t.namespace=e,t.enabled=r.enabled(e),t.useColors=r.useColors(),t.color=o(e),t.destroy=i,"function"==typeof r.init&&r.init(t),r.instances.push(t),t}function i(){var e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}r=n.exports=s.debug=s["default"]=s,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){r.enable("")},r.enable=function(e){r.save(e),r.names=[],r.skips=[];var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length,o;for(o=0;o<n;o++)t[o]&&(e=t[o].replace(/\*/g,".*?"),"-"===e[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(o=0;o<r.instances.length;o++){var s=r.instances[o];s.enabled=r.enabled(s.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=e("ms"),r.instances=[],r.names=[],r.skips=[],r.formatters={}},{ms:56}],31:[function(e,t){t.exports=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}},{}],32:[function(e,t){var n=e("once"),r=function(){},o=function(e){return e.setHeader&&"function"==typeof e.abort},s=function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length},i=function(e,t,d){if("function"==typeof t)return i(e,null,t);t||(t={}),d=n(d||r);var a=e._writableState,c=e._readableState,l=t.readable||!1!==t.readable&&e.readable,p=t.writable||!1!==t.writable&&e.writable,u=function(){e.writable||f()},f=function(){p=!1,l||d.call(e)},h=function(){l=!1,p||d.call(e)},m=function(t){d.call(e,t?new Error("exited with error code: "+t):null)},g=function(t){d.call(e,t)},_=function(){return l&&!(c&&c.ended)?d.call(e,new Error("premature close")):p&&!(a&&a.ended)?d.call(e,new Error("premature close")):void 0},y=function(){e.req.on("finish",f)};return o(e)?(e.on("complete",f),e.on("abort",_),e.req?y():e.on("request",y)):p&&!a&&(e.on("end",u),e.on("close",u)),s(e)&&e.on("exit",m),e.on("end",h),e.on("finish",f),!1!==t.error&&e.on("error",g),e.on("close",_),function(){e.removeListener("complete",f),e.removeListener("abort",_),e.removeListener("request",y),e.req&&e.req.removeListener("finish",f),e.removeListener("end",u),e.removeListener("close",u),e.removeListener("finish",f),e.removeListener("exit",m),e.removeListener("end",h),e.removeListener("error",g),e.removeListener("close",_)}};t.exports=i},{once:59}],33:[function(e,t){function n(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=_(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}function r(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function s(e,t,n){if(t)e.call(n);else for(var r=e.length,o=m(e,r),s=0;s<r;++s)o[s].call(n)}function d(e,t,n,r){if(t)e.call(n,r);else for(var o=e.length,s=m(e,o),d=0;d<o;++d)s[d].call(n,r)}function a(e,t,n,r,o){if(t)e.call(n,r,o);else for(var s=e.length,d=m(e,s),a=0;a<s;++a)d[a].call(n,r,o)}function c(e,t,n,r,o,s){if(t)e.call(n,r,o,s);else for(var d=e.length,a=m(e,d),c=0;c<d;++c)a[c].call(n,r,o,s)}function l(e,t,n,r){if(t)e.apply(n,r);else for(var o=e.length,s=m(e,o),d=0;d<o;++d)s[d].apply(n,r)}function i(e,t,n,o){var s,i,d;if("function"!=typeof n)throw new TypeError("\"listener\" argument must be a function");if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),d=i[t]):(i=e._events=_(null),e._eventsCount=0),!d)d=i[t]=n,++e._eventsCount;else if("function"==typeof d?d=i[t]=o?[n,d]:[d,n]:o?d.unshift(n):d.push(n),!d.warned&&(s=r(e),s&&0<s&&d.length>s)){d.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+d.length+" \""+(t+"\" listeners added. Use emitter.setMaxListeners() to increase limit."));a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=d.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",a.name,a.message)}return e}function p(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e);}}function u(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=b.call(p,r);return o.listener=n,r.wrapFn=o,o}function f(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function h(e,t){for(var r=t,o=r+1,s=e.length;o<s;r+=1,o+=1)e[r]=e[o];e.pop()}function m(e,t){for(var n=Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(e){for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}var _=Object.create||function(e){var t=function(){};return t.prototype=e,new t},y=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},b=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0;var w=10,k;try{var x={};Object.defineProperty&&Object.defineProperty(x,"x",{value:0}),k=0===x.x}catch(e){k=!1}k?Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(e){if("number"!=typeof e||0>e||e!==e)throw new TypeError("\"defaultMaxListeners\" must be a positive number");w=e}}):n.defaultMaxListeners=w,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw new TypeError("\"n\" argument must be a positive number");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return r(this)},n.prototype.emit=function(e){var t="error"===e,n,r,o,p,u,i;if(i=this._events,i)t=t&&null==i.error;else if(!t)return!1;if(t){if(1<arguments.length&&(n=arguments[1]),n instanceof Error)throw n;else{var f=new Error("Unhandled \"error\" event. ("+n+")");throw f.context=n,f}return!1}if(r=i[e],!r)return!1;var h="function"==typeof r;switch(o=arguments.length,o){case 1:s(r,h,this);break;case 2:d(r,h,this,arguments[1]);break;case 3:a(r,h,this,arguments[1],arguments[2]);break;case 4:c(r,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(p=Array(o-1),u=1;u<o;u++)p[u-1]=arguments[u];l(r,h,this,p);}return!0},n.prototype.addListener=function(e,t){return i(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return i(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.on(e,u(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.prependListener(e,u(this,e,t)),this},n.prototype.removeListener=function(e,t){var n,r,o,s,i;if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");if(r=this._events,!r)return this;if(n=r[e],!n)return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=_(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,s=n.length-1;0<=s;s--)if(n[s]===t||n[s].listener===t){i=n[s].listener,o=s;break}if(0>o)return this;0===o?n.shift():h(n,o),1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,i||t)}return this},n.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=_(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=_(null):delete n[e]),this;if(0===arguments.length){var o=y(n),s;for(r=0;r<o.length;++r)s=o[r],"removeListener"===s||this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=_(null),this._eventsCount=0,this}if(t=n[e],"function"==typeof t)this.removeListener(e,t);else if(t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},n.prototype.listeners=function(e){var t=this._events,n,r;return t?(n=t[e],r=n?"function"==typeof n?[n.listener||n]:g(n):[]):r=[],r},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},n.prototype.listenerCount=f,n.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],34:[function(e,t){function n(e,t){var o=this;return this instanceof n?void(t=t||{},r.call(this,t),this._offset=0,this._ready=!1,this._file=e,this._size=e.size,this._chunkSize=t.chunkSize||s(this._size/1e3,204800),this.reader=new FileReader,this._generateHeaderBlocks(e,t,function(e,t){return e?o.emit("error",e):void(Array.isArray(t)&&t.forEach(function(e){o.push(e)}),o._ready=!0,o.emit("_ready"))})):new n(e,t)}var r=e("readable-stream").Readable,o=e("inherits"),i=/^.*\.(\w+)$/,d=e("typedarray-to-buffer");o(n,r),t.exports=n,n.prototype._generateHeaderBlocks=function(e,t,n){n(null,[])},n.prototype._read=function(){if(!this._ready)return void this.once("_ready",this._read.bind(this));var e=this,t=this.reader,n=this._offset,r=this._offset+this._chunkSize;return r>this._size&&(r=this._size),n===this._size?(this.destroy(),void this.push(null)):void(t.onload=function(){e._offset=r,e.push(d(t.result))},t.onerror=function(){e.emit("error",t.error)},t.readAsArrayBuffer(this._file.slice(n,r)))},n.prototype.destroy=function(){if(this._file=null,this.reader){this.reader.onload=null,this.reader.onerror=null;try{this.reader.abort()}catch(t){}}this.reader=null}},{inherits:40,"readable-stream":82,"typedarray-to-buffer":110}],35:[function(e,t){t.exports=function(e,t){function n(e,r){return e.reduce(function(e,o){return Array.isArray(o)&&r<t?e.concat(n(o,r+1)):e.concat(o)},[])}return t="number"==typeof t?t:Infinity,t?n(e,1):Array.isArray(e)?e.map(function(e){return e}):e}},{}],36:[function(e,t){t.exports=function(){if("undefined"==typeof window)return null;var e={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}},{}],37:[function(e,t){function n(e){if("string"==typeof e&&(e=o.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error("Protocol \""+e.protocol+"\" not supported. Expected \"https:\"");return e}var r=e("http"),o=e("url"),s=t.exports;for(var i in r)r.hasOwnProperty(i)&&(s[i]=r[i]);s.request=function(e,t){return e=n(e),r.request.call(this,e,t)},s.get=function(e,t){return e=n(e),r.get.call(this,e,t)}},{http:97,url:114}],38:[function(e,o,s){s.read=function(t,r,o,a,c){var l=8*c-a-1,p=(1<<l)-1,u=p>>1,f=-7,h=o?c-1:0,i=o?-1:1,d=t[r+h],s,e;for(h+=i,s=d&(1<<-f)-1,d>>=-f,f+=l;0<f;s=256*s+t[r+h],h+=i,f-=8);for(e=s&(1<<-f)-1,s>>=-f,f+=a;0<f;e=256*e+t[r+h],h+=i,f-=8);if(0===s)s=1-u;else{if(s===p)return e?NaN:(d?-1:1)*Infinity;e+=n(2,a),s-=u}return(d?-1:1)*e*n(2,s-a)},s.write=function(o,a,l,p,u,f){var h=8*f-u-1,g=(1<<h)-1,_=g>>1,y=23===u?5.960464477539063e-8-6617444900424222e-39:0,b=p?0:f-1,i=p?1:-1,d=0>a||0===a&&0>1/a?1:0,s,w,m;for(a=t(a),isNaN(a)||a===Infinity?(w=isNaN(a)?1:0,s=g):(s=r(_Mathlog(a)/_MathLN),1>a*(m=n(2,-s))&&(s--,m*=2),a+=1<=s+_?y/m:y*n(2,1-_),2<=a*m&&(s++,m/=2),s+_>=g?(w=0,s=g):1<=s+_?(w=(a*m-1)*n(2,u),s+=_):(w=a*n(2,_-1)*n(2,u),s=0));8<=u;o[l+b]=255&w,b+=i,w/=256,u-=8);for(s=s<<u|w,h+=u;0<h;o[l+b]=255&s,b+=i,s/=256,h-=8);o[l+b-i]|=128*d}},{}],39:[function(e,t){(function(e){function n(e){if(!(this instanceof n))return new n(e);if(this.store=e,this.chunkLength=e.chunkLength,!this.store||!this.store.get||!this.store.put)throw new Error("First argument must be abstract-chunk-store compliant");this.mem=[]}function r(t,n,r){e.nextTick(function(){t&&t(n,r)})}t.exports=n,n.prototype.put=function(e,t,n){var r=this;r.mem[e]=t,r.store.put(e,t,function(t){r.mem[e]=null,n&&n(t)})},n.prototype.get=function(e,t,n){if("function"==typeof t)return this.get(e,null,t);var o=t&&t.offset||0,s=t&&t.length&&o+t.length,i=this.mem[e];return i?r(n,null,t?i.slice(o,s):i):void this.store.get(e,t,n)},n.prototype.close=function(e){this.store.close(e)},n.prototype.destroy=function(e){this.store.destroy(e)}}).call(this,e("_process"))},{_process:65}],40:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],41:[function(e,t){t.exports=function(e){for(var t=0,n=e.length;t<n;++t)if(127<e.charCodeAt(t))return!1;return!0}},{}],42:[function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function r(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}t.exports=function(e){return null!=e&&(n(e)||r(e)||!!e._isBuffer)}},{}],43:[function(e,t){"use strict";function n(e){return r.existsSync(e)&&r.statSync(e).isFile()}var r=e("fs");t.exports=function(e,t){return t?void r.stat(e,function(e,n){return e?t(e):t(null,n.isFile())}):n(e)},t.exports.sync=n},{fs:22}],44:[function(e,t){function n(e){return r(e)||o(e)}function r(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function o(e){return i[s.call(e)]}t.exports=n,n.strict=r,n.loose=o;var s=Object.prototype.toString,i={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0}},{}],45:[function(e,t){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],46:[function(e,t,n){"use strict";n.regex=n.re=/^npm-debug\.log$|^\..*\.swp$|^\.DS_Store$|^\.AppleDouble$|^\.LSOverride$|^Icon\r$|^\._.*|^\.Spotlight-V100(?:$|\/)|\.Trashes|^__MACOSX$|~$|^Thumbs\.db$|^ehthumbs\.db$|^Desktop\.ini$|^@eaDir$/,n.is=e=>n.re.test(e),n.not=e=>!n.is(e)},{}],47:[function(e,t){function n(e){var t={},n=e.split("magnet:?")[1],s=n&&0<=n.length?n.split("&"):[];s.forEach(function(e){var n=e.split("=");if(2===n.length){var r=n[0],o=n[1];if("dn"===r&&(o=decodeURIComponent(o).replace(/\+/g," ")),("tr"===r||"xs"===r||"as"===r||"ws"===r)&&(o=decodeURIComponent(o)),"kt"===r&&(o=decodeURIComponent(o).split("+")),"ix"===r&&(o=+o),!t[r])t[r]=o;else if(Array.isArray(t[r]))t[r].push(o);else{var s=t[r];t[r]=[s,o]}}});var d;if(t.xt){var a=Array.isArray(t.xt)?t.xt:[t.xt];a.forEach(function(e){if(d=e.match(/^urn:btih:(.{40})/))t.infoHash=d[1].toLowerCase();else if(d=e.match(/^urn:btih:(.{32})/)){var n=r.decode(d[1]);t.infoHash=o.from(n,"binary").toString("hex")}})}return t.infoHash&&(t.infoHashBuffer=o.from(t.infoHash,"hex")),t.dn&&(t.name=t.dn),t.kt&&(t.keywords=t.kt),t.announce="string"==typeof t.tr?[t.tr]:Array.isArray(t.tr)?t.tr:[],t.urlList=[],("string"==typeof t.as||Array.isArray(t.as))&&(t.urlList=t.urlList.concat(t.as)),("string"==typeof t.ws||Array.isArray(t.ws))&&(t.urlList=t.urlList.concat(t.ws)),i(t.announce),i(t.urlList),t}t.exports=n,t.exports.decode=n,t.exports.encode=function(e){e=s(e),e.infoHashBuffer&&(e.xt="urn:btih:"+e.infoHashBuffer.toString("hex")),e.infoHash&&(e.xt="urn:btih:"+e.infoHash),e.name&&(e.dn=e.name),e.keywords&&(e.kt=e.keywords),e.announce&&(e.tr=e.announce),e.urlList&&(e.ws=e.urlList,delete e.as);var t="magnet:?";return Object.keys(e).filter(function(e){return 2===e.length}).forEach(function(n,r){var o=Array.isArray(e[n])?e[n]:[e[n]];o.forEach(function(e,o){(0<r||0<o)&&("kt"!==n||0===o)&&(t+="&"),"dn"===n&&(e=encodeURIComponent(e).replace(/%20/g,"+")),("tr"===n||"xs"===n||"as"===n||"ws"===n)&&(e=encodeURIComponent(e)),"kt"===n&&(e=encodeURIComponent(e)),t+="kt"===n&&0<o?"+"+e:n+"="+e})}),t};var r=e("thirty-two"),o=e("safe-buffer").Buffer,s=e("xtend"),i=e("uniq")},{"safe-buffer":90,"thirty-two":105,uniq:112,xtend:122}],48:[function(e,t){function n(e,t){var r=this;if(!(r instanceof n))return new n(e,t);if(!d)throw new Error("web browser lacks MediaSource support");t||(t={}),r._bufferDuration=t.bufferDuration||a,r._elem=e,r._mediaSource=new d,r._streams=[],r.detailedError=null,r._errorHandler=function(){r._elem.removeEventListener("error",r._errorHandler);var e=r._streams.slice();e.forEach(function(e){e.destroy(r._elem.error)})},r._elem.addEventListener("error",r._errorHandler),r._elem.src=window.URL.createObjectURL(r._mediaSource)}function r(e,t){var n=this;if(s.Writable.call(n),n._wrapper=e,n._elem=e._elem,n._mediaSource=e._mediaSource,n._allStreams=e._streams,n._allStreams.push(n),n._bufferDuration=e._bufferDuration,n._sourceBuffer=null,n._openHandler=function(){n._onSourceOpen()},n._flowHandler=function(){n._flow()},"string"==typeof t)n._type=t,"open"===n._mediaSource.readyState?n._createSourceBuffer():n._mediaSource.addEventListener("sourceopen",n._openHandler);else if(null===t._sourceBuffer)t.destroy(),n._type=t._type,n._mediaSource.addEventListener("sourceopen",n._openHandler);else if(t._sourceBuffer)t.destroy(),n._type=t._type,n._sourceBuffer=t._sourceBuffer,n._sourceBuffer.addEventListener("updateend",n._flowHandler);else throw new Error("The argument to MediaElementWrapper.createWriteStream must be a string or a previous stream returned from that function");n._elem.addEventListener("timeupdate",n._flowHandler),n.on("error",function(e){n._wrapper.error(e)}),n.on("finish",function(){if(!n.destroyed&&(n._finished=!0,n._allStreams.every(function(e){return e._finished})))try{n._mediaSource.endOfStream()}catch(e){}})}t.exports=n;var o=e("inherits"),s=e("readable-stream"),i=e("to-arraybuffer"),d="undefined"!=typeof window&&window.MediaSource,a=60;n.prototype.createWriteStream=function(e){var t=this;return new r(t,e)},n.prototype.error=function(e){var t=this;t.detailedError||(t.detailedError=e);try{t._mediaSource.endOfStream("decode")}catch(e){}},o(r,s.Writable),r.prototype._onSourceOpen=function(){var e=this;e.destroyed||(e._mediaSource.removeEventListener("sourceopen",e._openHandler),e._createSourceBuffer())},r.prototype.destroy=function(e){var t=this;t.destroyed||(t.destroyed=!0,t._allStreams.splice(t._allStreams.indexOf(t),1),t._mediaSource.removeEventListener("sourceopen",t._openHandler),t._elem.removeEventListener("timeupdate",t._flowHandler),t._sourceBuffer&&(t._sourceBuffer.removeEventListener("updateend",t._flowHandler),"open"===t._mediaSource.readyState&&t._sourceBuffer.abort()),e&&t.emit("error",e),t.emit("close"))},r.prototype._createSourceBuffer=function(){var e=this;if(!e.destroyed)if(!d.isTypeSupported(e._type))e.destroy(new Error("The provided type is not supported"));else if(e._sourceBuffer=e._mediaSource.addSourceBuffer(e._type),e._sourceBuffer.addEventListener("updateend",e._flowHandler),e._cb){var t=e._cb;e._cb=null,t()}},r.prototype._write=function(e,t,n){var r=this;if(!r.destroyed){if(!r._sourceBuffer)return void(r._cb=function(o){return o?n(o):void r._write(e,t,n)});if(r._sourceBuffer.updating)return n(new Error("Cannot append buffer while source buffer updating"));try{r._sourceBuffer.appendBuffer(i(e))}catch(e){return void r.destroy(e)}r._cb=n}},r.prototype._flow=function(){var e=this;if(!(e.destroyed||!e._sourceBuffer||e._sourceBuffer.updating)&&!("open"===e._mediaSource.readyState&&e._getBufferDuration()>e._bufferDuration)&&e._cb){var t=e._cb;e._cb=null,t()}},r.prototype._getBufferDuration=function(){for(var e=this,t=e._sourceBuffer.buffered,n=e._elem.currentTime,r=-1,o=0;o<t.length;o++){var s=t.start(o),i=t.end(o)+0;if(s>n)break;else(0<=r||n<=i)&&(r=i)}var d=r-n;return 0>d&&(d=0),d}},{inherits:40,"readable-stream":82,"to-arraybuffer":107}],49:[function(e,t){(function(e){function n(e,t){if(!(this instanceof n))return new n(e,t);if(t||(t={}),this.chunkLength=+e,!this.chunkLength)throw new Error("First argument must be a chunk length");this.chunks=[],this.closed=!1,this.length=+t.length||Infinity,this.length!==Infinity&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=o(this.length/this.chunkLength)-1)}function r(t,n,r){e.nextTick(function(){t&&t(n,r)})}t.exports=n,n.prototype.put=function(e,t,n){if(this.closed)return r(n,new Error("Storage is closed"));var o=e===this.lastChunkIndex;return o&&t.length!==this.lastChunkLength?r(n,new Error("Last chunk length must be "+this.lastChunkLength)):o||t.length===this.chunkLength?void(this.chunks[e]=t,r(n,null)):r(n,new Error("Chunk length must be "+this.chunkLength))},n.prototype.get=function(e,t,n){if("function"==typeof t)return this.get(e,null,t);if(this.closed)return r(n,new Error("Storage is closed"));var o=this.chunks[e];if(!o){var s=new Error("Chunk not found");return s.notFound=!0,r(n,s)}if(!t)return r(n,null,o);var i=t.offset||0,d=t.length||o.length-i;r(n,null,o.slice(i,d+i))},n.prototype.close=n.prototype.destroy=function(e){return this.closed?r(e,new Error("Storage is closed")):void(this.closed=!0,this.chunks=null,r(e,null))}}).call(this,e("_process"))},{_process:65}],50:[function(e,t,n){(function(t){function o(e,t,n){for(var r=t;r<n;r++)e[r]=0}function s(e,t,n){t.writeUInt32BE(r((e.getTime()+y)/1e3),n)}function a(e,t,n){t.writeUInt16BE(r(e)%65536,n),t.writeUInt16BE(r(256*(256*e))%65536,n+2)}function i(e,t,n){t[n]=r(e)%256,t[n+1]=r(256*e)%256}function c(e,t,n){e||(e=[0,0,0,0,0,0,0,0,0]);for(var r=0;r<e.length;r++)a(e[r],t,n+4*r)}function l(e,n,r){var o=new t(e,"utf8");o.copy(n,r),n[r+o.length]=0}function p(e){for(var t=Array(e.length/4),n=0;n<t.length;n++)t[n]=f(e,4*n);return t}function u(e,t){return new Date(1e3*e.readUInt32BE(t)-y)}function f(e,t){return e.readUInt16BE(t)+e.readUInt16BE(t+2)/65536}function h(e,t){return e[t]+e[t+1]/256}function m(e,t,n){var r;for(r=0;r<n&&0!==e[t+r];r++);return e.toString("utf8",t,t+r)}var g=e("./index"),_=e("./descriptor"),y=20828448e5;n.fullBoxes={},["mvhd","tkhd","mdhd","vmhd","smhd","stsd","esds","stsz","stco","stss","stts","ctts","stsc","dref","elst","hdlr","mehd","trex","mfhd","tfhd","tfdt","trun"].forEach(function(e){n.fullBoxes[e]=!0}),n.ftyp={},n.ftyp.encode=function(e,r,o){r=r?r.slice(o):new t(n.ftyp.encodingLength(e));var s=e.compatibleBrands||[];r.write(e.brand,0,4,"ascii"),r.writeUInt32BE(e.brandVersion,4);for(var d=0;d<s.length;d++)r.write(s[d],8+4*d,4,"ascii");return n.ftyp.encode.bytes=8+4*s.length,r},n.ftyp.decode=function(e,t){e=e.slice(t);for(var n=e.toString("ascii",0,4),r=e.readUInt32BE(4),o=[],s=8;s<e.length;s+=4)o.push(e.toString("ascii",s,s+4));return{brand:n,brandVersion:r,compatibleBrands:o}},n.ftyp.encodingLength=function(e){return 8+4*(e.compatibleBrands||[]).length},n.mvhd={},n.mvhd.encode=function(e,r,d){return r=r?r.slice(d):new t(96),s(e.ctime||new Date,r,0),s(e.mtime||new Date,r,4),r.writeUInt32BE(e.timeScale||0,8),r.writeUInt32BE(e.duration||0,12),a(e.preferredRate||0,r,16),i(e.preferredVolume||0,r,20),o(r,22,32),c(e.matrix,r,32),r.writeUInt32BE(e.previewTime||0,68),r.writeUInt32BE(e.previewDuration||0,72),r.writeUInt32BE(e.posterTime||0,76),r.writeUInt32BE(e.selectionTime||0,80),r.writeUInt32BE(e.selectionDuration||0,84),r.writeUInt32BE(e.currentTime||0,88),r.writeUInt32BE(e.nextTrackId||0,92),n.mvhd.encode.bytes=96,r},n.mvhd.decode=function(e,t){return e=e.slice(t),{ctime:u(e,0),mtime:u(e,4),timeScale:e.readUInt32BE(8),duration:e.readUInt32BE(12),preferredRate:f(e,16),preferredVolume:h(e,20),matrix:p(e.slice(32,68)),previewTime:e.readUInt32BE(68),previewDuration:e.readUInt32BE(72),posterTime:e.readUInt32BE(76),selectionTime:e.readUInt32BE(80),selectionDuration:e.readUInt32BE(84),currentTime:e.readUInt32BE(88),nextTrackId:e.readUInt32BE(92)}},n.mvhd.encodingLength=function(){return 96},n.tkhd={},n.tkhd.encode=function(e,r,i){return r=r?r.slice(i):new t(80),s(e.ctime||new Date,r,0),s(e.mtime||new Date,r,4),r.writeUInt32BE(e.trackId||0,8),o(r,12,16),r.writeUInt32BE(e.duration||0,16),o(r,20,28),r.writeUInt16BE(e.layer||0,28),r.writeUInt16BE(e.alternateGroup||0,30),r.writeUInt16BE(e.volume||0,32),c(e.matrix,r,36),r.writeUInt32BE(e.trackWidth||0,72),r.writeUInt32BE(e.trackHeight||0,76),n.tkhd.encode.bytes=80,r},n.tkhd.decode=function(e,t){return e=e.slice(t),{ctime:u(e,0),mtime:u(e,4),trackId:e.readUInt32BE(8),duration:e.readUInt32BE(16),layer:e.readUInt16BE(28),alternateGroup:e.readUInt16BE(30),volume:e.readUInt16BE(32),matrix:p(e.slice(36,72)),trackWidth:e.readUInt32BE(72),trackHeight:e.readUInt32BE(76)}},n.tkhd.encodingLength=function(){return 80},n.mdhd={},n.mdhd.encode=function(e,r,o){return r=r?r.slice(o):new t(20),s(e.ctime||new Date,r,0),s(e.mtime||new Date,r,4),r.writeUInt32BE(e.timeScale||0,8),r.writeUInt32BE(e.duration||0,12),r.writeUInt16BE(e.language||0,16),r.writeUInt16BE(e.quality||0,18),n.mdhd.encode.bytes=20,r},n.mdhd.decode=function(e,t){return e=e.slice(t),{ctime:u(e,0),mtime:u(e,4),timeScale:e.readUInt32BE(8),duration:e.readUInt32BE(12),language:e.readUInt16BE(16),quality:e.readUInt16BE(18)}},n.mdhd.encodingLength=function(){return 20},n.vmhd={},n.vmhd.encode=function(e,r,o){r=r?r.slice(o):new t(8),r.writeUInt16BE(e.graphicsMode||0,0);var s=e.opcolor||[0,0,0];return r.writeUInt16BE(s[0],2),r.writeUInt16BE(s[1],4),r.writeUInt16BE(s[2],6),n.vmhd.encode.bytes=8,r},n.vmhd.decode=function(e,t){return e=e.slice(t),{graphicsMode:e.readUInt16BE(0),opcolor:[e.readUInt16BE(2),e.readUInt16BE(4),e.readUInt16BE(6)]}},n.vmhd.encodingLength=function(){return 8},n.smhd={},n.smhd.encode=function(e,r,s){return r=r?r.slice(s):new t(4),r.writeUInt16BE(e.balance||0,0),o(r,2,4),n.smhd.encode.bytes=4,r},n.smhd.decode=function(e,t){return e=e.slice(t),{balance:e.readUInt16BE(0)}},n.smhd.encodingLength=function(){return 4},n.stsd={},n.stsd.encode=function(e,r,o){r=r?r.slice(o):new t(n.stsd.encodingLength(e));var s=e.entries||[];r.writeUInt32BE(s.length,0);for(var d=4,a=0,i;a<s.length;a++)i=s[a],g.encode(i,r,d),d+=g.encode.bytes;return n.stsd.encode.bytes=d,r},n.stsd.decode=function(e,t,n){e=e.slice(t);for(var r=e.readUInt32BE(0),o=Array(r),s=4,d=0,i;d<r;d++)i=g.decode(e,s,n),o[d]=i,s+=i.length;return{entries:o}},n.stsd.encodingLength=function(e){var t=4;if(!e.entries)return t;for(var n=0;n<e.entries.length;n++)t+=g.encodingLength(e.entries[n]);return t},n.avc1=n.VisualSampleEntry={},n.VisualSampleEntry.encode=function(e,r,s){r=r?r.slice(s):new t(n.VisualSampleEntry.encodingLength(e)),o(r,0,6),r.writeUInt16BE(e.dataReferenceIndex||0,6),o(r,8,24),r.writeUInt16BE(e.width||0,24),r.writeUInt16BE(e.height||0,26),r.writeUInt32BE(e.hResolution||4718592,28),r.writeUInt32BE(e.vResolution||4718592,32),o(r,36,40),r.writeUInt16BE(e.frameCount||1,40);var i=e.compressorName||"",a=d(i.length,31);r.writeUInt8(a,42),r.write(i,43,a,"utf8"),r.writeUInt16BE(e.depth||24,74),r.writeInt16BE(-1,76);var c=78,l=e.children||[];l.forEach(function(e){g.encode(e,r,c),c+=g.encode.bytes}),n.VisualSampleEntry.encode.bytes=c},n.VisualSampleEntry.decode=function(e,t,n){e=e.slice(t);for(var r=n-t,o=d(e.readUInt8(42),31),s={dataReferenceIndex:e.readUInt16BE(6),width:e.readUInt16BE(24),height:e.readUInt16BE(26),hResolution:e.readUInt32BE(28),vResolution:e.readUInt32BE(32),frameCount:e.readUInt16BE(40),compressorName:e.toString("utf8",43,43+o),depth:e.readUInt16BE(74),children:[]},i=78,a;8<=r-i;)a=g.decode(e,i,r),s.children.push(a),s[a.type]=a,i+=a.length;return s},n.VisualSampleEntry.encodingLength=function(e){var t=78,n=e.children||[];return n.forEach(function(e){t+=g.encodingLength(e)}),t},n.avcC={},n.avcC.encode=function(e,r,o){r=r?r.slice(o):t(e.buffer.length),e.buffer.copy(r),n.avcC.encode.bytes=e.buffer.length},n.avcC.decode=function(e,n,r){return e=e.slice(n,r),{mimeCodec:e.toString("hex",1,4),buffer:new t(e)}},n.avcC.encodingLength=function(e){return e.buffer.length},n.mp4a=n.AudioSampleEntry={},n.AudioSampleEntry.encode=function(e,r,s){r=r?r.slice(s):new t(n.AudioSampleEntry.encodingLength(e)),o(r,0,6),r.writeUInt16BE(e.dataReferenceIndex||0,6),o(r,8,16),r.writeUInt16BE(e.channelCount||2,16),r.writeUInt16BE(e.sampleSize||16,18),o(r,20,24),r.writeUInt32BE(e.sampleRate||0,24);var i=28,d=e.children||[];d.forEach(function(e){g.encode(e,r,i),i+=g.encode.bytes}),n.AudioSampleEntry.encode.bytes=i},n.AudioSampleEntry.decode=function(e,t,n){e=e.slice(t,n);for(var r=n-t,o={dataReferenceIndex:e.readUInt16BE(6),channelCount:e.readUInt16BE(16),sampleSize:e.readUInt16BE(18),sampleRate:e.readUInt32BE(24),children:[]},s=28,i;8<=r-s;)i=g.decode(e,s,r),o.children.push(i),o[i.type]=i,s+=i.length;return o},n.AudioSampleEntry.encodingLength=function(e){var t=28,n=e.children||[];return n.forEach(function(e){t+=g.encodingLength(e)}),t},n.esds={},n.esds.encode=function(e,r,o){r=r?r.slice(o):t(e.buffer.length),e.buffer.copy(r,0),n.esds.encode.bytes=e.buffer.length},n.esds.decode=function(e,n,r){e=e.slice(n,r);var o=_.Descriptor.decode(e,0,e.length),s="ESDescriptor"===o.tagName?o:{},i=s.DecoderConfigDescriptor||{},d=i.oti||0,a=i.DecoderSpecificInfo,c=a?(248&a.buffer.readUInt8(0))>>3:0,l=null;return d&&(l=d.toString(16),c&&(l+="."+c)),{mimeCodec:l,buffer:new t(e.slice(0))}},n.esds.encodingLength=function(e){return e.buffer.length},n.stsz={},n.stsz.encode=function(e,r,o){var s=e.entries||[];r=r?r.slice(o):t(n.stsz.encodingLength(e)),r.writeUInt32BE(0,0),r.writeUInt32BE(s.length,4);for(var d=0;d<s.length;d++)r.writeUInt32BE(s[d],4*d+8);return n.stsz.encode.bytes=8+4*s.length,r},n.stsz.decode=function(e,t){e=e.slice(t);for(var n=e.readUInt32BE(0),r=e.readUInt32BE(4),o=Array(r),s=0;s<r;s++)o[s]=0===n?e.readUInt32BE(4*s+8):n;return{entries:o}},n.stsz.encodingLength=function(e){return 8+4*e.entries.length},n.stss=n.stco={},n.stco.encode=function(e,r,o){var s=e.entries||[];r=r?r.slice(o):new t(n.stco.encodingLength(e)),r.writeUInt32BE(s.length,0);for(var d=0;d<s.length;d++)r.writeUInt32BE(s[d],4*d+4);return n.stco.encode.bytes=4+4*s.length,r},n.stco.decode=function(e,t){e=e.slice(t);for(var n=e.readUInt32BE(0),r=Array(n),o=0;o<n;o++)r[o]=e.readUInt32BE(4*o+4);return{entries:r}},n.stco.encodingLength=function(e){return 4+4*e.entries.length},n.stts={},n.stts.encode=function(e,r,o){var s=e.entries||[];r=r?r.slice(o):new t(n.stts.encodingLength(e)),r.writeUInt32BE(s.length,0);for(var d=0,i;d<s.length;d++)i=8*d+4,r.writeUInt32BE(s[d].count||0,i),r.writeUInt32BE(s[d].duration||0,i+4);return n.stts.encode.bytes=4+8*e.entries.length,r},n.stts.decode=function(e,t){e=e.slice(t);for(var n=e.readUInt32BE(0),r=Array(n),o=0,s;o<n;o++)s=8*o+4,r[o]={count:e.readUInt32BE(s),duration:e.readUInt32BE(s+4)};return{entries:r}},n.stts.encodingLength=function(e){return 4+8*e.entries.length},n.ctts={},n.ctts.encode=function(e,r,o){var s=e.entries||[];r=r?r.slice(o):new t(n.ctts.encodingLength(e)),r.writeUInt32BE(s.length,0);for(var d=0,i;d<s.length;d++)i=8*d+4,r.writeUInt32BE(s[d].count||0,i),r.writeUInt32BE(s[d].compositionOffset||0,i+4);return n.ctts.encode.bytes=4+8*s.length,r},n.ctts.decode=function(e,t){e=e.slice(t);for(var n=e.readUInt32BE(0),r=Array(n),o=0,s;o<n;o++)s=8*o+4,r[o]={count:e.readUInt32BE(s),compositionOffset:e.readInt32BE(s+4)};return{entries:r}},n.ctts.encodingLength=function(e){return 4+8*e.entries.length},n.stsc={},n.stsc.encode=function(e,r,o){var s=e.entries||[];r=r?r.slice(o):new t(n.stsc.encodingLength(e)),r.writeUInt32BE(s.length,0);for(var d=0,i;d<s.length;d++)i=12*d+4,r.writeUInt32BE(s[d].firstChunk||0,i),r.writeUInt32BE(s[d].samplesPerChunk||0,i+4),r.writeUInt32BE(s[d].sampleDescriptionId||0,i+8);return n.stsc.encode.bytes=4+12*s.length,r},n.stsc.decode=function(e,t){e=e.slice(t);for(var n=e.readUInt32BE(0),r=Array(n),o=0,s;o<n;o++)s=12*o+4,r[o]={firstChunk:e.readUInt32BE(s),samplesPerChunk:e.readUInt32BE(s+4),sampleDescriptionId:e.readUInt32BE(s+8)};return{entries:r}},n.stsc.encodingLength=function(e){return 4+12*e.entries.length},n.dref={},n.dref.encode=function(e,r,o){r=r?r.slice(o):new t(n.dref.encodingLength(e));var s=e.entries||[];r.writeUInt32BE(s.length,0);for(var d=4,a=0;a<s.length;a++){var i=s[a],c=(i.buf?i.buf.length:0)+4+4;r.writeUInt32BE(c,d),d+=4,r.write(i.type,d,4,"ascii"),d+=4,i.buf&&(i.buf.copy(r,d),d+=i.buf.length)}return n.dref.encode.bytes=d,r},n.dref.decode=function(e,t){e=e.slice(t);for(var n=e.readUInt32BE(0),r=Array(n),o=4,s=0;s<n;s++){var i=e.readUInt32BE(o),d=e.toString("ascii",o+4,o+8),a=e.slice(o+8,o+i);o+=i,r[s]={type:d,buf:a}}return{entries:r}},n.dref.encodingLength=function(e){var t=4;if(!e.entries)return t;for(var n=0,r;n<e.entries.length;n++)r=e.entries[n].buf,t+=(r?r.length:0)+4+4;return t},n.elst={},n.elst.encode=function(e,r,o){var s=e.entries||[];r=r?r.slice(o):new t(n.elst.encodingLength(e)),r.writeUInt32BE(s.length,0);for(var d=0,i;d<s.length;d++)i=12*d+4,r.writeUInt32BE(s[d].trackDuration||0,i),r.writeUInt32BE(s[d].mediaTime||0,i+4),a(s[d].mediaRate||0,r,i+8);return n.elst.encode.bytes=4+12*s.length,r},n.elst.decode=function(e,t){e=e.slice(t);for(var n=e.readUInt32BE(0),r=Array(n),o=0,s;o<n;o++)s=12*o+4,r[o]={trackDuration:e.readUInt32BE(s),mediaTime:e.readInt32BE(s+4),mediaRate:f(e,s+8)};return{entries:r}},n.elst.encodingLength=function(e){return 4+12*e.entries.length},n.hdlr={},n.hdlr.encode=function(e,r,o){r=r?r.slice(o):new t(n.hdlr.encodingLength(e));var s=21+(e.name||"").length;return r.fill(0,0,s),r.write(e.handlerType||"",4,4,"ascii"),l(e.name||"",r,20),n.hdlr.encode.bytes=s,r},n.hdlr.decode=function(e,t,n){return e=e.slice(t),{handlerType:e.toString("ascii",4,8),name:m(e,20,n)}},n.hdlr.encodingLength=function(e){return 21+(e.name||"").length},n.mehd={},n.mehd.encode=function(e,r,o){return r=r?r.slice(o):new t(4),r.writeUInt32BE(e.fragmentDuration||0,0),n.mehd.encode.bytes=4,r},n.mehd.decode=function(e,t){return e=e.slice(t),{fragmentDuration:e.readUInt32BE(0)}},n.mehd.encodingLength=function(){return 4},n.trex={},n.trex.encode=function(e,r,o){return r=r?r.slice(o):new t(20),r.writeUInt32BE(e.trackId||0,0),r.writeUInt32BE(e.defaultSampleDescriptionIndex||0,4),r.writeUInt32BE(e.defaultSampleDuration||0,8),r.writeUInt32BE(e.defaultSampleSize||0,12),r.writeUInt32BE(e.defaultSampleFlags||0,16),n.trex.encode.bytes=20,r},n.trex.decode=function(e,t){return e=e.slice(t),{trackId:e.readUInt32BE(0),defaultSampleDescriptionIndex:e.readUInt32BE(4),defaultSampleDuration:e.readUInt32BE(8),defaultSampleSize:e.readUInt32BE(12),defaultSampleFlags:e.readUInt32BE(16)}},n.trex.encodingLength=function(){return 20},n.mfhd={},n.mfhd.encode=function(e,r,o){return r=r?r.slice(o):new t(4),r.writeUInt32BE(e.sequenceNumber||0,0),n.mfhd.encode.bytes=4,r},n.mfhd.decode=function(e){return{sequenceNumber:e.readUint32BE(0)}},n.mfhd.encodingLength=function(){return 4},n.tfhd={},n.tfhd.encode=function(e,r,o){return r=r?r.slice(o):new t(4),r.writeUInt32BE(e.trackId,0),n.tfhd.encode.bytes=4,r},n.tfhd.decode=function(){},n.tfhd.encodingLength=function(){return 4},n.tfdt={},n.tfdt.encode=function(e,r,o){return r=r?r.slice(o):new t(4),r.writeUInt32BE(e.baseMediaDecodeTime||0,0),n.tfdt.encode.bytes=4,r},n.tfdt.decode=function(){},n.tfdt.encodingLength=function(){return 4},n.trun={},n.trun.encode=function(e,r,o){r=r?r.slice(o):new t(8+16*e.entries.length),r.writeUInt32BE(e.entries.length,0),r.writeInt32BE(e.dataOffset,4);for(var s=8,d=0,i;d<e.entries.length;d++)i=e.entries[d],r.writeUInt32BE(i.sampleDuration,s),s+=4,r.writeUInt32BE(i.sampleSize,s),s+=4,r.writeUInt32BE(i.sampleFlags,s),s+=4,r.writeUInt32BE(i.sampleCompositionTimeOffset,s),s+=4;n.trun.encode.bytes=s},n.trun.decode=function(){},n.trun.encodingLength=function(e){return 8+16*e.entries.length},n.mdat={},n.mdat.encode=function(e,t,r){e.buffer?(e.buffer.copy(t,r),n.mdat.encode.bytes=e.buffer.length):n.mdat.encode.bytes=n.mdat.encodingLength(e)},n.mdat.decode=function(e,n,r){return{buffer:new t(e.slice(n,r))}},n.mdat.encodingLength=function(e){return e.buffer?e.buffer.length:e.contentLength}}).call(this,e("buffer").Buffer)},{"./descriptor":51,"./index":52,buffer:23}],51:[function(e,t,n){(function(e){var t={3:"ESDescriptor",4:"DecoderConfigDescriptor",5:"DecoderSpecificInfo",6:"SLConfigDescriptor"};n.Descriptor={},n.Descriptor.decode=function(r,o,s){var i=r.readUInt8(o),d=o+1,a=0,c;do c=r.readUInt8(d++),a=a<<7|127&c;while(128&c);var l=t[i],p;return p=n[l]?n[l].decode(r,d,s):{buffer:new e(r.slice(d,d+a))},p.tag=i,p.tagName=l,p.length=d-o+a,p.contentsLen=a,p},n.DescriptorArray={},n.DescriptorArray.decode=function(e,r,o){for(var s=r,i={},d;s+2<=o;){d=n.Descriptor.decode(e,s,o),s+=d.length;var a=t[d.tag]||"Descriptor"+d.tag;i[a]=d}return i},n.ESDescriptor={},n.ESDescriptor.decode=function(e,t,r){var o=e.readUInt8(t+2),s=t+3;if(128&o&&(s+=2),64&o){var i=e.readUInt8(s);s+=i+1}return 32&o&&(s+=2),n.DescriptorArray.decode(e,s,r)},n.DecoderConfigDescriptor={},n.DecoderConfigDescriptor.decode=function(e,t,r){var o=e.readUInt8(t),s=n.DescriptorArray.decode(e,t+13,r);return s.oti=o,s}}).call(this,e("buffer").Buffer)},{buffer:23}],52:[function(e,t,n){(function(t){var r=e("uint64be"),o=e("./boxes"),s=4294967295,i=n,d=n.containers={moov:["mvhd","meta","traks","mvex"],trak:["tkhd","tref","trgr","edts","meta","mdia","udta"],edts:["elst"],mdia:["mdhd","hdlr","elng","minf"],minf:["vmhd","smhd","hmhd","sthd","nmhd","dinf","stbl"],dinf:["dref"],stbl:["stsd","stts","ctts","cslg","stsc","stsz","stz2","stco","co64","stss","stsh","padb","stdp","sdtp","sbgps","sgpds","subss","saizs","saios"],mvex:["mehd","trexs","leva"],moof:["mfhd","meta","trafs"],traf:["tfhd","trun","sbgps","sgpds","subss","saizs","saios","tfdt","meta"]};i.encode=function(e,n,r){return i.encodingLength(e),r=r||0,n=n||new t(e.length),i._encode(e,n,r)},i._encode=function(e,t,n){var a=e.type,c=e.length;c>s&&(c=1),t.writeUInt32BE(c,n),t.write(e.type,n+4,4,"ascii");var l=n+8;if(1===c&&(r.encode(e.length,t,l),l+=8),o.fullBoxes[a]&&(t.writeUInt32BE(e.flags||0,l),t.writeUInt8(e.version||0,l),l+=4),d[a]){var p=d[a];p.forEach(function(n){if(5===n.length){var r=e[n]||[];n=n.substr(0,4),r.forEach(function(e){i._encode(e,t,l),l+=i.encode.bytes})}else e[n]&&(i._encode(e[n],t,l),l+=i.encode.bytes)}),e.otherBoxes&&e.otherBoxes.forEach(function(e){i._encode(e,t,l),l+=i.encode.bytes})}else if(o[a]){var u=o[a].encode;u(e,t,l),l+=u.bytes}else if(e.buffer){var f=e.buffer;f.copy(t,l),l+=e.buffer.length}else throw new Error("Either `type` must be set to a known type (not'"+a+"') or `buffer` must be set");return i.encode.bytes=l-n,t},i.readHeaders=function(e,t,n){if(t=t||0,n=n||e.length,8>n-t)return 8;var s=e.readUInt32BE(t),i=e.toString("ascii",t+4,t+8),d=t+8;if(1===s){if(16>n-t)return 16;s=r.decode(e,d),d+=8}var a,c;return o.fullBoxes[i]&&(a=e.readUInt8(d),c=16777215&e.readUInt32BE(d),d+=4),{length:s,headersLen:d-t,contentLen:s-(d-t),type:i,version:a,flags:c}},i.decode=function(e,t,n){t=t||0,n=n||e.length;var r=i.readHeaders(e,t,n);if(!r||r.length>n-t)throw new Error("Data too short");return i.decodeWithoutHeaders(r,e,t+r.headersLen,t+r.length)},i.decodeWithoutHeaders=function(e,n,r,s){r=r||0,s=s||n.length;var a=e.type,c={};if(d[a]){c.otherBoxes=[];for(var l=d[a],p=r,u;8<=s-p;)if(u=i.decode(n,p,s),p+=u.length,0<=l.indexOf(u.type))c[u.type]=u;else if(0<=l.indexOf(u.type+"s")){var f=u.type+"s",h=c[f]=c[f]||[];h.push(u)}else c.otherBoxes.push(u)}else if(o[a]){var m=o[a].decode;c=m(n,r,s)}else c.buffer=new t(n.slice(r,s));return c.length=e.length,c.contentLen=e.contentLen,c.type=e.type,c.version=e.version,c.flags=e.flags,c},i.encodingLength=function(e){var t=e.type,n=8;if(o.fullBoxes[t]&&(n+=4),d[t]){var r=d[t];r.forEach(function(t){if(5===t.length){var r=e[t]||[];t=t.substr(0,4),r.forEach(function(e){e.type=t,n+=i.encodingLength(e)})}else if(e[t]){var o=e[t];o.type=t,n+=i.encodingLength(o)}}),e.otherBoxes&&e.otherBoxes.forEach(function(e){n+=i.encodingLength(e)})}else if(o[t])n+=o[t].encodingLength(e);else if(e.buffer)n+=e.buffer.length;else throw new Error("Either `type` must be set to a known type (not'"+t+"') or `buffer` must be set");return n>s&&(n+=8),e.length=n,n}}).call(this,e("buffer").Buffer)},{"./boxes":50,buffer:23,uint64be:111}],53:[function(e,t){(function(n){function r(){return this instanceof r?void(s.Writable.call(this),this.destroyed=!1,this._pending=0,this._missing=0,this._buf=null,this._str=null,this._cb=null,this._ondrain=null,this._writeBuffer=null,this._writeCb=null,this._ondrain=null,this._kick()):new r}function o(e){this._parent=e,this.destroyed=!1,s.PassThrough.call(this)}var s=e("readable-stream"),i=e("inherits"),d=e("next-event"),a=e("mp4-box-encoding"),c=new n(0);t.exports=r,i(r,s.Writable),r.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,e&&this.emit("error",e),this.emit("close"))},r.prototype._write=function(e,t,n){if(!this.destroyed){for(var r=!this._str||!this._str._writableState.needDrain;e.length&&!this.destroyed;){if(!this._missing)return this._writeBuffer=e,void(this._writeCb=n);var o=e.length<this._missing?e.length:this._missing;if(this._buf?e.copy(this._buf,this._buf.length-this._missing):this._str&&(r=this._str.write(o===e.length?e:e.slice(0,o))),this._missing-=o,!this._missing){var s=this._buf,i=this._cb,d=this._str;this._buf=this._cb=this._str=this._ondrain=null,r=!0,d&&d.end(),i&&i(s)}e=o===e.length?c:e.slice(o)}return this._pending&&!this._missing?(this._writeBuffer=e,void(this._writeCb=n)):void(r?n():this._ondrain(n))}},r.prototype._buffer=function(e,t){this._missing=e,this._buf=new n(e),this._cb=t},r.prototype._stream=function(e,t){var n=this;return this._missing=e,this._str=new o(this),this._ondrain=d(this._str,"drain"),this._pending++,this._str.on("end",function(){n._pending--,n._kick()}),this._cb=t,this._str},r.prototype._readBox=function(){function e(r,o){t._buffer(r,function(r){o=o?n.concat([o,r]):r;var s=a.readHeaders(o);"number"==typeof s?e(s-o.length,o):(t._pending++,t._headers=s,t.emit("box",s))})}var t=this;e(8)},r.prototype.stream=function(){var e=this;if(!e._headers)throw new Error("this function can only be called once after 'box' is emitted");var t=e._headers;return e._headers=null,e._stream(t.contentLen,null)},r.prototype.decode=function(e){var t=this;if(!t._headers)throw new Error("this function can only be called once after 'box' is emitted");var n=t._headers;t._headers=null,t._buffer(n.contentLen,function(r){var o=a.decodeWithoutHeaders(n,r);e(o),t._pending--,t._kick()})},r.prototype.ignore=function(){var e=this;if(!e._headers)throw new Error("this function can only be called once after 'box' is emitted");var t=e._headers;e._headers=null,this._missing=t.contentLen,this._cb=function(){e._pending--,e._kick()}},r.prototype._kick=function(){if(!this._pending&&(this._buf||this._str||this._readBox(),this._writeBuffer)){var e=this._writeCb,t=this._writeBuffer;this._writeBuffer=null,this._writeCb=null,this._write(t,null,e)}},i(o,s.PassThrough),o.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,this._parent.destroy(e),e&&this.emit("error",e),this.emit("close"))}}).call(this,e("buffer").Buffer)},{buffer:23,inherits:40,"mp4-box-encoding":52,"next-event":58,"readable-stream":82}],54:[function(e,t){(function(n,r){function o(){}function s(){if(!(this instanceof s))return new s;d.Readable.call(this),this.destroyed=!1,this._reading=!1,this._stream=null,this._drain=null,this._want=!1,this._onreadable=function(){e._want&&(e._want=!1,e._read())},this._onend=function(){e._stream=null};var e=this}function i(e){this._parent=e,this.destroyed=!1,d.PassThrough.call(this)}var d=e("readable-stream"),a=e("inherits"),c=e("mp4-box-encoding");t.exports=s,a(s,d.Readable),s.prototype.mediaData=s.prototype.mdat=function(e,t){var n=new i(this);return this.box({type:"mdat",contentLength:e,encodeBufferLen:8,stream:n},t),n},s.prototype.box=function(e,t){if(t||(t=o),this.destroyed)return t(new Error("Encoder is destroyed"));var s;if(e.encodeBufferLen&&(s=new r(e.encodeBufferLen)),e.stream)e.buffer=null,s=c.encode(e,s),this.push(s),this._stream=e.stream,this._stream.on("readable",this._onreadable),this._stream.on("end",this._onend),this._stream.on("end",t),this._forward();else{s=c.encode(e,s);var i=this.push(s);if(i)return n.nextTick(t);this._drain=t}},s.prototype.destroy=function(e){if(!this.destroyed){if(this.destroyed=!0,this._stream&&this._stream.destroy&&this._stream.destroy(),this._stream=null,this._drain){var t=this._drain;this._drain=null,t(e)}e&&this.emit("error",e),this.emit("close")}},s.prototype.finalize=function(){this.push(null)},s.prototype._forward=function(){if(this._stream)for(;!this.destroyed;){var e=this._stream.read();if(!e)return void(this._want=!!this._stream);if(!this.push(e))return}},s.prototype._read=function(){if(!(this._reading||this.destroyed)){if(this._reading=!0,this._stream&&this._forward(),this._drain){var e=this._drain;this._drain=null,e()}this._reading=!1}},a(i,d.PassThrough),i.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,this._parent.destroy(e),e&&this.emit("error",e),this.emit("close"))}}).call(this,e("_process"),e("buffer").Buffer)},{_process:65,buffer:23,inherits:40,"mp4-box-encoding":52,"readable-stream":82}],55:[function(e,t,n){n.decode=e("./decode"),n.encode=e("./encode")},{"./decode":53,"./encode":54}],56:[function(e,t){function n(e){if(e+="",!(100<e.length)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();return"years"===n||"year"===n||"yrs"===n||"yr"===n||"y"===n?r*d:"days"===n||"day"===n||"d"===n?r*u:"hours"===n||"hour"===n||"hrs"===n||"hr"===n||"h"===n?r*p:"minutes"===n||"minute"===n||"mins"===n||"min"===n||"m"===n?r*s:"seconds"===n||"second"===n||"secs"===n||"sec"===n||"s"===n?r*l:"milliseconds"===n||"millisecond"===n||"msecs"===n||"msec"===n||"ms"===n?r:void 0}}}function i(e){var t=_Mathround;return e>=u?t(e/u)+"d":e>=p?t(e/p)+"h":e>=s?t(e/s)+"m":e>=l?t(e/l)+"s":e+"ms"}function a(e){return c(e,u,"day")||c(e,p,"hour")||c(e,s,"minute")||c(e,l,"second")||e+" ms"}function c(e,t,n){return e<t?void 0:e<1.5*t?r(e/t)+" "+n:o(e/t)+" "+n+"s"}var l=1e3,s=60*l,p=60*s,u=24*p,d=365.25*u;t.exports=function(e,t){t=t||{};var r=typeof e;if("string"==r&&0<e.length)return n(e);if("number"==r&&!1===isNaN(e))return t.long?a(e):i(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],57:[function(e,t){function n(e,t){var o=this;return o instanceof n?void(i.Readable.call(o,t),o.destroyed=!1,o._drained=!1,o._forwarding=!1,o._current=null,"function"==typeof e?o._queue=e:(o._queue=e.map(r),o._queue.forEach(function(e){"function"!=typeof e&&o._attachErrorListener(e)})),o._next()):new n(e,t)}function r(e){if(!e||"function"==typeof e||e._readableState)return e;var t=new i.Readable().wrap(e);return e.destroy&&(t.destroy=e.destroy.bind(e)),t}t.exports=n;var o=e("inherits"),i=e("readable-stream");o(n,i.Readable),n.obj=function(e){return new n(e,{objectMode:!0,highWaterMark:16})},n.prototype._read=function(){this._drained=!0,this._forward()},n.prototype._forward=function(){if(!this._forwarding&&this._drained&&this._current){this._forwarding=!0;for(var e;null!==(e=this._current.read());)this._drained=this.push(e);this._forwarding=!1}},n.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,this._current&&this._current.destroy&&this._current.destroy(),"function"!=typeof this._queue&&this._queue.forEach(function(e){e.destroy&&e.destroy()}),e&&this.emit("error",e),this.emit("close"))},n.prototype._next=function(){var e=this;if(e._current=null,"function"==typeof e._queue)e._queue(function(t,n){return t?e.destroy(t):void(n=r(n),e._attachErrorListener(n),e._gotNextStream(n))});else{var t=e._queue.shift();"function"==typeof t&&(t=r(t()),e._attachErrorListener(t)),e._gotNextStream(t)}},n.prototype._gotNextStream=function(e){function t(){o._forward()}function n(){e._readableState.ended||o.destroy()}function r(){o._current=null,e.removeListener("readable",t),e.removeListener("end",r),e.removeListener("close",n),o._next()}var o=this;return e?void(o._current=e,o._forward(),e.on("readable",t),e.once("end",r),e.once("close",n)):(o.push(null),void o.destroy())},n.prototype._attachErrorListener=function(e){function t(r){e.removeListener("error",t),n.destroy(r)}var n=this;e&&e.once("error",t)}},{inherits:40,"readable-stream":82}],58:[function(e,t){t.exports=function(e,t){var n=null;return e.on(t,function(e){if(n){var t=n;n=null,t(e)}}),function(e){n=e}}},{}],59:[function(e,t){function n(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function r(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},n=e.name||"Function wrapped with `once`";return t.onceError=n+" shouldn't be called more than once",t.called=!1,t}var o=e("wrappy");t.exports=o(n),t.exports.strict=o(r),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return r(this)},configurable:!0})})},{wrappy:121}],60:[function(e,t){(function(n){function r(e){n.isBuffer(e)&&(e=d.decode(e)),i(e.info,"info"),i(e.info["name.utf-8"]||e.info.name,"info.name"),i(e.info["piece length"],"info['piece length']"),i(e.info.pieces,"info.pieces"),e.info.files?e.info.files.forEach(function(e){i("number"==typeof e.length,"info.files[0].length"),i(e["path.utf-8"]||e.path,"info.files[0].path")}):i("number"==typeof e.info.length,"info.length");var t={};t.info=e.info,t.infoBuffer=d.encode(e.info),t.infoHash=c.sync(t.infoBuffer),t.infoHashBuffer=n.from(t.infoHash,"hex"),t.name=(e.info["name.utf-8"]||e.info.name).toString(),void 0!==e.info.private&&(t.private=!!e.info.private),e["creation date"]&&(t.created=new Date(1e3*e["creation date"])),e["created by"]&&(t.createdBy=e["created by"].toString()),n.isBuffer(e.comment)&&(t.comment=e.comment.toString()),t.announce=[],e["announce-list"]&&e["announce-list"].length?e["announce-list"].forEach(function(e){e.forEach(function(e){t.announce.push(e.toString())})}):e.announce&&t.announce.push(e.announce.toString()),n.isBuffer(e["url-list"])&&(e["url-list"]=0<e["url-list"].length?[e["url-list"]]:[]),t.urlList=(e["url-list"]||[]).map(function(e){return e.toString()}),l(t.announce),l(t.urlList);var r=e.info.files||[e.info];t.files=r.map(function(e,n){var s=[].concat(t.name,e["path.utf-8"]||e.path||[]).map(function(e){return e.toString()});return{path:a.join.apply(null,[a.sep].concat(s)).slice(1),name:s[s.length-1],length:e.length,offset:r.slice(0,n).reduce(o,0)}}),t.length=r.reduce(o,0);var p=t.files[t.files.length-1];return t.pieceLength=e.info["piece length"],t.lastPieceLength=(p.offset+p.length)%t.pieceLength||t.pieceLength,t.pieces=s(e.info.pieces),t}function o(e,t){return e+t.length}function s(e){for(var t=[],n=0;n<e.length;n+=20)t.push(e.slice(n,n+20).toString("hex"));return t}function i(e,t){if(!e)throw new Error("Torrent is missing required field: "+t)}t.exports=r,t.exports.decode=r,t.exports.encode=function(e){var t={info:e.info};return t["announce-list"]=(e.announce||[]).map(function(e){return t.announce||(t.announce=e),e=n.from(e,"utf8"),[e]}),t["url-list"]=e.urlList||[],e.created&&(t["creation date"]=0|e.created.getTime()/1e3),e.createdBy&&(t["created by"]=e.createdBy),e.comment&&(t.comment=e.comment),d.encode(t)};var d=e("bencode"),a=e("path"),c=e("simple-sha1"),l=e("uniq")}).call(this,e("buffer").Buffer)},{bencode:11,buffer:23,path:62,"simple-sha1":94,uniq:112}],61:[function(e,t){(function(n,r){function o(e){if("string"==typeof e&&/^(stream-)?magnet:/.test(e))return c(e);if("string"==typeof e&&(/^[a-f0-9]{40}$/i.test(e)||/^[a-z2-7]{32}$/i.test(e)))return c("magnet:?xt=urn:btih:"+e);if(r.isBuffer(e)&&20===e.length)return c("magnet:?xt=urn:btih:"+e.toString("hex"));if(r.isBuffer(e))return l(e);if(e&&e.infoHash)return e.announce||(e.announce=[]),"string"==typeof e.announce&&(e.announce=[e.announce]),e.urlList||(e.urlList=[]),e;throw new Error("Invalid torrent identifier")}function s(e){return"undefined"!=typeof Blob&&e instanceof Blob}t.exports=o,t.exports.remote=function(e,t){function r(e){try{c=o(e)}catch(e){return t(e)}c&&c.infoHash?t(null,c):t(new Error("Invalid torrent identifier"))}var c;if("function"!=typeof t)throw new Error("second argument must be a Function");try{c=o(e)}catch(e){}c&&c.infoHash?n.nextTick(function(){t(null,c)}):s(e)?i(e,function(e,n){return e?t(new Error("Error converting Blob: "+e.message)):void r(n)}):"function"==typeof a&&/^https?:/.test(e)?a.concat({url:e,timeout:3e4,headers:{"user-agent":"WebTorrent (http://webtorrent.io)"}},function(e,n,o){return e?t(new Error("Error downloading torrent: "+e.message)):void r(o)}):"function"==typeof d.readFile&&"string"==typeof e?d.readFile(e,function(e,n){return e?t(new Error("Invalid torrent identifier")):void r(n)}):n.nextTick(function(){t(new Error("Invalid torrent identifier"))})};var i=e("blob-to-buffer"),d=e("fs"),a=e("simple-get"),c=e("magnet-uri"),l=e("parse-torrent-file");t.exports.toMagnetURI=c.encode,t.exports.toTorrentFile=l.encode,function(){r.alloc(0)}()}).call(this,e("_process"),e("buffer").Buffer)},{_process:65,"blob-to-buffer":19,buffer:23,fs:22,"magnet-uri":47,"parse-torrent-file":60,"simple-get":92}],62:[function(e,t,n){(function(e){function t(e,t){for(var n=0,r=e.length-1,o;0<=r;r--)o=e[r],"."===o?e.splice(r,1):".."===o?(e.splice(r,1),n++):n&&(e.splice(r,1),n--);if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(e){return o.exec(e).slice(1)};n.resolve=function(){for(var n="",o=!1,s=arguments.length-1,i;-1<=s&&!o;s--){if(i=0<=s?arguments[s]:e.cwd(),"string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");else if(!i)continue;n=i+"/"+n,o="/"===i.charAt(0)}return n=t(r(n.split("/"),function(e){return!!e}),!o).join("/"),(o?"/":"")+n||"."},n.normalize=function(e){var o=n.isAbsolute(e),s="/"===i(e,-1);return e=t(r(e.split("/"),function(e){return!!e}),!o).join("/"),e||o||(e="."),e&&s&&(e+="/"),(o?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(r(e,function(e){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;0<=n&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var o=r(e.split("/")),s=r(t.split("/")),a=d(o.length,s.length),c=a,l=0;l<a;l++)if(o[l]!==s[l]){c=l;break}for(var i=[],l=c;l<o.length;l++)i.push("..");return i=i.concat(s.slice(c)),i.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var t=s(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(e,t){var n=s(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return s(e)[3]};var i=function(e,t,n){return e.substr(t,n)}}).call(this,e("_process"))},{_process:65}],63:[function(e,t){for(var r=e("closest-to"),o=1024,s=13,i=[];22>s++;)i.push(n(2,s));t.exports=function(e){return r(e/o,i)}},{"closest-to":26}],64:[function(e,t){(function(e){"use strict";t.exports=e.version&&0!==e.version.indexOf("v0.")&&(0!==e.version.indexOf("v1.")||0===e.version.indexOf("v1.8."))?e:{nextTick:function(t,n,r,o){if("function"!=typeof t)throw new TypeError("\"callback\" argument must be a function");var s=arguments.length,d,a;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,o)});default:for(d=Array(s-1),a=0;a<d.length;)d[a++]=arguments[a];return e.nextTick(function(){t.apply(null,d)});}}}}).call(this,e("_process"))},{_process:65}],65:[function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(p===setTimeout)return setTimeout(e,0);if((p===n||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function s(e){if(u===clearTimeout)return clearTimeout(e);if((u===r||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{return u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}function i(){h&&g&&(h=!1,g.length?f=g.concat(f):m=-1,f.length&&d())}function d(){if(!h){var e=o(i);h=!0;for(var t=f.length;t;){for(g=f,f=[];++m<t;)g&&g[m].run();m=-1,t=f.length}g=null,h=!1,s(e)}}function a(e,t){this.fun=e,this.array=t}function c(){}var l=t.exports={},p,u;(function(){try{p="function"==typeof setTimeout?setTimeout:n}catch(t){p=n}try{u="function"==typeof clearTimeout?clearTimeout:r}catch(t){u=r}})();var f=[],h=!1,m=-1,g;l.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new a(e,t)),1!==f.length||h||o(d)},a.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=c,l.addListener=c,l.once=c,l.off=c,l.removeListener=c,l.removeAllListeners=c,l.emit=c,l.prependListener=c,l.prependOnceListener=c,l.listeners=function(){return[]},l.binding=function(){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],66:[function(e,t){(function(n){var r=e("once"),o=e("end-of-stream"),s=e("fs"),i=function(){},d=/^v?\.0/.test(n.version),a=function(e){return"function"==typeof e},c=function(e){return!!d&&!!s&&(e instanceof(s.ReadStream||i)||e instanceof(s.WriteStream||i))&&a(e.close)},l=function(e){return e.setHeader&&a(e.abort)},p=function(e,t,n,s){s=r(s);var d=!1;e.on("close",function(){d=!0}),o(e,{readable:t,writable:n},function(e){return e?s(e):void(d=!0,s())});var p=!1;return function(t){if(!d)return p?void 0:(p=!0,c(e)?e.close(i):l(e)?e.abort():a(e.destroy)?e.destroy():void s(t||new Error("stream was destroyed")))}},u=function(e){e()},f=function(e,t){return e.pipe(t)};t.exports=function(){var e=Array.prototype.slice.call(arguments),t=a(e[e.length-1]||i)&&e.pop()||i;if(Array.isArray(e[0])&&(e=e[0]),2>e.length)throw new Error("pump requires two streams per minimum");var n=e.map(function(o,s){var i=s<e.length-1;return p(o,i,0<s,function(e){r||(r=e),e&&n.forEach(u),i||(n.forEach(u),t(r))})}),r;return e.reduce(f)}}).call(this,e("_process"))},{_process:65,"end-of-stream":32,fs:21,once:59}],67:[function(t,n,o){(function(t){(function(s){function d(e){throw new RangeError(U[e])}function a(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function c(e,t){var n=e.split("@"),r="";1<n.length&&(r=n[0]+"@",e=n[1]),e=e.replace(A,".");var o=e.split("."),s=a(o,t).join(".");return r+s}function l(e){for(var t=[],n=0,r=e.length,o,s;n<r;)o=e.charCodeAt(n++),55296<=o&&56319>=o&&n<r?(s=e.charCodeAt(n++),56320==(64512&s)?t.push(((1023&o)<<10)+(1023&s)+65536):(t.push(o),n--)):t.push(o);return t}function p(e){return a(e,function(e){var t="";return 65535<e&&(e-=65536,t+=O(55296|1023&e>>>10),e=56320|1023&e),t+=O(e),t}).join("")}function u(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:v}function f(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function h(e,t,n){var r=0;for(e=n?P(e/E):e>>1,e+=P(e/t);e>R*C>>1;r+=v)e=P(e/R);return P(r+(R+1)*e/(e+w))}function m(e){var r=[],o=e.length,s=0,i=I,n=B,a,c,l,f,m,g,_,y,b,t;for(c=e.lastIndexOf(L),0>c&&(c=0),l=0;l<c;++l)128<=e.charCodeAt(l)&&d("not-basic"),r.push(e.charCodeAt(l));for(f=0<c?c+1:0;f<o;){for(m=s,g=1,_=v;;_+=v){if(f>=o&&d("invalid-input"),y=u(e.charCodeAt(f++)),(y>=v||y>P((x-s)/g))&&d("overflow"),s+=y*g,b=_<=n?S:_>=n+C?C:_-n,y<b)break;t=v-b,g>P(x/t)&&d("overflow"),g*=t}a=r.length+1,n=h(s-m,a,0==m),P(s/a)>x-i&&d("overflow"),i+=P(s/a),s%=a,r.splice(s++,0,i)}return p(r)}function g(e){var r=[],o,n,s,i,a,c,p,u,m,g,t,_,y,b,w;for(e=l(e),_=e.length,o=I,n=0,a=B,c=0;c<_;++c)t=e[c],128>t&&r.push(O(t));for(s=i=r.length,i&&r.push(L);s<_;){for(p=x,c=0;c<_;++c)t=e[c],t>=o&&t<p&&(p=t);for(y=s+1,p-o>P((x-n)/y)&&d("overflow"),n+=(p-o)*y,o=p,c=0;c<_;++c)if(t=e[c],t<o&&++n>x&&d("overflow"),t==o){for(u=n,m=v;;m+=v){if(g=m<=a?S:m>=a+C?C:m-a,u<g)break;w=u-g,b=v-g,r.push(O(f(g+w%b,0))),u=P(w/b)}r.push(O(f(u,0))),a=h(n,y,s==i),n=0,++s}++n,++o}return r.join("")}var _="object"==typeof o&&o&&!o.nodeType&&o,y="object"==typeof n&&n&&!n.nodeType&&n,b="object"==typeof t&&t;(b.global===b||b.window===b||b.self===b)&&(s=b);var x=2147483647,v=36,S=1,C=26,w=38,E=700,B=72,I=128,L="-",k=/^xn--/,T=/[^\x20-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,U={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=v-S,P=r,O=e,H,M;if(H={version:"1.4.1",ucs2:{decode:l,encode:p},decode:m,encode:g,toASCII:function(e){return c(e,function(e){return T.test(e)?"xn--"+g(e):e})},toUnicode:function(e){return c(e,function(e){return k.test(e)?m(e.slice(4).toLowerCase()):e})}},"function"==typeof i&&"object"==typeof i.amd&&i.amd)i("punycode",function(){return H});else if(!(_&&y))s.punycode=H;else if(n.exports==_)y.exports=H;else for(M in H)H.hasOwnProperty(M)&&(_[M]=H[M])})(this)}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],68:[function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,o,s){t=t||"&",o=o||"=";var d={};if("string"!=typeof e||0===e.length)return d;var a=/\+/g;e=e.split(t);var c=1e3;s&&"number"==typeof s.maxKeys&&(c=s.maxKeys);var l=e.length;0<c&&l>c&&(l=c);for(var p=0;p<l;++p){var i=e[p].replace(a,"%20"),u=i.indexOf(o),f,h,m,g;0<=u?(f=i.substr(0,u),h=i.substr(u+1)):(f=i,h=""),m=decodeURIComponent(f),g=decodeURIComponent(h),n(d,m)?r(d[m])?d[m].push(g):d[m]=[d[m],g]:d[m]=g}return d};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],69:[function(e,t){"use strict";function n(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return"";}};t.exports=function(e,t,i,d){return t=t||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e?n(s(e),function(s){var d=encodeURIComponent(r(s))+i;return o(e[s])?n(e[s],function(e){return d+encodeURIComponent(r(e))}).join(t):d+encodeURIComponent(r(e[s]))}).join(t):d?encodeURIComponent(r(d))+i+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],70:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":68,"./encode":69}],71:[function(e,t){t.exports=function(e){var t=0;return function(){if(t===e.length)return null;var n=e.length-t,r=0|Math.random()*n,o=e[t+r],s=e[t];return e[t]=o,e[t+r]=s,t++,o}}},{}],72:[function(e,t){(function(n,r){"use strict";var o=e("safe-buffer").Buffer,s=r.crypto||r.msCrypto;t.exports=s&&s.getRandomValues?function(e,t){if(65536<e)throw new Error("requested too many random bytes");var i=new r.Uint8Array(e);0<e&&s.getRandomValues(i);var d=o.from(i.buffer);return"function"==typeof t?n.nextTick(function(){t(null,d)}):d}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{_process:65,"safe-buffer":90}],73:[function(e,t){function n(e,t){var r=this;return r instanceof n?void(o.Writable.call(r,t),r.destroyed=!1,r._queue=[],r._position=e||0,r._cb=null,r._buffer=null,r._out=null):new n(e)}var r=e("inherits"),o=e("readable-stream");t.exports=n,r(n,o.Writable),n.prototype._write=function(e,t,n){for(var r=this,o=!0;;){if(r.destroyed)return;if(0===r._queue.length)return r._buffer=e,void(r._cb=n);r._buffer=null;var i=r._queue[0],d=s(i.start-r._position,0),a=i.end-r._position;if(d>=e.length)return r._position+=e.length,n(null);var c;if(a>e.length){r._position+=e.length,c=0===d?e:e.slice(d),o=i.stream.write(c)&&o;break}r._position+=a,c=0===d&&a===e.length?e:e.slice(d,a),o=i.stream.write(c)&&o,i.last&&i.stream.end(),e=e.slice(a),r._queue.shift()}o?n(null):i.stream.once("drain",n.bind(null,null))},n.prototype.slice=function(e){var t=this;if(t.destroyed)return null;e instanceof Array||(e=[e]);var n=new o.PassThrough;return e.forEach(function(r,o){t._queue.push({start:r.start,end:r.end,stream:n,last:o===e.length-1})}),t._buffer&&t._write(t._buffer,null,t._cb),n},n.prototype.destroy=function(e){var t=this;t.destroyed||(t.destroyed=!0,e&&t.emit("error",e))}},{inherits:40,"readable-stream":82}],74:[function(e,t){"use strict";function n(e){return this instanceof n?void(a.call(this,e),c.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",r)):new n(e)}function r(){this.allowHalfOpen||this._writableState.ended||s(o,this)}function o(e){e.end()}var s=e("process-nextick-args").nextTick,i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=n;var d=e("core-util-is");d.inherits=e("inherits");var a=e("./_stream_readable"),c=e("./_stream_writable");d.inherits(n,a);for(var l=i(c.prototype),p=0,u;p<l.length;p++)u=l[p],n.prototype[u]||(n.prototype[u]=c.prototype[u]);Object.defineProperty(n.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),n.prototype._destroy=function(e,t){this.push(null),this.end(),s(t,e)}},{"./_stream_readable":76,"./_stream_writable":78,"core-util-is":27,inherits:40,"process-nextick-args":64}],75:[function(e,t){"use strict";function n(e){return this instanceof n?void r.call(this,e):new n(e)}t.exports=n;var r=e("./_stream_transform"),o=e("core-util-is");o.inherits=e("inherits"),o.inherits(n,r),n.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":77,"core-util-is":27,inherits:40}],76:[function(e,t){(function(n,o){"use strict";function s(e){return j.from(e)}function i(e){return j.isBuffer(e)||e instanceof F}function d(e,t,n){return"function"==typeof e.prependListener?e.prependListener(t,n):void(e._events&&e._events[t]?P(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n))}function a(t,n){O=O||e("./_stream_duplex"),t=t||{};var o=n instanceof O;this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var s=t.highWaterMark,i=t.readableHighWaterMark,d=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:o&&(i||0===i)?i:d,this.highWaterMark=r(this.highWaterMark),this.buffer=new z,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(!G&&(G=e("string_decoder/").StringDecoder),this.decoder=new G(t.encoding),this.encoding=t.encoding)}function c(t){return O=O||e("./_stream_duplex"),this instanceof c?void(this._readableState=new a(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),q.call(this)):new c(t)}function l(e,t,n,r,o){var i=e._readableState;if(null===t)i.reading=!1,g(e,i);else{var d;o||(d=u(i,t)),d?e.emit("error",d):i.objectMode||t&&0<t.length?("string"!=typeof t&&!i.objectMode&&Object.getPrototypeOf(t)!==j.prototype&&(t=s(t)),r?i.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):p(e,i,t,!0):i.ended?e.emit("error",new Error("stream.push() after EOF")):(i.reading=!1,i.decoder&&!n?(t=i.decoder.write(t),i.objectMode||0!==t.length?p(e,i,t,!1):b(e,i)):p(e,i,t,!1))):!r&&(i.reading=!1)}return f(i)}function p(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&_(e)),b(e,t)}function u(e,t){var n;return i(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function f(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function h(e){return e>=X?e=X:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function m(e,t){return 0>=e||0===t.length&&t.ended?0:t.objectMode?1:e===e?(e>t.highWaterMark&&(t.highWaterMark=h(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)):t.flowing&&t.length?t.buffer.head.data.length:t.length}function g(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,_(e)}}function _(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(W("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?R(y,e):y(e))}function y(e){W("emit readable"),e.emit("readable"),C(e)}function b(e,t){t.readingMore||(t.readingMore=!0,R(w,e,t))}function w(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(W("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function k(e){return function(){var t=e._readableState;W("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&M(e,"data")&&(t.flowing=!0,C(e))}}function x(e){W("readable nexttick read 0"),e.read(0)}function v(e,t){t.resumeScheduled||(t.resumeScheduled=!0,R(S,e,t))}function S(e,t){t.reading||(W("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),C(e),t.flowing&&!t.reading&&e.read(0)}function C(e){var t=e._readableState;for(W("flow",t.flowing);t.flowing&&null!==e.read(););}function E(e,t){if(0===t.length)return null;var r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=B(e,t.buffer,t.decoder),r}function B(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):e===t.head.data.length?r=t.shift():r=n?I(e,t):L(e,t),r}function I(e,t){var n=t.head,r=1,o=n.data;for(e-=o.length;n=n.next;){var s=n.data,i=e>s.length?s.length:e;if(o+=i===s.length?s:s.slice(0,e),e-=i,0===e){i===s.length?(++r,t.head=n.next?n.next:t.tail=null):(t.head=n,n.data=s.slice(i));break}++r}return t.length-=r,o}function L(e,t){var n=j.allocUnsafe(e),r=t.head,o=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var s=r.data,i=e>s.length?s.length:e;if(s.copy(n,n.length-e,0,i),e-=i,0===e){i===s.length?(++o,t.head=r.next?r.next:t.tail=null):(t.head=r,r.data=s.slice(i));break}++o}return t.length-=o,n}function T(e){var t=e._readableState;if(0<t.length)throw new Error("\"endReadable()\" called on non-empty stream");t.endEmitted||(t.ended=!0,R(A,t,e))}function A(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function U(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}var R=e("process-nextick-args").nextTick;t.exports=c;var P=e("isarray"),O;c.ReadableState=a;var H=e("events").EventEmitter,M=function(e,t){return e.listeners(t).length},q=e("./internal/streams/stream"),j=e("safe-buffer").Buffer,F=o.Uint8Array||function(){},N=e("core-util-is");N.inherits=e("inherits");var D=e("util"),W;W=D&&D.debuglog?D.debuglog("stream"):function(){};var z=e("./internal/streams/BufferList"),V=e("./internal/streams/destroy"),G;N.inherits(c,q);var K=["error","close","destroy","pause","resume"];Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),c.prototype.destroy=V.destroy,c.prototype._undestroy=V.undestroy,c.prototype._destroy=function(e,t){this.push(null),t(e)},c.prototype.push=function(e,t){var n=this._readableState,r;return n.objectMode?r=!0:"string"==typeof e&&(t=t||n.defaultEncoding,t!==n.encoding&&(e=j.from(e,t),t=""),r=!0),l(this,e,t,!1,r)},c.prototype.unshift=function(e){return l(this,e,null,!0,!1)},c.prototype.isPaused=function(){return!1===this._readableState.flowing},c.prototype.setEncoding=function(t){return G||(G=e("string_decoder/").StringDecoder),this._readableState.decoder=new G(t),this._readableState.encoding=t,this};var X=8388608;c.prototype.read=function(e){W("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return W("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?T(this):_(this),null;if(e=m(e,t),0===e&&t.ended)return 0===t.length&&T(this),null;var r=t.needReadable;W("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,W("length less than watermark",r)),t.ended||t.reading?(r=!1,W("reading or ended",r)):r&&(W("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,!t.reading&&(e=m(n,t)));var o;return o=0<e?E(e,t):null,null===o?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(!t.ended&&(t.needReadable=!0),n!==e&&t.ended&&T(this)),null!==o&&this.emit("data",o),o},c.prototype._read=function(){this.emit("error",new Error("_read() is not implemented"))},c.prototype.pipe=function(e,t){function r(e,t){W("onunpipe"),e===u&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,s())}function o(){W("onend"),e.end()}function s(){W("cleanup"),e.removeListener("close",c),e.removeListener("finish",l),e.removeListener("drain",g),e.removeListener("error",a),e.removeListener("unpipe",r),u.removeListener("end",o),u.removeListener("end",p),u.removeListener("data",i),_=!0,f.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&g()}function i(t){W("ondata"),y=!1;var n=e.write(t);!1!==n||y||((1===f.pipesCount&&f.pipes===e||1<f.pipesCount&&-1!==U(f.pipes,e))&&!_&&(W("false write response, pause",u._readableState.awaitDrain),u._readableState.awaitDrain++,y=!0),u.pause())}function a(t){W("onerror",t),p(),e.removeListener("error",a),0===M(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",l),p()}function l(){W("onfinish"),e.removeListener("close",c),p()}function p(){W("unpipe"),u.unpipe(e)}var u=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=e;break;case 1:f.pipes=[f.pipes,e];break;default:f.pipes.push(e);}f.pipesCount+=1,W("pipe count=%d opts=%j",f.pipesCount,t);var h=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr,m=h?o:p;f.endEmitted?R(m):u.once("end",m),e.on("unpipe",r);var g=k(u);e.on("drain",g);var _=!1,y=!1;return u.on("data",i),d(e,"error",a),e.once("close",c),e.once("finish",l),e.emit("pipe",u),f.flowing||(W("pipe resume"),u.resume()),e},c.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<o;s++)r[s].emit("unpipe",this,n);return this}var i=U(t.pipes,e);return-1===i?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},c.prototype.on=function(e,t){var n=q.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&_(this):R(x,this))}return n},c.prototype.addListener=c.prototype.on,c.prototype.resume=function(){var e=this._readableState;return e.flowing||(W("resume"),e.flowing=!0,v(this,e)),this},c.prototype.pause=function(){return W("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(W("pause"),this._readableState.flowing=!1,this.emit("pause")),this},c.prototype.wrap=function(e){var t=this,r=this._readableState,o=!1;for(var s in e.on("end",function(){if(W("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(n){if((W("wrapped data"),r.decoder&&(n=r.decoder.write(n)),!(r.objectMode&&(null===n||void 0===n)))&&(r.objectMode||n&&n.length)){var s=t.push(n);s||(o=!0,e.pause())}}),e)void 0===this[s]&&"function"==typeof e[s]&&(this[s]=function(t){return function(){return e[t].apply(e,arguments)}}(s));for(var i=0;i<K.length;i++)e.on(K[i],this.emit.bind(this,K[i]));return this._read=function(t){W("wrapped _read",t),o&&(o=!1,e.resume())},this},c._fromList=E}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./_stream_duplex":74,"./internal/streams/BufferList":79,"./internal/streams/destroy":80,"./internal/streams/stream":81,_process:65,"core-util-is":27,events:33,inherits:40,isarray:45,"process-nextick-args":64,"safe-buffer":90,"string_decoder/":104,util:21}],77:[function(e,t){"use strict";function n(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function r(e){return this instanceof r?void(i.call(this,e),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o)):new r(e)}function o(){var e=this;"function"==typeof this._flush?this._flush(function(t,n){s(e,t,n)}):s(this,null,null)}function s(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}t.exports=r;var i=e("./_stream_duplex"),d=e("core-util-is");d.inherits=e("inherits"),d.inherits(r,i),r.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},r.prototype._transform=function(){throw new Error("_transform() is not implemented")},r.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},r.prototype._read=function(){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},r.prototype._destroy=function(e,t){var n=this;i.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},{"./_stream_duplex":74,"core-util-is":27,inherits:40}],78:[function(e,t){(function(n,o){"use strict";function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){B(t,e)}}function i(e){return P.from(e)}function d(e){return P.isBuffer(e)||e instanceof O}function a(){}function c(t,n){T=T||e("./_stream_duplex"),t=t||{};var o=n instanceof T;this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,d=t.writableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:o&&(d||0===d)?d:a,this.highWaterMark=r(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){y(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function l(t){return T=T||e("./_stream_duplex"),M.call(l,this)||this instanceof T?void(this._writableState=new c(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),R.call(this)):new l(t)}function p(e,t){var n=new Error("write after end");e.emit("error",n),I(t,n)}function u(e,t,n,r){var o=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"!=typeof n&&void 0!==n&&!t.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),I(r,s),o=!1),o}function f(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=P.from(t,n)),t}function h(e,t,n,r,o,s){if(!n){var i=f(t,r,o);r!==i&&(n=!0,o="buffer",r=i)}var d=t.objectMode?1:r.length;t.length+=d;var a=t.length<t.highWaterMark;if(a||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:o,isBuf:n,callback:s,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else m(e,t,!1,d,r,o,s);return a}function m(e,t,n,r,o,s,i){t.writelen=r,t.writecb=i,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,s,t.onwrite),t.sync=!1}function g(e,t,n,r,o){--t.pendingcb,n?(I(o,r),I(C,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(o(r),e._writableState.errorEmitted=!0,e.emit("error",r),C(e,t))}function _(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function y(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if(_(n),t)g(e,n,r,t,o);else{var s=x(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||k(e,n),r?L(b,e,n,s,o):b(e,n,s,o)}}function b(e,t,n,r){n||w(e,t),t.pendingcb--,r(),C(e,t)}function w(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function k(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=Array(r),i=t.corkedRequestsFree;i.entry=n;for(var d=0,a=!0;n;)o[d]=n,n.isBuf||(a=!1),n=n.next,d+=1;o.allBuffers=a,m(e,t,!0,t.length,o,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,i.next?(t.corkedRequestsFree=i.next,i.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,p=n.callback,u=t.objectMode?1:c.length;if(m(e,t,!1,u,c,l,p),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function x(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function v(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),C(e,t)})}function S(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,I(v,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function C(e,t){var n=x(t);return n&&(S(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}function E(e,t,n){t.ending=!0,C(e,t),n&&(t.finished?I(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function B(e,t,n){var r=e.entry;for(e.entry=null;r;){var o=r.callback;t.pendingcb--,o(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}var I=e("process-nextick-args").nextTick;t.exports=l;var L=!n.browser&&-1<["v0.10","v0.9."].indexOf(n.version.slice(0,5))?setImmediate:I,T;l.WritableState=c;var A=e("core-util-is");A.inherits=e("inherits");var U={deprecate:e("util-deprecate")},R=e("./internal/streams/stream"),P=e("safe-buffer").Buffer,O=o.Uint8Array||function(){},H=e("./internal/streams/destroy");A.inherits(l,R),c.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(c.prototype,"buffer",{get:U.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var M;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(M=Function.prototype[Symbol.hasInstance],Object.defineProperty(l,Symbol.hasInstance,{value:function(e){return!!M.call(this,e)||this===l&&e&&e._writableState instanceof c}})):M=function(e){return e instanceof this},l.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},l.prototype.write=function(e,t,n){var r=this._writableState,o=!1,s=!r.objectMode&&d(e);return s&&!P.isBuffer(e)&&(e=i(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":!t&&(t=r.defaultEncoding),"function"!=typeof n&&(n=a),r.ended?p(this,n):(s||u(this,r,e,n))&&(r.pendingcb++,o=h(this,r,s,e,t,n)),o},l.prototype.cork=function(){var e=this._writableState;e.corked++},l.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,!e.writing&&!e.corked&&!e.finished&&!e.bufferProcessing&&e.bufferedRequest&&k(this,e))},l.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},l.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},l.prototype._writev=null,l.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||E(this,r,n)},Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),l.prototype.destroy=H.destroy,l.prototype._undestroy=H.undestroy,l.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./_stream_duplex":74,"./internal/streams/destroy":80,"./internal/streams/stream":81,_process:65,"core-util-is":27,inherits:40,"process-nextick-args":64,"safe-buffer":90,"util-deprecate":117}],79:[function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,n){e.copy(t,n)}var o=e("safe-buffer").Buffer,s=e("util");t.exports=function(){function e(){n(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return o.alloc(0);if(1===this.length)return this.head.data;for(var t=o.allocUnsafe(e>>>0),n=this.head,s=0;n;)r(n.data,t,s),s+=n.data.length,n=n.next;return t},e}(),s&&s.inspect&&s.inspect.custom&&(t.exports.prototype[s.inspect.custom]=function(){var e=s.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":90,util:21}],80:[function(e,t){"use strict";function n(e,t){e.emit("error",t)}var r=e("process-nextick-args").nextTick;t.exports={destroy:function(e,t){var o=this,s=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return s||i?(t?t(e):e&&(!this._writableState||!this._writableState.errorEmitted)&&r(n,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(r(n,o,e),o._writableState&&(o._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":64}],81:[function(e,t){t.exports=e("events").EventEmitter},{events:33}],82:[function(e,t,n){n=t.exports=e("./lib/_stream_readable.js"),n.Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":74,"./lib/_stream_passthrough.js":75,"./lib/_stream_readable.js":76,"./lib/_stream_transform.js":77,"./lib/_stream_writable.js":78}],83:[function(e,t,n){function r(e,t,n,r){function s(){S.removeEventListener("loadstart",s),n.autoplay&&S.play()}function d(){S.removeEventListener("canplay",d),r(null,S)}function u(){S=t("iframe"),o(e,function(e,t){return e?w(e):void(S.src=t,".pdf"!==x&&(S.sandbox="allow-forms allow-scripts"),r(null,S))})}function w(t){t.message="Error rendering file \""+e.name+"\": "+t.message,a(t.message),r(t)}var x=p.extname(e.name).toLowerCase(),v=0,S;0<=g.indexOf(x)?function(){function r(){a("Use MediaSource API for "+e.name),g(),S.addEventListener("error",u),S.addEventListener("loadstart",s),S.addEventListener("canplay",d);var t=new l(S),n=t.createWriteStream(i(e.name));e.createReadStream().pipe(n),v&&(S.currentTime=v)}function c(){a("Use Blob URL for "+e.name),g(),S.addEventListener("error",w),S.addEventListener("loadstart",s),S.addEventListener("canplay",d),o(e,function(e,t){return e?w(e):void(S.src=t,v&&(S.currentTime=v))})}function p(e){a("videostream error: fallback to MediaSource API: %o",e.message||e),S.removeEventListener("error",p),S.removeEventListener("canplay",d),r()}function u(t){return a("MediaSource API error: fallback to Blob URL: %o",t.message||t),"number"==typeof e.length&&e.length>n.maxBlobLength?(a("File length too large for Blob URL approach: %d (max: %d)",e.length,n.maxBlobLength),w(new Error("File length too large for Blob URL approach: "+e.length+" (max: "+n.maxBlobLength+")"))):void(S.removeEventListener("error",u),S.removeEventListener("canplay",d),c())}function g(){S||(S=t(_),S.addEventListener("progress",function(){v=S.currentTime}))}var _=0<=m.indexOf(x)?"video":"audio";k?0<=h.indexOf(x)?function(){a("Use `videostream` package for "+e.name),g(),S.addEventListener("error",p),S.addEventListener("loadstart",s),S.addEventListener("canplay",d),f(e,S)}():r():c()}():0<=_.indexOf(x)?function(){S=t("audio"),o(e,function(e,t){return e?w(e):void(S.addEventListener("error",w),S.addEventListener("loadstart",s),S.addEventListener("canplay",d),S.src=t)})}():0<=y.indexOf(x)?function(){S=t("img"),o(e,function(t,n){return t?w(t):void(S.src=n,S.alt=e.name,r(null,S))})}():0<=b.indexOf(x)?u():function(){a("Unknown file extension \"%s\" - will attempt to render into iframe",x);var t="";e.createReadStream({start:0,end:1e3}).setEncoding("utf8").on("data",function(e){t+=e}).on("end",function(){c(t)?(a("File extension \"%s\" appears ascii, so will render.",x),u()):(a("File extension \"%s\" appears non-ascii, will not render.",x),r(new Error("Unsupported file type \""+x+"\": Cannot append to DOM")))}).on("error",r)}()}function o(e,t){var r=p.extname(e.name).toLowerCase();u(e.createReadStream(),n.mime[r],t)}function s(e){if(null==e)throw new Error("file cannot be null or undefined");if("string"!=typeof e.name)throw new Error("missing or invalid file.name property");if("function"!=typeof e.createReadStream)throw new Error("missing or invalid file.createReadStream property")}function i(e){var t=p.extname(e).toLowerCase();return{".m4a":"audio/mp4; codecs=\"mp4a.40.5\"",".m4v":"video/mp4; codecs=\"avc1.640029, mp4a.40.5\"",".mkv":"video/webm; codecs=\"avc1.640029, mp4a.40.5\"",".mp3":"audio/mpeg",".mp4":"video/mp4; codecs=\"avc1.640029, mp4a.40.5\"",".webm":"video/webm; codecs=\"opus, vorbis, vp8\""}[t]}function d(e){null==e.autoplay&&(e.autoplay=!0),null==e.controls&&(e.controls=!0),null==e.maxBlobLength&&(e.maxBlobLength=w)}n.render=function(e,t,n,o){"function"==typeof n&&(o=n,n={}),n||(n={}),o||(o=function(){}),s(e),d(n),"string"==typeof t&&(t=document.querySelector(t)),r(e,function(n){if(t.nodeName!==n.toUpperCase()){var r=p.extname(e.name).toLowerCase();throw new Error("Cannot render \""+r+"\" inside a \""+t.nodeName.toLowerCase()+"\" element, expected \""+n+"\"")}return t},n,o)},n.append=function(e,t,n,o){function i(e){var r=a(e);return n.controls&&(r.controls=!0),n.autoplay&&(r.autoplay=!0),t.appendChild(r),r}function a(e){var n=document.createElement(e);return t.appendChild(n),n}if("function"==typeof n&&(o=n,n={}),n||(n={}),o||(o=function(){}),s(e),d(n),"string"==typeof t&&(t=document.querySelector(t)),t&&("VIDEO"===t.nodeName||"AUDIO"===t.nodeName))throw new Error("Invalid video/audio node argument. Argument must be root element that video/audio tag will be appended to.");r(e,function(e){return"video"===e||"audio"===e?i(e):a(e)},n,function(e,t){e&&t&&t.remove(),o(e,t)})},n.mime=e("./lib/mime.json");var a=e("debug")("render-media"),c=e("is-ascii"),l=e("mediasource"),p=e("path"),u=e("stream-to-blob-url"),f=e("videostream"),h=[".m4a",".m4v",".mp4"],m=[".m4v",".mkv",".mp4",".webm"],g=[].concat(m,[".m4a",".mp3"]),_=[".aac",".oga",".ogg",".wav"],y=[".bmp",".gif",".jpeg",".jpg",".png",".svg"],b=[".css",".html",".js",".md",".pdf",".txt"],w=2e8,k="undefined"!=typeof window&&window.MediaSource},{"./lib/mime.json":84,debug:85,"is-ascii":41,mediasource:48,path:62,"stream-to-blob-url":101,videostream:120}],84:[function(e,t){t.exports={".3gp":"video/3gpp",".aac":"audio/aac",".aif":"audio/x-aiff",".aiff":"audio/x-aiff",".atom":"application/atom+xml",".avi":"video/x-msvideo",".bmp":"image/bmp",".bz2":"application/x-bzip2",".conf":"text/plain",".css":"text/css",".csv":"text/plain",".diff":"text/x-diff",".doc":"application/msword",".flv":"video/x-flv",".gif":"image/gif",".gz":"application/x-gzip",".htm":"text/html",".html":"text/html",".ico":"image/vnd.microsoft.icon",".ics":"text/calendar",".iso":"application/octet-stream",".jar":"application/java-archive",".jpeg":"image/jpeg",".jpg":"image/jpeg",".js":"application/javascript",".json":"application/json",".less":"text/css",".log":"text/plain",".m3u":"audio/x-mpegurl",".m4a":"audio/mp4",".m4v":"video/mp4",".manifest":"text/cache-manifest",".markdown":"text/x-markdown",".mathml":"application/mathml+xml",".md":"text/x-markdown",".mid":"audio/midi",".midi":"audio/midi",".mov":"video/quicktime",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4v":"video/mp4",".mpeg":"video/mpeg",".mpg":"video/mpeg",".odp":"application/vnd.oasis.opendocument.presentation",".ods":"application/vnd.oasis.opendocument.spreadsheet",".odt":"application/vnd.oasis.opendocument.text",".oga":"audio/ogg",".ogg":"application/ogg",".pdf":"application/pdf",".png":"image/png",".pps":"application/vnd.ms-powerpoint",".ppt":"application/vnd.ms-powerpoint",".ps":"application/postscript",".psd":"image/vnd.adobe.photoshop",".qt":"video/quicktime",".rar":"application/x-rar-compressed",".rdf":"application/rdf+xml",".rss":"application/rss+xml",".rtf":"application/rtf",".svg":"image/svg+xml",".svgz":"image/svg+xml",".swf":"application/x-shockwave-flash",".tar":"application/x-tar",".tbz":"application/x-bzip-compressed-tar",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".torrent":"application/x-bittorrent",".ttf":"application/x-font-ttf",".txt":"text/plain",".wav":"audio/wav",".webm":"video/webm",".wma":"audio/x-ms-wma",".wmv":"video/x-ms-wmv",".xls":"application/vnd.ms-excel",".xml":"application/xml",".yaml":"text/yaml",".yml":"text/yaml",".zip":"application/zip"}},{}],85:[function(e,t,n){(function(o){function r(){var e;try{e=n.storage.debug}catch(t){}return!e&&"undefined"!=typeof o&&"env"in o&&(e=o.env.DEBUG),e}n=t.exports=e("./debug"),n.log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!!t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"===e||(o++,"%c"===e&&(s=o))}),e.splice(s,0,r)}},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(t){}},n.load=r,n.useColors=function(){return"undefined"!=typeof window&&window.process&&"renderer"===window.process.type||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},n.enable(r())}).call(this,e("_process"))},{"./debug":86,_process:65}],86:[function(e,n,r){function o(e){var n=0,o;for(o in e)n=(n<<5)-n+e.charCodeAt(o),n|=0;return r.colors[t(n)%r.colors.length]}function s(e){function t(){if(t.enabled){var e=t,n=+new Date,o=n-(d||n);e.diff=o,e.prev=d,e.curr=n,d=n;for(var s=Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=r.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var i=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(t,n){if("%%"===t)return t;i++;var o=r.formatters[n];if("function"==typeof o){var d=s[i];t=o.call(e,d),s.splice(i,1),i--}return t}),r.formatArgs.call(e,s);var c=t.log||r.log||console.log.bind(console);c.apply(e,s)}}return t.namespace=e,t.enabled=r.enabled(e),t.useColors=r.useColors(),t.color=o(e),"function"==typeof r.init&&r.init(t),t}r=n.exports=s.debug=s["default"]=s,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){r.enable("")},r.enable=function(e){r.save(e),r.names=[],r.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length,o=0;o<n;o++)t[o]&&(e=t[o].replace(/\*/g,".*?"),"-"===e[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")))},r.enabled=function(e){var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=e("ms"),r.names=[],r.skips=[],r.formatters={};var d},{ms:56}],87:[function(e,t){(function(e){t.exports=function(t,n,r){function o(t){function n(){r&&r(t,d),r=null}i?e.nextTick(n):n()}function s(e,n,r){if(d[e]=r,n&&(p=!0),0==--c||n)o(n);else if(!p&&u<a){var i;l?(i=l[u],u+=1,t[i](function(e,t){s(i,e,t)})):(i=u,u+=1,t[i](function(e,t){s(i,e,t)}))}}if("number"!=typeof n)throw new Error("second argument must be a Number");var i=!0,d,a,c,l,p;Array.isArray(t)?(d=[],c=a=t.length):(l=Object.keys(t),d={},c=a=l.length);var u=n;c?l?l.some(function(e,r){if(t[e](function(t,n){s(e,t,n)}),r===n-1)return!0}):t.some(function(e,t){if(e(function(e,n){s(t,e,n)}),t===n-1)return!0}):o(null),i=!1}}).call(this,e("_process"))},{_process:65}],88:[function(e,t){(function(e){t.exports=function(t,n){function r(t){function r(){n&&n(t,d),n=null}s?e.nextTick(r):r()}function o(e,t,n){d[e]=n,(0==--a||t)&&r(t)}var s=!0,d,a,i;Array.isArray(t)?(d=[],a=t.length):(i=Object.keys(t),d={},a=i.length),a?i?i.forEach(function(e){t[e](function(t,n){o(e,t,n)})}):t.forEach(function(e,t){e(function(e,n){o(t,e,n)})}):r(null),s=!1}}).call(this,e("_process"))},{_process:65}],89:[function(e,t,n){(function(o){(function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof i&&i.amd)i([],e);else{var r;r="undefined"==typeof window?"undefined"==typeof o?"undefined"==typeof self?this:self:o:window,r.Rusha=e()}})(function(){return function d(c,t,n){function r(i,o){if(!t[i]){if(!c[i]){var p="function"==typeof e&&e;if(!o&&p)return p(i,!0);if(s)return s(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var f=t[i]={exports:{}};c[i][0].call(f.exports,function(t){var e=c[i][1][t];return r(e?e:t)},f,f.exports,d,c,t,n)}return t[i].exports}for(var s="function"==typeof e&&e,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t){var n=arguments[3],o=arguments[4],s=arguments[5],d=JSON.stringify;t.exports=function(e,t){function a(e){for(var t in _[e]=!0,o[e][1]){var n=o[e][1][t];_[n]||a(n)}}for(var c=Object.keys(s),p=0,i=c.length,l;p<i;p++){var u=c[p],f=s[u].exports;if(f===e||f&&f.default===e){l=u;break}}if(!l){l=r(4294967296*Math.random()).toString(16);for(var h={},p=0,i=c.length,u;p<i;p++)u=c[p],h[u]=u;o[l]=["function(require,module,exports){"+e+"(self); }",h]}var m=r(4294967296*Math.random()).toString(16),g={};g[l]=l,o[m]=["function(require,module,exports){var f = require("+d(l)+");(f.default ? f.default : f)(self);}",g];var _={};a(m);var y="("+n+")({"+Object.keys(_).map(function(e){return d(e)+":["+o[e][0]+","+d(o[e][1])+"]"}).join(",")+"},{},["+d(m)+"])",b=window.URL||window.webkitURL||window.mozURL||window.msURL,w=new Blob([y],{type:"text/javascript"});if(t&&t.bare)return w;var k=b.createObjectURL(w),x=new Worker(k);return x.objectURL=k,x}},{}],2:[function(e,t){(function(e){"use strict";var n;"undefined"!=typeof self&&"undefined"!=typeof self.FileReaderSync&&(n=new self.FileReaderSync);var r=function(e,t,n,r,o,s){var d=s%4,a=(o+d)%4,c=o-a,l;switch(d){case 0:t[s]=e.charCodeAt(r+3);case 1:t[0|s+1-(d<<1)]=e.charCodeAt(r+2);case 2:t[0|s+2-(d<<1)]=e.charCodeAt(r+1);case 3:t[0|s+3-(d<<1)]=e.charCodeAt(r);}if(!(o<a+(4-d))){for(l=4-d;l<c;l=0|l+4)n[s+l>>2]=e.charCodeAt(r+l)<<24|e.charCodeAt(r+l+1)<<16|e.charCodeAt(r+l+2)<<8|e.charCodeAt(r+l+3);switch(a){case 3:t[0|s+c+1]=e.charCodeAt(r+c+2);case 2:t[0|s+c+2]=e.charCodeAt(r+c+1);case 1:t[0|s+c+3]=e.charCodeAt(r+c);}}},o=function(e,t,n,r,o,s){var d=s%4,a=(o+d)%4,c=o-a,l;switch(d){case 0:t[s]=e[r+3];case 1:t[0|s+1-(d<<1)]=e[r+2];case 2:t[0|s+2-(d<<1)]=e[r+1];case 3:t[0|s+3-(d<<1)]=e[r];}if(!(o<a+(4-d))){for(l=4-d;l<c;l=0|l+4)n[0|s+l>>2]=e[r+l]<<24|e[r+l+1]<<16|e[r+l+2]<<8|e[r+l+3];switch(a){case 3:t[0|s+c+1]=e[r+c+2];case 2:t[0|s+c+2]=e[r+c+1];case 1:t[0|s+c+3]=e[r+c];}}},s=function(e,t,r,o,s,d){var a=d%4,c=(s+a)%4,l=s-c,p=new Uint8Array(n.readAsArrayBuffer(e.slice(o,o+s))),u;switch(a){case 0:t[d]=p[3];case 1:t[0|d+1-(a<<1)]=p[2];case 2:t[0|d+2-(a<<1)]=p[1];case 3:t[0|d+3-(a<<1)]=p[0];}if(!(s<c+(4-a))){for(u=4-a;u<l;u=0|u+4)r[0|d+u>>2]=p[u]<<24|p[u+1]<<16|p[u+2]<<8|p[u+3];switch(c){case 3:t[0|d+l+1]=p[l+2];case 2:t[0|d+l+2]=p[l+1];case 1:t[0|d+l+3]=p[l];}}};t.exports=function(t,n,i,d,a,c){if("string"==typeof t)return r(t,n,i,d,a,c);if(t instanceof Array)return o(t,n,i,d,a,c);if(e.Buffer&&e.Buffer.isBuffer(t))return o(t,n,i,d,a,c);if(t instanceof ArrayBuffer)return o(new Uint8Array(t),n,i,d,a,c);if(t.buffer instanceof ArrayBuffer)return o(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n,i,d,a,c);if(t instanceof Blob)return s(t,n,i,d,a,c);throw new Error("Unsupported data type.")}}).call(this,"undefined"==typeof o?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:o)},{}],3:[function(e,t){"use strict";t.exports=function(e,t,n){"use asm";var r=new e.Int32Array(n);return{hash:function(e,t){e|=0,t|=0;var n=0,o=0,s=0,i=0,d=0,a=0,c=0,l=0,p=0,u=0,f=0,h=0,m=0,g=0;for(s=0|r[t+320>>2],d=0|r[t+324>>2],c=0|r[t+328>>2],p=0|r[t+332>>2],f=0|r[t+336>>2],n=0;(0|n)<(0|e);n=0|n+64){for(i=s,a=d,l=c,u=p,h=f,o=0;64>(0|o);o=0|o+4)g=0|r[n+o>>2],m=0|(0|(s<<5|s>>>27)+(d&c|~d&p))+(0|(0|g+f)+1518500249),f=p,p=c,c=d<<30|d>>>2,d=s,s=m,r[e+o>>2]=g;for(o=0|e+64;(0|o)<(0|e+80);o=0|o+4)g=(r[o-12>>2]^r[o-32>>2]^r[o-56>>2]^r[o-64>>2])<<1|(r[o-12>>2]^r[o-32>>2]^r[o-56>>2]^r[o-64>>2])>>>31,m=0|(0|(s<<5|s>>>27)+(d&c|~d&p))+(0|(0|g+f)+1518500249),f=p,p=c,c=d<<30|d>>>2,d=s,s=m,r[o>>2]=g;for(o=0|e+80;(0|o)<(0|e+160);o=0|o+4)g=(r[o-12>>2]^r[o-32>>2]^r[o-56>>2]^r[o-64>>2])<<1|(r[o-12>>2]^r[o-32>>2]^r[o-56>>2]^r[o-64>>2])>>>31,m=0|(0|(s<<5|s>>>27)+(d^c^p))+(0|(0|g+f)+1859775393),f=p,p=c,c=d<<30|d>>>2,d=s,s=m,r[o>>2]=g;for(o=0|e+160;(0|o)<(0|e+240);o=0|o+4)g=(r[o-12>>2]^r[o-32>>2]^r[o-56>>2]^r[o-64>>2])<<1|(r[o-12>>2]^r[o-32>>2]^r[o-56>>2]^r[o-64>>2])>>>31,m=0|(0|(s<<5|s>>>27)+(d&c|d&p|c&p))+(0|(0|g+f)-1894007588),f=p,p=c,c=d<<30|d>>>2,d=s,s=m,r[o>>2]=g;for(o=0|e+240;(0|o)<(0|e+320);o=0|o+4)g=(r[o-12>>2]^r[o-32>>2]^r[o-56>>2]^r[o-64>>2])<<1|(r[o-12>>2]^r[o-32>>2]^r[o-56>>2]^r[o-64>>2])>>>31,m=0|(0|(s<<5|s>>>27)+(d^c^p))+(0|(0|g+f)-899497514),f=p,p=c,c=d<<30|d>>>2,d=s,s=m,r[o>>2]=g;s=0|s+i,d=0|d+a,c=0|c+l,p=0|p+u,f=0|f+h}r[t+320>>2]=s,r[t+324>>2]=d,r[t+328>>2]=c,r[t+332>>2]=p,r[t+336>>2]=f}}}},{}],4:[function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=e("./rusha"),o=e("./utils"),s=o.toHex,i=function(){function e(){n(this,e),this._rusha=new r,this._rusha.resetState()}return e.prototype.update=function(e){return this._rusha.append(e),this},e.prototype.digest=function(e){var t=this._rusha.rawEnd().buffer;if(!e)return t;if("hex"===e)return s(t);throw new Error("unsupported digest encoding")},e}();t.exports=function(){return new i}},{"./rusha":6,"./utils":7}],5:[function(e,t){"use strict";var n=e("webworkify"),r=e("./rusha"),o=e("./hash"),s=e("./worker"),i=e("./utils"),d=i.isDedicatedWorkerScope,a="undefined"!=typeof self&&d(self);r.disableWorkerBehaviour=a?s():function(){},r.createWorker=function(){var t=n(e("./worker")),r=t.terminate;return t.terminate=function(){URL.revokeObjectURL(t.objectURL),r.call(t)},t},r.createHash=o,t.exports=r},{"./hash":4,"./rusha":6,"./utils":7,"./worker":8,webworkify:1}],6:[function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=e("./core.sjs"),o=e("./utils"),s=o.toHex,i=o.ceilHeapSize,a=e("./conv"),c=function(e){for(e+=9;0<e%64;e+=1);return e},l=function(e,t){var n=new Uint8Array(e.buffer),r=t%4,o=t-r;switch(r){case 0:n[o+3]=0;case 1:n[o+2]=0;case 2:n[o+1]=0;case 3:n[o+0]=0;}for(var s=(t>>2)+1;s<e.length;s++)e[s]=0},p=function(e,t,n){e[t>>2]|=128<<24-(t%4<<3),e[(-16&(t>>2)+2)+14]=0|n/536870912,e[(-16&(t>>2)+2)+15]=n<<3},u=function(e,t){var n=new Int32Array(e,t+320,5),r=new Int32Array(5),o=new DataView(r.buffer);return o.setInt32(0,n[0],!1),o.setInt32(4,n[1],!1),o.setInt32(8,n[2],!1),o.setInt32(12,n[3],!1),o.setInt32(16,n[4],!1),r},f=function(){function e(t){if(n(this,e),t=t||65536,0<t%64)throw new Error("Chunk size must be a multiple of 128 bit");this._offset=0,this._maxChunkLen=t,this._padMaxChunkLen=c(t),this._heap=new ArrayBuffer(i(this._padMaxChunkLen+320+20)),this._h32=new Int32Array(this._heap),this._h8=new Int8Array(this._heap),this._core=new r({Int32Array:Int32Array},{},this._heap)}return e.prototype._initState=function(e,t){this._offset=0;var n=new Int32Array(e,t+320,5);n[0]=1732584193,n[1]=-271733879,n[2]=-1732584194,n[3]=271733878,n[4]=-1009589776},e.prototype._padChunk=function(e,t){var n=c(e),r=new Int32Array(this._heap,0,n>>2);return l(r,e),p(r,e,t),n},e.prototype._write=function(e,t,n,r){a(e,this._h8,this._h32,t,n,r||0)},e.prototype._coreCall=function(e,t,n,r,o){var s=n;this._write(e,t,n),o&&(s=this._padChunk(n,r)),this._core.hash(s,this._padMaxChunkLen)},e.prototype.rawDigest=function(e){var t=e.byteLength||e.length||e.size||0;this._initState(this._heap,this._padMaxChunkLen);var n=0,r=this._maxChunkLen;for(n=0;t>n+r;n+=r)this._coreCall(e,n,r,t,!1);return this._coreCall(e,n,t-n,t,!0),u(this._heap,this._padMaxChunkLen)},e.prototype.digest=function(e){return s(this.rawDigest(e).buffer)},e.prototype.digestFromString=function(e){return this.digest(e)},e.prototype.digestFromBuffer=function(e){return this.digest(e)},e.prototype.digestFromArrayBuffer=function(e){return this.digest(e)},e.prototype.resetState=function(){return this._initState(this._heap,this._padMaxChunkLen),this},e.prototype.append=function(e){var t=0,n=e.byteLength||e.length||e.size||0,r=this._offset%this._maxChunkLen,o;for(this._offset+=n;t<n;)o=d(n-t,this._maxChunkLen-r),this._write(e,t,o,r),r+=o,t+=o,r===this._maxChunkLen&&(this._core.hash(this._maxChunkLen,this._padMaxChunkLen),r=0);return this},e.prototype.getState=function(){var e=this._offset%this._maxChunkLen,t;if(!e){var n=new Int32Array(this._heap,this._padMaxChunkLen+320,5);t=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}else t=this._heap.slice(0);return{offset:this._offset,heap:t}},e.prototype.setState=function(e){if(this._offset=e.offset,20===e.heap.byteLength){var t=new Int32Array(this._heap,this._padMaxChunkLen+320,5);t.set(new Int32Array(e.heap))}else this._h32.set(new Int32Array(e.heap));return this},e.prototype.rawEnd=function(){var e=this._offset,t=e%this._maxChunkLen,n=this._padChunk(t,e);this._core.hash(n,this._padMaxChunkLen);var r=u(this._heap,this._padMaxChunkLen);return this._initState(this._heap,this._padMaxChunkLen),r},e.prototype.end=function(){return s(this.rawEnd().buffer)},e}();t.exports=f,t.exports._core=r},{"./conv":2,"./core.sjs":3,"./utils":7}],7:[function(e,t){"use strict";for(var n=Array(256),r=0;256>r;r++)n[r]=(16>r?"0":"")+r.toString(16);t.exports.toHex=function(e){for(var t=new Uint8Array(e),r=Array(e.byteLength),o=0;o<r.length;o++)r[o]=n[t[o]];return r.join("")},t.exports.ceilHeapSize=function(e){var t=0;if(65536>=e)return 65536;if(16777216>e)for(t=1;t<e;t<<=1);else for(t=16777216;t<e;t+=16777216);return t},t.exports.isDedicatedWorkerScope=function(e){var t="WorkerGlobalScope"in e&&e instanceof e.WorkerGlobalScope,n="SharedWorkerGlobalScope"in e&&e instanceof e.SharedWorkerGlobalScope,r="ServiceWorkerGlobalScope"in e&&e instanceof e.ServiceWorkerGlobalScope;return t&&!n&&!r}},{}],8:[function(e,t){"use strict";t.exports=function(){var t=e("./rusha"),n=function(e,t,n){try{return n(null,e.digest(t))}catch(t){return n(t)}},r=function(e,t,n,o,s){var i=new self.FileReader;i.onloadend=function(){if(i.error)return s(i.error);var d=i.result;t+=i.result.byteLength;try{e.append(d)}catch(t){return void s(t)}t<o.size?r(e,t,n,o,s):s(null,e.end())},i.readAsArrayBuffer(o.slice(t,t+n))},o=!0;return self.onmessage=function(e){if(o){var s=e.data.data,i=e.data.file,d=e.data.id;if("undefined"!=typeof d&&(i||s)){var a=e.data.blockSize||4194304,c=new t(a);c.resetState();var l=function(e,t){e?self.postMessage({id:d,error:e.name}):self.postMessage({id:d,hash:t})};s&&n(c,s,l),i&&r(c,0,a,i,l)}}},function(){o=!1}}},{"./rusha":6}]},{},[5])(5)})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],90:[function(e,t,n){function r(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}var s=e("buffer"),i=s.Buffer;i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=s:(r(s,n),n.Buffer=o),r(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0===t?r.fill(0):"string"==typeof n?r.fill(t,n):r.fill(t),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s.SlowBuffer(e)}},{buffer:23}],91:[function(e,t){(function(e){t.exports=function(t,n){var r=[];t.on("data",function(e){r.push(e)}),t.once("end",function(){n&&n(null,e.concat(r)),n=null}),t.once("error",function(e){n&&n(e),n=null})}}).call(this,e("buffer").Buffer)},{buffer:23}],92:[function(e,t){(function(n){function r(e,t){e="string"==typeof e?{url:e}:Object.assign({},e),e.headers=Object.assign({},e.headers),t=c(t),e.url&&o(e),null==e.maxRedirects&&(e.maxRedirects=10);var i;e.form&&(i="string"==typeof e.form?e.form:l.stringify(e.form)),e.body&&(i=e.json&&!s(e.body)?JSON.stringify(e.body):e.body),e.json&&(e.headers.accept="application/json"),e.json&&i&&(e.headers["content-type"]="application/json"),e.form&&(e.headers["content-type"]="application/x-www-form-urlencoded"),i&&!s(i)&&(e.headers["content-length"]=n.byteLength(i)),delete e.body,delete e.form,i&&!e.method&&(e.method="POST"),e.method&&(e.method=e.method.toUpperCase());var u=Object.keys(e.headers).some(function(e){return"accept-encoding"===e.toLowerCase()});u||(e.headers["accept-encoding"]="gzip, deflate");var f="https:"===e.protocol?a:d,h=f.request(e,function(n){if(300<=n.statusCode&&400>n.statusCode&&"location"in n.headers)return e.url=n.headers.location,n.resume(),void(0<e.maxRedirects?(e.maxRedirects-=1,r(e,t)):t(new Error("too many redirects")));var o="function"==typeof p&&"HEAD"!==e.method;t(null,o?p(n):n)});return h.on("timeout",function(){h.abort(),t(new Error("Request timed out"))}),h.on("error",t),i&&s(i)?i.on("error",t).pipe(h):h.end(i),h}function o(e){var t=u.parse(e.url);t.hostname&&(e.hostname=t.hostname),t.port&&(e.port=t.port),t.protocol&&(e.protocol=t.protocol),t.auth&&(e.auth=t.auth),e.path=t.path,delete e.url}function s(e){return"function"==typeof e.pipe}t.exports=r;var i=e("simple-concat"),d=e("http"),a=e("https"),c=e("once"),l=e("querystring"),p=e("decompress-response"),u=e("url");r.concat=function(e,t){return r(e,function(n,r){return n?t(n):void i(r,function(n,o){if(n)return t(n);if(e.json)try{o=JSON.parse(o.toString())}catch(e){return t(e,r,o)}t(null,r,o)})})},["get","post","put","patch","head","delete"].forEach(function(e){r[e]=function(t,n){return"string"==typeof t&&(t={url:t}),t.method=e.toUpperCase(),r(t,n)}})}).call(this,e("buffer").Buffer)},{buffer:23,"decompress-response":21,http:97,https:37,once:59,querystring:70,"simple-concat":91,url:114}],93:[function(e,t){(function(n){function r(e){var t=this;if(!(t instanceof r))return new r(e);if(t._id=a(4).toString("hex").slice(0,7),t._debug("new peer %o",e),e=Object.assign({allowHalfOpen:!1},e),c.Duplex.call(t,e),t.channelName=e.initiator?e.channelName||a(20).toString("hex"):null,t._isChromium="undefined"!=typeof window&&!!window.webkitRTCPeerConnection,t.initiator=e.initiator||!1,t.channelConfig=e.channelConfig||r.channelConfig,t.config=e.config||r.config,t.constraints=t._transformConstraints(e.constraints||r.constraints),t.offerConstraints=t._transformConstraints(e.offerConstraints||{}),t.answerConstraints=t._transformConstraints(e.answerConstraints||{}),t.reconnectTimer=e.reconnectTimer||!1,t.sdpTransform=e.sdpTransform||function(e){return e},t.stream=e.stream||!1,t.trickle=void 0===e.trickle||e.trickle,t.destroyed=!1,t.connected=!1,t.remoteAddress=void 0,t.remoteFamily=void 0,t.remotePort=void 0,t.localAddress=void 0,t.localPort=void 0,t._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:i(),!t._wrtc)if("undefined"==typeof window)throw new Error("No WebRTC support: Specify `opts.wrtc` option in this environment");else throw new Error("No WebRTC support: Not a supported browser");if(t._pcReady=!1,t._channelReady=!1,t._iceComplete=!1,t._channel=null,t._pendingCandidates=[],t._previousStreams=[],t._chunk=null,t._cb=null,t._interval=null,t._reconnectTimeout=null,t._pc=new t._wrtc.RTCPeerConnection(t.config,t.constraints),t._isWrtc=Array.isArray(t._pc.RTCIceConnectionStates),t._isReactNativeWebrtc="number"==typeof t._pc._peerConnectionId,t._pc.oniceconnectionstatechange=function(){t._onIceStateChange()},t._pc.onicegatheringstatechange=function(){t._onIceStateChange()},t._pc.onsignalingstatechange=function(){t._onSignalingStateChange()},t._pc.onicecandidate=function(e){t._onIceCandidate(e)},t.initiator){var n=!1;t._pc.onnegotiationneeded=function(){n||t._createOffer(),n=!0},t._setupData({channel:t._pc.createDataChannel(t.channelName,t.channelConfig)})}else t._pc.ondatachannel=function(e){t._setupData(e)};"addTrack"in t._pc?(t.stream&&t.stream.getTracks().forEach(function(e){t._pc.addTrack(e,t.stream)}),t._pc.ontrack=function(e){t._onTrack(e)}):(t.stream&&t._pc.addStream(t.stream),t._pc.onaddstream=function(e){t._onAddStream(e)}),t.initiator&&t._isWrtc&&t._pc.onnegotiationneeded(),t._onFinishBound=function(){t._onFinish()},t.once("finish",t._onFinishBound)}function o(){}t.exports=r;var s=e("debug")("simple-peer"),i=e("get-browser-rtc"),d=e("inherits"),a=e("randombytes"),c=e("readable-stream"),l=65536;d(r,c.Duplex),r.WEBRTC_SUPPORT=!!i(),r.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},r.constraints={},r.channelConfig={},Object.defineProperty(r.prototype,"bufferSize",{get:function(){var e=this;return e._channel&&e._channel.bufferedAmount||0}}),r.prototype.address=function(){var e=this;return{port:e.localPort,family:"IPv4",address:e.localAddress}},r.prototype.signal=function(e){var t=this;if(t.destroyed)throw new Error("cannot signal after peer is destroyed");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}t._debug("signal()"),e.candidate&&(t._pc.remoteDescription&&t._pc.remoteDescription.type?t._addIceCandidate(e.candidate):t._pendingCandidates.push(e.candidate)),e.sdp&&t._pc.setRemoteDescription(new t._wrtc.RTCSessionDescription(e),function(){t.destroyed||(t._pendingCandidates.forEach(function(e){t._addIceCandidate(e)}),t._pendingCandidates=[],"offer"===t._pc.remoteDescription.type&&t._createAnswer())},function(e){t._destroy(e)}),e.sdp||e.candidate||t._destroy(new Error("signal() called with invalid signal data"))},r.prototype._addIceCandidate=function(e){var t=this;try{t._pc.addIceCandidate(new t._wrtc.RTCIceCandidate(e),o,function(e){t._destroy(e)})}catch(e){t._destroy(new Error("error adding candidate: "+e.message))}},r.prototype.send=function(e){var t=this;t._channel.send(e)},r.prototype.destroy=function(e){var t=this;t._destroy(null,e)},r.prototype._destroy=function(e,t){var n=this;if(!n.destroyed){if(t&&n.once("close",t),n._debug("destroy (error: %s)",e&&(e.message||e)),n.readable=n.writable=!1,n._readableState.ended||n.push(null),n._writableState.finished||n.end(),n.destroyed=!0,n.connected=!1,n._pcReady=!1,n._channelReady=!1,n._previousStreams=null,clearInterval(n._interval),clearTimeout(n._reconnectTimeout),n._interval=null,n._reconnectTimeout=null,n._chunk=null,n._cb=null,n._onFinishBound&&n.removeListener("finish",n._onFinishBound),n._onFinishBound=null,n._pc){try{n._pc.close()}catch(e){}n._pc.oniceconnectionstatechange=null,n._pc.onicegatheringstatechange=null,n._pc.onsignalingstatechange=null,n._pc.onicecandidate=null,"addTrack"in n._pc?n._pc.ontrack=null:n._pc.onaddstream=null,n._pc.onnegotiationneeded=null,n._pc.ondatachannel=null}if(n._channel){try{n._channel.close()}catch(e){}n._channel.onmessage=null,n._channel.onopen=null,n._channel.onclose=null,n._channel.onerror=null}n._pc=null,n._channel=null,e&&n.emit("error",e),n.emit("close")}},r.prototype._setupData=function(e){var t=this;return e.channel?void(t._channel=e.channel,t._channel.binaryType="arraybuffer","number"==typeof t._channel.bufferedAmountLowThreshold&&(t._channel.bufferedAmountLowThreshold=l),t.channelName=t._channel.label,t._channel.onmessage=function(e){t._onChannelMessage(e)},t._channel.onbufferedamountlow=function(){t._onChannelBufferedAmountLow()},t._channel.onopen=function(){t._onChannelOpen()},t._channel.onclose=function(){t._onChannelClose()},t._channel.onerror=function(e){t._destroy(e)}):t._destroy(new Error("Data channel event is missing `channel` property"))},r.prototype._read=function(){},r.prototype._write=function(e,t,n){var r=this;if(r.destroyed)return n(new Error("cannot write after peer is destroyed"));if(r.connected){try{r.send(e)}catch(e){return r._destroy(e)}r._channel.bufferedAmount>l?(r._debug("start backpressure: bufferedAmount %d",r._channel.bufferedAmount),r._cb=n):n(null)}else r._debug("write before connect"),r._chunk=e,r._cb=n},r.prototype._onFinish=function(){function e(){setTimeout(function(){t._destroy()},1e3)}var t=this;t.destroyed||(t.connected?e():t.once("connect",e))},r.prototype._createOffer=function(){var e=this;e.destroyed||e._pc.createOffer(function(t){function n(){var n=e._pc.localDescription||t;e._debug("signal"),e.emit("signal",{type:n.type,sdp:n.sdp})}e.destroyed||(t.sdp=e.sdpTransform(t.sdp),e._pc.setLocalDescription(t,function(){e.destroyed||(e.trickle||e._iceComplete?n():e.once("_iceComplete",n))},function(t){e._destroy(t)}))},function(t){e._destroy(t)},e.offerConstraints)},r.prototype._createAnswer=function(){var e=this;e.destroyed||e._pc.createAnswer(function(t){function n(){var n=e._pc.localDescription||t;e._debug("signal"),e.emit("signal",{type:n.type,sdp:n.sdp})}e.destroyed||(t.sdp=e.sdpTransform(t.sdp),e._pc.setLocalDescription(t,function(){e.destroyed||(e.trickle||e._iceComplete?n():e.once("_iceComplete",n))},function(t){e._destroy(t)}))},function(t){e._destroy(t)},e.answerConstraints)},r.prototype._onIceStateChange=function(){var e=this;if(!e.destroyed){var t=e._pc.iceConnectionState,n=e._pc.iceGatheringState;e._debug("iceStateChange (connection: %s) (gathering: %s)",t,n),e.emit("iceStateChange",t,n),("connected"===t||"completed"===t)&&(clearTimeout(e._reconnectTimeout),e._pcReady=!0,e._maybeReady()),"disconnected"===t&&(e.reconnectTimer?(clearTimeout(e._reconnectTimeout),e._reconnectTimeout=setTimeout(function(){e._destroy()},e.reconnectTimer)):e._destroy()),"failed"===t&&e._destroy(new Error("Ice connection failed.")),"closed"===t&&e._destroy()}},r.prototype.getStats=function(e){var t=this;0===t._pc.getStats.length?t._pc.getStats().then(function(t){var n=[];t.forEach(function(e){n.push(e)}),e(null,n)},function(t){e(t)}):t._isReactNativeWebrtc?t._pc.getStats(null,function(t){var n=[];t.forEach(function(e){n.push(e)}),e(null,n)},function(t){e(t)}):0<t._pc.getStats.length?t._pc.getStats(function(n){if(!t.destroyed){var r=[];n.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,r.push(t)}),e(null,r)}},function(t){e(t)}):e(null,[])},r.prototype._maybeReady=function(){function e(){t.destroyed||t.getStats(function(n,r){function o(e){a=!0;var n=i[e.localCandidateId];n&&n.ip?(t.localAddress=n.ip,t.localPort=+n.port):n&&n.ipAddress?(t.localAddress=n.ipAddress,t.localPort=+n.portNumber):"string"==typeof e.googLocalAddress&&(n=e.googLocalAddress.split(":"),t.localAddress=n[0],t.localPort=+n[1]);var r=s[e.remoteCandidateId];r&&r.ip?(t.remoteAddress=r.ip,t.remotePort=+r.port):r&&r.ipAddress?(t.remoteAddress=r.ipAddress,t.remotePort=+r.portNumber):"string"==typeof e.googRemoteAddress&&(r=e.googRemoteAddress.split(":"),t.remoteAddress=r[0],t.remotePort=+r[1]),t.remoteFamily="IPv4",t._debug("connect local: %s:%s remote: %s:%s",t.localAddress,t.localPort,t.remoteAddress,t.remotePort)}if(!t.destroyed){n&&(r=[]);var s={},i={},d={},a=!1;if(r.forEach(function(e){("remotecandidate"===e.type||"remote-candidate"===e.type)&&(s[e.id]=e),("localcandidate"===e.type||"local-candidate"===e.type)&&(i[e.id]=e),("candidatepair"===e.type||"candidate-pair"===e.type)&&(d[e.id]=e)}),r.forEach(function(e){"transport"===e.type&&o(d[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&o(e)}),!a&&(!Object.keys(d).length||Object.keys(i).length))return void setTimeout(e,100);if(t._connecting=!1,t.connected=!0,t._chunk){try{t.send(t._chunk)}catch(e){return t._destroy(e)}t._chunk=null,t._debug("sent chunk from \"write before connect\"");var c=t._cb;t._cb=null,c(null)}"number"!=typeof t._channel.bufferedAmountLowThreshold&&(t._interval=setInterval(function(){t._onInterval()},150),t._interval.unref&&t._interval.unref()),t._debug("connect"),t.emit("connect")}})}var t=this;t._debug("maybeReady pc %s channel %s",t._pcReady,t._channelReady),t.connected||t._connecting||!t._pcReady||!t._channelReady||(t._connecting=!0,e())},r.prototype._onInterval=function(){this._cb&&this._channel&&!(this._channel.bufferedAmount>l)&&this._onChannelBufferedAmountLow()},r.prototype._onSignalingStateChange=function(){var e=this;e.destroyed||(e._debug("signalingStateChange %s",e._pc.signalingState),e.emit("signalingStateChange",e._pc.signalingState))},r.prototype._onIceCandidate=function(e){var t=this;t.destroyed||(e.candidate&&t.trickle?t.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&(t._iceComplete=!0,t.emit("_iceComplete")))},r.prototype._onChannelMessage=function(e){var t=this;if(!t.destroyed){var r=e.data;r instanceof ArrayBuffer&&(r=n.from(r)),t.push(r)}},r.prototype._onChannelBufferedAmountLow=function(){var e=this;if(!e.destroyed&&e._cb){e._debug("ending backpressure: bufferedAmount %d",e._channel.bufferedAmount);var t=e._cb;e._cb=null,t(null)}},r.prototype._onChannelOpen=function(){var e=this;e.connected||e.destroyed||(e._debug("on channel open"),e._channelReady=!0,e._maybeReady())},r.prototype._onChannelClose=function(){var e=this;e.destroyed||(e._debug("on channel close"),e._destroy())},r.prototype._onAddStream=function(e){var t=this;t.destroyed||(t._debug("on add stream"),t.emit("stream",e.stream))},r.prototype._onTrack=function(e){var t=this;if(!t.destroyed){t._debug("on track");var n=e.streams[0].id;-1!==t._previousStreams.indexOf(n)||(t._previousStreams.push(n),t.emit("stream",e.streams[0]))}},r.prototype._debug=function(){var e=this,t=[].slice.call(arguments);t[0]="["+e._id+"] "+t[0],s.apply(null,t)},r.prototype._transformConstraints=function(e){var t=this;if(0===Object.keys(e).length)return e;if((e.mandatory||e.optional)&&!t._isChromium){var n=Object.assign({},e.optional,e.mandatory);return void 0!==n.OfferToReceiveVideo&&(n.offerToReceiveVideo=n.OfferToReceiveVideo,delete n.OfferToReceiveVideo),void 0!==n.OfferToReceiveAudio&&(n.offerToReceiveAudio=n.OfferToReceiveAudio,delete n.OfferToReceiveAudio),n}return e.mandatory||e.optional||!t._isChromium?e:(void 0!==e.offerToReceiveVideo&&(e.OfferToReceiveVideo=e.offerToReceiveVideo,delete e.offerToReceiveVideo),void 0!==e.offerToReceiveAudio&&(e.OfferToReceiveAudio=e.offerToReceiveAudio,delete e.offerToReceiveAudio),{mandatory:e})}}).call(this,e("buffer").Buffer)},{buffer:23,debug:29,"get-browser-rtc":36,inherits:40,randombytes:72,"readable-stream":82}],94:[function(e,t){function n(e){return i.digest(e)}function r(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n}function o(e){for(var t=e.length,n=[],r=0,o;r<t;r++)o=e[r],n.push((o>>>4).toString(16)),n.push((15&o).toString(16));return n.join("")}var s=e("rusha"),i=new s,d="undefined"==typeof window?self:window,a=d.crypto||d.msCrypto||{},c=a.subtle||a.webkitSubtle;try{c.digest({name:"sha-1"},new Uint8Array).catch(function(){c=!1})}catch(e){c=!1}t.exports=function(e,t){return c?void("string"==typeof e&&(e=r(e)),c.digest({name:"sha-1"},e).then(function(e){t(o(new Uint8Array(e)))},function(){t(n(e))})):void setTimeout(t,0,n(e))},t.exports.sync=n},{rusha:89}],95:[function(e,t){(function(n){function r(e){var t=this;if(!(t instanceof r))return new r(e);if(e||(e={}),"string"==typeof e&&(e={url:e}),null==e.url&&null==e.socket)throw new Error("Missing required `url` or `socket` option");if(null!=e.url&&null!=e.socket)throw new Error("Must specify either `url` or `socket` option, not both");if(t._id=d(4).toString("hex").slice(0,7),t._debug("new websocket: %o",e),e=Object.assign({allowHalfOpen:!1},e),a.Duplex.call(t,e),t.connected=!1,t.destroyed=!1,t._chunk=null,t._cb=null,t._interval=null,e.socket)t.url=e.socket.url,t._ws=e.socket;else{t.url=e.url;try{t._ws="function"==typeof c?new l(e.url,e):new l(e.url)}catch(e){return void n.nextTick(function(){t._destroy(e)})}}t._ws.binaryType="arraybuffer",t._ws.onopen=function(){t._onOpen()},t._ws.onmessage=function(e){t._onMessage(e)},t._ws.onclose=function(){t._onClose()},t._ws.onerror=function(){t.destroy(new Error("connection error to "+t.url))},t._onFinishBound=function(){t._onFinish()},t.once("finish",t._onFinishBound)}t.exports=r;var o=e("safe-buffer").Buffer,s=e("debug")("simple-websocket"),i=e("inherits"),d=e("randombytes"),a=e("readable-stream"),c=e("ws"),l="function"==typeof c?c:WebSocket,p=65536;i(r,a.Duplex),r.WEBSOCKET_SUPPORT=!!l,r.prototype.send=function(e){this._ws.send(e)},r.prototype.destroy=function(e){this._destroy(e,function(){})},r.prototype._destroy=function(e,t){var n=this;if(!n.destroyed){if(n._debug("destroy (error: %s)",e&&(e.message||e)),n.readable=n.writable=!1,n._readableState.ended||n.push(null),n._writableState.finished||n.end(),n.connected=!1,n.destroyed=!0,clearInterval(n._interval),n._interval=null,n._chunk=null,n._cb=null,n._onFinishBound&&n.removeListener("finish",n._onFinishBound),n._onFinishBound=null,n._ws){var r=n._ws,o=function(){r.onclose=null};if(r.readyState===l.CLOSED)o();else try{r.onclose=o,r.close()}catch(e){o()}r.onopen=null,r.onmessage=null,r.onerror=function(){}}if(n._ws=null,e){if("undefined"!=typeof DOMException&&e instanceof DOMException){var s=e.code;e=new Error(e.message),e.code=s}n.emit("error",e)}n.emit("close"),t()}},r.prototype._read=function(){},r.prototype._write=function(e,t,n){if(this.destroyed)return n(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(e){return this.destroy(e)}"function"!=typeof c&&this._ws.bufferedAmount>p?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n},r.prototype._onFinish=function(){function e(){setTimeout(function(){t.destroy()},1e3)}var t=this;t.destroyed||(t.connected?e():t.once("connect",e))},r.prototype._onMessage=function(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=o.from(t)),this.push(t)}},r.prototype._onOpen=function(){var e=this;if(!(e.connected||e.destroyed)){if(e.connected=!0,e._chunk){try{e.send(e._chunk)}catch(t){return e.destroy(t)}e._chunk=null,e._debug("sent chunk from \"write before connect\"");var t=e._cb;e._cb=null,t(null)}"function"!=typeof c&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e._debug("connect"),e.emit("connect")}},r.prototype._onInterval=function(){if(this._cb&&this._ws&&!(this._ws.bufferedAmount>p)){this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);var e=this._cb;this._cb=null,e(null)}},r.prototype._onClose=function(){this.destroyed||(this._debug("on close"),this.destroy())},r.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],s.apply(null,e)}}).call(this,e("_process"))},{_process:65,debug:29,inherits:40,randombytes:72,"readable-stream":82,"safe-buffer":90,ws:21}],96:[function(e,t){var n=1,r=65535,o=4,s=setInterval(function(){n=n+1&r},0|1e3/o);s.unref&&s.unref(),t.exports=function(e){var t=o*(e||5),s=[0],i=1,d=n-1&r;return function(e){var a=n-d&r;for(a>t&&(a=t),d=n;a--;)i==t&&(i=0),s[i]=s[0==i?t-1:i-1],i++;e&&(s[i-1]+=e);var c=s[i-1],l=s.length<t?0:s[i==t?0:i];return s.length<o?c:(c-l)*o/s.length}}},{}],97:[function(e,t,n){(function(t){var r=e("./lib/request"),o=e("./lib/response"),s=e("xtend"),i=e("builtin-status-codes"),d=e("url"),a=n;a.request=function(e,n){e="string"==typeof e?d.parse(e):s(e);var o=-1===t.location.protocol.search(/^https?:$/)?"http:":"",i=e.protocol||o,a=e.hostname||e.host,c=e.port,l=e.path||"/";a&&-1!==a.indexOf(":")&&(a="["+a+"]"),e.url=(a?i+"//"+a:"")+(c?":"+c:"")+l,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var p=new r(e);return n&&p.on("response",n),p},a.get=function(e,t){var n=a.request(e,t);return n.end(),n},a.ClientRequest=r,a.IncomingMessage=o,a.Agent=function(){},a.Agent.defaultMaxSockets=4,a.STATUS_CODES=i,a.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./lib/request":99,"./lib/response":100,"builtin-status-codes":24,url:114,xtend:122}],98:[function(e,t,n){(function(e){function t(){if(void 0!=d)return d;if(e.XMLHttpRequest){d=new e.XMLHttpRequest;try{d.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(t){d=null}}else d=null;return d}function r(e){var n=t();if(!n)return!1;try{return n.responseType=e,n.responseType===e}catch(t){}return!1}function o(e){return"function"==typeof e}n.fetch=o(e.fetch)&&o(e.ReadableStream),n.writableStream=o(e.WritableStream),n.abortController=o(e.AbortController),n.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),n.blobConstructor=!0}catch(t){}var s="undefined"!=typeof e.ArrayBuffer,i=s&&o(e.ArrayBuffer.prototype.slice),d;n.arraybuffer=n.fetch||s&&r("arraybuffer"),n.msstream=!n.fetch&&i&&r("ms-stream"),n.mozchunkedarraybuffer=!n.fetch&&s&&r("moz-chunked-arraybuffer"),n.overrideMimeType=n.fetch||!!t()&&o(t().overrideMimeType),n.vbArray=o(e.VBArray),d=null}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],99:[function(e,t){(function(n,r,o){function s(e,t){return d.fetch&&t?"fetch":d.mozchunkedarraybuffer?"moz-chunked-arraybuffer":d.msstream?"ms-stream":d.arraybuffer&&e?"arraybuffer":d.vbArray&&e?"text:vbarray":"text"}function i(e){try{var t=e.status;return null!==t&&0!==t}catch(t){return!1}}var d=e("./capability"),a=e("inherits"),c=e("./response"),l=e("readable-stream"),p=e("to-arraybuffer"),u=c.IncomingMessage,f=c.readyStates,h=t.exports=function(e){var t=this;l.Writable.call(t),t._opts=e,t._body=[],t._headers={},e.auth&&t.setHeader("Authorization","Basic "+new o(e.auth).toString("base64")),Object.keys(e.headers).forEach(function(n){t.setHeader(n,e.headers[n])});var n=!0,r;if("disable-fetch"===e.mode||"requestTimeout"in e&&!d.abortController)n=!1,r=!0;else if("prefer-streaming"===e.mode)r=!1;else if("allow-wrong-content-type"===e.mode)r=!d.overrideMimeType;else if(!e.mode||"default"===e.mode||"prefer-fast"===e.mode)r=!0;else throw new Error("Invalid value for opts.mode");t._mode=s(r,n),t.on("finish",function(){t._onFinish()})};a(h,l.Writable),h.prototype.setHeader=function(e,t){var n=this,r=e.toLowerCase();-1!==m.indexOf(r)||(n._headers[r]={name:e,value:t})},h.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},h.prototype.removeHeader=function(e){var t=this;delete t._headers[e.toLowerCase()]},h.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t=e._opts,s=e._headers,i=null;"GET"!==t.method&&"HEAD"!==t.method&&(d.arraybuffer?i=p(o.concat(e._body)):d.blobConstructor?i=new r.Blob(e._body.map(function(e){return p(e)}),{type:(s["content-type"]||{}).value||""}):i=o.concat(e._body).toString());var a=[];if(Object.keys(s).forEach(function(e){var t=s[e].name,n=s[e].value;Array.isArray(n)?n.forEach(function(e){a.push([t,e])}):a.push([t,n])}),"fetch"===e._mode){var c=null;if(d.abortController){var l=new AbortController;c=l.signal,e._fetchAbortController=l,"requestTimeout"in t&&0!==t.requestTimeout&&r.setTimeout(function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()},t.requestTimeout)}r.fetch(e._opts.url,{method:e._opts.method,headers:a,body:i||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin",signal:c}).then(function(t){e._fetchResponse=t,e._connect()},function(t){e.emit("error",t)})}else{var u=e._xhr=new r.XMLHttpRequest;try{u.open(e._opts.method,e._opts.url,!0)}catch(t){return void n.nextTick(function(){e.emit("error",t)})}"responseType"in u&&(u.responseType=e._mode.split(":")[0]),"withCredentials"in u&&(u.withCredentials=!!t.withCredentials),"text"===e._mode&&"overrideMimeType"in u&&u.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in t&&(u.timeout=t.requestTimeout,u.ontimeout=function(){e.emit("requestTimeout")}),a.forEach(function(e){u.setRequestHeader(e[0],e[1])}),e._response=null,u.onreadystatechange=function(){switch(u.readyState){case f.LOADING:case f.DONE:e._onXHRProgress();}},"moz-chunked-arraybuffer"===e._mode&&(u.onprogress=function(){e._onXHRProgress()}),u.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{u.send(i)}catch(t){return void n.nextTick(function(){e.emit("error",t)})}}}},h.prototype._onXHRProgress=function(){var e=this;!i(e._xhr)||e._destroyed||(!e._response&&e._connect(),e._response._onXHRProgress())},h.prototype._connect=function(){var e=this;e._destroyed||(e._response=new u(e._xhr,e._fetchResponse,e._mode),e._response.on("error",function(t){e.emit("error",t)}),e.emit("response",e._response))},h.prototype._write=function(e,t,n){var r=this;r._body.push(e),n()},h.prototype.abort=h.prototype.destroy=function(){var e=this;e._destroyed=!0,e._response&&(e._response._destroyed=!0),e._xhr?e._xhr.abort():e._fetchAbortController&&e._fetchAbortController.abort()},h.prototype.end=function(e,t,n){var r=this;"function"==typeof e&&(n=e,e=void 0),l.Writable.prototype.end.call(r,e,t,n)},h.prototype.flushHeaders=function(){},h.prototype.setTimeout=function(){},h.prototype.setNoDelay=function(){},h.prototype.setSocketKeepAlive=function(){};var m=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,e("buffer").Buffer)},{"./capability":98,"./response":100,_process:65,buffer:23,inherits:40,"readable-stream":82,"to-arraybuffer":107}],100:[function(e,t,n){(function(t,r,o){var s=e("./capability"),i=e("inherits"),d=e("readable-stream"),a=n.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},c=n.IncomingMessage=function(e,n,r){var i=this;if(d.Readable.call(i),i._mode=r,i.headers={},i.rawHeaders=[],i.trailers={},i.rawTrailers=[],i.on("end",function(){t.nextTick(function(){i.emit("close")})}),"fetch"===r){function e(){c.read().then(function(t){return i._destroyed?void 0:t.done?void i.push(null):void(i.push(new o(t.value)),e())}).catch(function(e){i._destroyed||i.emit("error",e)})}if(i._fetchResponse=n,i.url=n.url,i.statusCode=n.status,i.statusMessage=n.statusText,n.headers.forEach(function(e,t){i.headers[t.toLowerCase()]=e,i.rawHeaders.push(t,e)}),s.writableStream){var a=new WritableStream({write:function(e){return new Promise(function(t){i._destroyed||(i.push(new o(e))?t():i._resumeFetch=t)})},close:function(){i._destroyed||i.push(null)},abort:function(e){i._destroyed||i.emit("error",e)}});try{return void n.body.pipeTo(a)}catch(t){}}var c=n.body.getReader();e()}else{i._xhr=e,i._pos=0,i.url=e.responseURL,i.statusCode=e.status,i.statusMessage=e.statusText;var l=e.getAllResponseHeaders().split(/\r?\n/);if(l.forEach(function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var n=t[1].toLowerCase();"set-cookie"===n?(void 0===i.headers[n]&&(i.headers[n]=[]),i.headers[n].push(t[2])):void 0===i.headers[n]?i.headers[n]=t[2]:i.headers[n]+=", "+t[2],i.rawHeaders.push(t[1],t[2])}}),i._charset="x-user-defined",!s.overrideMimeType){var p=i.rawHeaders["mime-type"];if(p){var u=p.match(/;\s*charset=([^;])(;|$)/);u&&(i._charset=u[1].toLowerCase())}i._charset||(i._charset="utf-8")}}};i(c,d.Readable),c.prototype._read=function(){var e=this,t=e._resumeFetch;t&&(e._resumeFetch=null,t())},c.prototype._onXHRProgress=function(){var e=this,t=e._xhr,n=null;switch(e._mode){case"text:vbarray":if(t.readyState!==a.DONE)break;try{n=new r.VBArray(t.responseBody).toArray()}catch(t){}if(null!==n){e.push(new o(n));break}case"text":try{n=t.responseText}catch(t){e._mode="text:vbarray";break}if(n.length>e._pos){var s=n.substr(e._pos);if("x-user-defined"===e._charset){for(var d=new o(s.length),c=0;c<s.length;c++)d[c]=255&s.charCodeAt(c);e.push(d)}else e.push(s,e._charset);e._pos=n.length}break;case"arraybuffer":if(t.readyState!==a.DONE||!t.response)break;n=t.response,e.push(new o(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=t.response,t.readyState!==a.LOADING||!n)break;e.push(new o(new Uint8Array(n)));break;case"ms-stream":if(n=t.response,t.readyState!==a.LOADING)break;var i=new r.MSStreamReader;i.onprogress=function(){i.result.byteLength>e._pos&&(e.push(new o(new Uint8Array(i.result.slice(e._pos)))),e._pos=i.result.byteLength)},i.onload=function(){e.push(null)},i.readAsArrayBuffer(n);}e._xhr.readyState===a.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,e("buffer").Buffer)},{"./capability":98,_process:65,buffer:23,inherits:40,"readable-stream":82}],101:[function(e,t){var n=e("stream-to-blob");t.exports=function e(t,r,o){return"function"==typeof r?e(t,null,r):void n(t,r,function(e,t){if(e)return o(e);var n=URL.createObjectURL(t);o(null,n)})}},{"stream-to-blob":102}],102:[function(e,t){var n=e("once");t.exports=function e(t,r,o){if("function"==typeof r)return e(t,null,r);o=n(o);var s=[];t.on("data",function(e){s.push(e)}).on("end",function(){var e=r?new Blob(s,{type:r}):new Blob(s);o(null,e)}).on("error",o)}},{once:59}],103:[function(e,t){(function(n){var r=e("once");t.exports=function(e,t,o){o=r(o);var s=new n(t),i=0;e.on("data",function(e){e.copy(s,i),i+=e.length}).on("end",function(){o(null,s)}).on("error",o)}}).call(this,e("buffer").Buffer)},{buffer:23,once:59}],104:[function(e,t,n){"use strict";function r(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0;}}function o(e){var t=r(e);if("string"!=typeof t&&(g.isEncoding===_||!_(e)))throw new Error("Unknown encoding: "+e);return t||e}function s(e){this.encoding=o(e);var t;switch(this.encoding){case"utf16le":this.text=l,this.end=p,t=4;break;case"utf8":this.fillLast=c,t=4;break;case"base64":this.text=u,this.end=f,t=3;break;default:return this.write=h,void(this.end=m);}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(t)}function d(e){return 127>=e?0:6==e>>5?2:14==e>>4?3:30==e>>3?4:-1}function a(e,t,n){var r=t.length-1;if(r<n)return 0;var o=d(t[r]);return 0<=o?(0<o&&(e.lastNeed=o-1),o):--r<n?0:(o=d(t[r]),0<=o)?(0<o&&(e.lastNeed=o-2),o):--r<n?0:(o=d(t[r]),0<=o?(0<o&&(2===o?o=0:e.lastNeed=o-3),o):0)}function i(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"\uFFFD".repeat(n);if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"\uFFFD".repeat(n+1);if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,"\uFFFD".repeat(n+2)}}function c(e){var t=this.lastTotal-this.lastNeed,n=i(this,e,t);return void 0===n?this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length):n}function l(e,t){if(0==(e.length-t)%2){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(55296<=r&&56319>=r)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function p(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function u(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}var g=e("safe-buffer").Buffer,_=g.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};n.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(t=this.fillLast(e),void 0===t)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\uFFFD".repeat(this.lastTotal-this.lastNeed):t},s.prototype.text=function(e,t){var n=a(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},s.prototype.fillLast=function(e){return this.lastNeed<=e.length?(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length)}},{"safe-buffer":90}],105:[function(e,t,n){var r=e("./thirty-two");n.encode=r.encode,n.decode=r.decode},{"./thirty-two":106}],106:[function(e,t,n){(function(e){"use strict";function t(e){var t=r(e.length/5);return 0==e.length%5?t:t+1}var s=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];n.encode=function(n){e.isBuffer(n)||(n=new e(n));for(var r=0,o=0,s=0,i=0,d=new e(8*t(n)),a;r<n.length;)a=n[r],3<s?(i=a&255>>s,s=(s+5)%8,i=i<<s|(r+1<n.length?n[r+1]:0)>>8-s,r++):(i=31&a>>8-(s+5),s=(s+5)%8,0==s&&r++),d[o]="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".charCodeAt(i),o++;for(r=o;r<d.length;r++)d[r]=61;return d},n.decode=function(t){var n=0,r=0,d=0,a;e.isBuffer(t)||(t=new e(t));for(var c=new e(o(5*t.length/8)),l=0,i;l<t.length&&61!==t[l];l++)if(i=t[l]-48,i<s.length)r=s[i],3>=n?(n=(n+5)%8,0==n?(a|=r,c[d]=a,d++,a=0):a|=255&r<<8-n):(n=(n+5)%8,a|=255&r>>>n,c[d]=a,d++,a=255&r<<8-n);else throw new Error("Invalid input - it is not base32 encoded string");return c.slice(0,d)}}).call(this,e("buffer").Buffer)},{buffer:23}],107:[function(e,t){var n=e("buffer").Buffer;t.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(n.isBuffer(e)){for(var t=new Uint8Array(e.length),r=e.length,o=0;o<r;o++)t[o]=e[o];return t.buffer}throw new Error("Argument must be a Buffer")}},{buffer:23}],108:[function(e,t){(function(n){function o(e){function t(e,t){var n=new i(t);return n.on("warning",r._onWarning),n.on("error",r._onError),n.listen(e),r._internalDHT=!0,n}var r=this;if(!(r instanceof o))return new o(e);if(d.call(r),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!n.browser&&!e.port)throw new Error("Option `port` is required");r.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),r.infoHash="string"==typeof e.infoHash?e.infoHash:e.infoHash.toString("hex"),r._port=e.port,r._userAgent=e.userAgent,r.destroyed=!1,r._announce=e.announce||[],r._intervalMs=e.intervalMs||9e5,r._trackerOpts=null,r._dhtAnnouncing=!1,r._dhtTimeout=!1,r._internalDHT=!1,r._onWarning=function(e){r.emit("warning",e)},r._onError=function(e){r.emit("error",e)},r._onDHTPeer=function(e,t){t.toString("hex")!==r.infoHash||r.emit("peer",e.host+":"+e.port,"dht")},r._onTrackerPeer=function(e){r.emit("peer",e,"tracker")},r._onTrackerAnnounce=function(){r.emit("trackerAnnounce")},!1===e.tracker?r.tracker=null:e.tracker&&"object"==typeof e.tracker?(r._trackerOpts=a(e.tracker),r.tracker=r._createTracker()):r.tracker=r._createTracker(),r.dht=!1===e.dht||"function"!=typeof i?null:e.dht&&"function"==typeof e.dht.addNode?e.dht:e.dht&&"object"==typeof e.dht?t(e.dhtPort,e.dht):t(e.dhtPort),r.dht&&(r.dht.on("peer",r._onDHTPeer),r._dhtAnnounce())}t.exports=o;var s=e("debug")("torrent-discovery"),i=e("bittorrent-dht/client"),d=e("events").EventEmitter,a=e("xtend"),c=e("inherits"),l=e("run-parallel"),p=e("bittorrent-tracker/client");c(o,d),o.prototype.updatePort=function(e){var t=this;e===t._port||(t._port=e,t.dht&&t._dhtAnnounce(),t.tracker&&(t.tracker.stop(),t.tracker.destroy(function(){t.tracker=t._createTracker()})))},o.prototype.complete=function(e){this.tracker&&this.tracker.complete(e)},o.prototype.destroy=function(e){var t=this;if(!t.destroyed){t.destroyed=!0,clearTimeout(t._dhtTimeout);var n=[];t.tracker&&(t.tracker.stop(),t.tracker.removeListener("warning",t._onWarning),t.tracker.removeListener("error",t._onError),t.tracker.removeListener("peer",t._onTrackerPeer),t.tracker.removeListener("update",t._onTrackerAnnounce),n.push(function(e){t.tracker.destroy(e)})),t.dht&&t.dht.removeListener("peer",t._onDHTPeer),t._internalDHT&&(t.dht.removeListener("warning",t._onWarning),t.dht.removeListener("error",t._onError),n.push(function(e){t.dht.destroy(e)})),l(n,e),t.dht=null,t.tracker=null,t._announce=null}},o.prototype._createTracker=function(){var e=a(this._trackerOpts,{infoHash:this.infoHash,announce:this._announce,peerId:this.peerId,port:this._port,userAgent:this._userAgent}),t=new p(e);return t.on("warning",this._onWarning),t.on("error",this._onError),t.on("peer",this._onTrackerPeer),t.on("update",this._onTrackerAnnounce),t.setInterval(this._intervalMs),t.start(),t},o.prototype._dhtAnnounce=function(){function e(){return t._intervalMs+r(Math.random()*t._intervalMs/5)}var t=this;t._dhtAnnouncing||(s("dht announce"),t._dhtAnnouncing=!0,clearTimeout(t._dhtTimeout),t.dht.announce(t.infoHash,t._port,function(n){t._dhtAnnouncing=!1,s("dht announce complete"),n&&t.emit("warning",n),t.emit("dhtAnnounce"),t.destroyed||(t._dhtTimeout=setTimeout(function(){t._dhtAnnounce()},e()),t._dhtTimeout.unref&&t._dhtTimeout.unref())}))}}).call(this,e("_process"))},{_process:65,"bittorrent-dht/client":21,"bittorrent-tracker/client":15,debug:29,events:33,inherits:40,"run-parallel":88,xtend:122}],109:[function(e,t){(function(e){function n(e){return this instanceof n?void(this.length=e,this.missing=e,this.sources=null,this._chunks=o(e/r),this._remainder=e%r||r,this._buffered=0,this._buffer=null,this._cancellations=null,this._reservations=0,this._flushed=!1):new n(e)}t.exports=n;var r=16384;n.BLOCK_LENGTH=r,n.prototype.chunkLength=function(e){return e===this._chunks-1?this._remainder:r},n.prototype.chunkLengthRemaining=function(e){return this.length-e*r},n.prototype.chunkOffset=function(e){return e*r},n.prototype.reserve=function(){return this.init()?this._cancellations.length?this._cancellations.pop():this._reservations<this._chunks?this._reservations++:-1:-1},n.prototype.reserveRemaining=function(){if(!this.init())return-1;if(this._reservations<this._chunks){var e=this._reservations;return this._reservations=this._chunks,e}return-1},n.prototype.cancel=function(e){this.init()&&this._cancellations.push(e)},n.prototype.cancelRemaining=function(e){this.init()&&(this._reservations=e)},n.prototype.get=function(e){return this.init()?this._buffer[e]:null},n.prototype.set=function(e,t,n){if(!this.init())return!1;for(var s=t.length,i=o(s/r),d=0;d<i;d++)if(!this._buffer[e+d]){var a=d*r,c=t.slice(a,a+r);this._buffered++,this._buffer[e+d]=c,this.missing-=c.length,-1===this.sources.indexOf(n)&&this.sources.push(n)}return this._buffered===this._chunks},n.prototype.flush=function(){if(!this._buffer||this._chunks!==this._buffered)return null;var t=e.concat(this._buffer,this.length);return this._buffer=null,this._cancellations=null,this.sources=null,this._flushed=!0,t},n.prototype.init=function(){return!this._flushed&&(!!this._buffer||(this._buffer=Array(this._chunks),this._cancellations=[],this.sources=[],!0))}}).call(this,e("buffer").Buffer)},{buffer:23}],110:[function(e,t){(function(n){var r=e("is-typedarray").strict;t.exports=function(e){if(r(e)){var t=new n(e.buffer);return e.byteLength!==e.buffer.byteLength&&(t=t.slice(e.byteOffset,e.byteOffset+e.byteLength)),t}return new n(e)}}).call(this,e("buffer").Buffer)},{buffer:23,"is-typedarray":44}],111:[function(e,t,n){(function(e){var t=4294967295;n.encodingLength=function(){return 8},n.encode=function(n,o,s){o||(o=new e(8)),s||(s=0);var i=r(n/t);return o.writeUInt32BE(i,s),o.writeUInt32BE(n-i*t,s+4),o},n.decode=function(n,r){r||(r=0),n||(n=new e(4)),r||(r=0);var o=n.readUInt32BE(r),s=n.readUInt32BE(r+4);return o*t+s},n.encode.bytes=8,n.decode.bytes=8}).call(this,e("buffer").Buffer)},{buffer:23}],112:[function(e,t){"use strict";function n(e,t){for(var n=1,r=e.length,o=e[0],s=e[0],d=1;d<r;++d)if(s=o,o=e[d],t(o,s)){if(d===n){n++;continue}e[n++]=o}return e.length=n,e}function r(e){for(var t=1,n=e.length,r=e[0],o=e[0],s=1;s<n;++s,o=r)if(o=r,r=e[s],r!==o){if(s===t){t++;continue}e[t++]=r}return e.length=t,e}t.exports=function(e,t,o){return 0===e.length?e:t?(o||e.sort(t),n(e,t)):(o||e.sort(),r(e))}},{}],113:[function(e,t){t.exports=function(e,t){if(!(t>=e.length||0>t)){var n=e.pop();if(t<e.length){var r=e[t];return e[t]=n,r}return n}}},{}],114:[function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,n){if(e&&d.isObject(e)&&e instanceof r)return e;var o=new r;return o.parse(e,t,n),o}var s=e("punycode"),d=e("./util");n.parse=o,n.resolve=function(e,t){return o(e,!1,!0).resolve(t)},n.resolveObject=function(e,t){return e?o(e,!1,!0).resolveObject(t):t},n.format=function(e){return d.isString(e)&&(e=o(e)),e instanceof r?e.format():r.prototype.format.call(e)},n.Url=r;var a=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">","\"","`"," ","\r","\n","\t"]),p=["'"].concat(l),u=["%","/","?",";","#"].concat(p),f=["/","?","#"],h=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},_={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=e("querystring");r.prototype.parse=function(e,t,n){if(!d.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),o=-1!==r&&r<e.indexOf("#")?"?":"#",w=e.split(o),x=/\\/g;w[0]=w[0].replace(x,"/"),e=w.join(o);var v=e;if(v=v.trim(),!n&&1===e.split("#").length){var S=c.exec(v);if(S)return this.path=v,this.href=v,this.pathname=S[1],S[2]?(this.search=S[2],this.query=t?b.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var C=a.exec(v);if(C){C=C[0];var E=C.toLowerCase();this.protocol=E,v=v.substr(C.length)}if(n||C||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var B="//"===v.substr(0,2);B&&!(C&&_[C])&&(v=v.substr(2),this.slashes=!0)}if(!_[C]&&(B||C&&!y[C])){for(var I=-1,L=0,i;L<f.length;L++)i=v.indexOf(f[L]),-1!==i&&(-1==I||i<I)&&(I=i);var T,A;A=-1===I?v.lastIndexOf("@"):v.lastIndexOf("@",I),-1!==A&&(T=v.slice(0,A),v=v.slice(A+1),this.auth=decodeURIComponent(T)),I=-1;for(var L=0,i;L<u.length;L++)i=v.indexOf(u[L]),-1!==i&&(-1===I||i<I)&&(I=i);-1===I&&(I=v.length),this.host=v.slice(0,I),v=v.slice(I),this.parseHost(),this.hostname=this.hostname||"";var U="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!U)for(var R=this.hostname.split(/\./),L=0,P=R.length,l;L<P;L++)if(l=R[L],l&&!l.match(h)){for(var O="",H=0,M=l.length;H<M;H++)O+=127<l.charCodeAt(H)?"x":l[H];if(!O.match(h)){var k=R.slice(0,L),q=R.slice(L+1),j=l.match(m);j&&(k.push(j[1]),q.unshift(j[2])),q.length&&(v="/"+q.join(".")+v),this.hostname=k.join(".");break}}this.hostname=255<this.hostname.length?"":this.hostname.toLowerCase(),U||(this.hostname=s.toASCII(this.hostname));var F=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+F,this.href+=this.host,U&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!g[E])for(var L=0,P=p.length,D;L<P;L++)if(D=p[L],-1!==v.indexOf(D)){var W=encodeURIComponent(D);W===D&&(W=escape(D)),v=v.split(D).join(W)}var z=v.indexOf("#");-1!==z&&(this.hash=v.substr(z),v=v.slice(0,z));var V=v.indexOf("?");if(-1===V?t&&(this.search="",this.query={}):(this.search=v.substr(V),this.query=v.substr(V+1),t&&(this.query=b.parse(this.query)),v=v.slice(0,V)),v&&(this.pathname=v),y[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",G=this.search||"";this.path=F+G}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&d.isObject(this.query)&&Object.keys(this.query).length&&(s=b.stringify(this.query));var i=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||y[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):!o&&(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),i&&"?"!==i.charAt(0)&&(i="?"+i),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),i=i.replace("#","%23"),t+o+n+i+r},r.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(d.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,o=Object.keys(this),a=0,c;a<o.length;a++)c=o[a],n[c]=this[c];if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),u=0,f;u<l.length;u++)f=l[u],"protocol"!==f&&(n[f]=e[f]);return y[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!y[e.protocol]){for(var h=Object.keys(e),m=0,g;m<h.length;m++)g=h[m],n[g]=e[g];return n.href=n.format(),n}if(n.protocol=e.protocol,!e.host&&!_[e.protocol]){for(var b=(e.pathname||"").split("/");b.length&&!(e.host=b.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==b[0]&&b.unshift(""),2>b.length&&b.unshift(""),n.pathname=b.join("/")}else n.pathname=e.pathname;if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var w=n.pathname||"",p=n.search||"";n.path=w+p}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var s=n.pathname&&"/"===n.pathname.charAt(0),k=e.host||e.pathname&&"/"===e.pathname.charAt(0),x=k||s||n.host&&e.pathname,v=x,S=n.pathname&&n.pathname.split("/")||[],b=e.pathname&&e.pathname.split("/")||[],C=n.protocol&&!y[n.protocol];if(C&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===b[0]?b[0]=e.host:b.unshift(e.host)),e.host=null),x=x&&(""===b[0]||""===S[0])),k)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,S=b;else if(b.length)S||(S=[]),S.pop(),S=S.concat(b),n.search=e.search,n.query=e.query;else if(!d.isNullOrUndefined(e.search)){if(C){n.hostname=n.host=S.shift();var E=n.host&&0<n.host.indexOf("@")&&n.host.split("@");E&&(n.auth=E.shift(),n.host=n.hostname=E.shift())}return n.search=e.search,n.query=e.query,d.isNull(n.pathname)&&d.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.path=n.search?"/"+n.search:null,n.href=n.format(),n;for(var B=S.slice(-1)[0],I=(n.host||e.host||1<S.length)&&("."===B||".."===B)||""===B,L=0,T=S.length;0<=T;T--)B=S[T],"."===B?S.splice(T,1):".."===B?(S.splice(T,1),L++):L&&(S.splice(T,1),L--);if(!x&&!v)for(;L--;L)S.unshift("..");x&&""!==S[0]&&(!S[0]||"/"!==S[0].charAt(0))&&S.unshift(""),I&&"/"!==S.join("/").substr(-1)&&S.push("");var i=""===S[0]||S[0]&&"/"===S[0].charAt(0);if(C){n.hostname=n.host=i?"":S.length?S.shift():"";var E=n.host&&0<n.host.indexOf("@")&&n.host.split("@");E&&(n.auth=E.shift(),n.host=n.hostname=E.shift())}return x=x||n.host&&S.length,x&&!i&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),d.isNull(n.pathname)&&d.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=i.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":115,punycode:67,querystring:70}],115:[function(e,t){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],116:[function(e,t){var n=e("bencode"),r=e("bitfield"),s=e("safe-buffer").Buffer,i=e("debug")("ut_metadata"),d=e("events").EventEmitter,a=e("inherits"),c=e("simple-sha1"),l=1e3,p=16384;t.exports=function(e){function t(t){d.call(this),this._wire=t,this._metadataComplete=!1,this._metadataSize=null,this._remainingRejects=null,this._fetching=!1,this._bitfield=new r(0,{grow:l}),s.isBuffer(e)&&this.setMetadata(e)}return a(t,d),t.prototype.name="ut_metadata",t.prototype.onHandshake=function(e){this._infoHash=e},t.prototype.onExtendedHandshake=function(e){return e.m&&e.m.ut_metadata?e.metadata_size?"number"!=typeof e.metadata_size||1e7<e.metadata_size||0>=e.metadata_size?this.emit("warning",new Error("Peer gave invalid metadata size")):void(this._metadataSize=e.metadata_size,this._numPieces=o(this._metadataSize/p),this._remainingRejects=2*this._numPieces,this._fetching&&this._requestPieces()):this.emit("warning",new Error("Peer does not have metadata")):this.emit("warning",new Error("Peer does not support ut_metadata"))},t.prototype.onMessage=function(e){var t,r;try{var o=e.toString(),s=o.indexOf("ee")+2;t=n.decode(o.substring(0,s)),r=e.slice(s)}catch(e){return}switch(t.msg_type){case 0:this._onRequest(t.piece);break;case 1:this._onData(t.piece,r,t.total_size);break;case 2:this._onReject(t.piece);}},t.prototype.fetch=function(){this._metadataComplete||(this._fetching=!0,this._metadataSize&&this._requestPieces())},t.prototype.cancel=function(){this._fetching=!1},t.prototype.setMetadata=function(e){if(this._metadataComplete)return!0;i("set metadata");try{var t=n.decode(e).info;t&&(e=n.encode(t))}catch(e){}return!(this._infoHash&&this._infoHash!==c.sync(e))&&(this.cancel(),this.metadata=e,this._metadataComplete=!0,this._metadataSize=this.metadata.length,this._wire.extendedHandshake.metadata_size=this._metadataSize,this.emit("metadata",n.encode({info:n.decode(this.metadata)})),!0)},t.prototype._send=function(e,t){var r=n.encode(e);s.isBuffer(t)&&(r=s.concat([r,t])),this._wire.extended("ut_metadata",r)},t.prototype._request=function(e){this._send({msg_type:0,piece:e})},t.prototype._data=function(e,t,n){var r={msg_type:1,piece:e};"number"==typeof n&&(r.total_size=n),this._send(r,t)},t.prototype._reject=function(e){this._send({msg_type:2,piece:e})},t.prototype._onRequest=function(e){if(!this._metadataComplete)return void this._reject(e);var t=e*p,n=t+p;n>this._metadataSize&&(n=this._metadataSize);var r=this.metadata.slice(t,n);this._data(e,r,this._metadataSize)},t.prototype._onData=function(e,t){t.length>p||(t.copy(this.metadata,e*p),this._bitfield.set(e),this._checkDone())},t.prototype._onReject=function(e){0<this._remainingRejects&&this._fetching?(this._request(e),this._remainingRejects-=1):this.emit("warning",new Error("Peer sent \"reject\" too much"))},t.prototype._requestPieces=function(){this.metadata=s.alloc(this._metadataSize);for(var e=0;e<this._numPieces;e++)this._request(e)},t.prototype._checkDone=function(){for(var e=!0,t=0;t<this._numPieces;t++)if(!this._bitfield.get(t)){e=!1;break}if(e){var n=this.setMetadata(this.metadata);n||this._failedMetadata()}},t.prototype._failedMetadata=function(){this._bitfield=new r(0,{grow:l}),this._remainingRejects-=this._numPieces,0<this._remainingRejects?this._requestPieces():this.emit("warning",new Error("Peer sent invalid metadata"))},t}},{bencode:11,bitfield:13,debug:29,events:33,inherits:40,"safe-buffer":90,"simple-sha1":94}],117:[function(e,t){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(e){return!1}var n=e.localStorage[t];return null!=n&&"true"===(n+"").toLowerCase()}t.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);else n("traceDeprecation")?console.trace(t):console.warn(t);r=!0}return e.apply(this,arguments)}}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],118:[function(e,t){(function(n){function o(e){var t=this;a.call(t),t._tracks=[],t._fragmentSequence=1,t._file=e,t._decoder=null,t._findMoov(0)}function s(e,t){var n=this;n._entries=e,n._countName=t||"count",n._index=0,n._offset=0,n.value=n._entries[0]}function d(){return{version:0,flags:0,entries:[]}}var i=e("binary-search"),a=e("events").EventEmitter,c=e("inherits"),l=e("mp4-stream"),p=e("mp4-box-encoding"),u=e("range-slice-stream");t.exports=o,c(o,a),o.prototype._findMoov=function(e){var t=this;t._decoder&&t._decoder.destroy(),t._decoder=l.decode();var n=t._file.createReadStream({start:e});n.pipe(t._decoder),t._decoder.once("box",function(r){"moov"===r.type?t._decoder.decode(function(e){n.destroy();try{t._processMoov(e)}catch(e){e.message="Cannot parse mp4 file: "+e.message,t.emit("error",e)}}):(n.destroy(),t._findMoov(e+r.length))})},s.prototype.inc=function(){var e=this;e._offset++,e._offset>=e._entries[e._index][e._countName]&&(e._index++,e._offset=0),e.value=e._entries[e._index]},o.prototype._processMoov=function(e){var t=this,r=e.traks;t._tracks=[],t._hasVideo=!1,t._hasAudio=!1;for(var o=0;o<r.length;o++){var i=r[o],a=i.mdia.minf.stbl,c=a.stsd.entries[0],l=i.mdia.hdlr.handlerType,u,f;if("vide"===l&&"avc1"===c.type){if(t._hasVideo)continue;t._hasVideo=!0,u="avc1",c.avcC&&(u+="."+c.avcC.mimeCodec),f="video/mp4; codecs=\""+u+"\""}else if("soun"===l&&"mp4a"===c.type){if(t._hasAudio)continue;t._hasAudio=!0,u="mp4a",c.esds&&c.esds.mimeCodec&&(u+="."+c.esds.mimeCodec),f="audio/mp4; codecs=\""+u+"\""}else continue;var h=[],m=0,g=0,_=0,y=0,b=0,w=0,k=new s(a.stts.entries),x=null;a.ctts&&(x=new s(a.ctts.entries));for(var v=0;;){var S=a.stsc.entries[b],C=a.stsz.entries[m],E=k.value.duration,B=x?x.value.compositionOffset:0,I=!0;if(a.stss&&(I=a.stss.entries[v]===m+1),h.push({size:C,duration:E,dts:w,presentationOffset:B,sync:I,offset:y+a.stco.entries[_]}),m++,m>=a.stsz.entries.length)break;if(g++,y+=C,g>=S.samplesPerChunk){g=0,y=0,_++;var L=a.stsc.entries[b+1];L&&_+1>=L.firstChunk&&b++}w+=E,k.inc(),x&&x.inc(),I&&v++}i.mdia.mdhd.duration=0,i.tkhd.duration=0;var T=S.sampleDescriptionId,A={type:"moov",mvhd:e.mvhd,traks:[{tkhd:i.tkhd,mdia:{mdhd:i.mdia.mdhd,hdlr:i.mdia.hdlr,elng:i.mdia.elng,minf:{vmhd:i.mdia.minf.vmhd,smhd:i.mdia.minf.smhd,dinf:i.mdia.minf.dinf,stbl:{stsd:a.stsd,stts:d(),ctts:d(),stsc:d(),stsz:d(),stco:d(),stss:d()}}}}],mvex:{mehd:{fragmentDuration:e.mvhd.duration},trexs:[{trackId:i.tkhd.trackId,defaultSampleDescriptionIndex:T,defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0}]}};t._tracks.push({trackId:i.tkhd.trackId,timeScale:i.mdia.mdhd.timeScale,samples:h,currSample:null,currTime:null,moov:A,mime:f})}if(0===t._tracks.length)return void t.emit("error",new Error("no playable tracks"));e.mvhd.duration=0,t._ftyp={type:"ftyp",brand:"iso5",brandVersion:0,compatibleBrands:["iso5"]};var U=p.encode(t._ftyp),R=t._tracks.map(function(e){var t=p.encode(e.moov);return{mime:e.mime,init:n.concat([U,t])}});t.emit("ready",R)},o.prototype.seek=function(e){var t=this;if(!t._tracks)throw new Error("Not ready yet; wait for 'ready' event");t._fileStream&&(t._fileStream.destroy(),t._fileStream=null);var n=-1;if(t._tracks.map(function(r,o){function s(e){i.destroyed||i.box(e.moof,function(n){if(n)return t.emit("error",n);if(!i.destroyed){var d=r.inStream.slice(e.ranges);d.pipe(i.mediaData(e.length,function(e){if(e)return t.emit("error",e);if(!i.destroyed){var n=t._generateFragment(o);return n?void s(n):i.finalize()}}))}})}r.outStream&&r.outStream.destroy(),r.inStream&&(r.inStream.destroy(),r.inStream=null);var i=r.outStream=l.encode(),d=t._generateFragment(o,e);return d?void((-1==n||d.ranges[0].start<n)&&(n=d.ranges[0].start),s(d)):i.finalize()}),0<=n){var r=t._fileStream=t._file.createReadStream({start:n});t._tracks.forEach(function(e){e.inStream=new u(n,{highWaterMark:1e7}),r.pipe(e.inStream)})}return t._tracks.map(function(e){return e.outStream})},o.prototype._findSampleBefore=function(e,t){var n=this,o=n._tracks[e],s=r(o.timeScale*t),d=i(o.samples,s,function(e,n){var t=e.dts+e.presentationOffset;return t-n});for(-1===d?d=0:0>d&&(d=-d-2);!o.samples[d].sync;)d--;return d},o.prototype._generateFragment=function(e,t){var n=this,r=n._tracks[e],o;if(o=void 0===t?r.currSample:n._findSampleBefore(e,t),o>=r.samples.length)return null;for(var s=r.samples[o].dts,i=0,d=[],a=o,c;a<r.samples.length&&(c=r.samples[a],!(c.sync&&c.dts-s>=1*r.timeScale));a++){i+=c.size;var l=d.length-1;0>l||d[l].end!==c.offset?d.push({start:c.offset,end:c.offset+c.size}):d[l].end+=c.size}return r.currSample=a,{moof:n._generateMoof(e,o,a),ranges:d,length:i}},o.prototype._generateMoof=function(e,t,n){for(var r=this,o=r._tracks[e],s=[],i=t,d;i<n;i++)d=o.samples[i],s.push({sampleDuration:d.duration,sampleSize:d.size,sampleFlags:d.sync?33554432:16842752,sampleCompositionTimeOffset:d.presentationOffset});var a={type:"moof",mfhd:{sequenceNumber:r._fragmentSequence++},trafs:[{tfhd:{flags:131072,trackId:o.trackId},tfdt:{baseMediaDecodeTime:o.samples[t].dts},trun:{flags:3841,dataOffset:8,entries:s}}]};return a.trafs[0].trun.dataOffset+=p.encodingLength(a),a}}).call(this,e("buffer").Buffer)},{"binary-search":12,buffer:23,events:33,inherits:40,"mp4-box-encoding":52,"mp4-stream":55,"range-slice-stream":73}],119:[function(e,t){var n=e("once"),r=e("end-of-stream"),o=e("fs"),s=function(){},i=function(e){return"function"==typeof e},d=function(e){return!!o&&(e instanceof(o.ReadStream||s)||e instanceof(o.WriteStream||s))&&i(e.close)},a=function(e){return e.setHeader&&i(e.abort)},c=function(e,t,o,c){c=n(c);var l=!1;e.on("close",function(){l=!0}),r(e,{readable:t,writable:o},function(e){return e?c(e):void(l=!0,c())});var p=!1;return function(t){if(!l)return p?void 0:(p=!0,d(e)?e.close(s):a(e)?e.abort():i(e.destroy)?e.destroy():void c(t||new Error("stream was destroyed")))}},l=function(e){e()},p=function(e,t){return e.pipe(t)};t.exports=function(){var e=Array.prototype.slice.call(arguments),t=i(e[e.length-1]||s)&&e.pop()||s;if(Array.isArray(e[0])&&(e=e[0]),2>e.length)throw new Error("pump requires two streams per minimum");var n=e.map(function(o,s){var i=s<e.length-1;return c(o,i,0<s,function(e){r||(r=e),e&&n.forEach(l),i||(n.forEach(l),t(r))})}),r;return e.reduce(p)}},{"end-of-stream":32,fs:21,once:59}],120:[function(e,t){function n(e,t,o){var s=this;return this instanceof n?void(o=o||{},s.detailedError=null,s._elem=t,s._elemWrapper=new r(t),s._waitingFired=!1,s._trackMeta=null,s._file=e,s._tracks=null,"none"!==s._elem.preload&&s._createMuxer(),s._onError=function(){s.detailedError=s._elemWrapper.detailedError,s.destroy()},s._onWaiting=function(){s._waitingFired=!0,s._muxer?s._tracks&&s._pump():s._createMuxer()},s._elem.addEventListener("waiting",s._onWaiting),s._elem.addEventListener("error",s._onError)):new n(e,t,o)}var r=e("mediasource"),o=e("pump"),s=e("./mp4-remuxer");t.exports=n,n.prototype._createMuxer=function(){var e=this;e._muxer=new s(e._file),e._muxer.on("ready",function(t){e._tracks=t.map(function(t){var n=e._elemWrapper.createWriteStream(t.mime);n.on("error",function(t){e._elemWrapper.error(t)});var r={muxed:null,mediaSource:n,initFlushed:!1,onInitFlushed:null};return n.write(t.init,function(e){r.initFlushed=!0,r.onInitFlushed&&r.onInitFlushed(e)}),r}),(e._waitingFired||"auto"===e._elem.preload)&&e._pump()}),e._muxer.on("error",function(t){e._elemWrapper.error(t)})},n.prototype._pump=function(){var e=this,t=e._muxer.seek(e._elem.currentTime,!e._tracks);e._tracks.forEach(function(n,r){var s=function(){n.muxed&&(n.muxed.destroy(),n.mediaSource=e._elemWrapper.createWriteStream(n.mediaSource),n.mediaSource.on("error",function(t){e._elemWrapper.error(t)})),n.muxed=t[r],o(n.muxed,n.mediaSource)};n.initFlushed?s():n.onInitFlushed=function(t){return t?void e._elemWrapper.error(t):void s()}})},n.prototype.destroy=function(){var e=this;e.destroyed||(e.destroyed=!0,e._elem.removeEventListener("waiting",e._onWaiting),e._elem.removeEventListener("error",e._onError),e._tracks&&e._tracks.forEach(function(e){e.muxed.destroy()}),e._elem.src="")}},{"./mp4-remuxer":118,mediasource:48,pump:119}],121:[function(e,t){function n(e,t){function r(){for(var t=Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];var r=e.apply(this,t),o=t[t.length-1];return"function"==typeof r&&r!==o&&Object.keys(o).forEach(function(e){r[e]=o[e]}),r}if(e&&t)return n(e)(t);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(t){r[t]=e[t]}),r}t.exports=n},{}],122:[function(e,t){t.exports=function(){for(var e={},t=0,r;t<arguments.length;t++)for(var o in r=arguments[t],r)n.call(r,o)&&(e[o]=r[o]);return e};var n=Object.prototype.hasOwnProperty},{}],123:[function(e,t){t.exports=function(e){for(var t=1,r;t<arguments.length;t++)for(var o in r=arguments[t],r)n.call(r,o)&&(e[o]=r[o]);return e};var n=Object.prototype.hasOwnProperty},{}],124:[function(e,t){t.exports=function e(t,n,r){return void 0===n?function(n,r){return e(t,n,r)}:(void 0===r&&(r="0"),t-=n.toString().length,0<t?Array(t+(/\./.test(n)?2:1)).join(r)+n:n+"")}},{}],125:[function(e,t){t.exports={version:"0.98.23"}},{}],126:[function(e,t){(function(n,r){function o(e){function t(){s.destroyed||(s.ready=!0,s.emit("ready"))}var s=this;return s instanceof o?void(u.call(s),!e&&(e={}),s.peerId="string"==typeof e.peerId?e.peerId:d.isBuffer(e.peerId)?e.peerId.toString("hex"):d.from(B+w(9).toString("base64")).toString("hex"),s.peerIdBuffer=d.from(s.peerId,"hex"),s.nodeId="string"==typeof e.nodeId?e.nodeId:d.isBuffer(e.nodeId)?e.nodeId.toString("hex"):w(20).toString("hex"),s.nodeIdBuffer=d.from(s.nodeId,"hex"),s._debugId=s.peerId.toString("hex").substring(0,7),s.destroyed=!1,s.listening=!1,s.torrentPort=e.torrentPort||0,s.dhtPort=e.dhtPort||0,s.tracker=void 0===e.tracker?{}:e.tracker,s.torrents=[],s.maxConns=+e.maxConns||55,s._debug("new webtorrent (peerId %s, nodeId %s, port %s)",s.peerId,s.nodeId,s.torrentPort),s.tracker&&("object"!=typeof s.tracker&&(s.tracker={}),e.rtcConfig&&(console.warn("WebTorrent: opts.rtcConfig is deprecated. Use opts.tracker.rtcConfig instead"),s.tracker.rtcConfig=e.rtcConfig),e.wrtc&&(console.warn("WebTorrent: opts.wrtc is deprecated. Use opts.tracker.wrtc instead"),s.tracker.wrtc=e.wrtc),r.WRTC&&!s.tracker.wrtc&&(s.tracker.wrtc=r.WRTC)),"function"==typeof v?s._tcpPool=new v(s):n.nextTick(function(){s._onListening()}),s._downloadSpeed=k(),s._uploadSpeed=k(),!1!==e.dht&&"function"==typeof p?(s.dht=new p(f({nodeId:s.nodeId},e.dht)),s.dht.once("error",function(e){s._destroy(e)}),s.dht.once("listening",function(){var e=s.dht.address();e&&(s.dhtPort=e.port)}),s.dht.setMaxListeners(0),s.dht.listen(s.dhtPort)):s.dht=!1,s.enableWebSeeds=!1!==e.webSeeds,"function"==typeof m&&null!=e.blocklist?m(e.blocklist,{headers:{"user-agent":"WebTorrent/"+C+" (https://webtorrent.io)"}},function(e,n){return e?s.error("Failed to load blocklist: "+e.message):void(s.blocked=n,t())}):n.nextTick(t)):new o(e)}function s(e){return"object"==typeof e&&null!=e&&"function"==typeof e.pipe}function i(e){return"undefined"!=typeof FileList&&e instanceof FileList}t.exports=o;var d=e("safe-buffer").Buffer,a=e("simple-concat"),c=e("create-torrent"),l=e("debug")("webtorrent"),p=e("bittorrent-dht/client"),u=e("events").EventEmitter,f=e("xtend"),h=e("inherits"),m=e("load-ip-set"),g=e("run-parallel"),_=e("parse-torrent"),y=e("path"),b=e("simple-peer"),w=e("randombytes"),k=e("speedometer"),x=e("zero-fill"),v=e("./lib/tcp-pool"),S=e("./lib/torrent"),C=e("./package.json").version,E=C.match(/([0-9]+)/g).slice(0,2).map(function(e){return x(2,e)}).join(""),B="-WW"+E+"-";h(o,u),o.WEBRTC_SUPPORT=b.WEBRTC_SUPPORT,Object.defineProperty(o.prototype,"downloadSpeed",{get:function(){return this._downloadSpeed()}}),Object.defineProperty(o.prototype,"uploadSpeed",{get:function(){return this._uploadSpeed()}}),Object.defineProperty(o.prototype,"progress",{get:function(){var e=this.torrents.filter(function(e){return 1!==e.progress}),t=e.reduce(function(e,t){return e+t.downloaded},0),n=e.reduce(function(e,t){return e+(t.length||0)},0)||1;return t/n}}),Object.defineProperty(o.prototype,"ratio",{get:function(){var e=this.torrents.reduce(function(e,t){return e+t.uploaded},0),t=this.torrents.reduce(function(e,t){return e+t.received},0)||1;return e/t}}),o.prototype.get=function(e){var t=this,n=t.torrents.length,r,o;if(e instanceof S){for(r=0;r<n;r++)if(o=t.torrents[r],o===e)return o;}else{var s;try{s=_(e)}catch(e){}if(!s)return null;if(!s.infoHash)throw new Error("Invalid torrent identifier");for(r=0;r<n;r++)if(o=t.torrents[r],o.infoHash===s.infoHash)return o}return null},o.prototype.download=function(e,t,n){return console.warn("WebTorrent: client.download() is deprecated. Use client.add() instead"),this.add(e,t,n)},o.prototype.add=function(e,t,n){function r(){if(!d.destroyed)for(var e=0,n=d.torrents.length,r;e<n;e++)if(r=d.torrents[e],r.infoHash===a.infoHash&&r!==a)return void a._destroy(new Error("Cannot add duplicate torrent "+a.infoHash))}function o(){d.destroyed||("function"==typeof n&&n(a),d.emit("torrent",a))}function s(){a.removeListener("_infoHash",r),a.removeListener("ready",o),a.removeListener("close",s)}var d=this;if(d.destroyed)throw new Error("client is destroyed");if("function"==typeof t)return d.add(e,null,t);d._debug("add"),t=t?f(t):{};var a=new S(e,d,t);return d.torrents.push(a),a.once("_infoHash",r),a.once("ready",o),a.once("close",s),a},o.prototype.seed=function(e,t,n){function r(e){o._debug("on seed"),"function"==typeof n&&n(e),e.emit("seed"),o.emit("seed",e)}var o=this;if(o.destroyed)throw new Error("client is destroyed");if("function"==typeof t)return o.seed(e,null,t);o._debug("seed"),t=t?f(t):{},"string"==typeof e&&(t.path=y.dirname(e)),t.createdBy||(t.createdBy="WebTorrent/"+E);var d=o.add(null,t,function(e){var t=[function(t){e.load(l,t)}];o.dht&&t.push(function(t){e.once("dhtAnnounce",t)}),g(t,function(t){return o.destroyed?void 0:t?e._destroy(t):void r(e)})}),l;return i(e)&&(e=Array.prototype.slice.call(e)),Array.isArray(e)||(e=[e]),g(e.map(function(e){return function(t){s(e)?a(e,t):t(null,e)}}),function(e,n){return o.destroyed?void 0:e?d._destroy(e):void c.parseInput(n,t,function(e,r){return o.destroyed?void 0:e?d._destroy(e):void(l=r.map(function(e){return e.getStream}),c(n,t,function(e,t){if(!o.destroyed){if(e)return d._destroy(e);var n=o.get(t);n?d._destroy(new Error("Cannot add duplicate torrent "+n.infoHash)):d._onTorrentId(t)}}))})}),d},o.prototype.remove=function(e,t){this._debug("remove");var n=this.get(e);if(!n)throw new Error("No torrent with id "+e);this._remove(e,t)},o.prototype._remove=function(e,t){var n=this.get(e);n&&(this.torrents.splice(this.torrents.indexOf(n),1),n.destroy(t))},o.prototype.address=function(){return this.listening?this._tcpPool?this._tcpPool.server.address():{address:"0.0.0.0",family:"IPv4",port:0}:null},o.prototype.destroy=function(e){if(this.destroyed)throw new Error("client already destroyed");this._destroy(null,e)},o.prototype._destroy=function(e,t){var n=this;n._debug("client destroy"),n.destroyed=!0;var r=n.torrents.map(function(e){return function(t){e.destroy(t)}});n._tcpPool&&r.push(function(e){n._tcpPool.destroy(e)}),n.dht&&r.push(function(e){n.dht.destroy(e)}),g(r,t),e&&n.emit("error",e),n.torrents=[],n._tcpPool=null,n.dht=null},o.prototype._onListening=function(){if(this._debug("listening"),this.listening=!0,this._tcpPool){var e=this._tcpPool.server.address();e&&(this.torrentPort=e.port)}this.emit("listening")},o.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._debugId+"] "+e[0],l.apply(null,e)}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./lib/tcp-pool":21,"./lib/torrent":5,"./package.json":125,_process:65,"bittorrent-dht/client":21,"create-torrent":28,debug:29,events:33,inherits:40,"load-ip-set":21,"parse-torrent":61,path:62,randombytes:72,"run-parallel":88,"safe-buffer":90,"simple-concat":91,"simple-peer":93,speedometer:96,xtend:122,"zero-fill":124}]},{},[126])(126)})}(),function(){var define=$__System.amdDefine;(function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("5b",[],t);else{var e;e="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,e.IdbChunkStore=t()}})(function(){return function t(e,r,n){function i(s,u){if(!r[s]){if(!e[s]){var f="function"==typeof require&&require;if(!u&&f)return f(s,!0);if(o)return o(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var h=r[s]={exports:{}};e[s][0].call(h.exports,function(t){var r=e[s][1][t];return i(r?r:t)},h,h.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){"use strict";function a(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function l(t){var h=t.length,e,r,n,s,u,f;u=a(t),f=new o(3*h/4-u),n=0<u?h-4:h;var l=0;for(e=0,r=0;e<n;e+=4,r+=3)s=i[t.charCodeAt(e)]<<18|i[t.charCodeAt(e+1)]<<12|i[t.charCodeAt(e+2)]<<6|i[t.charCodeAt(e+3)],f[l++]=255&s>>16,f[l++]=255&s>>8,f[l++]=255&s;return 2===u?(s=i[t.charCodeAt(e)]<<2|i[t.charCodeAt(e+1)]>>4,f[l++]=255&s):1===u&&(s=i[t.charCodeAt(e)]<<10|i[t.charCodeAt(e+1)]<<4|i[t.charCodeAt(e+2)]>>2,f[l++]=255&s>>8,f[l++]=255&s),f}function c(t){return n[63&t>>18]+n[63&t>>12]+n[63&t>>6]+n[63&t]}function p(t,e,r){for(var i=[],o=e,n;o<r;o+=3)n=(t[o]<<16)+(t[o+1]<<8)+t[o+2],i.push(c(n));return i.join("")}function v(t){for(var r=t.length,i=r%3,o="",s=[],u=16383,f=0,a=r-i,e;f<a;f+=u)s.push(p(t,f,f+u>a?a:f+u));return 1==i?(e=t[r-1],o+=n[e>>2],o+=n[63&e<<4],o+="=="):2==i&&(e=(t[r-2]<<8)+t[r-1],o+=n[e>>10],o+=n[63&e>>4],o+=n[63&e<<2],o+="="),s.push(o),s.join("")}r.byteLength=function(t){return 3*t.length/4-a(t)},r.toByteArray=l,r.fromByteArray=v;for(var n=[],i=[],o="undefined"==typeof Uint8Array?Array:Uint8Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,f=s.length;u<f;++u)n[u]=s[u],i[s.charCodeAt(u)]=u;i[45]=62,i[95]=63},{}],2:[function(t,e,r){"use strict";function u(t){if(t>o)throw new RangeError("Invalid typed array length");var e=new Uint8Array(t);return e.__proto__=f.prototype,e}function f(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(t)}return a(t,e,r)}function a(t,e,r){if("number"==typeof t)throw new TypeError("\"value\" argument must not be a number");return t instanceof ArrayBuffer?d(t,e,r):"string"==typeof t?p(t,e):g(t)}function h(t){if("number"!=typeof t)throw new TypeError("\"size\" argument must be a number");else if(0>t)throw new RangeError("\"size\" argument must not be negative")}function l(t,e,r){return h(t),0>=t?u(t):void 0===e?u(t):"string"==typeof r?u(t).fill(e,r):u(t).fill(e)}function c(t){return h(t),u(0>t?0:0|y(t))}function p(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!f.isEncoding(e))throw new TypeError("\"encoding\" must be a valid string encoding");var r=0|_(t,e),n=u(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function v(t){for(var e=0>t.length?0:0|y(t.length),r=u(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(0>e||t.byteLength<e)throw new RangeError("'offset' is out of bounds");if(t.byteLength<e+(r||0))throw new RangeError("'length' is out of bounds");var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),n.__proto__=f.prototype,n}function g(t){if(f.isBuffer(t)){var e=0|y(t.length),r=u(e);return 0===r.length?r:(t.copy(r,0,0,e),r)}if(t){if(Q(t)||"length"in t)return"number"!=typeof t.length||W(t.length)?u(0):v(t);if("Buffer"===t.type&&Array.isArray(t.data))return v(t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function _(t,e){if(f.isBuffer(t))return t.length;if(Q(t)||t instanceof ArrayBuffer)return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Z(t).length;default:if(n)return H(t).length;e=(""+e).toLowerCase(),n=!0;}}function m(t,e,r){var n=!1;if((void 0===e||0>e)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),0>=r)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return D(this,e,r);case"utf8":case"utf-8":return C(this,e,r);case"ascii":return M(this,e,r);case"latin1":case"binary":return j(this,e,r);case"base64":return I(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0;}}function b(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function E(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:-2147483648>r&&(r=-2147483648),r=+r,W(r)&&(r=i?0:t.length-1),0>r&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(0>r)if(i)r=0;else return-1;if("string"==typeof e&&(e=f.from(e,n)),f.isBuffer(e))return 0===e.length?-1:A(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):A(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function A(t,e,r,n,i){function f(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,s=t.length,u=e.length;if(void 0!==n&&(n=(n+"").toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(2>t.length||2>e.length)return-1;o=2,s/=2,u/=2,r/=2}var a;if(i){var h=-1;for(a=r;a<s;a++)if(f(t,a)!==f(e,-1==h?0:a-h))-1!=h&&(a-=a-h),h=-1;else if(-1==h&&(h=a),a-h+1===u)return h*o}else for(r+u>s&&(r=s-u),a=r;0<=a;a--){for(var l=!0,c=0;c<u;c++)if(f(t,a+c)!==f(e,c)){l=!1;break}if(l)return a}return-1}function k(t,e,r,n){r=+r||0;var i=t.length-r;n?(n=+n,n>i&&(n=i)):n=i;var o=e.length;if(0!=o%2)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0,u;s<n;++s){if(u=parseInt(e.substr(2*s,2),16),W(u))return s;t[r+s]=u}return s}function B(t,e,r,n){return K(H(e,t.length-r),t,r,n)}function L(t,e,r,n){return K(V(e),t,r,n)}function T(t,e,r,n){return L(t,e,r,n)}function S(t,e,r,n){return K(Z(e),t,r,n)}function x(t,e,r,n){return K(J(e,t.length-r),t,r,n)}function I(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function C(t,e,r){r=_Mathmin(t.length,r);for(var n=[],i=e;i<r;){var o=t[i],s=null,u=239<o?4:223<o?3:191<o?2:1;if(i+u<=r){var f,a,h,l;1==u?128>o&&(s=o):2==u?(f=t[i+1],128==(192&f)&&(l=(31&o)<<6|63&f,127<l&&(s=l))):3==u?(f=t[i+1],a=t[i+2],128==(192&f)&&128==(192&a)&&(l=(15&o)<<12|(63&f)<<6|63&a,2047<l&&(55296>l||57343<l)&&(s=l))):4==u?(f=t[i+1],a=t[i+2],h=t[i+3],128==(192&f)&&128==(192&a)&&128==(192&h)&&(l=(15&o)<<18|(63&f)<<12|(63&a)<<6|63&h,65535<l&&1114112>l&&(s=l))):void 0}null===s?(s=65533,u=1):65535<s&&(s-=65536,n.push(55296|1023&s>>>10),s=56320|1023&s),n.push(s),i+=u}return U(n)}function U(t){var e=t.length;if(e<=P)return _StringfromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=_StringfromCharCode.apply(String,t.slice(n,n+=P));return r}function M(t,e,r){var n="";r=_Mathmin(t.length,r);for(var i=e;i<r;++i)n+=_StringfromCharCode(127&t[i]);return n}function j(t,e,r){var n="";r=_Mathmin(t.length,r);for(var i=e;i<r;++i)n+=_StringfromCharCode(t[i]);return n}function D(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=X(t[o]);return i}function R(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=_StringfromCharCode(n[o]+256*n[o+1]);return i}function O(t,e,r){if(0!=t%1||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,r,n,i,o){if(!f.isBuffer(t))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(e>i||e<o)throw new RangeError("\"value\" argument is out of bounds");if(r+n>t.length)throw new RangeError("Index out of range")}function z(t,e,r,n){if(r+n>t.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("Index out of range")}function F(t,e,r,n,o){return e=+e,r>>>=0,o||z(t,e,r,4,34028234663852886e22,-34028234663852886e22),i.write(t,e,r,n,23,4),r+4}function q(t,e,r,n,o){return e=+e,r>>>=0,o||z(t,e,r,8,17976931348623157e292,-17976931348623157e292),i.write(t,e,r,n,52,8),r+8}function G(t){if(t=t.trim().replace(Y,""),2>t.length)return"";for(;0!=t.length%4;)t+="=";return t}function X(t){return 16>t?"0"+t.toString(16):t.toString(16)}function H(t,e){e=e||Infinity;for(var n=t.length,i=null,o=[],s=0,r;s<n;++s){if(r=t.charCodeAt(s),55295<r&&57344>r){if(!i){if(56319<r){-1<(e-=3)&&o.push(239,191,189);continue}else if(s+1===n){-1<(e-=3)&&o.push(239,191,189);continue}i=r;continue}if(56320>r){-1<(e-=3)&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,128>r){if(0>(e-=1))break;o.push(r)}else if(2048>r){if(0>(e-=2))break;o.push(192|r>>6,128|63&r)}else if(65536>r){if(0>(e-=3))break;o.push(224|r>>12,128|63&r>>6,128|63&r)}else if(1114112>r){if(0>(e-=4))break;o.push(240|r>>18,128|63&r>>12,128|63&r>>6,128|63&r)}else throw new Error("Invalid code point")}return o}function V(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function J(t,e){for(var o=[],s=0,r,n,i;s<t.length&&!(0>(e-=2));++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function Z(t){return n.toByteArray(G(t))}function K(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Q(t){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(t)}function W(t){return t!==t}var n=t("base64-js"),i=t("ieee754");r.Buffer=f,r.SlowBuffer=function(t){return+t!=t&&(t=0),f.alloc(+t)},r.INSPECT_MAX_BYTES=50;var o=2147483647;r.kMaxLength=o,f.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}(),f.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),f.poolSize=8192,f.from=function(t,e,r){return a(t,e,r)},f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,f.alloc=function(t,e,r){return l(t,e,r)},f.allocUnsafe=function(t){return c(t)},f.allocUnsafeSlow=function(t){return c(t)},f.isBuffer=function(e){return null!=e&&!0===e._isBuffer},f.compare=function(e,r){if(!f.isBuffer(e)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var n=e.length,i=r.length,o=0,s=_Mathmin(n,i);o<s;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0},f.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},f.concat=function(e,r){if(!Array.isArray(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return f.alloc(0);var n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=f.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!f.isBuffer(s))throw new TypeError("\"list\" argument must be an Array of Buffers");s.copy(i,o),o+=s.length}return i},f.byteLength=_,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===f.compare(this,e)},f.prototype.inspect=function(){var e="",n=r.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},f.prototype.compare=function(e,r,n,i,o){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),0>r||n>e.length||0>i||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;for(var s=o-i,u=n-r,a=_Mathmin(s,u),h=this.slice(i,o),l=e.slice(r,n),c=0;c<a;++c)if(h[c]!==l[c]){s=h[c],u=l[c];break}return s<u?-1:u<s?1:0},f.prototype.includes=function(e,r,n){return-1!==this.indexOf(e,r,n)},f.prototype.indexOf=function(e,r,n){return E(this,e,r,n,!0)},f.prototype.lastIndexOf=function(e,r,n){return E(this,e,r,n,!1)},f.prototype.write=function(e,r,n,i){if(void 0===r)i="utf8",n=this.length,r=0;else if(void 0===n&&"string"==typeof r)i=r,n=this.length,r=0;else if(isFinite(r))r>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-r;if((void 0===n||n>o)&&(n=o),0<e.length&&(0>n||0>r)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return k(this,e,r,n);case"utf8":case"utf-8":return B(this,e,r,n);case"ascii":return L(this,e,r,n);case"latin1":case"binary":return T(this,e,r,n);case"base64":return S(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0;}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;f.prototype.slice=function(e,r){var n=this.length;e=~~e,r=void 0===r?n:~~r,0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),0>r?(r+=n,0>r&&(r=0)):r>n&&(r=n),r<e&&(r=e);var i=this.subarray(e,r);return i.__proto__=f.prototype,i},f.prototype.readUIntLE=function(e,r,n){e>>>=0,r>>>=0,n||O(e,r,this.length);for(var i=this[e],o=1,s=0;++s<r&&(o*=256);)i+=this[e+s]*o;return i},f.prototype.readUIntBE=function(e,r,n){e>>>=0,r>>>=0,n||O(e,r,this.length);for(var i=this[e+--r],o=1;0<r&&(o*=256);)i+=this[e+--r]*o;return i},f.prototype.readUInt8=function(e,r){return e>>>=0,r||O(e,1,this.length),this[e]},f.prototype.readUInt16LE=function(e,r){return e>>>=0,r||O(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUInt16BE=function(e,r){return e>>>=0,r||O(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUInt32LE=function(e,r){return e>>>=0,r||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUInt32BE=function(e,r){return e>>>=0,r||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readIntLE=function(e,r,n){e>>>=0,r>>>=0,n||O(e,r,this.length);for(var i=this[e],o=1,s=0;++s<r&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=_Mathpow(2,8*r)),i},f.prototype.readIntBE=function(e,r,n){e>>>=0,r>>>=0,n||O(e,r,this.length);for(var i=r,o=1,s=this[e+--i];0<i&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=_Mathpow(2,8*r)),s},f.prototype.readInt8=function(e,r){return e>>>=0,r||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,r){e>>>=0,r||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt16BE=function(e,r){e>>>=0,r||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt32LE=function(e,r){return e>>>=0,r||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,r){return e>>>=0,r||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readFloatLE=function(e,r){return e>>>=0,r||O(e,4,this.length),i.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,r){return e>>>=0,r||O(e,4,this.length),i.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,r){return e>>>=0,r||O(e,8,this.length),i.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,r){return e>>>=0,r||O(e,8,this.length),i.read(this,e,!1,52,8)},f.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r>>>=0,n>>>=0,!i){var o=_Mathpow(2,8*n)-1;N(this,e,r,n,o,0)}var s=1,u=0;for(this[r]=255&e;++u<n&&(s*=256);)this[r+u]=255&e/s;return r+n},f.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r>>>=0,n>>>=0,!i){var o=_Mathpow(2,8*n)-1;N(this,e,r,n,o,0)}var s=n-1,u=1;for(this[r+s]=255&e;0<=--s&&(u*=256);)this[r+s]=255&e/u;return r+n},f.prototype.writeUInt8=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,1,255,0),this[r]=255&e,r+1},f.prototype.writeUInt16LE=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,2,65535,0),this[r]=255&e,this[r+1]=e>>>8,r+2},f.prototype.writeUInt16BE=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=255&e,r+2},f.prototype.writeUInt32LE=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e,r+4},f.prototype.writeUInt32BE=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e,r+4},f.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r>>>=0,!i){var o=_Mathpow(2,8*n-1);N(this,e,r,n,o-1,-o)}var s=0,u=1,f=0;for(this[r]=255&e;++s<n&&(u*=256);)0>e&&0==f&&0!==this[r+s-1]&&(f=1),this[r+s]=255&(e/u>>0)-f;return r+n},f.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r>>>=0,!i){var o=_Mathpow(2,8*n-1);N(this,e,r,n,o-1,-o)}var s=n-1,u=1,f=0;for(this[r+s]=255&e;0<=--s&&(u*=256);)0>e&&0==f&&0!==this[r+s+1]&&(f=1),this[r+s]=255&(e/u>>0)-f;return r+n},f.prototype.writeInt8=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,1,127,-128),0>e&&(e=255+e+1),this[r]=255&e,r+1},f.prototype.writeInt16LE=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,2,32767,-32768),this[r]=255&e,this[r+1]=e>>>8,r+2},f.prototype.writeInt16BE=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=255&e,r+2},f.prototype.writeInt32LE=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,4,2147483647,-2147483648),this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4},f.prototype.writeInt32BE=function(e,r,n){return e=+e,r>>>=0,n||N(this,e,r,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e,r+4},f.prototype.writeFloatLE=function(e,r,n){return F(this,e,r,!0,n)},f.prototype.writeFloatBE=function(e,r,n){return F(this,e,r,!1,n)},f.prototype.writeDoubleLE=function(e,r,n){return q(this,e,r,!0,n)},f.prototype.writeDoubleBE=function(e,r,n){return q(this,e,r,!1,n)},f.prototype.copy=function(e,r,n,i){if(n||(n=0),i||0===i||(i=this.length),r>=e.length&&(r=e.length),r||(r=0),0<i&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(0>r)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o=i-n,s;if(this===e&&n<r&&r<i)for(s=o-1;0<=s;--s)e[s+r]=this[s+n];else if(1e3>o)for(s=0;s<o;++s)e[s+r]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),r);return o},f.prototype.fill=function(e,r,n,i){if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);256>o&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!f.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(0>r||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r>>>=0,n=n===void 0?this.length:n>>>0,e||(e=0);var s;if("number"==typeof e)for(s=r;s<n;++s)this[s]=e;else{var u=f.isBuffer(e)?e:new f(e,i),a=u.length;for(s=0;s<n-r;++s)this[s+r]=u[s%a]}return this};var Y=/[^+\/0-9A-Za-z-_]/g},{"base64-js":1,ieee754:5}],3:[function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function u(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,r,n,o,f,a;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length))if(e=arguments[1],e instanceof Error)throw e;else{var h=new Error("Uncaught, unspecified \"error\" event. ("+e+")");throw h.context=e,h}if(r=this._events[t],u(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o);}else if(s(r))for(o=Array.prototype.slice.call(arguments,1),a=r.slice(),n=a.length,f=0;f<n;f++)a[f].apply(this,o);return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(r=u(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&0<r&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var r,n,o,u;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],o=r.length,n=-1,r===e||i(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(r)){for(u=o;0<u--;)if(r[u]===e||r[u].listener&&r[u].listener===e){n=u;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],i(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[],e},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},{}],4:[function(t,e){function f(t,e,r){function c(t){h(t),i._close(t.target.error)}function p(t){if(i._closed)t.target.result.close();else{for(var e in i._db=t.target.result,i._db.onclose=d,i._db.onerror=c,i._waiters)i._waiters[e]._init(null);i._waiters=null,r&&r(null),i.emit("open")}}function v(t){var e=t.target.result;e.createObjectStore("kv",{autoIncrement:!0})}function d(){i._close()}var i=this;if("string"!=typeof t)throw new Error("A name must be supplied of type string");if(!u)throw new Error("IndexedDB not supported");if("function"==typeof e)return new f(t,null,e);if(!(i instanceof f))return new f(t,e,r);e||(e={}),n.call(i),i._db=null,i._closed=!1,i._channel=null,i._waiters=[];var o=e.channel||s.BroadcastChannel;o&&(i._channel=new o(t),i._channel.onmessage=function(t){"add"===t.data.method?i.emit("add",t.data):"set"===t.data.method?i.emit("set",t.data):"remove"===t.data.method&&i.emit("remove",t.data)});var a=u.open(t);a.onerror=function(t){h(t),i._close(t.target.error),r&&r(t.target.error)},a.onsuccess=p,a.onupgradeneeded=v,i.on("newListener",function(t){return"add"!==t&&"set"!==t&&"remove"!==t||i._channel?void 0:i.emit("error",new Error("No BroadcastChannel support"))})}function a(t,e){if(this._kvStore=t,this._mode=e||"readwrite",this._objectStore=null,this._waiters=null,this.finished=!1,this.onfinish=null,"readonly"!==this._mode&&"readwrite"!==this._mode)throw new Error("mode must be either \"readonly\" or \"readwrite\"")}function h(t,e){return null==e?h(null,t):void(e.preventDefault(),e.stopPropagation(),t&&t(e.target.error))}e.exports=f;var n=t("events").EventEmitter,i=t("inherits"),o=t("promisize"),s="undefined"==typeof window?self:window,u=s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB;f.INDEXEDDB_SUPPORT=null!=u,f.BROADCAST_SUPPORT=null!=s.BroadcastChannel,i(f,n),f.prototype.get=function(t,e){return this.transaction("readonly").get(t,e)},f.prototype.set=function(t,e,r){return this.transaction("readwrite").set(t,e,r)},f.prototype.json=function(t,e){return this.transaction("readonly").json(t,e)},f.prototype.keys=function(t,e){return this.transaction("readonly").keys(t,e)},f.prototype.values=function(t,e){return this.transaction("readonly").values(t,e)},f.prototype.remove=function(t,e){return this.transaction("readwrite").remove(t,e)},f.prototype.clear=function(t){return this.transaction("readwrite").clear(t)},f.prototype.count=function(t,e){return this.transaction("readonly").count(t,e)},f.prototype.add=function(t,e,r){return this.transaction("readwrite").add(t,e,r)},f.prototype.iterator=function(t,e){return this.transaction("readonly").iterator(t,e)},f.prototype.transaction=function(t){if(this._closed)throw new Error("Database is closed");var e=new a(this,t);return this._db?e._init(null):this._waiters.push(e),e},f.prototype.close=function(){this._close()},f.prototype._close=function(t){if(!this._closed){for(var e in this._closed=!0,this._db&&this._db.close(),this._channel&&this._channel.close(),this._db=null,this._channel=null,t&&this.emit("error",t),this.emit("close"),this._waiters)this._waiters[e]._init(t||new Error("Database is closed"));this._waiters=null,this.removeAllListeners()}},a.prototype._init=function(t){function i(){e._close(null)}function o(t){h(t),e._close(t.target.error)}var e=this;if(!e.finished){if(t)return e._close(t);var r=e._kvStore._db.transaction("kv",e._mode);for(var n in r.oncomplete=i,r.onerror=o,e._objectStore=r.objectStore("kv"),e._waiters)e._waiters[n](null,e._objectStore);e._waiters=null}},a.prototype._getObjectStore=function(t){if(this.finished)throw new Error("Transaction is finished");return this._objectStore?t(null,this._objectStore):void(this._waiters=this._waiters||[],this._waiters.push(t))},a.prototype.set=function(t,e,r){var n=this;if(null==t||null==e)throw new Error("A key and value must be given");return r=o(r),n._getObjectStore(function(i,o){if(i)return r(i);try{var s=o.put(e,t)}catch(t){return r(t)}s.onerror=h.bind(this,r),s.onsuccess=function(){n._kvStore._channel&&n._kvStore._channel.postMessage({method:"set",key:t,value:e}),r(null)}}),r.promise},a.prototype.add=function(t,e,r){var n=this;if(null==e&&null!=t)return n.add(void 0,t,r);if("function"==typeof e||null==e&&null==r)return n.add(void 0,t,e);if(null==e)throw new Error("A value must be provided as an argument");return r=o(r),n._getObjectStore(function(i,o){if(i)return r(i);try{var s=null==t?o.add(e):o.add(e,t)}catch(t){return r(t)}s.onerror=h.bind(this,r),s.onsuccess=function(){n._kvStore._channel&&n._kvStore._channel.postMessage({method:"add",key:t,value:e}),r(null)}}),r.promise},a.prototype.get=function(t,e){var r=this;if(null==t)throw new Error("A key must be given as an argument");return e=o(e),r._getObjectStore(function(r,n){if(r)return e(r);try{var i=n.get(t)}catch(t){return e(t)}i.onerror=h.bind(this,e),i.onsuccess=function(t){e(null,t.target.result)}}),e.promise},a.prototype.json=function(t,e){var r=this;if("function"==typeof t)return r.json(null,t);e=o(e);var n={};return r.iterator(t,function(t,r){return t?e(t):void(r?(n[r.key]=r.value,r.continue()):e(null,n))}),e.promise},a.prototype.keys=function(t,e){var r=this;if("function"==typeof t)return r.keys(null,t);e=o(e);var n=[];return r.iterator(t,function(t,r){return t?e(t):void(r?(n.push(r.key),r.continue()):e(null,n))}),e.promise},a.prototype.values=function(t,e){var r=this;if("function"==typeof t)return r.values(null,t);e=o(e);var n=[];return r.iterator(t,function(t,r){return t?e(t):void(r?(n.push(r.value),r.continue()):e(null,n))}),e.promise},a.prototype.remove=function(t,e){var r=this;if(null==t)throw new Error("A key must be given as an argument");return e=o(e),r._getObjectStore(function(n,i){if(n)return e(n);try{var o=i.delete(t)}catch(t){return e(t)}o.onerror=h.bind(this,e),o.onsuccess=function(){r._kvStore._channel&&r._kvStore._channel.postMessage({method:"remove",key:t}),e(null)}}),e.promise},a.prototype.clear=function(t){var e=this;return t=o(t),e._getObjectStore(function(e,r){if(e)return t(e);try{var n=r.clear()}catch(e){return t(e)}n.onerror=h.bind(this,t),n.onsuccess=function(){t(null)}}),t.promise},a.prototype.count=function(t,e){var r=this;return"function"==typeof t?r.count(null,t):(e=o(e),r._getObjectStore(function(r,n){if(r)return e(r);try{var i=null==t?n.count():n.count(t)}catch(t){return e(t)}i.onerror=h.bind(this,e),i.onsuccess=function(t){e(null,t.target.result)}}),e.promise)},a.prototype.iterator=function(t,e){var r=this;if("function"==typeof t)return r.iterator(null,t);if("function"!=typeof e)throw new Error("A function must be given");r._getObjectStore(function(r,n){if(r)return e(r);try{var i=null==t?n.openCursor():n.openCursor(t)}catch(t){return e(t)}i.onerror=h.bind(this,e),i.onsuccess=function(t){var r=t.target.result;e(null,r)}})},a.prototype.abort=function(){if(this.finished)throw new Error("Transaction is finished");this._objectStore&&this._objectStore.transaction.abort(),this._close(new Error("Transaction aborted"))},a.prototype._close=function(t){if(!this.finished){for(var e in this.finished=!0,this._kvStore=null,this._objectStore=null,this._waiters)this._waiters[e](t||new Error("Transaction is finished"));this.onfinish&&this.onfinish(t),this.onfinish=null,this._waiters=null}}},{events:3,inherits:6,promisize:8}],5:[function(t,e,r){r.read=function(t,e,r,n,i){var u=8*i-n-1,f=(1<<u)-1,a=f>>1,h=-7,l=r?i-1:0,c=r?-1:1,p=t[e+l],o,s;for(l+=c,o=p&(1<<-h)-1,p>>=-h,h+=u;0<h;o=256*o+t[e+l],l+=c,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;0<h;s=256*s+t[e+l],l+=c,h-=8);if(0===o)o=1-a;else{if(o===f)return s?NaN:(p?-1:1)*Infinity;s+=_Mathpow(2,n),o-=a}return(p?-1:1)*s*_Mathpow(2,o-n)},r.write=function(t,e,r,n,i,o){var a=8*o-i-1,h=(1<<a)-1,l=h>>1,c=23===i?5.960464477539063e-8-6.617444900424222e-24:0,p=n?0:o-1,v=n?1:-1,d=0>e||0===e&&0>1/e?1:0,s,u,f;for(e=_Mathabs(e),isNaN(e)||e===Infinity?(u=isNaN(e)?1:0,s=h):(s=_Mathfloor(_Mathlog(e)/_MathLN),1>e*(f=_Mathpow(2,-s))&&(s--,f*=2),e+=1<=s+l?c/f:c*_Mathpow(2,1-l),2<=e*f&&(s++,f/=2),s+l>=h?(u=0,s=h):1<=s+l?(u=(e*f-1)*_Mathpow(2,i),s+=l):(u=e*_Mathpow(2,l-1)*_Mathpow(2,i),s=0));8<=i;t[r+p]=255&u,p+=v,u/=256,i-=8);for(s=s<<i|u,a+=i;0<a;t[r+p]=255&s,p+=v,s/=256,a-=8);t[r+p-v]|=128*d}},{}],6:[function(t,e){e.exports="function"==typeof Object.create?function(e,r){e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],7:[function(t,e){function s(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function f(t){if(i===setTimeout)return setTimeout(t,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}function a(t){if(o===clearTimeout)return clearTimeout(t);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}function v(){l&&c&&(l=!1,c.length?h=c.concat(h):p=-1,h.length&&d())}function d(){if(!l){var t=f(v);l=!0;for(var e=h.length;e;){for(c=h,h=[];++p<e;)c&&c[p].run();p=-1,e=h.length}c=null,l=!1,a(t)}}function g(t,e){this.fun=t,this.array=e}function y(){}var n=e.exports={},i,o;(function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(t){i=s}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(t){o=u}})();var h=[],l=!1,p=-1,c;n.nextTick=function(t){var e=Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new g(t,e)),1!==h.length||l||f(d)},g.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=y,n.addListener=y,n.once=y,n.off=y,n.removeListener=y,n.removeAllListeners=y,n.emit=y,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],8:[function(t,e){function n(t){function i(i,o){if(e)i?n(i):r(o);else if(t)t(i,o);else if(i)throw i}var e,r,n;if(null!=t&&"function"!=typeof t)throw new Error("cb must be a function");return null==t&&"undefined"!=typeof Promise&&(e=new Promise(function(t,e){r=t,n=e})),i.promise=e,i}e.exports=n},{}],"/":[function(t,e){(function(r,n){function o(t,e,r){var n=this;if("number"!=typeof t)throw new Error("chunkLength must be a number");if("function"==typeof e)return o(t,null,e);if(!(n instanceof o))return new o(t,e,r);e||(e={}),n.chunkLength=t,n.length=+e.length||Infinity,n.closed=!1,n._groupPutDelay=e.groupPutDelay||10,n._groupPutCallbacks=[],n._groupPutData={},n._groupPutTimeout=null,n._lastGroupPut=0,n.length!==Infinity&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,n.lastChunkIndex=_Mathceil(n.length/n.chunkLength)-1);var s=e.name||""+_Mathround(9e16*Math.random());e.torrent&&e.torrent.infoHash&&(s=e.torrent.infoHash),n._store=new i(s,r),n._store.on("close",function(){n._close(new Error("IndexedDB database unexpectedly closed"))}),n._store.on("error",function(t){n._close(t)})}function s(){null!=arguments[0]&&r.nextTick.apply(this,arguments)}function u(){}e.exports=o;var i=t("idb-kv-store");o.prototype.put=function(t,e,r){var i=this;if(i.closed)throw new Error("Store is closed");if("number"!=typeof t)throw new Error("index must be a number");n.isBuffer(e)||(e=n.from(e));var o=t===i.lastChunkIndex,u=o&&e.length!==i.lastChunkLength||!o&&e.length!==i.chunkLength;return u?s(r,new Error("Invalid buffer length")):void(i._groupPutData[t]=e,r&&i._groupPutCallbacks.push(r),i._lastGroupPut+i._groupPutDelay<Date.now()?i._groupPut():null==i._groupPutTimeout&&(i._groupPutTimeout=setTimeout(i._groupPut.bind(i),i._groupPutDelay)))},o.prototype._groupPut=function(){var t=this;if(!t.closed){var e=t._groupPutCallbacks,r=t._groupPutData;t._groupPutCallbacks=[],t._groupPutData={},t._lastGroupPut=Date.now(),null!=t._groupPutTimeout&&clearTimeout(t._groupPutTimeout),t._groupPutTimeout=null;var n=t._store.transaction("readwrite");for(var i in r)n.set(+i,r[i],u);n.onfinish=function(t){for(var r in e)e[r](t)}}},o.prototype.get=function(t,e,r){var i=this;if("function"==typeof e)return i.get(t,null,e);if("function"!=typeof r)throw new Error("cb must be a function");if(i.closed)throw new Error("Store is closed");if("number"!=typeof t)throw new Error("index must be a number");e||(e={}),i._store.get(t,function(t,i){if(t)return r(t);if("undefined"==typeof i){var o=new Error("Chunk does not exist");return o.name="MissingChunkError",r(o)}var s="offset"in e?e.offset:0,u="length"in e?e.length:i.length-s;r(null,n.from(i).slice(s,s+u))})},o.prototype.close=function(t){this._close(),s(t,null)},o.prototype._close=function(t){if(!this.closed){for(var e in this.closed=!0,this._store.close(),this._store=null,this._groupPutData=null,clearTimeout(this._groupPutTimeout),t=t||new Error("Store is closed"),this._groupPutCallbacks)this._groupPutCallbacks[e](t);this._groupPutCallbacks=null}},o.prototype.destroy=function(t){var e=this;if(e.closed)throw new Error("Store is closed");e._store.clear(u),e.close(t)}}).call(this,t("_process"),t("buffer").Buffer)},{_process:7,buffer:2,"idb-kv-store":4}]},{},[])("/")})}(),$__System.register("2b",["7","10","57","59","a","2c","5d","5c","5a","5b"],function(_export){var _classCallCheck,_Map,_Promise,OptionRegex,_createClass,_Object$assign,_getIterator,Helper,WebTorrent,IndexeddbChunkStore,MasterWebTorrent;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_Map=_2["default"]},function(_3){_Promise=_3["default"]},function(_4){OptionRegex=_4.OptionRegex},function(_a){_createClass=_a["default"]},function(_c){_Object$assign=_c["default"]},function(_d){_getIterator=_d["default"]},function(_c2){Helper=_c2.Helper},function(_a2){WebTorrent=_a2["default"]},function(_b){IndexeddbChunkStore=_b["default"]}],execute:function(){"use strict";MasterWebTorrent=function(){function MasterWebTorrent(){var container=0>=arguments.length||void 0===arguments[0]?document.body:arguments[0];_classCallCheck(this,MasterWebTorrent),this.container=container,this.Helper=new Helper,this.client=new WebTorrent,this.client.on("error",function(err){console.error("ERROR: "+err.message)}),this.addByTextReturn=new _Map,this.OptionRegex=new OptionRegex(this,this.client,void 0,this.addByTextReturn),this.OptionRegex.returnMap.set("init",[this.OptionRegex.getMagnetURL,this.OptionRegex]),this.OptionRegex.returnMap.set("getMagnetURL",[this.OptionRegex.mapFoundMagnetURL,this.OptionRegex]),this.OptionRegex.returnMap.set("mapFoundMagnetURL",[this.OptionRegex.replaceBlobURL,this.OptionRegex]),this.OptionRegex.returnMap.set("replaceBlobURL",[this.OptionRegex.addProgressBar,this.OptionRegex]),this.OptionRegex.returnMap.set("addProgressBar",[this.OptionRegex.addTorrent,this.OptionRegex]),this.OptionRegex.returnMap.set("addTorrent",[this._resultAddByText,this]),this.torrents=new _Map,this.nodes=[],this.addOpts={store:IndexeddbChunkStore},this.seedOpts={comment:"sst_WebRTC",store:IndexeddbChunkStore},this.appendToOpts={maxBlobLength:2000000000},this.attributes=["data-id","data-magnetURL","data-blobs","onerror","data-linktxt"],this.classes=["webTorrent","blobLoading","torrentLoading"],this.timeoutCont=null,this.onerrorCont=[],this.api={removeDeletedNodes:this.removeDeletedNodes.bind(this),createFilesId:this.Helper.createFilesId.bind(this.Helper),torrents:this.torrents,container:this.container}}return _createClass(MasterWebTorrent,[{key:"add",value:function(magnetURL,id,node,addOpts,appendToOpts,addCallback,appendToCallback){void 0===addOpts&&(addOpts=_Object$assign({},this.addOpts));var _this=this;return void 0===addCallback&&(addCallback=function(torrent){return _this.appendTo(void 0,appendToOpts,appendToCallback,torrent)}),function(){id=+id;var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError;try{for(var _iterator=_getIterator(this.client.torrents),_step,_torrent;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)if(_torrent=_step.value,id===_torrent.sst_id)return node&&this.setNodes(_torrent,node,_torrent.sst_id),_torrent.done&&addCallback(_torrent),!1}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator["return"]&&_iterator["return"]()}finally{if(_didIteratorError)throw _iteratorError}}var torrent=this.client.add(magnetURL,addOpts,addCallback);return this.addParseTorrent(torrent),torrent.sst_id=id,this.torrents.set(torrent.sst_id,torrent),node&&this.setNodes(torrent,node,torrent.sst_id),torrent}.apply(this,arguments)}},{key:"addByText",value:function(txt,arrayReturnMap,addOpts,appendToOpts,addCallback,appendToCallback){var workerID=this.Helper.getRandomString();this.addByTextReturn.set(workerID,[arrayReturnMap,[addOpts,appendToOpts,addCallback,appendToCallback]]),this.OptionRegex.init(txt,[this.attributes,this.classes],workerID)}},{key:"_resultAddByText",value:function(data){var txt=data[0][0],workerID=data[0][2],arrayReturnMap=this.addByTextReturn.get(workerID)[0];return arrayReturnMap&&(arrayReturnMap.forEach(function(returnMap){returnMap.get("attributes").push(txt),returnMap.get("function").apply(returnMap.get("scope"),returnMap.get("attributes"))}),this.addByTextReturn["delete"](workerID)),txt}},{key:"seed",value:function(files,text,node,seedOpts,appendToOpts,seedCallback,appendToCallback){void 0===seedOpts&&(seedOpts=_Object$assign({},this.seedOpts));var _this2=this;return void 0===seedCallback&&(seedCallback=function(torrent){return _this2.appendTo(text,appendToOpts,appendToCallback,torrent)}),function(){node&&(node.classList.add(this.classes[0],this.classes[1]),node.contentEditable=!1);var id=this.Helper.createFilesId(files),_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2;try{for(var _iterator2=_getIterator(this.client.torrents),_step2,_torrent2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0)if(_torrent2=_step2.value,id===_torrent2.sst_id)return node&&this.setNodes(_torrent2,node,_torrent2.sst_id),_torrent2.done&&seedCallback(_torrent2),!1}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2["return"]&&_iterator2["return"]()}finally{if(_didIteratorError2)throw _iteratorError2}}var torrent=this.client.seed(files,seedOpts,seedCallback);return this.addParseTorrent(torrent),torrent.sst_id=id,this.torrents.set(torrent.sst_id,torrent),node&&this.setNodes(torrent,node,torrent.sst_id),torrent}.apply(this,arguments)}},{key:"appendTo",value:function(text,appendToOpts,appendToCallback,torrent){return void 0===appendToOpts&&(appendToOpts=this.appendToOpts),void 0===appendToCallback&&(appendToCallback=function(torrent){console.info("torrent: "+torrent.name+" appended!")}),function(){var _this3=this;torrent.sst_nodes&&0<torrent.sst_nodes.length?torrent.sst_nodeCont?this.appended(torrent,appendToCallback,text):!torrent.sst_appending&&function(){torrent.sst_appending=!0;var node=torrent.sst_nodes[0];node.innerHTML="",torrent.files.forEach(function(file,i){file.appendTo(node,appendToOpts,function(err,elem){var callback=i===torrent.files.length-1?function(elem){setTimeout(function(){torrent.sst_appending=!1,+torrent.sst_id===+node.getAttribute(_this3.attributes[0])?(_this3.ProgressBar&&_this3.ProgressBar.removeAll(torrent),torrent.sst_nodeCont=node.innerHTML,torrent.sst_containsVideo=-1!==torrent.sst_nodeCont.indexOf("video"),_this3.appended(torrent,appendToCallback,text)):(node.removeChild(elem),torrent.sst_nodes=[],_this3.appendTo(text,appendToOpts,appendToCallback,torrent))},50)}:function(){};return elem?callback(elem):(file.done?_this3.appendToUnsupportedFileAsLink(text,torrent,file,node,callback):torrent.on("done",function(){_this3.appendToUnsupportedFileAsLink(text,torrent,file,node,callback)}),err=void 0),err&&(node.remove(),_this3.removeDeletedNodes()),!err||console.warn(err)})})}():(console.info("no nodes found in dom for:"),console.info(torrent))}.apply(this,arguments)}},{key:"appendToUnsupportedFileAsLink",value:function(text,torrent,file,node,callback){var _this4=this;file.getBlobURL(function(err,url){if(err)return console.warn(err);var name=file.name;text=text?text:node.getAttribute(_this4.attributes[4]),text&&(name=1<torrent.files.length?text+"_"+torrent.files.indexOf(file):text);var a=document.createElement("a");a.target="_blank",a.download=name,a.href=url,a.textContent=name,node.lastChild&&"A"===node.lastChild.tagName&&(a.textContent=", "+name),node.appendChild(a),callback(a)})}},{key:"appended",value:function(torrent){var _this5=this,appendToCallback=!(1>=arguments.length||void 0===arguments[1])&&arguments[1],text=!(2>=arguments.length||void 0===arguments[2])&&arguments[2],invalidNodes=[];torrent.sst_nodes.forEach(function(node,i){node&&"function"==typeof node.getAttribute?(node.innerHTML!==torrent.sst_nodeCont&&(node.innerHTML=torrent.sst_nodeCont),!node.getAttribute(_this5.attributes[1])&&node.setAttribute(_this5.attributes[1],torrent.magnetURI),text&&!node.getAttribute(_this5.attributes[4])&&node.setAttribute(_this5.attributes[4],text),node.classList.contains(_this5.classes[1])&&node.classList.remove(_this5.classes[1]),node.classList.contains(_this5.classes[2])&&node.classList.remove(_this5.classes[2]),0===i&&(torrent.sst_localBlobs=[]),node.childNodes.forEach(function(child){if(0===i){var blob=child.getAttribute("src")?child.getAttribute("src"):child.getAttribute("href");blob&&torrent.sst_localBlobs.push(blob)}child.setAttribute(_this5.attributes[3],_this5.appended_onerror+"("+torrent.sst_id+");"),torrent.sst_onerror=_this5.appended_onerror+"("+torrent.sst_id+");"}),node.setAttribute(_this5.attributes[2],torrent.sst_localBlobs.join(","))):invalidNodes.push(node)}),this.removeInvalidNodes(invalidNodes,torrent.sst_id),appendToCallback&&appendToCallback(torrent)}},{key:"blobsRefresh",value:function(){var _this6=this,torrentId=0>=arguments.length||void 0===arguments[0]?this.onerrorCont:arguments[0];Array.isArray(torrentId)?(torrentId.forEach(function(id){var torrent=_this6.torrents.get(id);torrent&&torrent.files.forEach(function(file,i){file.getBlobURL(function(err,url){return err?console.warn(err):void(url!==torrent.sst_localBlobs[i]&&(torrent.sst_nodeCont=torrent.sst_nodeCont.replace(torrent.sst_localBlobs[i],url),URL.revokeObjectURL(torrent.sst_localBlobs[i])),i===torrent.files.length-1&&(_this6.findAllNodes(torrent),_this6.appended(torrent)))})})}),this.onerrorCont=[]):(-1===this.onerrorCont.indexOf(torrentId)&&this.onerrorCont.push(torrentId),clearTimeout(this.timeoutCont),this.timeoutCont=setTimeout(function(){_this6.blobsRefresh()},1e3))}},{key:"setNodes",value:function(torrent,node,id){return!!(node&&(torrent.sst_nodes||(torrent.sst_nodes=[]),-1===torrent.sst_nodes.indexOf(node)))&&(torrent.sst_nodes.push(node),node.getAttribute(this.attributes[0])||node.setAttribute(this.attributes[0],id),-1===this.nodes.indexOf(node)&&this.nodes.push(node),!0)}},{key:"findAllNodes",value:function(torrent){var _this7=this,nodes=this.container.querySelectorAll("["+this.attributes[0]+"=\""+torrent.sst_id+"\"]");return nodes.forEach(function(node){_this7.setNodes(torrent,node,torrent.sst_id)}),nodes}},{key:"removeDeletedNodes",value:function(){var _this8=this,container=0>=arguments.length||void 0===arguments[0]?this.container:arguments[0],removedNodes=[];return this.nodes.forEach(function(node){!container.contains(node)&&_this8.remove(node)&&removedNodes.push(node)}),0<removedNodes.length&&(this.nodes=this.nodes.filter(function(e){return-1===removedNodes.indexOf(e)})),removedNodes}},{key:"removeInvalidNodes",value:function(nodes,id){var _this9=this,removedNodes=[];return nodes.forEach(function(node){_this9.remove(node,void 0,id)&&removedNodes.push(node)}),0<removedNodes.length&&(this.nodes=this.nodes.filter(function(e){return-1===removedNodes.indexOf(e)})),removedNodes}},{key:"remove",value:function(){var node=!(0>=arguments.length||void 0===arguments[0])&&arguments[0],callback=1>=arguments.length||void 0===arguments[1]?null:arguments[1],id=!(2>=arguments.length||void 0===arguments[2])&&arguments[2];id=id?id:+node.getAttribute(this.attributes[0]);var torrent=this.torrents.get(id);if(torrent){var index=torrent.sst_nodes.indexOf(node);return-1!==index&&torrent.sst_nodes.splice(index,1),0===torrent.sst_nodes.length&&0===this.findAllNodes(torrent).length?(this.ProgressBar&&this.ProgressBar.removeAll(torrent),torrent.sst_localBlobs&&torrent.sst_localBlobs.forEach(function(blob){URL.revokeObjectURL(blob)}),callback?torrent.destroy(callback):this.client.remove(torrent),this.torrents["delete"](id),!0):torrent}return!1}},{key:"areTorrentsLoading",value:function(){return this.client.torrents.some(function(torrent){return!torrent.done||torrent.sst_appending})}},{key:"addParseTorrent",value:function(){}},{key:"getBlobByFileName",value:function(name){var _this10=this;return new _Promise(function(resolve,reject){var getBlob=function(file){file.getBlob(function(err,blob){return err?reject(console.warn(err)):void resolve(blob)})};_this10.client.torrents.some(function(torrent){var file;return torrent.done&&(file=torrent.files.find(function(file){return file.name===name}))?(getBlob(file),!0):!!torrent.magnetURI.includes(name)&&(torrent.on("done",function(){getBlob(torrent.files[0])}),!0)})||reject("not found!")})}}]),MasterWebTorrent}(),_export("MasterWebTorrent",MasterWebTorrent)}}}),$__System.registerDynamic("52",["3a"],!0,function($__require,exports,module){var global=this||self,ITERATOR=$__require("3a")("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR]();riter["return"]=function(){SAFE_CLOSING=!0},Array.from(riter,function(){throw 2})}catch(e){}module.exports=function(exec,skipClosing){if(!skipClosing&&!SAFE_CLOSING)return!1;var safe=!1;try{var arr=[7],iter=arr[ITERATOR]();iter.next=function(){return{done:safe=!0}},arr[ITERATOR]=function(){return iter},exec(arr)}catch(e){}return safe}}),$__System.registerDynamic("5e",["41","33","2f","5f","60","61","62","52"],!0,function($__require){"use strict";var global=this||self,ctx=$__require("41"),$export=$__require("33"),toObject=$__require("2f"),call=$__require("5f"),isArrayIter=$__require("60"),toLength=$__require("61"),getIterFn=$__require("62");$export($export.S+$export.F*!$__require("52")(function(iter){Array.from(iter)}),"Array",{from:function(arrayLike){var O=toObject(arrayLike),C="function"==typeof this?this:Array,$$=arguments,$$len=$$.length,mapfn=1<$$len?$$[1]:void 0,mapping=void 0!==mapfn,index=0,iterFn=getIterFn(O),length,result,step,iterator;if(mapping&&(mapfn=ctx(mapfn,2<$$len?$$[2]:void 0,2)),void 0!=iterFn&&!(C==Array&&isArrayIter(iterFn)))for(iterator=iterFn.call(O),result=new C;!(step=iterator.next()).done;index++)result[index]=mapping?call(iterator,mapfn,[step.value,index],!0):step.value;else for(length=toLength(O.length),result=new C(length);length>index;index++)result[index]=mapping?mapfn(O[index],index):O[index];return result.length=index,result}})}),$__System.registerDynamic("63",["55","5e","35"],!0,function($__require,exports,module){var global=this||self;$__require("55"),$__require("5e"),module.exports=$__require("35").Array.from}),$__System.registerDynamic("64",["63"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("63"),__esModule:!0}}),$__System.registerDynamic("1c",["64"],!0,function($__require,exports){"use strict";var global=this||self,_Array$from=$__require("64")["default"];exports["default"]=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return _Array$from(arr)},exports.__esModule=!0}),$__System.registerDynamic("54",[],!0,function(){"format cjs";var global=this||self}),$__System.registerDynamic("51",["35","2e","4e","3a"],!0,function($__require,exports,module){"use strict";var global=this||self,core=$__require("35"),$=$__require("2e"),DESCRIPTORS=$__require("4e"),SPECIES=$__require("3a")("species");module.exports=function(KEY){var C=core[KEY];DESCRIPTORS&&C&&!C[SPECIES]&&$.setDesc(C,SPECIES,{configurable:!0,get:function(){return this}})}}),$__System.registerDynamic("65",["2e","66","4f","41","4b","67","4c","68","69","6a","6b","3f","51","4e"],!0,function($__require,exports,module){"use strict";var global=this||self,$=$__require("2e"),hide=$__require("66"),redefineAll=$__require("4f"),ctx=$__require("41"),strictNew=$__require("4b"),defined=$__require("67"),forOf=$__require("4c"),$iterDefine=$__require("68"),step=$__require("69"),ID=$__require("6a")("id"),$has=$__require("6b"),isObject=$__require("3f"),setSpecies=$__require("51"),DESCRIPTORS=$__require("4e"),isExtensible=Object.isExtensible||isObject,SIZE=DESCRIPTORS?"_s":"size",id=0,fastKey=function(it,create){if(!isObject(it))return"symbol"==typeof it?it:("string"==typeof it?"S":"P")+it;if(!$has(it,ID)){if(!isExtensible(it))return"F";if(!create)return"E";hide(it,ID,++id)}return"O"+it[ID]},getEntry=function(that,key){var index=fastKey(key),entry;if("F"!==index)return that._i[index];for(entry=that._f;entry;entry=entry.n)if(entry.k==key)return entry};module.exports={getConstructor:function(wrapper,NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){strictNew(that,C,NAME),that._i=$.create(null),that._f=void 0,that._l=void 0,that[SIZE]=0,void 0!=iterable&&forOf(iterable,IS_MAP,that[ADDER],that)});return redefineAll(C.prototype,{clear:function(){for(var that=this,data=that._i,entry=that._f;entry;entry=entry.n)entry.r=!0,entry.p&&(entry.p=entry.p.n=void 0),delete data[entry.i];that._f=that._l=void 0,that[SIZE]=0},delete:function(key){var that=this,entry=getEntry(that,key);if(entry){var next=entry.n,prev=entry.p;delete that._i[entry.i],entry.r=!0,prev&&(prev.n=next),next&&(next.p=prev),that._f==entry&&(that._f=next),that._l==entry&&(that._l=prev),that[SIZE]--}return!!entry},forEach:function(callbackfn){for(var f=ctx(callbackfn,1<arguments.length?arguments[1]:void 0,3),entry;entry=entry?entry.n:this._f;)for(f(entry.v,entry.k,this);entry&&entry.r;)entry=entry.p},has:function(key){return!!getEntry(this,key)}}),DESCRIPTORS&&$.setDesc(C.prototype,"size",{get:function(){return defined(this[SIZE])}}),C},def:function(that,key,value){var entry=getEntry(that,key),prev,index;return entry?entry.v=value:(that._l=entry={i:index=fastKey(key,!0),k:key,v:value,p:prev=that._l,n:void 0,r:!1},!that._f&&(that._f=entry),prev&&(prev.n=entry),that[SIZE]++,"F"!==index&&(that._i[index]=entry)),that},getEntry:getEntry,setStrong:function(C,NAME,IS_MAP){$iterDefine(C,NAME,function(iterated,kind){this._t=iterated,this._k=kind,this._l=void 0},function(){for(var that=this,kind=that._k,entry=that._l;entry&&entry.r;)entry=entry.p;return that._t&&(that._l=entry=entry?entry.n:that._t._f)?"keys"==kind?step(0,entry.k):"values"==kind?step(0,entry.v):step(0,[entry.k,entry.v]):(that._t=void 0,step(1))},IS_MAP?"entries":"values",!IS_MAP,!0),setSpecies(NAME)}}}),$__System.registerDynamic("4f",["6c"],!0,function($__require,exports,module){var global=this||self,redefine=$__require("6c");module.exports=function(target,src){for(var key in src)redefine(target,key,src[key]);return target}}),$__System.registerDynamic("4b",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(it,Constructor,name){if(!(it instanceof Constructor))throw TypeError(name+": use the 'new' operator!");return it}}),$__System.registerDynamic("6d",["2e","3d","33","31","66","4f","4c","4b","3f","50","4e"],!0,function($__require,exports,module){"use strict";var global=this||self,$=$__require("2e"),global=$__require("3d"),$export=$__require("33"),fails=$__require("31"),hide=$__require("66"),redefineAll=$__require("4f"),forOf=$__require("4c"),strictNew=$__require("4b"),isObject=$__require("3f"),setToStringTag=$__require("50"),DESCRIPTORS=$__require("4e");module.exports=function(NAME,wrapper,methods,common,IS_MAP,IS_WEAK){var Base=global[NAME],C=Base,ADDER=IS_MAP?"set":"add",proto=C&&C.prototype,O={};return DESCRIPTORS&&"function"==typeof C&&(IS_WEAK||proto.forEach&&!fails(function(){new C().entries().next()}))?(C=wrapper(function(target,iterable){strictNew(target,C,NAME),target._c=new Base,void 0!=iterable&&forOf(iterable,IS_MAP,target[ADDER],target)}),$.each.call(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(KEY){var IS_ADDER="add"==KEY||"set"==KEY;KEY in proto&&!(IS_WEAK&&"clear"==KEY)&&hide(C.prototype,KEY,function(a,b){if(IS_ADDER||!IS_WEAK||isObject(a)){var result=this._c[KEY](0===a?0:a,b);return IS_ADDER?this:result}})}),"size"in proto&&$.setDesc(C.prototype,"size",{get:function(){return this._c.size}})):(C=common.getConstructor(wrapper,NAME,IS_MAP,ADDER),redefineAll(C.prototype,methods)),setToStringTag(C,NAME),O[NAME]=C,$export($export.G+$export.W+$export.F,O),IS_WEAK||common.setStrong(C,NAME,IS_MAP),C}}),$__System.registerDynamic("6e",["65","6d"],!0,function($__require){"use strict";var global=this||self,strong=$__require("65");$__require("6d")("Map",function(get){return function(){return get(this,0<arguments.length?arguments[0]:void 0)}},{get:function(key){var entry=strong.getEntry(this,key);return entry&&entry.v},set:function(key,value){return strong.def(this,0===key?0:key,value)}},strong,!0)}),$__System.registerDynamic("5f",["38"],!0,function($__require,exports,module){var global=this||self,anObject=$__require("38");module.exports=function(iterator,fn,value,entries){try{return entries?fn(anObject(value)[0],value[1]):fn(value)}catch(e){var ret=iterator["return"];throw void 0!==ret&&anObject(ret.call(iterator)),e}}}),$__System.registerDynamic("60",["6f","3a"],!0,function($__require,exports,module){var global=this||self,Iterators=$__require("6f"),ITERATOR=$__require("3a")("iterator"),ArrayProto=Array.prototype;module.exports=function(it){return it!==void 0&&(Iterators.Array===it||ArrayProto[ITERATOR]===it)}}),$__System.registerDynamic("61",["70"],!0,function($__require,exports,module){var global=this||self,toInteger=$__require("70");module.exports=function(it){return 0<it?_Mathmin(toInteger(it),9007199254740991):0}}),$__System.registerDynamic("4c",["41","5f","60","38","61","62"],!0,function($__require,exports,module){var global=this||self,ctx=$__require("41"),call=$__require("5f"),isArrayIter=$__require("60"),anObject=$__require("38"),toLength=$__require("61"),getIterFn=$__require("62");module.exports=function(iterable,entries,fn,that){var iterFn=getIterFn(iterable),f=ctx(fn,that,entries?2:1),index=0,length,step,iterator;if("function"!=typeof iterFn)throw TypeError(iterable+" is not iterable!");if(isArrayIter(iterFn))for(length=toLength(iterable.length);length>index;index++)entries?f(anObject(step=iterable[index])[0],step[1]):f(iterable[index]);else for(iterator=iterFn.call(iterable);!(step=iterator.next()).done;)call(iterator,f,step.value,entries)}}),$__System.registerDynamic("71",["4c","4a"],!0,function($__require,exports,module){var global=this||self,forOf=$__require("4c"),classof=$__require("4a");module.exports=function(NAME){return function(){if(classof(this)!=NAME)throw TypeError(NAME+"#toJSON isn't generic");var arr=[];return forOf(this,!1,arr.push,arr),arr}}}),$__System.registerDynamic("72",["33","71"],!0,function($__require){var global=this||self,$export=$__require("33");$export($export.P,"Map",{toJSON:$__require("71")("Map")})}),$__System.registerDynamic("73",["54","55","56","6e","72","35"],!0,function($__require,exports,module){var global=this||self;$__require("54"),$__require("55"),$__require("56"),$__require("6e"),$__require("72"),module.exports=$__require("35").Map}),$__System.registerDynamic("10",["73"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("73"),__esModule:!0}}),$__System.register("74",["7","10","a","1c","5d"],function(_export){var _classCallCheck,_Map,_createClass,_toConsumableArray,_getIterator,ProgressBar;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_Map=_2["default"]},function(_a){_createClass=_a["default"]},function(_c){_toConsumableArray=_c["default"]},function(_d){_getIterator=_d["default"]}],execute:function(){"use strict";ProgressBar=function(){function ProgressBar(torrents,addTorrent,removeTorrentNode){var interval=3>=arguments.length||void 0===arguments[3]?1e3:arguments[3],animationClass=4>=arguments.length||void 0===arguments[4]?"torrentLoading":arguments[4];_classCallCheck(this,ProgressBar),this.torrents=torrents,this.addTorrent=addTorrent,this.removeTorrentNode=removeTorrentNode,this.interval=interval,this.resetInterval=5*this.interval,this.intervalCont=void 0,this.tags=["span"],this.classes=["torrentInfo",animationClass,"torrentProgress","torrentControls"]}return _createClass(ProgressBar,[{key:"start",value:function(){var _this=this;this.intervalCont||(this.intervalCont=setInterval(function(){_this.update()},this.interval))}},{key:"end",value:function(){this.intervalCont=clearInterval(this.intervalCont);var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError;try{for(var _iterator=_getIterator(this.torrents.values()),_step,torrent;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)torrent=_step.value,this.removeAll(torrent)}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator["return"]&&_iterator["return"]()}finally{if(_didIteratorError)throw _iteratorError}}}},{key:"update",value:function(){var _this2=this,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2;try{for(var _loop=function(){var torrent=_step2.value;torrent.done||!torrent.sst_nodes||torrent.sst_containsVideo||function(){var progress=(100*torrent.progress).toFixed(1);torrent.sst_progressNodes||(torrent.sst_progressNodes=new _Map),torrent.sst_nodes.forEach(function(node){var parentNode=torrent.sst_progressNodes.get(node),animationNode,infoNode,controlsNode;parentNode&&node.contains(parentNode)?infoNode=parentNode.getElementsByClassName(_this2.classes[2])[0]:(parentNode=document.createElement("span"),parentNode.classList.add(_this2.classes[0]),node.appendChild(parentNode),torrent.sst_progressNodes.set(node,parentNode),animationNode=document.createElement("span"),animationNode.classList.add(_this2.classes[1]),parentNode.appendChild(animationNode),infoNode=document.createElement("span"),infoNode.classList.add(_this2.classes[2]),parentNode.appendChild(infoNode),controlsNode=document.createElement("a"),controlsNode.classList.add(_this2.classes[3]),controlsNode.innerText="Reset",controlsNode.onclick=function(){var magnetURI=torrent.magnetURI,sst_id=torrent.sst_id,nodes=[];torrent.sst_nodes.forEach(function(node){nodes.push(node),_this2.removeTorrentNode(node,function(){setTimeout(function(){nodes.forEach(function(node){_this2.addTorrent(magnetURI,sst_id,node)})},_this2.resetInterval)})})},parentNode.appendChild(controlsNode)),infoNode.innerHTML="&nbsp;"+progress+"%&nbsp;"})}()},_iterator2=_getIterator(this.torrents.values()),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0)_loop()}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2["return"]&&_iterator2["return"]()}finally{if(_didIteratorError2)throw _iteratorError2}}}},{key:"remove",value:function(torrent,node){if(torrent.sst_progressNodes){var parentNode=torrent.sst_progressNodes.get(node);parentNode&&node.contains(parentNode)?(node.removeChild(parentNode),torrent.sst_progressNodes["delete"](node),!torrent.sst_progressNodes.size&&delete torrent.sst_progressNodes):[].concat(_toConsumableArray(node.getElementsByClassName(this.classes[0]))).forEach(function(parentNode){node.removeChild(parentNode)})}}},{key:"removeAll",value:function(torrent){var _this3=this;torrent.sst_progressNodes&&torrent.sst_nodes.forEach(function(node){_this3.remove(torrent,node)})}}]),ProgressBar}(),_export("ProgressBar",ProgressBar)}}}),$__System.register("75",["5","6","7","74","a","2c","2b"],function(_export){var _get,_inherits,_classCallCheck,ProgressBar,_createClass,_Object$assign,MasterWebTorrent,WebTorrentReceiver;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){ProgressBar=_4.ProgressBar},function(_a){_createClass=_a["default"]},function(_c){_Object$assign=_c["default"]},function(_b){MasterWebTorrent=_b.MasterWebTorrent}],execute:function(){"use strict";WebTorrentReceiver=function(_MasterWebTorrent){function WebTorrentReceiver(container){_classCallCheck(this,WebTorrentReceiver),_get(Object.getPrototypeOf(WebTorrentReceiver.prototype),"constructor",this).call(this,container),this.ProgressBar=new ProgressBar(this.torrents,this.add.bind(this),this.remove.bind(this)),this.appended_onerror="window.sst_WebTorrentReceiver_blobsRefresh",window.sst_WebTorrentReceiver_blobsRefresh=this.blobsRefresh.bind(this),this.api=_Object$assign(this.api,{addByText:this.addByText.bind(this)})}return _inherits(WebTorrentReceiver,_MasterWebTorrent),_createClass(WebTorrentReceiver,[{key:"appendTo",value:function(text,appendToOpts,appendToCallback,torrent){this.findAllNodes(torrent),_get(Object.getPrototypeOf(WebTorrentReceiver.prototype),"appendTo",this).call(this,text,appendToOpts,appendToCallback,torrent)}},{key:"appended",value:function(torrent,appendToCallback){this.findAllNodes(torrent),_get(Object.getPrototypeOf(WebTorrentReceiver.prototype),"appended",this).call(this,torrent,appendToCallback),this.areTorrentsLoading()||this.ProgressBar.end()}},{key:"add",value:function(magnetURL,id,node,addOpts,appendToOpts,addCallback,appendToCallback){var torrent=_get(Object.getPrototypeOf(WebTorrentReceiver.prototype),"add",this).call(this,magnetURL,id,node,addOpts,appendToOpts,addCallback,appendToCallback);return this.findAllNodes(torrent),this.ProgressBar.start(),torrent}}]),WebTorrentReceiver}(MasterWebTorrent),_export("WebTorrentReceiver",WebTorrentReceiver)}}}),$__System.registerDynamic("2f",["67"],!0,function($__require,exports,module){var global=this||self,defined=$__require("67");module.exports=function(it){return Object(defined(it))}}),$__System.registerDynamic("76",["2f","77"],!0,function($__require){var global=this||self,toObject=$__require("2f");$__require("77")("keys",function($keys){return function(it){return $keys(toObject(it))}})}),$__System.registerDynamic("78",["76","35"],!0,function($__require,exports,module){var global=this||self;$__require("76"),module.exports=$__require("35").Object.keys}),$__System.registerDynamic("79",["78"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("78"),__esModule:!0}}),$__System.register("7a",["7","79","a"],function(_export){var _classCallCheck,_Object$keys,_createClass,MasterEditor;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){_Object$keys=_2["default"]},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterEditor=function(){function MasterEditor(){_classCallCheck(this,MasterEditor)}return _createClass(MasterEditor,[{key:"addEmojis",value:function(){$.ajax({url:"https://api.github.com/emojis"}).then(function(data){window.emojis=_Object$keys(data),window.emojiUrls=data})}},{key:"loadFile",value:function(files,text){var _this=this,container=2>=arguments.length||void 0===arguments[2]?this.container:arguments[2];$.each(files,function(i,file){var name=file.name;text&&(name=1<files.length?text+"_"+i:text);var Reader=new FileReader;Reader.addEventListener("load",function(){var node=document.createElement("a");node.href=Reader.result,node.text=name,node.setAttribute("download",name),node.setAttribute("data-filename",name),0<i&&_this.setData(container,", "),_this.setData(container,node,"insertNode")},!1),Reader.readAsDataURL(file)})}}]),MasterEditor}(),_export("MasterEditor",MasterEditor)}}}),$__System.register("7b",["5","6","7","19"],function(_export){var _get,_inherits,_classCallCheck,MasterHelper,Helper;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterHelper=_4.MasterHelper}],execute:function(){"use strict";Helper=function(_MasterHelper){function Helper(){_classCallCheck(this,Helper),_get(Object.getPrototypeOf(Helper.prototype),"constructor",this).apply(this,arguments)}return _inherits(Helper,_MasterHelper),Helper}(MasterHelper),_export("Helper",Helper)}}}),$__System.registerDynamic("7c",["28"],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,"$",null);return function(){"format global";"deps jquery";"exports $";if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";var version=$.fn.jquery.split(" ")[0].split(".");if(2>version[0]&&9>version[1]||1==version[0]&&9==version[1]&&1>version[2]||3<version[0])throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){if($(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),+function($){"use strict";var dismiss="[data-dismiss=\"alert\"]",Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.VERSION="3.3.7",Alert.TRANSITION_DURATION=150,Alert.prototype.close=function(e){function removeElement(){$parent.detach().trigger("closed.bs.alert").remove()}var $this=$(this),selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=$("#"===selector?[]:selector);e&&e.preventDefault(),$parent.length||($parent=$this.closest(".alert")),$parent.trigger(e=$.Event("close.bs.alert")),e.isDefaultPrevented()||($parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.one("bsTransitionEnd",removeElement).emulateTransitionEnd(Alert.TRANSITION_DURATION):removeElement())};var old=$.fn.alert;$.fn.alert=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.alert");data||$this.data("bs.alert",data=new Alert(this)),"string"==typeof option&&data[option].call($this)})},$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.bs.alert.data-api",dismiss,Alert.prototype.close)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.button");data||$this.data("bs.button",data=new Button(this,"object"==typeof option&&option)),"toggle"==option?data.toggle():option&&data.setState(option)})}var Button=function(element,options){this.$element=$(element),this.options=$.extend({},Button.DEFAULTS,options),this.isLoading=!1};Button.VERSION="3.3.7",Button.DEFAULTS={loadingText:"loading..."},Button.prototype.setState=function(state){var d="disabled",$el=this.$element,val=$el.is("input")?"val":"html",data=$el.data();state+="Text",null==data.resetText&&$el.data("resetText",$el[val]()),setTimeout($.proxy(function(){$el[val](null==data[state]?this.options[state]:data[state]),"loadingText"==state?(this.isLoading=!0,$el.addClass(d).attr(d,d).prop(d,!0)):this.isLoading&&(this.isLoading=!1,$el.removeClass(d).removeAttr(d).prop(d,!1))},this),0)},Button.prototype.toggle=function(){var changed=!0,$parent=this.$element.closest("[data-toggle=\"buttons\"]");if($parent.length){var $input=this.$element.find("input");"radio"==$input.prop("type")?($input.prop("checked")&&(changed=!1),$parent.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==$input.prop("type")&&($input.prop("checked")!==this.$element.hasClass("active")&&(changed=!1),this.$element.toggleClass("active")),$input.prop("checked",this.$element.hasClass("active")),changed&&$input.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=Plugin,$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.bs.button.data-api","[data-toggle^=\"button\"]",function(e){var $btn=$(e.target).closest(".btn");Plugin.call($btn,"toggle"),$(e.target).is("input[type=\"radio\"], input[type=\"checkbox\"]")||(e.preventDefault(),$btn.is("input,button")?$btn.trigger("focus"):$btn.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api","[data-toggle^=\"button\"]",function(e){$(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.carousel"),options=$.extend({},Carousel.DEFAULTS,$this.data(),"object"==typeof option&&option),action="string"==typeof option?option:options.slide;data||$this.data("bs.carousel",data=new Carousel(this,options)),"number"==typeof option?data.to(option):action?data[action]():options.interval&&data.pause().cycle()})}var Carousel=function(element,options){this.$element=$(element),this.$indicators=this.$element.find(".carousel-indicators"),this.options=options,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",$.proxy(this.keydown,this)),"hover"!=this.options.pause||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};Carousel.VERSION="3.3.7",Carousel.TRANSITION_DURATION=600,Carousel.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},Carousel.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return;}e.preventDefault()}},Carousel.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},Carousel.prototype.getItemIndex=function(item){return this.$items=item.parent().children(".item"),this.$items.index(item||this.$active)},Carousel.prototype.getItemForDirection=function(direction,active){var activeIndex=this.getItemIndex(active),willWrap="prev"==direction&&0===activeIndex||"next"==direction&&activeIndex==this.$items.length-1;if(willWrap&&!this.options.wrap)return active;var delta="prev"==direction?-1:1,itemIndex=(activeIndex+delta)%this.$items.length;return this.$items.eq(itemIndex)},Carousel.prototype.to=function(pos){var that=this,activeIndex=this.getItemIndex(this.$active=this.$element.find(".item.active"));return pos>this.$items.length-1||0>pos?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){that.to(pos)}):activeIndex==pos?this.pause().cycle():this.slide(pos>activeIndex?"next":"prev",this.$items.eq(pos))},Carousel.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},Carousel.prototype.next=function(){return this.sliding?void 0:this.slide("next")},Carousel.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},Carousel.prototype.slide=function(type,next){var $active=this.$element.find(".item.active"),$next=next||this.getItemForDirection(type,$active),isCycling=this.interval,direction="next"==type?"left":"right",that=this;if($next.hasClass("active"))return this.sliding=!1;var relatedTarget=$next[0],slideEvent=$.Event("slide.bs.carousel",{relatedTarget:relatedTarget,direction:direction});if(this.$element.trigger(slideEvent),!slideEvent.isDefaultPrevented()){if(this.sliding=!0,isCycling&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var $nextIndicator=$(this.$indicators.children()[this.getItemIndex($next)]);$nextIndicator&&$nextIndicator.addClass("active")}var slidEvent=$.Event("slid.bs.carousel",{relatedTarget:relatedTarget,direction:direction});return $.support.transition&&this.$element.hasClass("slide")?($next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$active.one("bsTransitionEnd",function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" ")),that.sliding=!1,setTimeout(function(){that.$element.trigger(slidEvent)},0)}).emulateTransitionEnd(Carousel.TRANSITION_DURATION)):($active.removeClass("active"),$next.addClass("active"),this.sliding=!1,this.$element.trigger(slidEvent)),isCycling&&this.cycle(),this}};var old=$.fn.carousel;$.fn.carousel=Plugin,$.fn.carousel.Constructor=Carousel,$.fn.carousel.noConflict=function(){return $.fn.carousel=old,this};var clickHandler=function(e){var $this=$(this),$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,"")),href;if($target.hasClass("carousel")){var options=$.extend({},$target.data(),$this.data()),slideIndex=$this.attr("data-slide-to");slideIndex&&(options.interval=!1),Plugin.call($target,options),slideIndex&&$target.data("bs.carousel").to(slideIndex),e.preventDefault()}};$(document).on("click.bs.carousel.data-api","[data-slide]",clickHandler).on("click.bs.carousel.data-api","[data-slide-to]",clickHandler),$(window).on("load",function(){$("[data-ride=\"carousel\"]").each(function(){var $carousel=$(this);Plugin.call($carousel,$carousel.data())})})}(jQuery),+function($){"use strict";function getTargetFromTrigger($trigger){var target=$trigger.attr("data-target")||(href=$trigger.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""),href;return $(target)}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&/show|hide/.test(option)&&(options.toggle=!1),data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})}var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.$trigger=$("[data-toggle=\"collapse\"][href=\"#"+element.id+"\"],[data-toggle=\"collapse\"][data-target=\"#"+element.id+"\"]"),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};Collapse.VERSION="3.3.7",Collapse.TRANSITION_DURATION=350,Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},Collapse.prototype.show=function(){if(!(this.transitioning||this.$element.hasClass("in"))){var actives=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing"),activesData;if(!(actives&&actives.length&&(activesData=actives.data("bs.collapse"),activesData&&activesData.transitioning))){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){actives&&actives.length&&(Plugin.call(actives,"hide"),activesData||actives.data("bs.collapse",null));var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])}}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return $.support.transition?void this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION):complete.call(this)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},Collapse.prototype.getParent=function(){return $(this.options.parent).find("[data-toggle=\"collapse\"][data-parent=\""+this.options.parent+"\"]").each($.proxy(function(i,element){var $element=$(element);this.addAriaAndCollapsedClass(getTargetFromTrigger($element),$element)},this)).end()},Collapse.prototype.addAriaAndCollapsedClass=function($element,$trigger){var isOpen=$element.hasClass("in");$element.attr("aria-expanded",isOpen),$trigger.toggleClass("collapsed",!isOpen).attr("aria-expanded",isOpen)};var old=$.fn.collapse;$.fn.collapse=Plugin,$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api","[data-toggle=\"collapse\"]",function(e){var $this=$(this);$this.attr("data-target")||e.preventDefault();var $target=getTargetFromTrigger($this),data=$target.data("bs.collapse"),option=data?"toggle":$this.data();Plugin.call($target,option)})}(jQuery),+function($){"use strict";function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $this=$(this),$parent=getParent($this),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&$.contains($parent[0],e.target)||($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||($this.attr("aria-expanded","false"),$parent.removeClass("open").trigger($.Event("hidden.bs.dropdown",relatedTarget)))))}))}var backdrop=".dropdown-backdrop",toggle="[data-toggle=\"dropdown\"]",Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.3.7",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$(document.createElement("div")).addClass("dropdown-backdrop").insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus").attr("aria-expanded","true"),$parent.toggleClass("open").trigger($.Event("shown.bs.dropdown",relatedTarget))}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive&&27!=e.which||isActive&&27==e.which)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var $items=$parent.find(".dropdown-menu"+" li:not(.disabled):visible a");if($items.length){var index=$items.index(e.target);38==e.which&&0<index&&index--,40==e.which&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})},$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle,Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",Dropdown.prototype.keydown)}(jQuery),+function($){"use strict";function Plugin(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})}var Modal=function(element,options){this.options=options,this.$body=$(document.body),this.$element=$(element),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.VERSION="3.3.7",Modal.TRANSITION_DURATION=300,Modal.BACKDROP_TRANSITION_DURATION=150,Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal","[data-dismiss=\"modal\"]",$.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){that.$element.one("mouseup.dismiss.bs.modal",function(e){$(e.target).is(that.$element)&&(that.ignoreBackdropClick=!0)})}),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body),that.$element.show().scrollTop(0),that.adjustDialog(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in"),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$dialog.one("bsTransitionEnd",function(){that.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(Modal.TRANSITION_DURATION):that.$element.trigger("focus").trigger(e)}))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),!this.isShown||e.isDefaultPrevented()||(this.isShown=!1,this.escape(),this.resize(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(Modal.TRANSITION_DURATION):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){document===e.target||this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):!this.isShown&&this.$element.off("keydown.dismiss.bs.modal")},Modal.prototype.resize=function(){this.isShown?$(window).on("resize.bs.modal",$.proxy(this.handleUpdate,this)):$(window).off("resize.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.$body.removeClass("modal-open"),that.resetAdjustments(),that.resetScrollbar(),that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$(document.createElement("div")).addClass("modal-backdrop "+animate).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(e.target!==e.currentTarget||("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop(),callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callbackRemove()}else callback&&callback()},Modal.prototype.handleUpdate=function(){this.adjustDialog()},Modal.prototype.adjustDialog=function(){var modalIsOverflowing=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&modalIsOverflowing?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!modalIsOverflowing?this.scrollbarWidth:""})},Modal.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},Modal.prototype.checkScrollbar=function(){var fullWindowWidth=window.innerWidth;if(!fullWindowWidth){var documentElementRect=document.documentElement.getBoundingClientRect();fullWindowWidth=documentElementRect.right-_Mathabs(documentElementRect.left)}this.bodyIsOverflowing=document.body.clientWidth<fullWindowWidth,this.scrollbarWidth=this.measureScrollbar()},Modal.prototype.setScrollbar=function(){var bodyPad=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",bodyPad+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},Modal.prototype.measureScrollbar=function(){var scrollDiv=document.createElement("div");scrollDiv.className="modal-scrollbar-measure",this.$body.append(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;return this.$body[0].removeChild(scrollDiv),scrollbarWidth};var old=$.fn.modal;$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api","[data-toggle=\"modal\"]",function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.one("show.bs.modal",function(showEvent){showEvent.isDefaultPrevented()||$target.one("hidden.bs.modal",function(){$this.is(":visible")&&$this.trigger("focus")})}),Plugin.call($target,option,this)})}(jQuery),+function($){"use strict";var Tooltip=function(element,options){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.3.7",Tooltip.TRANSITION_DURATION=150,Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:"<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>",trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){if(this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$($.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var triggers=this.options.trigger.split(" "),i=triggers.length,trigger;i--;)if(trigger=triggers[i],"click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusin"==obj.type?"focus":"hover"]=!0),self.tip().hasClass("in")||"in"==self.hoverState)?void(self.hoverState="in"):(clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?void(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)):self.show())},Tooltip.prototype.isInStateTrue=function(){for(var key in this.inState)if(this.inState[key])return!0;return!1},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);if(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusout"==obj.type?"focus":"hover"]=!1),!self.isInStateTrue())return clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?void(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)):self.hide()},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,viewportDim=this.getPosition(this.$viewport);placement="bottom"==placement&&pos.bottom+actualHeight>viewportDim.bottom?"top":"top"==placement&&pos.top-actualHeight<viewportDim.top?"bottom":"right"==placement&&pos.right+actualWidth>viewportDim.width?"left":"left"==placement&&pos.left-actualWidth<viewportDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){var prevHoverState=that.hoverState;that.$element.trigger("shown.bs."+that.type),that.hoverState=null,"out"==prevHoverState&&that.leave(that)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top+=marginTop,offset.left+=marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:_Mathround(props.top),left:_Mathround(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var isVertical=/top|bottom/.test(placement),arrowDelta=isVertical?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowOffsetPosition=isVertical?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],isVertical)},Tooltip.prototype.replaceArrow=function(delta,dimension,isVertical){this.arrow().css(isVertical?"left":"top",50*(1-delta/dimension)+"%").css(isVertical?"top":"left","")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(callback){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element&&that.$element.removeAttr("aria-describedby").trigger("hidden.bs."+that.type),callback&&callback()}var that=this,$tip=$(this.$tip),e=$.Event("hide.bs."+this.type);if(this.$element.trigger(e),!e.isDefaultPrevented())return $tip.removeClass("in"),$.support.transition&&$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete(),this.hoverState=null,this},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody="BODY"==el.tagName,elRect=el.getBoundingClientRect();null==elRect.width&&(elRect=$.extend({},elRect,{width:elRect.right-elRect.left,height:elRect.bottom-elRect.top}));var isSvg=window.SVGElement&&el instanceof window.SVGElement,elOffset=isBody?{top:0,left:0}:isSvg?null:$element.offset(),scroll={scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop()},outerDims=isBody?{width:$(window).width(),height:$(window).height()}:null;return $.extend({},elRect,scroll,outerDims,elOffset)},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.right&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var $e=this.$element,o=this.options,title;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title),title},Tooltip.prototype.getUID=function(prefix){do prefix+=~~(1e6*Math.random());while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){if(!this.$tip&&(this.$tip=$(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&(self=$(e.currentTarget).data("bs."+this.type),!self&&(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),e?(self.inState.click=!self.inState.click,self.isInStateTrue()?self.enter(self):self.leave(self)):self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){var that=this;clearTimeout(this.timeout),this.hide(function(){that.$element.off("."+that.type).removeData("bs."+that.type),that.$tip&&that.$tip.detach(),that.$tip=null,that.$arrow=null,that.$viewport=null,that.$element=null})};var old=$.fn.tooltip;$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip");!data&&/destroy|hide/.test(option)||(!data&&$this.data("bs.tooltip",data=new Tooltip(this,"object"==typeof option&&option)),"string"==typeof option&&data[option]())})},$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),+function($){"use strict";var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.VERSION="3.3.7",Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:"<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>"}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var old=$.fn.popover;$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover");!data&&/destroy|hide/.test(option)||(!data&&$this.data("bs.popover",data=new Popover(this,"object"==typeof option&&option)),"string"==typeof option&&data[option]())})},$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),+function($){"use strict";function ScrollSpy(element,options){this.$body=$(document.body),this.$scrollElement=$(element).is(document.body)?$(window):$(element),this.options=$.extend({},ScrollSpy.DEFAULTS,options),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",$.proxy(this.process,this)),this.refresh(),this.process()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.scrollspy");data||$this.data("bs.scrollspy",data=new ScrollSpy(this,"object"==typeof option&&option)),"string"==typeof option&&data[option]()})}ScrollSpy.VERSION="3.3.7",ScrollSpy.DEFAULTS={offset:10},ScrollSpy.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||_Mathmax(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},ScrollSpy.prototype.refresh=function(){var that=this,offsetMethod="offset",offsetBase=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),$.isWindow(this.$scrollElement[0])||(offsetMethod="position",offsetBase=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var $el=$(this),href=$el.data("target")||$el.attr("href"),$href=/^#./.test(href)&&$(href);return $href&&$href.length&&$href.is(":visible")&&[[$href[offsetMethod]().top+offsetBase,href]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){that.offsets.push(this[0]),that.targets.push(this[1])})},ScrollSpy.prototype.process=function(){var scrollTop=this.$scrollElement.scrollTop()+this.options.offset,scrollHeight=this.getScrollHeight(),maxScroll=this.options.offset+scrollHeight-this.$scrollElement.height(),offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget,i;if(this.scrollHeight!=scrollHeight&&this.refresh(),scrollTop>=maxScroll)return activeTarget!=(i=targets[targets.length-1])&&this.activate(i);if(activeTarget&&scrollTop<offsets[0])return this.activeTarget=null,this.clear();for(i=offsets.length;i--;)activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(void 0===offsets[i+1]||scrollTop<offsets[i+1])&&this.activate(targets[i])},ScrollSpy.prototype.activate=function(target){this.activeTarget=target,this.clear();var selector=this.selector+"[data-target=\""+target+"\"],"+this.selector+"[href=\""+target+"\"]",active=$(selector).parents("li").addClass("active");active.parent(".dropdown-menu").length&&(active=active.closest("li.dropdown").addClass("active")),active.trigger("activate.bs.scrollspy")},ScrollSpy.prototype.clear=function(){$(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var old=$.fn.scrollspy;$.fn.scrollspy=Plugin,$.fn.scrollspy.Constructor=ScrollSpy,$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=old,this},$(window).on("load.bs.scrollspy.data-api",function(){$("[data-spy=\"scroll\"]").each(function(){var $spy=$(this);Plugin.call($spy,$spy.data())})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tab");data||$this.data("bs.tab",data=new Tab(this)),"string"==typeof option&&data[option]()})}var Tab=function(element){this.element=$(element)};Tab.VERSION="3.3.7",Tab.TRANSITION_DURATION=150,Tab.prototype.show=function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),selector=$this.data("target");if(selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,"")),!$this.parent("li").hasClass("active")){var $previous=$ul.find(".active:last a"),hideEvent=$.Event("hide.bs.tab",{relatedTarget:$this[0]}),showEvent=$.Event("show.bs.tab",{relatedTarget:$previous[0]});if($previous.trigger(hideEvent),$this.trigger(showEvent),!(showEvent.isDefaultPrevented()||hideEvent.isDefaultPrevented())){var $target=$(selector);this.activate($this.closest("li"),$ul),this.activate($target,$target.parent(),function(){$previous.trigger({type:"hidden.bs.tab",relatedTarget:$this[0]}),$this.trigger({type:"shown.bs.tab",relatedTarget:$previous[0]})})}}},Tab.prototype.activate=function(element,container,callback){function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find("[data-toggle=\"tab\"]").attr("aria-expanded",!1),element.addClass("active").find("[data-toggle=\"tab\"]").attr("aria-expanded",!0),transition?(element[0].offsetWidth,element.addClass("in")):element.removeClass("fade"),element.parent(".dropdown-menu").length&&element.closest("li.dropdown").addClass("active").end().find("[data-toggle=\"tab\"]").attr("aria-expanded",!0),callback&&callback()}var $active=container.find("> .active"),transition=callback&&$.support.transition&&($active.length&&$active.hasClass("fade")||!!container.find("> .fade").length);$active.length&&transition?$active.one("bsTransitionEnd",next).emulateTransitionEnd(Tab.TRANSITION_DURATION):next(),$active.removeClass("in")};var old=$.fn.tab;$.fn.tab=Plugin,$.fn.tab.Constructor=Tab,$.fn.tab.noConflict=function(){return $.fn.tab=old,this};var clickHandler=function(e){e.preventDefault(),Plugin.call($(this),"show")};$(document).on("click.bs.tab.data-api","[data-toggle=\"tab\"]",clickHandler).on("click.bs.tab.data-api","[data-toggle=\"pill\"]",clickHandler)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.affix");data||$this.data("bs.affix",data=new Affix(this,"object"==typeof option&&option)),"string"==typeof option&&data[option]()})}var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(element),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};Affix.VERSION="3.3.7",Affix.RESET="affix affix-top affix-bottom",Affix.DEFAULTS={offset:0,target:window},Affix.prototype.getState=function(scrollHeight,height,offsetTop,offsetBottom){var scrollTop=this.$target.scrollTop(),position=this.$element.offset(),targetHeight=this.$target.height();if(null!=offsetTop&&"top"==this.affixed)return!!(scrollTop<offsetTop)&&"top";if("bottom"==this.affixed)return null==offsetTop?!(scrollTop+targetHeight<=scrollHeight-offsetBottom)&&"bottom":!(scrollTop+this.unpin<=position.top)&&"bottom";var initializing=null==this.affixed,colliderTop=initializing?scrollTop:position.top,colliderHeight=initializing?targetHeight:height;return null!=offsetTop&&scrollTop<=offsetTop?"top":!!(null!=offsetBottom&&colliderTop+colliderHeight>=scrollHeight-offsetBottom)&&"bottom"},Affix.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(Affix.RESET).addClass("affix");var scrollTop=this.$target.scrollTop(),position=this.$element.offset();return this.pinnedOffset=position.top-scrollTop},Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},Affix.prototype.checkPosition=function(){if(this.$element.is(":visible")){var height=this.$element.height(),offset=this.options.offset,offsetTop=offset.top,offsetBottom=offset.bottom,scrollHeight=_Mathmax($(document).height(),$(document.body).height());"object"!=typeof offset&&(offsetBottom=offsetTop=offset),"function"==typeof offsetTop&&(offsetTop=offset.top(this.$element)),"function"==typeof offsetBottom&&(offsetBottom=offset.bottom(this.$element));var affix=this.getState(scrollHeight,height,offsetTop,offsetBottom);if(this.affixed!=affix){null!=this.unpin&&this.$element.css("top","");var affixType="affix"+(affix?"-"+affix:""),e=$.Event(affixType+".bs.affix");if(this.$element.trigger(e),e.isDefaultPrevented())return;this.affixed=affix,this.unpin="bottom"==affix?this.getPinnedOffset():null,this.$element.removeClass(Affix.RESET).addClass(affixType).trigger(affixType.replace("affix","affixed")+".bs.affix")}"bottom"==affix&&this.$element.offset({top:scrollHeight-height-offsetBottom})}};var old=$.fn.affix;$.fn.affix=Plugin,$.fn.affix.Constructor=Affix,$.fn.affix.noConflict=function(){return $.fn.affix=old,this},$(window).on("load",function(){$("[data-spy=\"affix\"]").each(function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{},null!=data.offsetBottom&&(data.offset.bottom=data.offsetBottom),null!=data.offsetTop&&(data.offset.top=data.offsetTop),Plugin.call($spy,data)})})}(jQuery)}(this),_retrieveGlobal()}),$__System.registerDynamic("7d",["7c"],!0,function($__require,exports,module){var global=this||self;module.exports=$__require("7c")}),$__System.registerDynamic("7e",[],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function(){CodeMirror.defineMode("xml",function(config,parserConfig){function inText(stream,state){function chain(parser){return state.tokenize=parser,parser(stream,state)}var ch=stream.next();if("<"==ch){if(stream.eat("!"))return stream.eat("[")?stream.match("CDATA[")?chain(inBlock("atom","]]>")):null:stream.match("--")?chain(inBlock("comment","-->")):stream.match("DOCTYPE",!0,!0)?(stream.eatWhile(/[\w\._\-]/),chain(doctype(1))):null;if(stream.eat("?"))return stream.eatWhile(/[\w\._\-]/),state.tokenize=inBlock("meta","?>"),"meta";var isClose=stream.eat("/");tagName="";for(var c;c=stream.eat(/[^\s\u00a0=<>\"\'\/?]/);)tagName+=c;return tagName?(type=isClose?"closeTag":"openTag",state.tokenize=inTag,"tag"):"tag error"}if("&"==ch){var ok;return ok=stream.eat("#")?stream.eat("x")?stream.eatWhile(/[a-fA-F\d]/)&&stream.eat(";"):stream.eatWhile(/[\d]/)&&stream.eat(";"):stream.eatWhile(/[\w\.\-:]/)&&stream.eat(";"),ok?"atom":"error"}return stream.eatWhile(/[^&<]/),null}function inTag(stream,state){var ch=stream.next();if(">"==ch||"/"==ch&&stream.eat(">"))return state.tokenize=inText,type=">"==ch?"endTag":"selfcloseTag","tag";if("="==ch)return type="equals",null;if("<"==ch){state.tokenize=inText;var next=state.tokenize(stream,state);return next?next+" error":"error"}return /[\'\"]/.test(ch)?(state.tokenize=inAttribute(ch),state.stringStartCol=stream.column(),state.tokenize(stream,state)):(stream.eatWhile(/[^\s\u00a0=<>\"\']/),"word")}function inAttribute(quote){var closure=function(stream,state){for(;!stream.eol();)if(stream.next()==quote){state.tokenize=inTag;break}return"string"};return closure.isInAttribute=!0,closure}function inBlock(style,terminator){return function(stream,state){for(;!stream.eol();){if(stream.match(terminator)){state.tokenize=inText;break}stream.next()}return style}}function doctype(depth){return function(stream,state){for(var ch;null!=(ch=stream.next());){if("<"==ch)return state.tokenize=doctype(depth+1),state.tokenize(stream,state);if(">"==ch)if(1==depth){state.tokenize=inText;break}else return state.tokenize=doctype(depth-1),state.tokenize(stream,state)}return"meta"}}function pass(){for(var i=arguments.length-1;0<=i;i--)curState.cc.push(arguments[i])}function cont(){return pass.apply(null,arguments),!0}function pushContext(tagName,startOfLine){var noIndent=Kludges.doNotIndent.hasOwnProperty(tagName)||curState.context&&curState.context.noIndent;curState.context={prev:curState.context,tagName:tagName,indent:curState.indented,startOfLine:startOfLine,noIndent:noIndent}}function popContext(){curState.context&&(curState.context=curState.context.prev)}function element(type){if("openTag"==type)return curState.tagName=tagName,curState.tagStart=curStream.column(),cont(attributes,endtag(curState.startOfLine));if("closeTag"==type){var err=!1;return curState.context?curState.context.tagName!=tagName&&(Kludges.implicitlyClosed.hasOwnProperty(curState.context.tagName.toLowerCase())&&popContext(),err=!curState.context||curState.context.tagName!=tagName):err=!0,err&&(setStyle="error"),cont(endclosetag(err))}return cont()}function endtag(startOfLine){return function(type){var tagName=curState.tagName;return curState.tagName=curState.tagStart=null,"selfcloseTag"==type||"endTag"==type&&Kludges.autoSelfClosers.hasOwnProperty(tagName.toLowerCase())?(maybePopContext(tagName.toLowerCase()),cont()):"endTag"==type?(maybePopContext(tagName.toLowerCase()),pushContext(tagName,startOfLine),cont()):cont()}}function endclosetag(err){return function(type){return(err&&(setStyle="error"),"endTag"==type)?(popContext(),cont()):(setStyle="error",cont(arguments.callee))}}function maybePopContext(nextTagName){for(var parentTagName;;){if(!curState.context)return;if(parentTagName=curState.context.tagName.toLowerCase(),!Kludges.contextGrabbers.hasOwnProperty(parentTagName)||!Kludges.contextGrabbers[parentTagName].hasOwnProperty(nextTagName))return;popContext()}}function attributes(type){return"word"==type?(setStyle="attribute",cont(attribute,attributes)):"endTag"==type||"selfcloseTag"==type?pass():(setStyle="error",cont(attributes))}function attribute(type){if("equals"==type)return cont(attvalue,attributes);if(!Kludges.allowMissing)setStyle="error";else if("word"==type)return setStyle="attribute",cont(attribute,attributes);return"endTag"==type||"selfcloseTag"==type?pass():cont()}function attvalue(type){return"string"==type?cont(attvaluemaybe):"word"==type&&Kludges.allowUnquoted?(setStyle="string",cont()):(setStyle="error","endTag"==type||"selfCloseTag"==type?pass():cont())}function attvaluemaybe(type){return"string"==type?cont(attvaluemaybe):pass()}var indentUnit=config.indentUnit,multilineTagIndentFactor=parserConfig.multilineTagIndentFactor||1,multilineTagIndentPastTag=parserConfig.multilineTagIndentPastTag||!0,Kludges=parserConfig.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1},alignCDATA=parserConfig.alignCDATA,tagName,type,curState,curStream,setStyle;return{startState:function(){return{tokenize:inText,cc:[],indented:0,startOfLine:!0,tagName:null,tagStart:null,context:null}},token:function(stream,state){if(!state.tagName&&stream.sol()&&(state.startOfLine=!0,state.indented=stream.indentation()),stream.eatSpace())return null;setStyle=type=tagName=null;var style=state.tokenize(stream,state);if(state.type=type,(style||type)&&"comment"!=style)for(curState=state,curStream=stream;;){var comb=state.cc.pop()||element;if(comb(type||style))break}return state.startOfLine=!1,setStyle&&(style="error"==setStyle?style+" error":setStyle),style},indent:function(state,textAfter,fullLine){var context=state.context;if(state.tokenize.isInAttribute)return state.stringStartCol+1;if(state.tokenize!=inTag&&state.tokenize!=inText||context&&context.noIndent)return fullLine?fullLine.match(/^(\s*)/)[0].length:0;if(state.tagName)return multilineTagIndentPastTag?state.tagStart+state.tagName.length+2:state.tagStart+indentUnit*multilineTagIndentFactor;if(alignCDATA&&/<!\[CDATA\[/.test(textAfter))return 0;for(context&&/^<\//.test(textAfter)&&(context=context.prev);context&&!context.startOfLine;)context=context.prev;return context?context.indent+indentUnit:0},electricChars:"/",blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:parserConfig.htmlMode?"html":"xml",helperType:parserConfig.htmlMode?"html":"xml"}}),CodeMirror.defineMIME("text/xml","xml"),CodeMirror.defineMIME("application/xml","xml"),CodeMirror.mimeModes.hasOwnProperty("text/html")||CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:!0})}(this),_retrieveGlobal()}),$__System.registerDynamic("7f",["80"],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function(){CodeMirror.defineMode("javascript",function(config,parserConfig){function nextUntilUnescaped(stream,end){for(var escaped=!1,next;null!=(next=stream.next());){if(next==end&&!escaped)return!1;escaped=!escaped&&"\\"==next}return escaped}function ret(tp,style,cont){return type=tp,content=cont,style}function tokenBase(stream,state){var ch=stream.next();if("\""==ch||"'"==ch)return state.tokenize=tokenString(ch),state.tokenize(stream,state);if("."==ch&&stream.match(/^\d+(?:[eE][+\-]?\d+)?/))return ret("number","number");if("."==ch&&stream.match(".."))return ret("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(ch))return ret(ch);if("="==ch&&stream.eat(">"))return ret("=>");if("0"==ch&&stream.eat(/x/i))return stream.eatWhile(/[\da-f]/i),ret("number","number");if(/\d/.test(ch))return stream.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),ret("number","number");if("/"==ch)return stream.eat("*")?(state.tokenize=tokenComment,tokenComment(stream,state)):stream.eat("/")?(stream.skipToEnd(),ret("comment","comment")):"operator"==state.lastType||"keyword c"==state.lastType||"sof"==state.lastType||/^[\[{}\(,;:]$/.test(state.lastType)?(nextUntilUnescaped(stream,"/"),stream.eatWhile(/[gimy]/),ret("regexp","string-2")):(stream.eatWhile(isOperatorChar),ret("operator",null,stream.current()));if("`"==ch)return state.tokenize=tokenQuasi,tokenQuasi(stream,state);if("#"==ch)return stream.skipToEnd(),ret("error","error");if(isOperatorChar.test(ch))return stream.eatWhile(isOperatorChar),ret("operator",null,stream.current());stream.eatWhile(/[\w\$_]/);var word=stream.current(),known=keywords.propertyIsEnumerable(word)&&keywords[word];return known&&"."!=state.lastType?ret(known.type,known.style,word):ret("variable","variable",word)}function tokenString(quote){return function(stream,state){return nextUntilUnescaped(stream,quote)||(state.tokenize=tokenBase),ret("string","string")}}function tokenComment(stream,state){for(var maybeEnd=!1,ch;ch=stream.next();){if("/"==ch&&maybeEnd){state.tokenize=tokenBase;break}maybeEnd="*"==ch}return ret("comment","comment")}function tokenQuasi(stream,state){for(var escaped=!1,next;null!=(next=stream.next());){if(!escaped&&("`"==next||"$"==next&&stream.eat("{"))){state.tokenize=tokenBase;break}escaped=!escaped&&"\\"==next}return ret("quasi","string-2",stream.current())}function findFatArrow(stream,state){state.fatArrowAt&&(state.fatArrowAt=null);var arrow=stream.string.indexOf("=>",stream.start);if(!(0>arrow)){for(var depth=0,sawSomething=!1,pos=arrow-1;0<=pos;--pos){var ch=stream.string.charAt(pos),bracket=brackets.indexOf(ch);if(0<=bracket&&3>bracket){if(!depth){++pos;break}if(0==--depth)break}else if(3<=bracket&&6>bracket)++depth;else if(/[$\w]/.test(ch))sawSomething=!0;else if(sawSomething&&!depth){++pos;break}}sawSomething&&!depth&&(state.fatArrowAt=pos)}}function JSLexical(indented,column,type,align,prev,info){this.indented=indented,this.column=column,this.type=type,this.prev=prev,this.info=info,null!=align&&(this.align=align)}function inScope(state,varname){for(var v=state.localVars;v;v=v.next)if(v.name==varname)return!0;for(var cx=state.context;cx;cx=cx.prev)for(var v=cx.vars;v;v=v.next)if(v.name==varname)return!0}function parseJS(state,style,type,content,stream){var cc=state.cc;for(cx.state=state,cx.stream=stream,cx.marked=null,cx.cc=cc,state.lexical.hasOwnProperty("align")||(state.lexical.align=!0);;){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){for(;cc.length&&cc[cc.length-1].lex;)cc.pop()();return cx.marked?cx.marked:"variable"==type&&inScope(state,content)?"variable-2":style}}}function pass(){for(var i=arguments.length-1;0<=i;i--)cx.cc.push(arguments[i])}function cont(){return pass.apply(null,arguments),!0}function register(varname){function inList(list){for(var v=list;v;v=v.next)if(v.name==varname)return!0;return!1}var state=cx.state;if(state.context){if(cx.marked="def",inList(state.localVars))return;state.localVars={name:varname,next:state.localVars}}else{if(inList(state.globalVars))return;parserConfig.globalVars&&(state.globalVars={name:varname,next:state.globalVars})}}function pushcontext(){cx.state.context={prev:cx.state.context,vars:cx.state.localVars},cx.state.localVars=defaultVars}function popcontext(){cx.state.localVars=cx.state.context.vars,cx.state.context=cx.state.context.prev}function pushlex(type,info){var result=function(){var state=cx.state,indent=state.indented;"stat"==state.lexical.type&&(indent=state.lexical.indented),state.lexical=new JSLexical(indent,cx.stream.column(),type,null,state.lexical,info)};return result.lex=!0,result}function poplex(){var state=cx.state;state.lexical.prev&&(")"==state.lexical.type&&(state.indented=state.lexical.indented),state.lexical=state.lexical.prev)}function expect(wanted){return function(type){return type==wanted?cont():";"==wanted?pass():cont(arguments.callee)}}function statement(type,value){return"var"==type?cont(pushlex("vardef",value.length),vardef,expect(";"),poplex):"keyword a"==type?cont(pushlex("form"),expression,statement,poplex):"keyword b"==type?cont(pushlex("form"),statement,poplex):"{"==type?cont(pushlex("}"),block,poplex):";"==type?cont():"if"==type?cont(pushlex("form"),expression,statement,poplex,maybeelse):"function"==type?cont(functiondef):"for"==type?cont(pushlex("form"),forspec,poplex,statement,poplex):"variable"==type?cont(pushlex("stat"),maybelabel):"switch"==type?cont(pushlex("form"),expression,pushlex("}","switch"),expect("{"),block,poplex,poplex):"case"==type?cont(expression,expect(":")):"default"==type?cont(expect(":")):"catch"==type?cont(pushlex("form"),pushcontext,expect("("),funarg,expect(")"),statement,poplex,popcontext):"module"==type?cont(pushlex("form"),pushcontext,afterModule,popcontext,poplex):"class"==type?cont(pushlex("form"),className,objlit,poplex):"export"==type?cont(pushlex("form"),afterExport,poplex):"import"==type?cont(pushlex("form"),afterImport,poplex):pass(pushlex("stat"),expression,expect(";"),poplex)}function expression(type){return expressionInner(type,!1)}function expressionNoComma(type){return expressionInner(type,!0)}function expressionInner(type,noComma){if(cx.state.fatArrowAt==cx.stream.start){var body=noComma?arrowBodyNoComma:arrowBody;if("("==type)return cont(pushcontext,commasep(pattern,")"),expect("=>"),body,popcontext);if("variable"==type)return pass(pushcontext,pattern,expect("=>"),body,popcontext)}var maybeop=noComma?maybeoperatorNoComma:maybeoperatorComma;return atomicTypes.hasOwnProperty(type)?cont(maybeop):"function"==type?cont(functiondef):"keyword c"==type?cont(noComma?maybeexpressionNoComma:maybeexpression):"("==type?cont(pushlex(")"),maybeexpression,comprehension,expect(")"),poplex,maybeop):"operator"==type||"spread"==type?cont(noComma?expressionNoComma:expression):"["==type?cont(pushlex("]"),expressionNoComma,maybeArrayComprehension,poplex,maybeop):"{"==type?cont(commasep(objprop,"}"),maybeop):cont()}function maybeexpression(type){return type.match(/[;\}\)\],]/)?pass():pass(expression)}function maybeexpressionNoComma(type){return type.match(/[;\}\)\],]/)?pass():pass(expressionNoComma)}function maybeoperatorComma(type,value){return","==type?cont(expression):maybeoperatorNoComma(type,value,!1)}function maybeoperatorNoComma(type,value,noComma){var me=!1==noComma?maybeoperatorComma:maybeoperatorNoComma,expr=!1==noComma?expression:expressionNoComma;return"=>"==value?cont(pushcontext,noComma?arrowBodyNoComma:arrowBody,popcontext):"operator"==type?/\+\+|--/.test(value)?cont(me):"?"==value?cont(expression,expect(":"),expr):cont(expr):"quasi"==type?(cx.cc.push(me),quasi(value)):";"==type?void 0:"("==type?cont(commasep(expressionNoComma,")","call"),me):"."==type?cont(property,me):"["==type?cont(pushlex("]"),maybeexpression,expect("]"),poplex,me):void 0}function quasi(value){if(!value)debugger;return"${"==value.slice(value.length-2)?cont(expression,continueQuasi):cont()}function continueQuasi(type){if("}"==type)return cx.marked="string-2",cx.state.tokenize=tokenQuasi,cont()}function arrowBody(type){return findFatArrow(cx.stream,cx.state),"{"==type?pass(statement):pass(expression)}function arrowBodyNoComma(type){return findFatArrow(cx.stream,cx.state),"{"==type?pass(statement):pass(expressionNoComma)}function maybelabel(type){return":"==type?cont(poplex,statement):pass(maybeoperatorComma,expect(";"),poplex)}function property(type){if("variable"==type)return cx.marked="property",cont()}function objprop(type,value){if("variable"==type){if(cx.marked="property","get"==value||"set"==value)return cont(getterSetter);}else if("number"==type||"string"==type)cx.marked=type+" property";else if("["==type)return cont(expression,expect("]"),afterprop);return atomicTypes.hasOwnProperty(type)?cont(afterprop):void 0}function getterSetter(type){return"variable"==type?(cx.marked="property",cont(functiondef)):pass(afterprop)}function afterprop(type){return":"==type?cont(expressionNoComma):"("==type?pass(functiondef):void 0}function commasep(what,end,info){function proceed(type){if(","==type){var lex=cx.state.lexical;return"call"==lex.info&&(lex.pos=(lex.pos||0)+1),cont(what,proceed)}return type==end?cont():cont(expect(end))}return function(type){return type==end?cont():!1===info?pass(what,proceed):pass(pushlex(end,info),what,proceed,poplex)}}function block(type){return"}"==type?cont():pass(statement,block)}function maybetype(type){if(isTS&&":"==type)return cont(typedef)}function typedef(type){if("variable"==type)return cx.marked="variable-3",cont()}function vardef(){return pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(type,value){return"variable"==type?(register(value),cont()):"["==type?cont(commasep(pattern,"]")):"{"==type?cont(commasep(proppattern,"}")):void 0}function proppattern(type,value){return"variable"!=type||cx.stream.match(/^\s*:/,!1)?("variable"==type&&(cx.marked="property"),cont(expect(":"),pattern,maybeAssign)):(register(value),cont(maybeAssign))}function maybeAssign(_type,value){if("="==value)return cont(expressionNoComma)}function vardefCont(type){if(","==type)return cont(vardef)}function maybeelse(type,value){if("keyword b"==type&&"else"==value)return cont(pushlex("form"),statement,poplex)}function forspec(type){if("("==type)return cont(pushlex(")"),forspec1,expect(")"))}function forspec1(type){return"var"==type?cont(vardef,expect(";"),forspec2):";"==type?cont(forspec2):"variable"==type?cont(formaybeinof):pass(expression,expect(";"),forspec2)}function formaybeinof(_type,value){return"in"==value||"of"==value?(cx.marked="keyword",cont(expression)):cont(maybeoperatorComma,forspec2)}function forspec2(type,value){return";"==type?cont(forspec3):"in"==value||"of"==value?(cx.marked="keyword",cont(expression)):pass(expression,expect(";"),forspec3)}function forspec3(type){")"!=type&&cont(expression)}function functiondef(type,value){return"*"==value?(cx.marked="keyword",cont(functiondef)):"variable"==type?(register(value),cont(functiondef)):"("==type?cont(pushcontext,commasep(funarg,")"),statement,popcontext):void 0}function funarg(type){return"spread"==type?cont(funarg):pass(pattern,maybetype)}function className(type,value){if("variable"==type)return register(value),cont(classNameAfter)}function classNameAfter(_type,value){if("extends"==value)return cont(expression)}function objlit(type){if("{"==type)return cont(commasep(objprop,"}"))}function afterModule(type,value){return"string"==type?cont(statement):"variable"==type?(register(value),cont(maybeFrom)):void 0}function afterExport(_type,value){return"*"==value?(cx.marked="keyword",cont(maybeFrom,expect(";"))):"default"==value?(cx.marked="keyword",cont(expression,expect(";"))):pass(statement)}function afterImport(type){return"string"==type?cont():pass(importSpec,maybeFrom)}function importSpec(type,value){return"{"==type?cont(commasep(importSpec,"}")):("variable"==type&&register(value),cont())}function maybeFrom(_type,value){if("from"==value)return cx.marked="keyword",cont(expression)}function maybeArrayComprehension(type){return"for"==type?pass(comprehension):","==type?cont(commasep(expressionNoComma,"]",!1)):pass(commasep(expressionNoComma,"]",!1))}function comprehension(type){return"for"==type?cont(forspec,comprehension):"if"==type?cont(expression,comprehension):void 0}var indentUnit=config.indentUnit,statementIndent=parserConfig.statementIndent,jsonMode=parserConfig.json,isTS=parserConfig.typescript,keywords=function(){function kw(type){return{type:type,style:"keyword"}}var A=kw("keyword a"),B=kw("keyword b"),C=kw("keyword c"),operator=kw("operator"),atom={type:"atom",style:"atom"},jsKeywords={if:kw("if"),while:A,with:A,else:B,do:B,try:B,finally:B,return:C,break:C,continue:C,new:C,delete:C,throw:C,var:kw("var"),const:kw("var"),let:kw("var"),function:kw("function"),catch:kw("catch"),for:kw("for"),switch:kw("switch"),case:kw("case"),default:kw("default"),in:operator,typeof:operator,instanceof:operator,true:atom,false:atom,null:atom,undefined:atom,NaN:atom,Infinity:atom,this:kw("this"),module:kw("module"),class:kw("class"),super:kw("atom"),yield:C,export:kw("export"),import:kw("import"),extends:C};if(isTS){var type={type:"variable",style:"variable-3"},tsKeywords={interface:kw("interface"),extends:kw("extends"),constructor:kw("constructor"),public:kw("public"),private:kw("private"),protected:kw("protected"),static:kw("static"),string:type,number:type,bool:type,any:type};for(var attr in tsKeywords)jsKeywords[attr]=tsKeywords[attr]}return jsKeywords}(),isOperatorChar=/[+\-*&%=<>!?|~^]/,brackets="([{}])",atomicTypes={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0},cx={state:null,column:null,marked:null,cc:null},defaultVars={name:"this",next:{name:"arguments"}},type,content;return poplex.lex=!0,{startState:function(basecolumn){var state={tokenize:tokenBase,lastType:"sof",cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,"block",!1),localVars:parserConfig.localVars,context:parserConfig.localVars&&{vars:parserConfig.localVars},indented:0};return parserConfig.globalVars&&(state.globalVars=parserConfig.globalVars),state},token:function(stream,state){if(stream.sol()&&(!state.lexical.hasOwnProperty("align")&&(state.lexical.align=!1),state.indented=stream.indentation(),findFatArrow(stream,state)),state.tokenize!=tokenComment&&stream.eatSpace())return null;var style=state.tokenize(stream,state);return"comment"==type?style:(state.lastType="operator"==type&&("++"==content||"--"==content)?"incdec":type,parseJS(state,style,type,content,stream))},indent:function(state,textAfter){if(state.tokenize==tokenComment)return CodeMirror.Pass;if(state.tokenize!=tokenBase)return 0;for(var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical,i=state.cc.length-1,c;0<=i;--i)if(c=state.cc[i],c==poplex)lexical=lexical.prev;else if(c!=maybeelse)break;"stat"==lexical.type&&"}"==firstChar&&(lexical=lexical.prev),statementIndent&&")"==lexical.type&&"stat"==lexical.prev.type&&(lexical=lexical.prev);var type=lexical.type,closing=firstChar==type;return"vardef"==type?lexical.indented+("operator"==state.lastType||","==state.lastType?lexical.info+1:0):"form"==type&&"{"==firstChar?lexical.indented:"form"==type?lexical.indented+indentUnit:"stat"==type?lexical.indented+("operator"==state.lastType||","==state.lastType?statementIndent||indentUnit:0):"switch"!=lexical.info||closing||!1==parserConfig.doubleIndentSwitch?lexical.align?lexical.column+(closing?0:1):lexical.indented+(closing?0:indentUnit):lexical.indented+(/^(?:case|default)\b/.test(textAfter)?indentUnit:2*indentUnit)},electricChars:":{}",blockCommentStart:jsonMode?null:"/*",blockCommentEnd:jsonMode?null:"*/",lineComment:jsonMode?null:"//",fold:"brace",helperType:jsonMode?"json":"javascript",jsonMode:jsonMode}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("text/ecmascript","javascript"),CodeMirror.defineMIME("application/javascript","javascript"),CodeMirror.defineMIME("application/ecmascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("application/x-json",{name:"javascript",json:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0})}(this),_retrieveGlobal()}),$__System.registerDynamic("81",["80"],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function(){CodeMirror.defineMode("css",function(config,parserConfig){"use strict";function ret(style,tp){return type=tp,style}function tokenBase(stream,state){var ch=stream.next();if(hooks[ch]){var result=hooks[ch](stream,state);if(!1!==result)return result}if("@"==ch)return stream.eatWhile(/[\w\\\-]/),ret("def",stream.current());if("="==ch)ret(null,"compare");else{if(("~"==ch||"|"==ch)&&stream.eat("="))return ret(null,"compare");if("\""==ch||"'"==ch)return state.tokenize=tokenString(ch),state.tokenize(stream,state);if("#"==ch)return stream.eatWhile(/[\w\\\-]/),ret("atom","hash");if("!"==ch)return stream.match(/^\s*\w*/),ret("keyword","important");if(/\d/.test(ch)||"."==ch&&stream.eat(/\d/))return stream.eatWhile(/[\w.%]/),ret("number","unit");if("-"===ch){if(/\d/.test(stream.peek()))return stream.eatWhile(/[\w.%]/),ret("number","unit");if(stream.match(/^[^-]+-/))return ret("meta","meta")}else return /[,+>*\/]/.test(ch)?ret(null,"select-op"):"."==ch&&stream.match(/^-?[_a-z][_a-z0-9-]*/i)?ret("qualifier","qualifier"):":"==ch?ret("operator",ch):/[;{}\[\]\(\)]/.test(ch)?ret(null,ch):"u"==ch&&stream.match("rl(")?(stream.backUp(1),state.tokenize=tokenParenthesized,ret("property","variable")):(stream.eatWhile(/[\w\\\-]/),ret("property","variable"))}}function tokenString(quote,nonInclusive){return function(stream,state){for(var escaped=!1,ch;null!=(ch=stream.next())&&(ch!=quote||escaped);)escaped=!escaped&&"\\"==ch;return escaped||(nonInclusive&&stream.backUp(1),state.tokenize=tokenBase),ret("string","string")}}function tokenParenthesized(stream,state){return stream.next(),state.tokenize=stream.match(/\s*[\"\']/,!1)?tokenBase:tokenString(")",!0),ret(null,"(")}parserConfig.propertyKeywords||(parserConfig=CodeMirror.resolveMode("text/css"));var indentUnit=config.indentUnit||config.tabSize||2,hooks=parserConfig.hooks||{},atMediaTypes=parserConfig.atMediaTypes||{},atMediaFeatures=parserConfig.atMediaFeatures||{},propertyKeywords=parserConfig.propertyKeywords||{},colorKeywords=parserConfig.colorKeywords||{},valueKeywords=parserConfig.valueKeywords||{},allowNested=!!parserConfig.allowNested,type=null;return{startState:function(base){return{tokenize:tokenBase,baseIndent:base||0,stack:[],lastToken:null}},token:function(stream,state){if(state.tokenize=state.tokenize||tokenBase,state.tokenize==tokenBase&&stream.eatSpace())return null;var style=state.tokenize(stream,state);style&&"string"!=typeof style&&(style=ret(style[0],style[1]));var context=state.stack[state.stack.length-1];if("variable"==style)return"variable-definition"==type&&state.stack.push("propertyValue"),state.lastToken="variable-2";if("property"==style){var word=stream.current().toLowerCase();"propertyValue"==context?valueKeywords.hasOwnProperty(word)?style="string-2":colorKeywords.hasOwnProperty(word)?style="keyword":style="variable-2":"rule"==context?!propertyKeywords.hasOwnProperty(word)&&(style+=" error"):"block"==context?propertyKeywords.hasOwnProperty(word)?style="property":colorKeywords.hasOwnProperty(word)?style="keyword":valueKeywords.hasOwnProperty(word)?style="string-2":style="tag":context&&"@media{"!=context?"@media"==context?atMediaTypes[stream.current()]?style="attribute":/^(only|not)$/.test(word)?style="keyword":"and"==word?style="error":atMediaFeatures.hasOwnProperty(word)?style="error":style="attribute error":"@mediaType"==context?atMediaTypes.hasOwnProperty(word)?style="attribute":"and"==word?style="operator":/^(only|not)$/.test(word)?style="error":style="error":"@mediaType("==context?propertyKeywords.hasOwnProperty(word)||(atMediaTypes.hasOwnProperty(word)?style="error":"and"==word?style="operator":/^(only|not)$/.test(word)?style="error":style+=" error"):"@import"==context?style="tag":style="error":style="tag"}else"atom"==style?context&&"@media{"!=context&&"block"!=context?"propertyValue"==context?!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(stream.current())&&(style+=" error"):style="error":style="builtin":"@media"==context&&"{"==type&&(style="error");if("{"==type){if("@media"==context||"@mediaType"==context)state.stack[state.stack.length-1]="@media{";else{var newContext=allowNested?"block":"rule";state.stack.push(newContext)}}else if("}"==type)for("interpolation"==context&&(style="operator");state.stack.length;){var removed=state.stack.pop();if(-1<removed.indexOf("{")||"block"==removed||"rule"==removed)break}else if("interpolation"==type)state.stack.push("interpolation");else if("@media"==type)state.stack.push("@media");else if("@import"==type)state.stack.push("@import");else if("@media"==context&&/\b(keyword|attribute)\b/.test(style))state.stack[state.stack.length-1]="@mediaType";else if("@mediaType"==context&&","==stream.current())state.stack[state.stack.length-1]="@media";else if("("==type)"@media"==context||"@mediaType"==context?(state.stack[state.stack.length-1]="@mediaType",state.stack.push("@mediaType(")):state.stack.push("(");else if(")"==type)for(;state.stack.length;){var removed=state.stack.pop();if(-1<removed.indexOf("("))break}else":"==type&&"property"==state.lastToken?state.stack.push("propertyValue"):"propertyValue"==context&&";"==type?state.stack.pop():"@import"==context&&";"==type&&state.stack.pop();return state.lastToken=style},indent:function(state,textAfter){var n=state.stack.length;return /^\}/.test(textAfter)&&(n-="propertyValue"==state.stack[n-1]?2:1),state.baseIndent+n*indentUnit},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",fold:"brace"}}),function(){function keySet(array){for(var keys={},i=0;i<array.length;++i)keys[array[i]]=!0;return keys}function tokenCComment(stream,state){for(var maybeEnd=!1,ch;null!=(ch=stream.next());){if(maybeEnd&&"/"==ch){state.tokenize=null;break}maybeEnd="*"==ch}return["comment","comment"]}var atMediaTypes=keySet(["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"]),atMediaFeatures=keySet(["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid"]),propertyKeywords=keySet(["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid-cell","grid-column","grid-column-align","grid-column-sizing","grid-column-span","grid-columns","grid-flow","grid-row","grid-row-align","grid-row-sizing","grid-row-span","grid-rows","grid-template","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-inside","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index","zoom","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-profile","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","kerning","text-anchor","writing-mode"]),colorKeywords=keySet(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"]),valueKeywords=keySet(["above","absolute","activeborder","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","auto","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","column","compact","condensed","contain","content","content-box","context-menu","continuous","copy","cover","crop","cross","crosshair","currentcolor","cursive","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ew-resize","expanded","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-table","inset","inside","intrinsic","invert","italic","justify","kannada","katakana","katakana-iroha","keep-all","khmer","landscape","lao","large","larger","left","level","lighter","line-through","linear","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","round","row-resize","rtl","run-in","running","s-resize","sans-serif","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","single","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","x-large","x-small","xor","xx-large","xx-small"]);CodeMirror.defineMIME("text/css",{atMediaTypes:atMediaTypes,atMediaFeatures:atMediaFeatures,propertyKeywords:propertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,hooks:{"<":function(stream,state){function tokenSGMLComment(stream,state){for(var dashes=0,ch;null!=(ch=stream.next());){if(2<=dashes&&">"==ch){state.tokenize=null;break}dashes="-"==ch?dashes+1:0}return["comment","comment"]}if(stream.eat("!"))return state.tokenize=tokenSGMLComment,tokenSGMLComment(stream,state)},"/":function(stream,state){return!!stream.eat("*")&&(state.tokenize=tokenCComment,tokenCComment(stream,state))}},name:"css"}),CodeMirror.defineMIME("text/x-scss",{atMediaTypes:atMediaTypes,atMediaFeatures:atMediaFeatures,propertyKeywords:propertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,allowNested:!0,hooks:{":":function(stream){return!!stream.match(/\s*{/)&&[null,"{"]},$:function(stream){return stream.match(/^[\w-]+/),":"==stream.peek()?["variable","variable-definition"]:["variable","variable"]},",":function(stream,state){if("propertyValue"==state.stack[state.stack.length-1]&&stream.match(/^ *\$/,!1))return["operator",";"]},"/":function(stream,state){return stream.eat("/")?(stream.skipToEnd(),["comment","comment"]):stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):["operator","operator"]},"#":function(stream){return stream.eat("{")?["operator","interpolation"]:(stream.eatWhile(/[\w\\\-]/),["atom","hash"])}},name:"css"})}()}(this),_retrieveGlobal()}),$__System.registerDynamic("82",["80"],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function(){CodeMirror.defineMode("htmlmixed",function(config,parserConfig){function html(stream,state){var tagName=state.htmlState.tagName,style=htmlMode.token(stream,state.htmlState);if("script"==tagName&&/\btag\b/.test(style)&&">"==stream.current()){var scriptType=stream.string.slice(_Mathmax(0,stream.pos-100),stream.pos).match(/\btype\s*=\s*("[^"]+"|'[^']+'|\S+)[^<]*$/i);scriptType=scriptType?scriptType[1]:"",scriptType&&/[\"\']/.test(scriptType.charAt(0))&&(scriptType=scriptType.slice(1,scriptType.length-1));for(var i=0,tp;i<scriptTypes.length;++i)if(tp=scriptTypes[i],"string"==typeof tp.matches?scriptType==tp.matches:tp.matches.test(scriptType)){tp.mode&&(state.token=script,state.localMode=tp.mode,state.localState=tp.mode.startState&&tp.mode.startState(htmlMode.indent(state.htmlState,"")));break}}else"style"==tagName&&/\btag\b/.test(style)&&">"==stream.current()&&(state.token=css,state.localMode=cssMode,state.localState=cssMode.startState(htmlMode.indent(state.htmlState,"")));return style}function maybeBackup(stream,pat,style){var cur=stream.current(),close=cur.search(pat),m;return-1<close?stream.backUp(cur.length-close):(m=cur.match(/<\/?$/))&&(stream.backUp(cur.length),!stream.match(pat,!1)&&stream.match(cur)),style}function script(stream,state){return stream.match(/^<\/\s*script\s*>/i,!1)?(state.token=html,state.localState=state.localMode=null,html(stream,state)):maybeBackup(stream,/<\/\s*script\s*>/,state.localMode.token(stream,state.localState))}function css(stream,state){return stream.match(/^<\/\s*style\s*>/i,!1)?(state.token=html,state.localState=state.localMode=null,html(stream,state)):maybeBackup(stream,/<\/\s*style\s*>/,cssMode.token(stream,state.localState))}var htmlMode=CodeMirror.getMode(config,{name:"xml",htmlMode:!0}),cssMode=CodeMirror.getMode(config,"css"),scriptTypes=[],scriptTypesConf=parserConfig&&parserConfig.scriptTypes;if(scriptTypes.push({matches:/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,mode:CodeMirror.getMode(config,"javascript")}),scriptTypesConf)for(var i=0,conf;i<scriptTypesConf.length;++i)conf=scriptTypesConf[i],scriptTypes.push({matches:conf.matches,mode:conf.mode&&CodeMirror.getMode(config,conf.mode)});return scriptTypes.push({matches:/./,mode:CodeMirror.getMode(config,"text/plain")}),{startState:function(){var state=htmlMode.startState();return{token:html,localMode:null,localState:null,htmlState:state}},copyState:function(state){if(state.localState)var local=CodeMirror.copyState(state.localMode,state.localState);return{token:state.token,localMode:state.localMode,localState:local,htmlState:CodeMirror.copyState(htmlMode,state.htmlState)}},token:function(stream,state){return state.token(stream,state)},indent:function(state,textAfter){return!state.localMode||/^\s*<\//.test(textAfter)?htmlMode.indent(state.htmlState,textAfter):state.localMode.indent?state.localMode.indent(state.localState,textAfter):CodeMirror.Pass},electricChars:"/{}:",innerMode:function(state){return{state:state.localState||state.htmlState,mode:state.localMode||htmlMode}}}},"xml","javascript","css"),CodeMirror.defineMIME("text/html","htmlmixed")}(this),_retrieveGlobal()}),$__System.registerDynamic("80",[],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function(){window.CodeMirror=function(){"use strict";function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);for(var opt in this.options=options=options||{},defaults)!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt)&&(options[opt]=defaults[opt]);setGuttersForLineNumbers(options);var docStart="string"==typeof options.value?0:options.value.first,display=this.display=makeDisplay(place,docStart);display.wrapper.CodeMirror=this,updateGutters(this),options.autofocus&&!mobile&&focusInput(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new Delayed},themeChanged(this),options.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var doc=options.value;"string"==typeof doc&&(doc=new Doc(options.value,options.mode)),operation(this,attachDoc)(this,doc),ie&&setTimeout(bind(resetInput,this,!0),20),registerEventHandlers(this);var hasFocus;try{hasFocus=document.activeElement==display.input}catch(e){}hasFocus||options.autofocus&&!mobile?setTimeout(bind(onFocus,this),20):onBlur(this),operation(this,function(){for(var opt in optionHandlers)optionHandlers.propertyIsEnumerable(opt)&&optionHandlers[opt](this,options[opt],Init);for(var i=0;i<initHooks.length;++i)initHooks[i](this)})()}function makeDisplay(place,docStart){var d={},input=d.input=elt("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");return webkit?input.style.width="1000px":input.setAttribute("wrap","off"),ios&&(input.style.border="1px solid black"),input.setAttribute("autocorrect","off"),input.setAttribute("autocapitalize","off"),input.setAttribute("spellcheck","false"),d.inputDiv=elt("div",[input],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),d.scrollbarH=elt("div",[elt("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),d.scrollbarV=elt("div",[elt("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler"),d.gutterFiller=elt("div",null,"CodeMirror-gutter-filler"),d.lineDiv=elt("div",null,"CodeMirror-code"),d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1"),d.cursor=elt("div","\xA0","CodeMirror-cursor"),d.otherCursor=elt("div","\xA0","CodeMirror-cursor CodeMirror-secondarycursor"),d.measure=elt("div",null,"CodeMirror-measure"),d.lineSpace=elt("div",[d.measure,d.selectionDiv,d.lineDiv,d.cursor,d.otherCursor],null,"position: relative; outline: none"),d.mover=elt("div",[elt("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative"),d.sizer=elt("div",[d.mover],"CodeMirror-sizer"),d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerCutOff+"px; width: 1px;"),d.gutters=elt("div",null,"CodeMirror-gutters"),d.lineGutter=null,d.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll"),d.scroller.setAttribute("tabIndex","-1"),d.wrapper=elt("div",[d.inputDiv,d.scrollbarH,d.scrollbarV,d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror"),ie_lt8&&(d.gutters.style.zIndex=-1,d.scroller.style.paddingRight=0),place.appendChild?place.appendChild(d.wrapper):place(d.wrapper),ios&&(input.style.width="0px"),webkit||(d.scroller.draggable=!0),khtml?(d.inputDiv.style.height="1px",d.inputDiv.style.position="absolute"):ie_lt8&&(d.scrollbarH.style.minWidth=d.scrollbarV.style.minWidth="18px"),d.viewOffset=d.lastSizeC=0,d.showingFrom=d.showingTo=docStart,d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null,d.prevInput="",d.alignWidgets=!1,d.pollingFast=!1,d.poll=new Delayed,d.cachedCharWidth=d.cachedTextHeight=null,d.measureLineCache=[],d.measureLineCachePos=0,d.inaccurateSelection=!1,d.maxLine=null,d.maxLineLength=0,d.maxLineChanged=!1,d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null,d}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption),cm.doc.iter(function(line){line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null)}),cm.doc.frontier=cm.doc.first,startWorker(cm,100),cm.state.modeGen++,cm.curOp&&regChange(cm)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping,perLine=wrapping&&_Mathmax(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){return lineIsHidden(cm.doc,line)?0:wrapping?(_Mathceil(line.text.length/perLine)||1)*th:th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);estHeight!=line.height&&updateLineHeight(line,estHeight)})}function keyMapChanged(cm){var map=keyMap[cm.options.keyMap],style=map.style;cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(style?" cm-keymap-"+style:""),cm.state.disableInput=map.disableInput}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-"),clearCaches(cm)}function guttersChanged(cm){updateGutters(cm),regChange(cm),setTimeout(function(){alignHorizontally(cm)},20)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i],gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+gutterClass));"CodeMirror-linenumbers"==gutterClass&&(cm.display.lineGutter=gElt,gElt.style.width=(cm.display.lineNumWidth||1)+"px")}gutters.style.display=i?"":"none"}function lineLength(doc,line){if(0==line.height)return 0;for(var len=line.text.length,cur=line,merged,found;merged=collapsedSpanAtStart(cur);)found=merged.find(),cur=getLine(doc,found.from.line),len+=found.from.ch-found.to.ch;for(cur=line;merged=collapsedSpanAtEnd(cur);){var found=merged.find();len-=cur.text.length-found.from.ch,cur=getLine(doc,found.to.line),len+=cur.text.length-found.to.ch}return len}function computeMaxLength(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first),d.maxLineLength=lineLength(doc,d.maxLine),d.maxLineChanged=!0,doc.iter(function(line){var len=lineLength(doc,line);len>d.maxLineLength&&(d.maxLineLength=len,d.maxLine=line)})}function setGuttersForLineNumbers(options){var found=indexOf(options.gutters,"CodeMirror-linenumbers");-1==found&&options.lineNumbers?options.gutters=options.gutters.concat(["CodeMirror-linenumbers"]):-1<found&&!options.lineNumbers&&(options.gutters=options.gutters.slice(0),options.gutters.splice(found,1))}function updateScrollbars(cm){var d=cm.display,docHeight=cm.doc.height,totalHeight=docHeight+paddingVert(d);d.sizer.style.minHeight=d.heightForcer.style.top=totalHeight+"px",d.gutters.style.height=_Mathmax(totalHeight,d.scroller.clientHeight-scrollerCutOff)+"px";var scrollHeight=_Mathmax(totalHeight,d.scroller.scrollHeight),needsH=d.scroller.scrollWidth>d.scroller.clientWidth+1,needsV=scrollHeight>d.scroller.clientHeight+1;needsV?(d.scrollbarV.style.display="block",d.scrollbarV.style.bottom=needsH?scrollbarWidth(d.measure)+"px":"0",d.scrollbarV.firstChild.style.height=scrollHeight-d.scroller.clientHeight+d.scrollbarV.clientHeight+"px"):(d.scrollbarV.style.display="",d.scrollbarV.firstChild.style.height="0"),needsH?(d.scrollbarH.style.display="block",d.scrollbarH.style.right=needsV?scrollbarWidth(d.measure)+"px":"0",d.scrollbarH.firstChild.style.width=d.scroller.scrollWidth-d.scroller.clientWidth+d.scrollbarH.clientWidth+"px"):(d.scrollbarH.style.display="",d.scrollbarH.firstChild.style.width="0"),needsH&&needsV?(d.scrollbarFiller.style.display="block",d.scrollbarFiller.style.height=d.scrollbarFiller.style.width=scrollbarWidth(d.measure)+"px"):d.scrollbarFiller.style.display="",needsH&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter?(d.gutterFiller.style.display="block",d.gutterFiller.style.height=scrollbarWidth(d.measure)+"px",d.gutterFiller.style.width=d.gutters.offsetWidth+"px"):d.gutterFiller.style.display="",mac_geLion&&0===scrollbarWidth(d.measure)&&(d.scrollbarV.style.minWidth=d.scrollbarH.style.minHeight=mac_geMountainLion?"18px":"12px",d.scrollbarV.style.pointerEvents=d.scrollbarH.style.pointerEvents="none")}function visibleLines(display,doc,viewPort){var top=display.scroller.scrollTop,height=display.wrapper.clientHeight;"number"==typeof viewPort?top=viewPort:viewPort&&(top=viewPort.top,height=viewPort.bottom-viewPort.top),top=_Mathfloor(top-paddingTop(display));var bottom=_Mathceil(top+height);return{from:lineAtHeight(doc,top),to:lineAtHeight(doc,bottom)}}function alignHorizontally(cm){var display=cm.display;if(display.alignWidgets||display.gutters.firstChild&&cm.options.fixedGutter){for(var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft,gutterW=display.gutters.offsetWidth,n=display.lineDiv.firstChild;n;n=n.nextSibling)if(n.alignable)for(var i=0,a=n.alignable;i<a.length;++i)a[i].style.left=comp+"px";cm.options.fixedGutter&&(display.gutters.style.left=comp+gutterW+"px")}}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return!1;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt")),innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;return display.lineGutter.style.width="",display.lineNumInnerWidth=_Mathmax(innerW,display.lineGutter.offsetWidth-padding),display.lineNumWidth=display.lineNumInnerWidth+padding,display.lineNumChars=display.lineNumInnerWidth?last.length:-1,display.lineGutter.style.width=display.lineNumWidth+"px",!0}return!1}function lineNumberFor(options,i){return options.lineNumberFormatter(i+options.firstLineNumber)+""}function compensateForHScroll(display){return getRect(display.scroller).left-getRect(display.sizer).left}function updateDisplay(cm,changes,viewPort,forced){for(var oldFrom=cm.display.showingFrom,oldTo=cm.display.showingTo,visible=visibleLines(cm.display,cm.doc,viewPort),first=!0,updated,oldWidth;;first=!1){if(oldWidth=cm.display.scroller.clientWidth,!updateDisplayInner(cm,changes,visible,forced))break;if(updated=!0,changes=[],updateSelection(cm),updateScrollbars(cm),first&&cm.options.lineWrapping&&oldWidth!=cm.display.scroller.clientWidth){forced=!0;continue}if(forced=!1,viewPort&&(viewPort=_Mathmin(cm.display.scroller.scrollHeight-cm.display.scroller.clientHeight,"number"==typeof viewPort?viewPort:viewPort.top)),visible=visibleLines(cm.display,cm.doc,viewPort),visible.from>=cm.display.showingFrom&&visible.to<=cm.display.showingTo)break}return updated&&(signalLater(cm,"update",cm),(cm.display.showingFrom!=oldFrom||cm.display.showingTo!=oldTo)&&signalLater(cm,"viewportChange",cm,cm.display.showingFrom,cm.display.showingTo)),updated}function updateDisplayInner(cm,changes,visible,forced){var display=cm.display,doc=cm.doc;if(!display.wrapper.clientWidth)return display.showingFrom=display.showingTo=doc.first,void(display.viewOffset=0);if(!(!forced&&0==changes.length&&visible.from>display.showingFrom&&visible.to<display.showingTo)){maybeUpdateLineNumberWidth(cm)&&(changes=[{from:doc.first,to:doc.first+doc.size}]);var gutterW=display.sizer.style.marginLeft=display.gutters.offsetWidth+"px";display.scrollbarH.style.left=cm.options.fixedGutter?gutterW:"0";var positionsChangedFrom=Infinity;if(cm.options.lineNumbers)for(var i=0;i<changes.length;++i)changes[i].diff&&changes[i].from<positionsChangedFrom&&(positionsChangedFrom=changes[i].from);var end=doc.first+doc.size,from=_Mathmax(visible.from-cm.options.viewportMargin,doc.first),to=_Mathmin(end,visible.to+cm.options.viewportMargin);if(display.showingFrom<from&&20>from-display.showingFrom&&(from=_Mathmax(doc.first,display.showingFrom)),display.showingTo>to&&20>display.showingTo-to&&(to=_Mathmin(end,display.showingTo)),sawCollapsedSpans)for(from=lineNo(visualLine(doc,getLine(doc,from)));to<end&&lineIsHidden(doc,getLine(doc,to));)++to;var intact=[{from:_Mathmax(display.showingFrom,doc.first),to:_Mathmin(display.showingTo,end)}];if(intact=intact[0].from>=intact[0].to?[]:computeIntact(intact,changes),sawCollapsedSpans)for(var i=0;i<intact.length;++i)for(var range=intact[i],merged,newTo;merged=collapsedSpanAtEnd(getLine(doc,range.to-1));)if(newTo=merged.find().from.line,newTo>range.from)range.to=newTo;else{intact.splice(i--,1);break}for(var intactLines=0,i=0,range;i<intact.length;++i)range=intact[i],range.from<from&&(range.from=from),range.to>to&&(range.to=to),range.from>=range.to?intact.splice(i--,1):intactLines+=range.to-range.from;if(!forced&&intactLines==to-from&&from==display.showingFrom&&to==display.showingTo)return void updateViewOffset(cm);intact.sort(function(a,b){return a.from-b.from});try{var focused=document.activeElement}catch(e){}intactLines<.7*(to-from)&&(display.lineDiv.style.display="none"),patchDisplay(cm,from,to,intact,positionsChangedFrom),display.lineDiv.style.display="",focused&&document.activeElement!=focused&&focused.offsetHeight&&focused.focus();var different=from!=display.showingFrom||to!=display.showingTo||display.lastSizeC!=display.wrapper.clientHeight;return different&&(display.lastSizeC=display.wrapper.clientHeight,startWorker(cm,400)),display.showingFrom=from,display.showingTo=to,updateHeightsInViewport(cm),updateViewOffset(cm),!0}}function updateHeightsInViewport(cm){for(var display=cm.display,prevBottom=display.lineDiv.offsetTop,node=display.lineDiv.firstChild,height;node;node=node.nextSibling)if(node.lineObj){if(ie_lt8){var bot=node.offsetTop+node.offsetHeight;height=bot-prevBottom,prevBottom=bot}else{var box=getRect(node);height=box.bottom-box.top}var diff=node.lineObj.height-height;if(2>height&&(height=textHeight(display)),.001<diff||-.001>diff){updateLineHeight(node.lineObj,height);var widgets=node.lineObj.widgets;if(widgets)for(var i=0;i<widgets.length;++i)widgets[i].height=widgets[i].node.offsetHeight}}}function updateViewOffset(cm){var off=cm.display.viewOffset=heightAtLine(cm,getLine(cm.doc,cm.display.showingFrom));cm.display.mover.style.top=off+"px"}function computeIntact(intact,changes){for(var i=0,l=changes.length||0;i<l;++i){for(var change=changes[i],intact2=[],diff=change.diff||0,j=0,l2=intact.length,range;j<l2;++j)range=intact[j],change.to<=range.from&&change.diff?intact2.push({from:range.from+diff,to:range.to+diff}):change.to<=range.from||change.from>=range.to?intact2.push(range):(change.from>range.from&&intact2.push({from:range.from,to:change.from}),change.to<range.to&&intact2.push({from:change.to+diff,to:range.to+diff}));intact=intact2}return intact}function getDimensions(cm){for(var d=cm.display,left={},width={},n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i)left[cm.options.gutters[i]]=n.offsetLeft,width[cm.options.gutters[i]]=n.offsetWidth;return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,from,to,intact,updateNumbersFrom){function rm(node){var next=node.nextSibling;return webkit&&mac&&cm.display.currentWheelTarget==node?(node.style.display="none",node.lineObj=null):node.parentNode.removeChild(node),next}var dims=getDimensions(cm),display=cm.display,lineNumbers=cm.options.lineNumbers;intact.length||webkit&&cm.display.currentWheelTarget||removeChildren(display.lineDiv);var container=display.lineDiv,cur=container.firstChild,nextIntact=intact.shift(),lineN=from;for(cm.doc.iter(from,to,function(line){if(nextIntact&&nextIntact.to==lineN&&(nextIntact=intact.shift()),lineIsHidden(cm.doc,line)){if(0!=line.height&&updateLineHeight(line,0),line.widgets&&cur&&cur.previousSibling)for(var i=0,w;i<line.widgets.length;++i)if(w=line.widgets[i],w.showIfHidden){var prev=cur.previousSibling;if(/pre/i.test(prev.nodeName)){var wrap=elt("div",null,null,"position: relative");prev.parentNode.replaceChild(wrap,prev),wrap.appendChild(prev),prev=wrap}var wnode=prev.appendChild(elt("div",[w.node],"CodeMirror-linewidget"));w.handleMouseEvents||(wnode.ignoreEvents=!0),positionLineWidget(w,wnode,prev,dims)}}else if(nextIntact&&nextIntact.from<=lineN&&nextIntact.to>lineN){for(;cur.lineObj!=line;)cur=rm(cur);lineNumbers&&updateNumbersFrom<=lineN&&cur.lineNumber&&setTextContent(cur.lineNumber,lineNumberFor(cm.options,lineN)),cur=cur.nextSibling}else{if(line.widgets)for(var j=0,search=cur,reuse;search&&20>j;++j,search=search.nextSibling)if(search.lineObj==line&&/div/i.test(search.nodeName)){reuse=search;break}var lineNode=buildLineElement(cm,line,lineN,dims,reuse);if(lineNode!=reuse)container.insertBefore(lineNode,cur);else{for(;cur!=reuse;)cur=rm(cur);cur=cur.nextSibling}lineNode.lineObj=line}++lineN});cur;)cur=rm(cur)}function buildLineElement(cm,line,lineNo,dims,reuse){var built=buildLineContent(cm,line),lineElement=built.pre,markers=line.gutterMarkers,display=cm.display,bgClass=built.bgClass?built.bgClass+" "+(line.bgClass||""):line.bgClass,wrap;if(!cm.options.lineNumbers&&!markers&&!bgClass&&!line.wrapClass&&!line.widgets)return lineElement;if(reuse){reuse.alignable=null;for(var isOk=!0,widgetsSeen=0,insertBefore=null,n=reuse.firstChild,next;n;n=next)if(next=n.nextSibling,!/\bCodeMirror-linewidget\b/.test(n.className))reuse.removeChild(n);else{for(var i=0,widget;i<line.widgets.length;++i)if(widget=line.widgets[i],widget.node==n.firstChild){widget.above||insertBefore||(insertBefore=n),positionLineWidget(widget,n,reuse,dims),++widgetsSeen;break}if(i==line.widgets.length){isOk=!1;break}}reuse.insertBefore(lineElement,insertBefore),isOk&&widgetsSeen==line.widgets.length&&(wrap=reuse,reuse.className=line.wrapClass||"")}if(wrap||(wrap=elt("div",null,line.wrapClass,"position: relative"),wrap.appendChild(lineElement)),bgClass&&wrap.insertBefore(elt("div",null,bgClass+" CodeMirror-linebackground"),wrap.firstChild),cm.options.lineNumbers||markers){var gutterWrap=wrap.insertBefore(elt("div",null,null,"position: absolute; left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px"),wrap.firstChild);if(cm.options.fixedGutter&&(wrap.alignable||(wrap.alignable=[])).push(gutterWrap),!cm.options.lineNumbers||markers&&markers["CodeMirror-linenumbers"]||(wrap.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineNo),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+display.lineNumInnerWidth+"px"))),markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];found&&gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"))}}if(ie_lt8&&(wrap.style.zIndex=2),line.widgets&&wrap!=reuse)for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget");widget.handleMouseEvents||(node.ignoreEvents=!0),positionLineWidget(widget,node,wrap,dims),widget.above?wrap.insertBefore(node,cm.options.lineNumbers&&0!=line.height?gutterWrap:lineElement):wrap.appendChild(node),signalLater(widget,"redraw")}return wrap}function positionLineWidget(widget,node,wrap,dims){if(widget.noHScroll){(wrap.alignable||(wrap.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px",widget.coverGutter||(width-=dims.gutterTotalWidth,node.style.paddingLeft=dims.gutterTotalWidth+"px"),node.style.width=width+"px"}widget.coverGutter&&(node.style.zIndex=5,node.style.position="relative",!widget.noHScroll&&(node.style.marginLeft=-dims.gutterTotalWidth+"px"))}function updateSelection(cm){var display=cm.display,collapsed=posEq(cm.doc.sel.from,cm.doc.sel.to);if(collapsed||cm.options.showCursorWhenSelecting?updateSelectionCursor(cm):display.cursor.style.display=display.otherCursor.style.display="none",collapsed?display.selectionDiv.style.display="none":updateSelectionRange(cm),cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,cm.doc.sel.head,"div"),wrapOff=getRect(display.wrapper),lineOff=getRect(display.lineDiv);display.inputDiv.style.top=_Mathmax(0,_Mathmin(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top))+"px",display.inputDiv.style.left=_Mathmax(0,_Mathmin(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))+"px"}}function updateSelectionCursor(cm){var display=cm.display,pos=cursorCoords(cm,cm.doc.sel.head,"div");display.cursor.style.left=pos.left+"px",display.cursor.style.top=pos.top+"px",display.cursor.style.height=_Mathmax(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px",display.cursor.style.display="",pos.other?(display.otherCursor.style.display="",display.otherCursor.style.left=pos.other.left+"px",display.otherCursor.style.top=pos.other.top+"px",display.otherCursor.style.height=.85*(pos.other.bottom-pos.other.top)+"px"):display.otherCursor.style.display="none"}function updateSelectionRange(cm){function add(left,top,width,bottom){0>top&&(top=0),fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px; top: "+top+"px; width: "+(null==width?clientWidth-left:width)+"px; height: "+(bottom-top)+"px"))}function drawForLine(line,fromArg,toArg){function coords(ch,bias){return charCoords(cm,Pos(line,ch),"div",lineObj,bias)}var lineObj=getLine(doc,line),lineLen=lineObj.text.length,start,end;return iterateBidiSections(getOrder(lineObj),fromArg||0,null==toArg?lineLen:toArg,function(from,to,dir){var leftPos=coords(from,"left"),rightPos,left,right;if(from==to)rightPos=leftPos,left=right=leftPos.left;else{if(rightPos=coords(to-1,"right"),"rtl"==dir){var tmp=leftPos;leftPos=rightPos,rightPos=tmp}left=leftPos.left,right=rightPos.right}null==fromArg&&0==from&&(left=pl),3<rightPos.top-leftPos.top&&(add(left,leftPos.top,null,leftPos.bottom),left=pl,leftPos.bottom<rightPos.top&&add(left,leftPos.bottom,null,rightPos.top)),null==toArg&&to==lineLen&&(right=clientWidth),(!start||leftPos.top<start.top||leftPos.top==start.top&&leftPos.left<start.left)&&(start=leftPos),(!end||rightPos.bottom>end.bottom||rightPos.bottom==end.bottom&&rightPos.right>end.right)&&(end=rightPos),left<pl+1&&(left=pl),add(left,rightPos.top,right-left,rightPos.bottom)}),{start:start,end:end}}var display=cm.display,doc=cm.doc,sel=cm.doc.sel,fragment=document.createDocumentFragment(),clientWidth=display.lineSpace.offsetWidth,pl=paddingLeft(cm.display);if(sel.from.line==sel.to.line)drawForLine(sel.from.line,sel.from.ch,sel.to.ch);else{var fromLine=getLine(doc,sel.from.line),toLine=getLine(doc,sel.to.line),singleVLine=visualLine(doc,fromLine)==visualLine(doc,toLine),leftEnd=drawForLine(sel.from.line,sel.from.ch,singleVLine?fromLine.text.length:null).end,rightStart=drawForLine(sel.to.line,singleVLine?0:null,sel.to.ch).start;singleVLine&&(leftEnd.top<rightStart.top-2?(add(leftEnd.right,leftEnd.top,null,leftEnd.bottom),add(pl,rightStart.top,rightStart.left,rightStart.bottom)):add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom)),leftEnd.bottom<rightStart.top&&add(pl,leftEnd.bottom,null,rightStart.top)}removeChildrenAndAdd(display.selectionDiv,fragment),display.selectionDiv.style.display=""}function restartBlink(cm){if(cm.state.focused){var display=cm.display;clearInterval(display.blinker);var on=!0;display.cursor.style.visibility=display.otherCursor.style.visibility="",0<cm.options.cursorBlinkRate&&(display.blinker=setInterval(function(){display.cursor.style.visibility=display.otherCursor.style.visibility=(on=!on)?"":"hidden"},cm.options.cursorBlinkRate))}}function startWorker(cm,time){cm.doc.mode.startState&&cm.doc.frontier<cm.display.showingTo&&cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first&&(doc.frontier=doc.first),!(doc.frontier>=cm.display.showingTo)){var end=+new Date+cm.options.workTime,state=copyState(doc.mode,getStateBefore(cm,doc.frontier)),changed=[],prevChange;doc.iter(doc.frontier,_Mathmin(doc.first+doc.size,cm.display.showingTo+500),function(line){if(doc.frontier>=cm.display.showingFrom){var oldStyles=line.styles;line.styles=highlightLine(cm,line,state,!0);for(var ischange=!oldStyles||oldStyles.length!=line.styles.length,i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];ischange&&(prevChange&&prevChange.end==doc.frontier?prevChange.end++:changed.push(prevChange={start:doc.frontier,end:doc.frontier+1})),line.stateAfter=copyState(doc.mode,state)}else processLine(cm,line.text,state),line.stateAfter=0==doc.frontier%5?copyState(doc.mode,state):null;return(++doc.frontier,+new Date>end)?(startWorker(cm,cm.options.workDelay),!0):void 0}),changed.length&&operation(cm,function(){for(var i=0;i<changed.length;++i)regChange(this,changed[i].start,changed[i].end)})()}}function findStartLine(cm,n,precise){for(var doc=cm.doc,lim=precise?-1:n-(cm.doc.mode.innerMode?1e3:100),search=n,minindent,minline;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter&&(!precise||search<=doc.frontier))return search;var indented=countColumn(line.text,null,cm.options.tabSize);(null==minline||minindent>indented)&&(minline=search-1,minindent=indented)}return minline}function getStateBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return!0;var pos=findStartLine(cm,n,precise),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;return state=state?copyState(doc.mode,state):startState(doc.mode),doc.iter(pos,n,function(line){processLine(cm,line.text,state);var save=pos==n-1||0==pos%5||pos>=display.showingFrom&&pos<display.showingTo;line.stateAfter=save?copyState(doc.mode,state):null,++pos}),precise&&(doc.frontier=pos),state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingLeft(display){var e=removeChildrenAndAdd(display.measure,elt("pre",null,null,"text-align: left")).appendChild(elt("span","x"));return e.offsetLeft}function measureChar(cm,line,ch,data,bias){var dir=-1;if(data=data||measureLine(cm,line),data.crude){var left=data.left+ch*data.width;return{left:left,right:left+data.width,top:data.top,bottom:data.bottom}}for(var pos=ch,r;;pos+=dir){if(r=data[pos],r)break;0>dir&&0==pos&&(dir=1)}return bias=pos>ch?"left":pos<ch?"right":bias,"left"==bias&&r.leftSide?r=r.leftSide:"right"==bias&&r.rightSide&&(r=r.rightSide),{left:pos<ch?r.right:r.left,right:pos>ch?r.left:r.right,top:r.top,bottom:r.bottom}}function findCachedMeasurement(cm,line){for(var cache=cm.display.measureLineCache,i=0,memo;i<cache.length;++i)if(memo=cache[i],memo.text==line.text&&memo.markedSpans==line.markedSpans&&cm.display.scroller.clientWidth==memo.width&&memo.classes==line.textClass+"|"+line.wrapClass)return memo}function clearCachedMeasurement(cm,line){var exists=findCachedMeasurement(cm,line);exists&&(exists.text=exists.measure=exists.markedSpans=null)}function measureLine(cm,line){var cached=findCachedMeasurement(cm,line);if(cached)return cached.measure;var measure=measureLineInner(cm,line),cache=cm.display.measureLineCache,memo={text:line.text,width:cm.display.scroller.clientWidth,markedSpans:line.markedSpans,measure:measure,classes:line.textClass+"|"+line.wrapClass};return 16==cache.length?cache[++cm.display.measureLineCachePos%16]=memo:cache.push(memo),measure}function measureLineInner(cm,line){function measureRect(rect){var top=rect.top-outer.top,bot=rect.bottom-outer.top;bot>maxBot&&(bot=maxBot),0>top&&(top=0);for(var i=vranges.length-2;0<=i;i-=2){var rtop=vranges[i],rbot=vranges[i+1];if(!(rtop>bot||rbot<top)&&(rtop<=top&&rbot>=bot||top<=rtop&&bot>=rbot||_Mathmin(bot,rbot)-_Mathmax(top,rtop)>=bot-top>>1)){vranges[i]=_Mathmin(top,rtop),vranges[i+1]=_Mathmax(bot,rbot);break}}return 0>i&&(i=vranges.length,vranges.push(top,bot)),{left:rect.left-outer.left,right:rect.right-outer.left,top:i,bottom:null}}function finishRect(rect){rect.bottom=vranges[rect.top+1],rect.top=vranges[rect.top]}if(!cm.options.lineWrapping&&line.text.length>=cm.options.crudeMeasuringFrom)return crudelyMeasureLine(cm,line);var display=cm.display,measure=emptyArray(line.text.length),pre=buildLineContent(cm,line,measure,!0).pre;if(ie&&!ie_lt8&&!cm.options.lineWrapping&&100<pre.childNodes.length){for(var fragment=document.createDocumentFragment(),chunk=10,n=pre.childNodes.length,i=0,chunks=_Mathceil(n/chunk),wrap;i<chunks;++i){wrap=elt("div",null,null,"display: inline-block");for(var j=0;j<chunk&&n;++j)wrap.appendChild(pre.firstChild),--n;fragment.appendChild(wrap)}pre.appendChild(fragment)}removeChildrenAndAdd(display.measure,pre);var outer=getRect(display.lineDiv),vranges=[],data=emptyArray(line.text.length),maxBot=pre.offsetHeight;ie_lt9&&display.measure.first!=pre&&removeChildrenAndAdd(display.measure,pre);for(var i=0,cur;i<measure.length;++i)if(cur=measure[i]){var node=cur,rect=null;if(/\bCodeMirror-widget\b/.test(cur.className)&&cur.getClientRects){1==cur.firstChild.nodeType&&(node=cur.firstChild);var rects=node.getClientRects();1<rects.length&&(rect=data[i]=measureRect(rects[0]),rect.rightSide=measureRect(rects[rects.length-1]))}rect||(rect=data[i]=measureRect(getRect(node))),cur.measureRight&&(rect.right=getRect(cur.measureRight).left),cur.leftSide&&(rect.leftSide=measureRect(getRect(cur.leftSide)))}removeChildren(cm.display.measure);for(var i=0,cur;i<data.length;++i)(cur=data[i])&&(finishRect(cur),cur.leftSide&&finishRect(cur.leftSide),cur.rightSide&&finishRect(cur.rightSide));return data}function crudelyMeasureLine(cm,line){var copy=new Line(line.text.slice(0,100),null);line.textClass&&(copy.textClass=line.textClass);var measure=measureLineInner(cm,copy),left=measureChar(cm,copy,0,measure,"left"),right=measureChar(cm,copy,99,measure,"right");return{crude:!0,top:left.top,left:left.left,bottom:left.bottom,width:(right.right-left.left)/100}}function measureLineWidth(cm,line){var hasBadSpan=!1;if(line.markedSpans)for(var i=0,sp;i<line.markedSpans;++i)sp=line.markedSpans[i],sp.collapsed&&(null==sp.to||sp.to==line.text.length)&&(hasBadSpan=!0);var cached=!hasBadSpan&&findCachedMeasurement(cm,line);if(cached||line.text.length>=cm.options.crudeMeasuringFrom)return measureChar(cm,line,line.text.length,cached&&cached.measure,"right").right;var pre=buildLineContent(cm,line,null,!0).pre,end=pre.appendChild(zeroWidthElement(cm.display.measure));return removeChildrenAndAdd(cm.display.measure,pre),getRect(end).right-getRect(cm.display.lineDiv).left}function clearCaches(cm){cm.display.measureLineCache.length=cm.display.measureLineCachePos=0,cm.display.cachedCharWidth=cm.display.cachedTextHeight=null,cm.options.lineWrapping||(cm.display.maxLineChanged=!0),cm.display.lineNumChars=null}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size,rect.bottom+=size}if("line"==context)return rect;context||(context="local");var yOff=heightAtLine(cm,lineObj);if("local"==context?yOff+=paddingTop(cm.display):yOff-=cm.display.viewOffset,"page"==context||"window"==context){var lOff=getRect(cm.display.lineSpace);yOff+=lOff.top+("window"==context?0:pageScrollY());var xOff=lOff.left+("window"==context?0:pageScrollX());rect.left+=xOff,rect.right+=xOff}return rect.top+=yOff,rect.bottom+=yOff,rect}function fromCoordSystem(cm,coords,context){if("div"==context)return coords;var left=coords.left,top=coords.top;if("page"==context)left-=pageScrollX(),top-=pageScrollY();else if("local"==context||!context){var localBox=getRect(cm.display.sizer);left+=localBox.left,top+=localBox.top}var lineSpaceBox=getRect(cm.display.lineSpace);return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj,bias){return lineObj||(lineObj=getLine(cm.doc,pos.line)),intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,null,bias),context)}function cursorCoords(cm,pos,context,lineObj,measurement){function get(ch,right){var m=measureChar(cm,lineObj,ch,measurement,right?"right":"left");return right?m.left=m.right:m.right=m.left,intoCoordSystem(cm,lineObj,m,context)}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;return ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level?(part=order[--partPos],ch=bidiRight(part)-(part.level%2?0:1),right=!0):ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level&&(part=order[++partPos],ch=bidiLeft(part)-part.level%2,right=!1),right&&ch==part.to&&ch>part.from?get(ch-1):get(ch,right)}lineObj=lineObj||getLine(cm.doc,pos.line),measurement||(measurement=measureLine(cm,lineObj));var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch),val=getBidi(ch,partPos);return null!=bidiOther&&(val.other=getBidi(ch,bidiOther)),val}function PosWithInfo(line,ch,outside,xRel){var pos=new Pos(line,ch);return pos.xRel=xRel,outside&&(pos.outside=!0),pos}function coordsChar(cm,x,y){var doc=cm.doc;if(y+=cm.display.viewOffset,0>y)return PosWithInfo(doc.first,0,!0,-1);var lineNo=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineNo>last)return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,!0,1);for(0>x&&(x=0);;){var lineObj=getLine(doc,lineNo),found=coordsCharInner(cm,lineObj,lineNo,x,y),merged=collapsedSpanAtEnd(lineObj),mergedPos=merged&&merged.find();if(merged&&(found.ch>mergedPos.from.ch||found.ch==mergedPos.from.ch&&0<found.xRel))lineNo=mergedPos.to.line;else return found}}function coordsCharInner(cm,lineObj,lineNo,x,y){function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),"line",lineObj,measurement);return(wrongLine=!0,innerOff>sp.bottom)?sp.left-adjust:innerOff<sp.top?sp.left+adjust:(wrongLine=!1,sp.left)}var innerOff=y-heightAtLine(cm,lineObj),wrongLine=!1,adjust=2*cm.display.wrapper.clientWidth,measurement=measureLine(cm,lineObj),bidi=getOrder(lineObj),dist=lineObj.text.length,from=lineLeft(lineObj),to=lineRight(lineObj),fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosWithInfo(lineNo,to,toOutside,1);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):1>=to-from){for(var ch=x<fromX||x-fromX<=toX-x?from:to,xDiff=x-(ch==from?fromX:toX);isExtendingChar.test(lineObj.text.charAt(ch));)++ch;var pos=PosWithInfo(lineNo,ch,ch==from?fromOutside:toOutside,0>xDiff?-1:xDiff?1:0);return pos}var step=_Mathceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;i<step;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);middleX>x?(to=middle,toX=middleX,(toOutside=wrongLine)&&(toX+=1e3),dist=step):(from=middle,fromX=middleX,fromOutside=wrongLine,dist-=step)}}function textHeight(display){if(null!=display.cachedTextHeight)return display.cachedTextHeight;if(null==measureText){measureText=elt("pre");for(var i=0;49>i;++i)measureText.appendChild(document.createTextNode("x")),measureText.appendChild(elt("br"));measureText.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;return 3<height&&(display.cachedTextHeight=height),removeChildren(display.measure),height||1}function charWidth(display){if(null!=display.cachedCharWidth)return display.cachedCharWidth;var anchor=elt("span","x"),pre=elt("pre",[anchor]);removeChildrenAndAdd(display.measure,pre);var width=anchor.offsetWidth;return 2<width&&(display.cachedCharWidth=width),width||10}function startOperation(cm){cm.curOp={changes:[],forceUpdate:!1,updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++nextOpId},delayedCallbackDepth++||(delayedCallbacks=[])}function endOperation(cm){var op=cm.curOp,doc=cm.doc,display=cm.display;if(cm.curOp=null,op.updateMaxLine&&computeMaxLength(cm),display.maxLineChanged&&!cm.options.lineWrapping&&display.maxLine){var width=measureLineWidth(cm,display.maxLine);display.sizer.style.minWidth=_Mathmax(0,width+3+scrollerCutOff)+"px",display.maxLineChanged=!1;var maxScrollLeft=_Mathmax(0,display.sizer.offsetLeft+display.sizer.offsetWidth-display.scroller.clientWidth);maxScrollLeft<doc.scrollLeft&&!op.updateScrollPos&&setScrollLeft(cm,_Mathmin(display.scroller.scrollLeft,maxScrollLeft),!0)}var newScrollPos,updated;if(op.updateScrollPos)newScrollPos=op.updateScrollPos;else if(op.selectionChanged&&display.scroller.clientHeight){var coords=cursorCoords(cm,doc.sel.head);newScrollPos=calculateScrollPos(cm,coords.left,coords.top,coords.left,coords.bottom)}if((op.changes.length||op.forceUpdate||newScrollPos&&null!=newScrollPos.scrollTop)&&(updated=updateDisplay(cm,op.changes,newScrollPos&&newScrollPos.scrollTop,op.forceUpdate),cm.display.scroller.offsetHeight&&(cm.doc.scrollTop=cm.display.scroller.scrollTop)),!updated&&op.selectionChanged&&updateSelection(cm),op.updateScrollPos){var top=_Mathmax(0,_Mathmin(display.scroller.scrollHeight-display.scroller.clientHeight,newScrollPos.scrollTop)),left=_Mathmax(0,_Mathmin(display.scroller.scrollWidth-display.scroller.clientWidth,newScrollPos.scrollLeft));display.scroller.scrollTop=display.scrollbarV.scrollTop=doc.scrollTop=top,display.scroller.scrollLeft=display.scrollbarH.scrollLeft=doc.scrollLeft=left,alignHorizontally(cm),op.scrollToPos&&scrollPosIntoView(cm,clipPos(cm.doc,op.scrollToPos.from),clipPos(cm.doc,op.scrollToPos.to),op.scrollToPos.margin)}else newScrollPos&&scrollCursorIntoView(cm);op.selectionChanged&&restartBlink(cm),cm.state.focused&&op.updateInput&&resetInput(cm,op.userSelChange);var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)hidden[i].lines.length||signal(hidden[i],"hide");if(unhidden)for(var i=0;i<unhidden.length;++i)unhidden[i].lines.length&&signal(unhidden[i],"unhide");var delayed;if(--delayedCallbackDepth||(delayed=delayedCallbacks,delayedCallbacks=null),op.textChanged&&signal(cm,"change",cm,op.textChanged),op.cursorActivity&&signal(cm,"cursorActivity",cm),delayed)for(var i=0;i<delayed.length;++i)delayed[i]()}function operation(cm1,f){return function(){var cm=cm1||this,withOp=!cm.curOp;withOp&&startOperation(cm);try{var result=f.apply(cm,arguments)}finally{withOp&&endOperation(cm)}return result}}function docOperation(f){return function(){var withOp=this.cm&&!this.cm.curOp,result;withOp&&startOperation(this.cm);try{result=f.apply(this,arguments)}finally{withOp&&endOperation(this.cm)}return result}}function runInOp(cm,f){var withOp=!cm.curOp,result;withOp&&startOperation(cm);try{result=f()}finally{withOp&&endOperation(cm)}return result}function regChange(cm,from,to,lendiff){null==from&&(from=cm.doc.first),null==to&&(to=cm.doc.first+cm.doc.size),cm.curOp.changes.push({from:from,to:to,diff:lendiff})}function slowPoll(cm){cm.display.pollingFast||cm.display.poll.set(cm.options.pollInterval,function(){readInput(cm),cm.state.focused&&slowPoll(cm)})}function fastPoll(cm){function p(){var changed=readInput(cm);changed||missed?(cm.display.pollingFast=!1,slowPoll(cm)):(missed=!0,cm.display.poll.set(60,p))}var missed=!1;cm.display.pollingFast=!0,cm.display.poll.set(20,p)}function readInput(cm){var input=cm.display.input,prevInput=cm.display.prevInput,doc=cm.doc,sel=doc.sel;if(!cm.state.focused||hasSelection(input)||isReadOnly(cm)||cm.state.disableInput)return!1;cm.state.pasteIncoming&&cm.state.fakedLastChar&&(input.value=input.value.substring(0,input.value.length-1),cm.state.fakedLastChar=!1);var text=input.value;if(text==prevInput&&posEq(sel.from,sel.to))return!1;if(ie&&!ie_lt9&&cm.display.inputHasSelection===text)return resetInput(cm,!0),!1;var withOp=!cm.curOp;withOp&&startOperation(cm),sel.shift=!1;for(var same=0,l=_Mathmin(prevInput.length,text.length);same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same);)++same;var from=sel.from,to=sel.to;same<prevInput.length?from=Pos(from.line,from.ch-(prevInput.length-same)):cm.state.overwrite&&posEq(from,to)&&!cm.state.pasteIncoming&&(to=Pos(to.line,_Mathmin(getLine(doc,to.line).text.length,to.ch+(text.length-same))));var updateInput=cm.curOp.updateInput,changeEvent={from:from,to:to,text:splitLines(text.slice(same)),origin:cm.state.pasteIncoming?"paste":"+input"};return makeChange(cm.doc,changeEvent,"end"),cm.curOp.updateInput=updateInput,signalLater(cm,"inputRead",cm,changeEvent),1e3<text.length||-1<text.indexOf("\n")?input.value=cm.display.prevInput="":cm.display.prevInput=text,withOp&&endOperation(cm),cm.state.pasteIncoming=!1,!0}function resetInput(cm,user){var doc=cm.doc,minimal,selected;if(!posEq(doc.sel.from,doc.sel.to)){cm.display.prevInput="",minimal=hasCopyEvent&&(100<doc.sel.to.line-doc.sel.from.line||1e3<(selected=cm.getSelection()).length);var content=minimal?"-":selected||cm.getSelection();cm.display.input.value=content,cm.state.focused&&selectInput(cm.display.input),ie&&!ie_lt9&&(cm.display.inputHasSelection=content)}else user&&(cm.display.prevInput=cm.display.input.value="",ie&&!ie_lt9&&(cm.display.inputHasSelection=null));cm.display.inaccurateSelection=minimal}function focusInput(cm){"nocursor"==cm.options.readOnly||mobile&&document.activeElement==cm.display.input||cm.display.input.focus()}function isReadOnly(cm){return cm.options.readOnly||cm.doc.cantEdit}function registerEventHandlers(cm){function reFocus(){cm.state.focused&&setTimeout(bind(focusInput,cm),0)}function onResize(){null==resizeTimer&&(resizeTimer=setTimeout(function(){resizeTimer=null,d.cachedCharWidth=d.cachedTextHeight=knownScrollbarWidth=null,clearCaches(cm),runInOp(cm,bind(regChange,cm))},100))}function unregister(){for(var p=d.wrapper.parentNode;p&&p!=document.body;p=p.parentNode);p?setTimeout(unregister,5e3):off(window,"resize",onResize)}function drag_(e){signalDOMEvent(cm,e)||cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e))||e_stop(e)}function prepareCopy(){d.inaccurateSelection&&(d.prevInput="",d.inaccurateSelection=!1,d.input.value=cm.getSelection(),selectInput(d.input))}var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown)),ie?on(d.scroller,"dblclick",operation(cm,function(e){if(!signalDOMEvent(cm,e)){var pos=posFromMouse(cm,e);if(!(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e))){e_preventDefault(e);var word=findWordAt(getLine(cm.doc,pos.line).text,pos);extendSelection(cm.doc,word.from,word.to)}}})):on(d.scroller,"dblclick",function(e){signalDOMEvent(cm,e)||e_preventDefault(e)}),on(d.lineSpace,"selectstart",function(e){eventInWidget(d,e)||e_preventDefault(e)}),captureMiddleClick||on(d.scroller,"contextmenu",function(e){onContextMenu(cm,e)}),on(d.scroller,"scroll",function(){d.scroller.clientHeight&&(setScrollTop(cm,d.scroller.scrollTop),setScrollLeft(cm,d.scroller.scrollLeft,!0),signal(cm,"scroll",cm))}),on(d.scrollbarV,"scroll",function(){d.scroller.clientHeight&&setScrollTop(cm,d.scrollbarV.scrollTop)}),on(d.scrollbarH,"scroll",function(){d.scroller.clientHeight&&setScrollLeft(cm,d.scrollbarH.scrollLeft)}),on(d.scroller,"mousewheel",function(e){onScrollWheel(cm,e)}),on(d.scroller,"DOMMouseScroll",function(e){onScrollWheel(cm,e)}),on(d.scrollbarH,"mousedown",reFocus),on(d.scrollbarV,"mousedown",reFocus),on(d.wrapper,"scroll",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0});var resizeTimer;on(window,"resize",onResize),setTimeout(unregister,5e3),on(d.input,"keyup",operation(cm,function(e){signalDOMEvent(cm,e)||cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e))||16==e.keyCode&&(cm.doc.sel.shift=!1)})),on(d.input,"input",function(){ie&&!ie_lt9&&cm.display.inputHasSelection&&(cm.display.inputHasSelection=null),fastPoll(cm)}),on(d.input,"keydown",operation(cm,onKeyDown)),on(d.input,"keypress",operation(cm,onKeyPress)),on(d.input,"focus",bind(onFocus,cm)),on(d.input,"blur",bind(onBlur,cm)),cm.options.dragDrop&&(on(d.scroller,"dragstart",function(e){onDragStart(cm,e)}),on(d.scroller,"dragenter",drag_),on(d.scroller,"dragover",drag_),on(d.scroller,"drop",operation(cm,onDrop))),on(d.scroller,"paste",function(e){eventInWidget(d,e)||(focusInput(cm),fastPoll(cm))}),on(d.input,"paste",function(){if(webkit&&!cm.state.fakedLastChar&&!(200>new Date-cm.state.lastMiddleDown)){var start=d.input.selectionStart,end=d.input.selectionEnd;d.input.value+="$",d.input.selectionStart=start,d.input.selectionEnd=end,cm.state.fakedLastChar=!0}cm.state.pasteIncoming=!0,fastPoll(cm)}),on(d.input,"cut",prepareCopy),on(d.input,"copy",prepareCopy),khtml&&on(d.sizer,"mouseup",function(){document.activeElement==d.input&&d.input.blur(),focusInput(cm)})}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode)if(!n||n.ignoreEvents||n.parentNode==display.sizer&&n!=display.mover)return!0}function posFromMouse(cm,e,liberal){var display=cm.display;if(!liberal){var target=e_target(e);if(target==display.scrollbarH||target==display.scrollbarH.firstChild||target==display.scrollbarV||target==display.scrollbarV.firstChild||target==display.scrollbarFiller||target==display.gutterFiller)return null}var space=getRect(display.lineSpace),x,y;try{x=e.clientX,y=e.clientY}catch(e){return null}return coordsChar(cm,x-space.left,y-space.top)}function onMouseDown(e){function doSelect(cur){if(!posEq(lastPos,cur)){if(lastPos=cur,"single"==type)return void extendSelection(cm.doc,clipPos(doc,start),cur);if(startstart=clipPos(doc,startstart),startend=clipPos(doc,startend),"double"==type){var word=findWordAt(getLine(doc,cur.line).text,cur);posLess(cur,startstart)?extendSelection(cm.doc,word.from,startend):extendSelection(cm.doc,startstart,word.to)}else"triple"==type&&(posLess(cur,startstart)?extendSelection(cm.doc,startend,clipPos(doc,Pos(cur.line,0))):extendSelection(cm.doc,startstart,clipPos(doc,Pos(cur.line+1,0))))}}function extend(e){var curCount=++counter,cur=posFromMouse(cm,e,!0);if(cur)if(!posEq(cur,last)){cm.state.focused||onFocus(cm),last=cur,doSelect(cur);var visible=visibleLines(display,doc);(cur.line>=visible.to||cur.line<visible.from)&&setTimeout(operation(cm,function(){counter==curCount&&extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;outside&&setTimeout(operation(cm,function(){counter!=curCount||(display.scroller.scrollTop+=outside,extend(e))}),50)}}function done(e){counter=Infinity,e_preventDefault(e),focusInput(cm),off(document,"mousemove",move),off(document,"mouseup",up)}if(!signalDOMEvent(this,e)){var cm=this,display=cm.display,doc=cm.doc,sel=doc.sel;if(sel.shift=e.shiftKey,eventInWidget(display,e))return void(webkit||(display.scroller.draggable=!1,setTimeout(function(){display.scroller.draggable=!0},100)));if(!clickInGutter(cm,e)){var start=posFromMouse(cm,e);switch(e_button(e)){case 3:return void(captureMiddleClick&&onContextMenu.call(cm,cm,e));case 2:return webkit&&(cm.state.lastMiddleDown=+new Date),start&&extendSelection(cm.doc,start),setTimeout(bind(focusInput,cm),20),void e_preventDefault(e);}if(!start)return void(e_target(e)==display.scroller&&e_preventDefault(e));cm.state.focused||onFocus(cm);var now=+new Date,type="single";if(lastDoubleClick&&lastDoubleClick.time>now-400&&posEq(lastDoubleClick.pos,start))type="triple",e_preventDefault(e),setTimeout(bind(focusInput,cm),20),selectLine(cm,start.line);else if(lastClick&&lastClick.time>now-400&&posEq(lastClick.pos,start)){type="double",lastDoubleClick={time:now,pos:start},e_preventDefault(e);var word=findWordAt(getLine(doc,start.line).text,start);extendSelection(cm.doc,word.from,word.to)}else lastClick={time:now,pos:start};var last=start;if(cm.options.dragDrop&&dragAndDrop&&!isReadOnly(cm)&&!posEq(sel.from,sel.to)&&!posLess(start,sel.from)&&!posLess(sel.to,start)&&"single"==type){var dragEnd=operation(cm,function(e2){webkit&&(display.scroller.draggable=!1),cm.state.draggingText=!1,off(document,"mouseup",dragEnd),off(display.scroller,"drop",dragEnd),10>_Mathabs(e.clientX-e2.clientX)+_Mathabs(e.clientY-e2.clientY)&&(e_preventDefault(e2),extendSelection(cm.doc,start),focusInput(cm))});return webkit&&(display.scroller.draggable=!0),cm.state.draggingText=dragEnd,display.scroller.dragDrop&&display.scroller.dragDrop(),on(document,"mouseup",dragEnd),void on(display.scroller,"drop",dragEnd)}e_preventDefault(e),"single"==type&&extendSelection(cm.doc,clipPos(doc,start));var startstart=sel.from,startend=sel.to,lastPos=start,editorSize=getRect(display.wrapper),counter=0,move=operation(cm,function(e){ie||e_button(e)?extend(e):done(e)}),up=operation(cm,done);on(document,"mousemove",move),on(document,"mouseup",up)}}}function gutterEvent(cm,e,type,prevent,signalfn){try{var mX=e.clientX,mY=e.clientY}catch(e){return!1}if(mX>=_Mathfloor(getRect(cm.display.gutters).right))return!1;prevent&&e_preventDefault(e);var display=cm.display,lineBox=getRect(display.lineDiv);if(mY>lineBox.bottom||!hasHandler(cm,type))return e_defaultPrevented(e);mY-=lineBox.top-display.viewOffset;for(var i=0,g;i<cm.options.gutters.length;++i)if(g=display.gutters.childNodes[i],g&&getRect(g).right>=mX){var line=lineAtHeight(cm.doc,mY),gutter=cm.options.gutters[i];return signalfn(cm,type,cm,line,gutter,e),e_defaultPrevented(e)}}function contextMenuInGutter(cm,e){return!!hasHandler(cm,"gutterContextMenu")&&gutterEvent(cm,e,"gutterContextMenu",!1,signal)}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",!0,signalLater)}function onDrop(e){var cm=this;if(!(signalDOMEvent(cm,e)||eventInWidget(cm.display,e)||cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))){e_preventDefault(e),ie&&(lastDrop=+new Date);var pos=posFromMouse(cm,e,!0),files=e.dataTransfer.files;if(pos&&!isReadOnly(cm))if(files&&files.length&&window.FileReader&&window.File)for(var n=files.length,text=Array(n),read=0,loadFile=function(file,i){var reader=new FileReader;reader.onload=function(){text[i]=reader.result,++read==n&&(pos=clipPos(cm.doc,pos),makeChange(cm.doc,{from:pos,to:pos,text:splitLines(text.join("\n")),origin:"paste"},"around"))},reader.readAsText(file)},i=0;i<n;++i)loadFile(files[i],i);else{if(cm.state.draggingText&&!(posLess(pos,cm.doc.sel.from)||posLess(cm.doc.sel.to,pos)))return cm.state.draggingText(e),void setTimeout(bind(focusInput,cm),20);try{var text=e.dataTransfer.getData("Text");if(text){var curFrom=cm.doc.sel.from,curTo=cm.doc.sel.to;setSelection(cm.doc,pos,pos),cm.state.draggingText&&replaceRange(cm.doc,"",curFrom,curTo,"paste"),cm.replaceSelection(text,null,"paste"),focusInput(cm)}}catch(e){}}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||100>+new Date-lastDrop))return void e_stop(e);if(!(signalDOMEvent(cm,e)||eventInWidget(cm.display,e))){var txt=cm.getSelection();if(e.dataTransfer.setData("Text",txt),e.dataTransfer.setDragImage&&!safari){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",opera&&(img.width=img.height=1,cm.display.wrapper.appendChild(img),img._top=img.offsetTop),e.dataTransfer.setDragImage(img,0,0),opera&&img.parentNode.removeChild(img)}}}function setScrollTop(cm,val){2>_Mathabs(cm.doc.scrollTop-val)||(cm.doc.scrollTop=val,!gecko&&updateDisplay(cm,[],val),cm.display.scroller.scrollTop!=val&&(cm.display.scroller.scrollTop=val),cm.display.scrollbarV.scrollTop!=val&&(cm.display.scrollbarV.scrollTop=val),gecko&&updateDisplay(cm,[]),startWorker(cm,100))}function setScrollLeft(cm,val,isScroller){(isScroller?val==cm.doc.scrollLeft:2>_Mathabs(cm.doc.scrollLeft-val))||(val=_Mathmin(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth),cm.doc.scrollLeft=val,alignHorizontally(cm),cm.display.scroller.scrollLeft!=val&&(cm.display.scroller.scrollLeft=val),cm.display.scrollbarH.scrollLeft!=val&&(cm.display.scrollbarH.scrollLeft=val))}function onScrollWheel(cm,e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;null==dx&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(dx=e.detail),null==dy&&e.detail&&e.axis==e.VERTICAL_AXIS?dy=e.detail:null==dy&&(dy=e.wheelDelta);var display=cm.display,scroll=display.scroller;if(dx&&scroll.scrollWidth>scroll.clientWidth||dy&&scroll.scrollHeight>scroll.clientHeight){if(dy&&mac&&webkit)for(var cur=e.target;cur!=scroll;cur=cur.parentNode)if(cur.lineObj){cm.display.currentWheelTarget=cur;break}if(dx&&!gecko&&!opera&&null!=wheelPixelsPerUnit)return dy&&setScrollTop(cm,_Mathmax(0,_Mathmin(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight))),setScrollLeft(cm,_Mathmax(0,_Mathmin(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth))),e_preventDefault(e),void(display.wheelStartX=null);if(dy&&null!=wheelPixelsPerUnit){var pixels=dy*wheelPixelsPerUnit,top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;0>pixels?top=_Mathmax(0,top+pixels-50):bot=_Mathmin(cm.doc.height,bot+pixels+50),updateDisplay(cm,[],{top:top,bottom:bot})}20>wheelSamples&&(null==display.wheelStartX?(display.wheelStartX=scroll.scrollLeft,display.wheelStartY=scroll.scrollTop,display.wheelDX=dx,display.wheelDY=dy,setTimeout(function(){if(null!=display.wheelStartX){var movedX=scroll.scrollLeft-display.wheelStartX,movedY=scroll.scrollTop-display.wheelStartY,sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null,sample&&(wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1),++wheelSamples)}},200)):(display.wheelDX+=dx,display.wheelDY+=dy))}}function doHandleBinding(cm,bound,dropShift){if("string"==typeof bound&&(bound=commands[bound],!bound))return!1;cm.display.pollingFast&&readInput(cm)&&(cm.display.pollingFast=!1);var doc=cm.doc,prevShift=doc.sel.shift,done=!1;try{isReadOnly(cm)&&(cm.state.suppressEdits=!0),dropShift&&(doc.sel.shift=!1),done=bound(cm)!=Pass}finally{doc.sel.shift=prevShift,cm.state.suppressEdits=!1}return done}function allKeyMaps(cm){var maps=cm.state.keyMaps.slice(0);return cm.options.extraKeys&&maps.push(cm.options.extraKeys),maps.push(cm.options.keyMap),maps}function handleKeyBinding(cm,e){var startMap=getKeyMap(cm.options.keyMap),next=startMap.auto;clearTimeout(maybeTransition),next&&!isModifierKey(e)&&(maybeTransition=setTimeout(function(){getKeyMap(cm.options.keyMap)==startMap&&(cm.options.keyMap=next.call?next.call(null,cm):next,keyMapChanged(cm))},50));var name=keyName(e,!0),handled=!1;if(!name)return!1;var keymaps=allKeyMaps(cm);return handled=e.shiftKey?lookupKey("Shift-"+name,keymaps,function(b){return doHandleBinding(cm,b,!0)})||lookupKey(name,keymaps,function(b){if("string"==typeof b?/^go[A-Z]/.test(b):b.motion)return doHandleBinding(cm,b)}):lookupKey(name,keymaps,function(b){return doHandleBinding(cm,b)}),handled&&(e_preventDefault(e),restartBlink(cm),ie_lt9&&(e.oldKeyCode=e.keyCode,e.keyCode=0),signalLater(cm,"keyHandled",cm,name,e)),handled}function handleCharBinding(cm,e,ch){var handled=lookupKey("'"+ch+"'",allKeyMaps(cm),function(b){return doHandleBinding(cm,b,!0)});return handled&&(e_preventDefault(e),restartBlink(cm),signalLater(cm,"keyHandled",cm,"'"+ch+"'",e)),handled}function onKeyDown(e){var cm=this;if(cm.state.focused||onFocus(cm),!(signalDOMEvent(cm,e)||cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))){ie&&27==e.keyCode&&(e.returnValue=!1);var code=e.keyCode;cm.doc.sel.shift=16==code||e.shiftKey;var handled=handleKeyBinding(cm,e);opera&&(lastStoppedKey=handled?code:null,!handled&&88==code&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey)&&cm.replaceSelection(""))}}function onKeyPress(e){var cm=this;if(!(signalDOMEvent(cm,e)||cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))){var keyCode=e.keyCode,charCode=e.charCode;if(opera&&keyCode==lastStoppedKey)return lastStoppedKey=null,void e_preventDefault(e);if(!((opera&&(!e.which||10>e.which)||khtml)&&handleKeyBinding(cm,e))){var ch=_StringfromCharCode(null==charCode?keyCode:charCode);this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!isReadOnly(this)&&-1<this.doc.mode.electricChars.indexOf(ch)&&setTimeout(operation(cm,function(){indentLine(cm,cm.doc.sel.to.line,"smart")}),75),handleCharBinding(cm,e,ch)||(ie&&!ie_lt9&&(cm.display.inputHasSelection=null),fastPoll(cm))}}}function onFocus(cm){"nocursor"==cm.options.readOnly||(!cm.state.focused&&(signal(cm,"focus",cm),cm.state.focused=!0,-1==cm.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(cm.display.wrapper.className+=" CodeMirror-focused"),!cm.curOp&&(resetInput(cm,!0),webkit&&setTimeout(bind(resetInput,cm,!0),0))),slowPoll(cm),restartBlink(cm))}function onBlur(cm){cm.state.focused&&(signal(cm,"blur",cm),cm.state.focused=!1,cm.display.wrapper.className=cm.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(cm.display.blinker),setTimeout(function(){cm.state.focused||(cm.doc.sel.shift=!1)},150)}function onContextMenu(cm,e){function prepareSelectAllHack(){if(null!=display.input.selectionStart){var extval=display.input.value="\u200B"+(posEq(sel.from,sel.to)?"":display.input.value);display.prevInput="\u200B",display.input.selectionStart=1,display.input.selectionEnd=extval.length}}function rehide(){if(display.inputDiv.style.position="relative",display.input.style.cssText=oldCSS,ie_lt9&&(display.scrollbarV.scrollTop=display.scroller.scrollTop=scrollPos),slowPoll(cm),null!=display.input.selectionStart){(!ie||ie_lt9)&&prepareSelectAllHack(),clearTimeout(detectingSelectAll);var i=0,poll=function(){" "==display.prevInput&&0==display.input.selectionStart?operation(cm,commands.selectAll)(cm):10>i++?detectingSelectAll=setTimeout(poll,500):resetInput(cm)};detectingSelectAll=setTimeout(poll,200)}}if(!signalDOMEvent(cm,e,"contextmenu")){var display=cm.display,sel=cm.doc.sel;if(!(eventInWidget(display,e)||contextMenuInGutter(cm,e))){var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(pos&&!opera){var reset=cm.options.resetSelectionOnContextMenu;reset&&(posEq(sel.from,sel.to)||posLess(pos,sel.from)||!posLess(pos,sel.to))&&operation(cm,setSelection)(cm.doc,pos,pos);var oldCSS=display.input.style.cssText;if(display.inputDiv.style.position="absolute",display.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",focusInput(cm),resetInput(cm,!0),posEq(sel.from,sel.to)&&(display.input.value=display.prevInput=" "),ie&&!ie_lt9&&prepareSelectAllHack(),captureMiddleClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup),setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else setTimeout(rehide,50)}}}}function clipPostChange(doc,change,pos){if(!posLess(change.from,pos))return clipPos(doc,pos);var diff=change.text.length-1-(change.to.line-change.from.line);if(pos.line>change.to.line+diff){var preLine=pos.line-diff,lastLine=doc.first+doc.size-1;return preLine>lastLine?Pos(lastLine,getLine(doc,lastLine).text.length):clipToLen(pos,getLine(doc,preLine).text.length)}if(pos.line==change.to.line+diff)return clipToLen(pos,lst(change.text).length+(1==change.text.length?change.from.ch:0)+getLine(doc,change.to.line).text.length-change.to.ch);var inside=pos.line-change.from.line;return clipToLen(pos,change.text[inside].length+(inside?0:change.from.ch))}function computeSelAfterChange(doc,change,hint){if(hint&&"object"==typeof hint)return{anchor:clipPostChange(doc,change,hint.anchor),head:clipPostChange(doc,change,hint.head)};if("start"==hint)return{anchor:change.from,head:change.from};var end=changeEnd(change);if("around"==hint)return{anchor:change.from,head:end};if("end"==hint)return{anchor:end,head:end};var adjustPos=function(pos){if(posLess(pos,change.from))return pos;if(!posLess(change.to,pos))return end;var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;return pos.line==change.to.line&&(ch+=end.ch-change.to.ch),Pos(line,ch)};return{anchor:adjustPos(doc.sel.anchor),head:adjustPos(doc.sel.head)}}function filterChange(doc,change,update){var obj={canceled:!1,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){this.canceled=!0}};return update&&(obj.update=function(from,to,text,origin){from&&(this.from=clipPos(doc,from)),to&&(this.to=clipPos(doc,to)),text&&(this.text=text),void 0!==origin&&(this.origin=origin)}),signal(doc,"beforeChange",doc,obj),doc.cm&&signal(doc.cm,"beforeChange",doc.cm,obj),obj.canceled?null:{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,selUpdate,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,selUpdate,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(!((hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"))&&(change=filterChange(doc,change,!0),!change))){var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;1<=i;--i)makeChangeNoReadonly(doc,{from:split[i].from,to:split[i].to,text:[""]});split.length&&makeChangeNoReadonly(doc,{from:split[0].from,to:split[0].to,text:change.text},selUpdate)}else makeChangeNoReadonly(doc,change,selUpdate)}}function makeChangeNoReadonly(doc,change,selUpdate){if(!(1==change.text.length&&""==change.text[0]&&posEq(change.from,change.to))){var selAfter=computeSelAfterChange(doc,change,selUpdate);addToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN),makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}}function makeChangeFromHistory(doc,type){if(!(doc.cm&&doc.cm.state.suppressEdits)){var hist=doc.history,event=("undo"==type?hist.done:hist.undone).pop();if(event){var anti={changes:[],anchorBefore:event.anchorAfter,headBefore:event.headAfter,anchorAfter:event.anchorBefore,headAfter:event.headBefore,generation:hist.generation};("undo"==type?hist.undone:hist.done).push(anti),hist.generation=event.generation||++hist.maxGeneration;for(var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"),i=event.changes.length-1,change;0<=i;--i){if(change=event.changes[i],change.origin=type,filter&&!filterChange(doc,change,!1))return void(("undo"==type?hist.done:hist.undone).length=0);anti.changes.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change,null):{anchor:event.anchorBefore,head:event.headBefore};makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}}}function shiftDoc(doc,distance){function shiftPos(pos){return Pos(pos.line+distance,pos.ch)}doc.first+=distance,doc.cm&&regChange(doc.cm,doc.first,doc.first,distance),doc.sel.head=shiftPos(doc.sel.head),doc.sel.anchor=shiftPos(doc.sel.anchor),doc.sel.from=shiftPos(doc.sel.from),doc.sel.to=shiftPos(doc.sel.to)}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first)return void shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));if(!(change.from.line>doc.lastLine())){if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift),change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();change.to.line>last&&(change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}),change.removed=getBetween(doc,change.from,change.to),selAfter||(selAfter=computeSelAfterChange(doc,change,null)),doc.cm?makeChangeSingleDocInEditor(doc.cm,change,spans,selAfter):updateDoc(doc,change,spans,selAfter)}}function makeChangeSingleDocInEditor(cm,change,spans,selAfter){var doc=cm.doc,display=cm.display,from=change.from,to=change.to,recomputeMaxLength=!1,checkWidthStart=from.line;cm.options.lineWrapping||(checkWidthStart=lineNo(visualLine(doc,getLine(doc,from.line))),doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine)return recomputeMaxLength=!0,!0})),posLess(doc.sel.head,change.from)||posLess(change.to,doc.sel.head)||(cm.curOp.cursorActivity=!0),updateDoc(doc,change,spans,selAfter,estimateHeight(cm)),cm.options.lineWrapping||(doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(doc,line);len>display.maxLineLength&&(display.maxLine=line,display.maxLineLength=len,display.maxLineChanged=!0,recomputeMaxLength=!1)}),recomputeMaxLength&&(cm.curOp.updateMaxLine=!0)),doc.frontier=_Mathmin(doc.frontier,from.line),startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;if(regChange(cm,from.line,to.line+1,lendiff),hasHandler(cm,"change")){var changeObj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(cm.curOp.textChanged){for(var cur=cm.curOp.textChanged;cur.next;cur=cur.next);cur.next=changeObj}else cm.curOp.textChanged=changeObj}}function replaceRange(doc,code,from,to,origin){if(to||(to=from),posLess(to,from)){var tmp=to;to=from,from=tmp}"string"==typeof code&&(code=splitLines(code)),makeChange(doc,{from:from,to:to,text:code,origin:origin},null)}function Pos(line,ch){return this instanceof Pos?void(this.line=line,this.ch=ch):new Pos(line,ch)}function posEq(a,b){return a.line==b.line&&a.ch==b.ch}function posLess(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function copyPos(x){return Pos(x.line,x.ch)}function clipLine(doc,n){return _Mathmax(doc.first,_Mathmin(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;return pos.line>last?Pos(last,getLine(doc,last).text.length):clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;return null==ch||ch>linelen?Pos(pos.line,linelen):0>ch?Pos(pos.line,0):pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function extendSelection(doc,pos,other,bias){if(doc.sel.shift||doc.sel.extend){var anchor=doc.sel.anchor;if(other){var posBefore=posLess(pos,anchor);posBefore==posLess(other,anchor)?posBefore!=posLess(pos,other)&&(pos=other):(anchor=pos,pos=other)}setSelection(doc,anchor,pos,bias)}else setSelection(doc,pos,other||pos,bias);doc.cm&&(doc.cm.curOp.userSelChange=!0)}function filterSelectionChange(doc,anchor,head){var obj={anchor:anchor,head:head};return signal(doc,"beforeSelectionChange",doc,obj),doc.cm&&signal(doc.cm,"beforeSelectionChange",doc.cm,obj),obj.anchor=clipPos(doc,obj.anchor),obj.head=clipPos(doc,obj.head),obj}function setSelection(doc,anchor,head,bias,checkAtomic){if(!checkAtomic&&hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange")){var filtered=filterSelectionChange(doc,anchor,head);head=filtered.head,anchor=filtered.anchor}var sel=doc.sel;if(sel.goalColumn=null,null==bias&&(bias=posLess(head,sel.head)?-1:1),(checkAtomic||!posEq(anchor,sel.anchor))&&(anchor=skipAtomic(doc,anchor,bias,"push"!=checkAtomic)),(checkAtomic||!posEq(head,sel.head))&&(head=skipAtomic(doc,head,bias,"push"!=checkAtomic)),!(posEq(sel.anchor,anchor)&&posEq(sel.head,head))){sel.anchor=anchor,sel.head=head;var inv=posLess(head,anchor);sel.from=inv?head:anchor,sel.to=inv?anchor:head,doc.cm&&(doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=doc.cm.curOp.cursorActivity=!0),signalLater(doc,"cursorActivity",doc)}}function reCheckSelection(cm){setSelection(cm.doc,cm.doc.sel.from,cm.doc.sel.to,null,"push")}function skipAtomic(doc,pos,bias,mayClear){var flipped=!1,curPos=pos,dir=bias||1;doc.cantEdit=!1;search:for(;;){var line=getLine(doc,curPos.line);if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((null==sp.from||(m.inclusiveLeft?sp.from<=curPos.ch:sp.from<curPos.ch))&&(null==sp.to||(m.inclusiveRight?sp.to>=curPos.ch:sp.to>curPos.ch))){if(mayClear&&(signal(m,"beforeCursorEnter"),m.explicitlyCleared))if(!line.markedSpans)break;else{--i;continue}if(!m.atomic)continue;var newPos=m.find()[0>dir?"from":"to"];if(posEq(newPos,curPos)&&(newPos.ch+=dir,0>newPos.ch?newPos.line>doc.first?newPos=clipPos(doc,Pos(newPos.line-1)):newPos=null:newPos.ch>line.text.length&&(newPos.line<doc.first+doc.size-1?newPos=Pos(newPos.line+1,0):newPos=null),!newPos)){if(flipped)return mayClear?(doc.cantEdit=!0,Pos(doc.first,0)):skipAtomic(doc,pos,bias,!0);flipped=!0,newPos=pos,dir=-dir}curPos=newPos;continue search}}return curPos}}function scrollCursorIntoView(cm){var coords=scrollPosIntoView(cm,cm.doc.sel.head,null,cm.options.cursorScrollMargin);if(cm.state.focused){var display=cm.display,box=getRect(display.sizer),doScroll=null;if(0>coords.top+box.top?doScroll=!0:coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight)&&(doScroll=!1),null!=doScroll&&!phantom){var hidden="none"==display.cursor.style.display;hidden&&(display.cursor.style.display="",display.cursor.style.left=coords.left+"px",display.cursor.style.top=coords.top-display.viewOffset+"px"),display.cursor.scrollIntoView(doScroll),hidden&&(display.cursor.style.display="none")}}}function scrollPosIntoView(cm,pos,end,margin){for(null==margin&&(margin=0);;){var changed=!1,coords=cursorCoords(cm,pos),endCoords=end&&end!=pos?cursorCoords(cm,end):coords,scrollPos=calculateScrollPos(cm,_Mathmin(coords.left,endCoords.left),_Mathmin(coords.top,endCoords.top)-margin,_Mathmax(coords.left,endCoords.left),_Mathmax(coords.bottom,endCoords.bottom)+margin),startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(null!=scrollPos.scrollTop&&(setScrollTop(cm,scrollPos.scrollTop),1<_Mathabs(cm.doc.scrollTop-startTop)&&(changed=!0)),null!=scrollPos.scrollLeft&&(setScrollLeft(cm,scrollPos.scrollLeft),1<_Mathabs(cm.doc.scrollLeft-startLeft)&&(changed=!0)),!changed)return coords}}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);null!=scrollPos.scrollTop&&setScrollTop(cm,scrollPos.scrollTop),null!=scrollPos.scrollLeft&&setScrollLeft(cm,scrollPos.scrollLeft)}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);0>y1&&(y1=0);var screen=display.scroller.clientHeight-scrollerCutOff,screentop=display.scroller.scrollTop,result={},docBottom=cm.doc.height+paddingVert(display),atTop=y1<snapMargin;if(y1<screentop)result.scrollTop=atTop?0:y1;else if(y2>screentop+screen){var newTop=_Mathmin(y1,(y2>docBottom-snapMargin?docBottom:y2)-screen);newTop!=screentop&&(result.scrollTop=newTop)}var screenw=display.scroller.clientWidth-scrollerCutOff,screenleft=display.scroller.scrollLeft;x1+=display.gutters.offsetWidth,x2+=display.gutters.offsetWidth;var gutterw=display.gutters.offsetWidth,atLeft=x1<gutterw+10;return x1<screenleft+gutterw||atLeft?(atLeft&&(x1=0),result.scrollLeft=_Mathmax(0,x1-10-gutterw)):x2>screenw+screenleft-3&&(result.scrollLeft=x2+10-screenw),result}function updateScrollPos(cm,left,top){cm.curOp.updateScrollPos={scrollLeft:null==left?cm.doc.scrollLeft:left,scrollTop:null==top?cm.doc.scrollTop:top}}function addToScrollPos(cm,left,top){var pos=cm.curOp.updateScrollPos||(cm.curOp.updateScrollPos={scrollLeft:cm.doc.scrollLeft,scrollTop:cm.doc.scrollTop}),scroll=cm.display.scroller;pos.scrollTop=_Mathmax(0,_Mathmin(scroll.scrollHeight-scroll.clientHeight,pos.scrollTop+top)),pos.scrollLeft=_Mathmax(0,_Mathmin(scroll.scrollWidth-scroll.clientWidth,pos.scrollLeft+left))}function indentLine(cm,n,how,aggressive){var doc=cm.doc;if(null==how&&(how="add"),"smart"==how)if(!cm.doc.mode.indent)how="prev";else var state=getStateBefore(cm,n);var tabSize=cm.options.tabSize,line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize),curSpaceString=line.text.match(/^\s*/)[0],indentation;if("smart"==how&&(indentation=cm.doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text),indentation==Pass)){if(!aggressive)return;how="prev"}"prev"==how?n>doc.first?indentation=countColumn(getLine(doc,n-1).text,null,tabSize):indentation=0:"add"==how?indentation=curSpace+cm.options.indentUnit:"subtract"==how?indentation=curSpace-cm.options.indentUnit:"number"==typeof how&&(indentation=curSpace+how),indentation=_Mathmax(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs)for(var i=_Mathfloor(indentation/tabSize);i;--i)pos+=tabSize,indentString+="\t";pos<indentation&&(indentString+=spaceStr(indentation-pos)),indentString==curSpaceString?doc.sel.head.line==n&&doc.sel.head.ch<curSpaceString.length&&setSelection(doc,Pos(n,curSpaceString.length),Pos(n,curSpaceString.length),1):replaceRange(cm.doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input"),line.stateAfter=null}function changeLine(cm,handle,op){var no=handle,line=handle,doc=cm.doc;if("number"==typeof handle?line=getLine(doc,clipLine(doc,handle)):no=lineNo(handle),null==no)return null;if(op(line,no))regChange(cm,no,no+1);else return null;return line}function findPosH(doc,pos,dir,unit,visually){function findNextLine(){var l=line+dir;return l<doc.first||l>=doc.first+doc.size?possible=!1:(line=l,lineObj=getLine(doc,l))}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,!0);if(null!=next)ch=next;else if(!boundToLine&&findNextLine())ch=visually?(0>dir?lineRight:lineLeft)(lineObj):0>dir?lineObj.text.length:0;else return possible=!1;return!0}var line=pos.line,ch=pos.ch,origDir=dir,lineObj=getLine(doc,line),possible=!0;if("char"==unit)moveOnce();else if("column"==unit)moveOnce(!0);else if("word"==unit||"group"==unit)for(var sawType=null,first=!0;;first=!1){if(0>dir&&!moveOnce(!first))break;var cur=lineObj.text.charAt(ch)||"\n",type=isWordChar(cur)?"w":"group"==unit?/\s/.test(cur)?null:"p":null;if(sawType&&sawType!=type){0>dir&&(dir=1,moveOnce());break}if(type&&(sawType=type),0<dir&&!moveOnce(!first))break}var result=skipAtomic(doc,Pos(line,ch),origDir,!0);return possible||(result.hitSide=!0),result}function findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if("page"==unit){var pageSize=_Mathmin(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(0>dir?1.5:.5)*textHeight(cm.display))}else"line"==unit&&(y=0<dir?pos.bottom+3:pos.top-3);for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(0>dir?0>=y:y>=doc.height){target.hitSide=!0;break}y+=5*dir}return target}function findWordAt(line,pos){var start=pos.ch,end=pos.ch;if(line){(0>pos.xRel||end==line.length)&&start?--start:++end;for(var startChar=line.charAt(start),check=isWordChar(startChar)?isWordChar:/\s/.test(startChar)?function(ch){return /\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch)};0<start&&check(line.charAt(start-1));)--start;for(;end<line.length&&check(line.charAt(end));)++end}return{from:Pos(pos.line,start),to:Pos(pos.line,end)}}function selectLine(cm,line){extendSelection(cm.doc,Pos(line,0),clipPos(cm.doc,Pos(line+1,0)))}function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt,handle&&(optionHandlers[name]=notOnInit?function(cm,val,old){old!=Init&&handle(cm,val,old)}:handle)}function copyState(mode,state){if(!0===state)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];val instanceof Array&&(val=val.concat([])),nstate[n]=val}return nstate}function startState(mode,a1,a2){return!mode.startState||mode.startState(a1,a2)}function getKeyMap(val){return"string"==typeof val?keyMap[val]:val}function lookupKey(name,maps,handle){function lookup(map){map=getKeyMap(map);var found=map[name];if(!1===found)return"stop";if(null!=found&&handle(found))return!0;if(map.nofallthrough)return"stop";var fallthrough=map.fallthrough;if(null==fallthrough)return!1;if("[object Array]"!=Object.prototype.toString.call(fallthrough))return lookup(fallthrough);for(var i=0,e=fallthrough.length,done;i<e;++i)if(done=lookup(fallthrough[i]),done)return done;return!1}for(var i=0,done;i<maps.length;++i)if(done=lookup(maps[i]),done)return"stop"!=done}function isModifierKey(event){var name=keyNames[event.keyCode];return"Ctrl"==name||"Alt"==name||"Shift"==name||"Mod"==name}function keyName(event,noShift){if(opera&&34==event.keyCode&&event.char)return!1;var name=keyNames[event.keyCode];return!(null==name||event.altGraphKey)&&(event.altKey&&(name="Alt-"+name),(flipCtrlCmd?event.metaKey:event.ctrlKey)&&(name="Ctrl-"+name),(flipCtrlCmd?event.ctrlKey:event.metaKey)&&(name="Cmd-"+name),!noShift&&event.shiftKey&&(name="Shift-"+name),name)}function StringStream(string,tabSize){this.pos=this.start=0,this.string=string,this.tabSize=tabSize||8,this.lastColumnPos=this.lastColumnValue=0}function TextMarker(doc,type){this.lines=[],this.type=type,this.doc=doc}function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type);if(posLess(to,from)||posEq(from,to)&&"range"==type&&!(options.inclusiveLeft&&options.inclusiveRight))return marker;options&&copyObj(options,marker),marker.replacedWith&&(marker.collapsed=!0,marker.replacedWith=elt("span",[marker.replacedWith],"CodeMirror-widget"),!options.handleMouseEvents&&(marker.replacedWith.ignoreEvents=!0)),marker.collapsed&&(sawCollapsedSpans=!0),marker.addToHistory&&addToHistory(doc,{from:from,to:to,origin:"markText"},{head:doc.sel.head,anchor:doc.sel.anchor},NaN);var curLine=from.line,size=0,cm=doc.cm,collapsedAtStart,collapsedAtEnd,updateMaxLine;if(doc.iter(curLine,to.line+1,function(line){cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(doc,line)==cm.display.maxLine&&(updateMaxLine=!0);var span={from:null,to:null,marker:marker};size+=line.text.length,curLine==from.line&&(span.from=from.ch,size-=from.ch),curLine==to.line&&(span.to=to.ch,size-=line.text.length-to.ch),marker.collapsed&&(curLine==to.line&&(collapsedAtEnd=collapsedSpanAt(line,to.ch)),curLine==from.line?collapsedAtStart=collapsedSpanAt(line,from.ch):updateLineHeight(line,0)),addMarkedSpan(line,span),++curLine}),marker.collapsed&&doc.iter(from.line,to.line+1,function(line){lineIsHidden(doc,line)&&updateLineHeight(line,0)}),marker.clearOnEnter&&on(marker,"beforeCursorEnter",function(){marker.clear()}),marker.readOnly&&(sawReadOnlySpans=!0,(doc.history.done.length||doc.history.undone.length)&&doc.clearHistory()),marker.collapsed){if(collapsedAtStart!=collapsedAtEnd)throw new Error("Inserting collapsed marker overlapping an existing one");marker.size=size,marker.atomic=!0}return cm&&(updateMaxLine&&(cm.curOp.updateMaxLine=!0),(marker.className||marker.title||marker.startStyle||marker.endStyle||marker.collapsed)&&regChange(cm,from.line,to.line+1),marker.atomic&&reCheckSelection(cm)),marker}function SharedTextMarker(markers,primary){this.markers=markers,this.primary=primary;for(var i=0,me=this;i<markers.length;++i)markers[i].parent=this,on(markers[i],"clear",function(){me.clear()})}function markTextShared(doc,from,to,options,type){options=copyObj(options),options.shared=!1;var markers=[markText(doc,from,to,options,type)],primary=markers[0],widget=options.replacedWith;return linkedDocs(doc,function(doc){widget&&(options.replacedWith=widget.cloneNode(!0)),markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)}),new SharedTextMarker(markers,primary)}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0,span;i<spans.length;++i)if(span=spans[i],span.marker==marker)return span}function removeMarkedSpan(spans,span){for(var i=0,r;i<spans.length;++i)spans[i]!=span&&(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span],span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker,startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||(marker.inclusiveLeft&&marker.inclusiveRight||"bookmark"==marker.type)&&span.from==startCh&&(!isInsert||!span.marker.insertLeft)){var endsAfter=null==span.to||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push({from:span.from,to:endsAfter?null:span.to,marker:marker})}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker,endsAfter=null==span.to||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||"bookmark"==marker.type&&span.from==endCh&&(!isInsert||span.marker.insertLeft)){var startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push({from:startsBefore?null:span.from-endCh,to:null==span.to?null:span.to-endCh,marker:marker})}}return nw}function stretchSpansOverChange(doc,change){var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans,oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=posEq(change.from,change.to),first=markedSpansBefore(oldFirst,startCh,isInsert),last=markedSpansAfter(oldLast,endCh,isInsert),sameLine=1==change.text.length,offset=lst(change.text).length+(sameLine?startCh:0);if(first)for(var i=0,span;i<first.length;++i)if(span=first[i],null==span.to){var found=getMarkedSpanFor(last,span.marker);found?sameLine&&(span.to=null==found.to?null:found.to+offset):span.to=startCh}if(last)for(var i=0,span;i<last.length;++i)if(span=last[i],null!=span.to&&(span.to+=offset),null==span.from){var found=getMarkedSpanFor(first,span.marker);found||(span.from=offset,sameLine&&(first||(first=[])).push(span))}else span.from+=offset,sameLine&&(first||(first=[])).push(span);if(sameLine&&first){for(var i=0;i<first.length;++i)null!=first[i].from&&first[i].from==first[i].to&&"bookmark"!=first[i].marker.type&&first.splice(i--,1);first.length||(first=null)}var newMarkers=[first];if(!sameLine){var gap=change.text.length-2,gapMarkers;if(0<gap&&first)for(var i=0;i<first.length;++i)null==first[i].to&&(gapMarkers||(gapMarkers=[])).push({from:null,to:null,marker:first[i].marker});for(var i=0;i<gap;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change),stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur)spans:for(var j=0,span;j<stretchCur.length;++j){span=stretchCur[j];for(var k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}else stretchCur&&(old[i]=stretchCur)}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;if(doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0,mark;i<line.markedSpans.length;++i)mark=line.markedSpans[i].marker,mark.readOnly&&(!markers||-1==indexOf(markers,mark))&&(markers||(markers=[])).push(mark)}),!markers)return null;for(var parts=[{from:from,to:to}],i=0;i<markers.length;++i)for(var mk=markers[i],m=mk.find(),j=0,p;j<parts.length;++j)if(p=parts[j],!(posLess(p.to,m.from)||posLess(m.to,p.from))){var newParts=[j,1];(posLess(p.from,m.from)||!mk.inclusiveLeft&&posEq(p.from,m.from))&&newParts.push({from:p.from,to:m.from}),(posLess(m.to,p.to)||!mk.inclusiveRight&&posEq(p.to,m.to))&&newParts.push({from:m.to,to:p.to}),parts.splice.apply(parts,newParts),j+=newParts.length-1}return parts}function collapsedSpanAt(line,ch){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps)for(var i=0,sp;i<sps.length;++i)sp=sps[i],sp.marker.collapsed&&(null==sp.from||sp.from<ch)&&(null==sp.to||sp.to>ch)&&(!found||found.width<sp.marker.width)&&(found=sp.marker);return found}function collapsedSpanAtStart(line){return collapsedSpanAt(line,-1)}function collapsedSpanAtEnd(line){return collapsedSpanAt(line,line.text.length+1)}function visualLine(doc,line){for(var merged;merged=collapsedSpanAtStart(line);)line=getLine(doc,merged.find().from.line);return line}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var i=0,sp;i<sps.length;++i)if(sp=sps[i],sp.marker.collapsed){if(null==sp.from)return!0;if(!sp.marker.replacedWith&&0==sp.from&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return!0}}function lineIsHiddenInner(doc,line,span){if(null==span.to){var end=span.marker.find().to,endLine=getLine(doc,end.line);return lineIsHiddenInner(doc,endLine,getMarkedSpanFor(endLine.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return!0;for(var i=0,sp;i<line.markedSpans.length;++i)if(sp=line.markedSpans[i],sp.marker.collapsed&&!sp.marker.replacedWith&&sp.from==span.to&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return!0}function detachMarkedSpans(line){var spans=line.markedSpans;if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}}function attachMarkedSpans(line,spans){if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}}function widgetOperation(f){return function(){var withOp=!this.cm.curOp;withOp&&startOperation(this.cm);try{var result=f.apply(this,arguments)}finally{withOp&&endOperation(this.cm)}return result}}function widgetHeight(widget){return null==widget.height?(widget.node.parentNode&&1==widget.node.parentNode.nodeType||removeChildrenAndAdd(widget.cm.display.measure,elt("div",[widget.node],null,"position: relative")),widget.height=widget.node.offsetHeight):widget.height}function addLineWidget(cm,handle,node,options){var widget=new LineWidget(cm,node,options);return widget.noHScroll&&(cm.display.alignWidgets=!0),changeLine(cm,handle,function(line){var widgets=line.widgets||(line.widgets=[]);if(null==widget.insertAt?widgets.push(widget):widgets.splice(_Mathmin(widgets.length-1,_Mathmax(0,widget.insertAt)),0,widget),widget.line=line,!lineIsHidden(cm.doc,line)||widget.showIfHidden){var aboveVisible=heightAtLine(cm,line)<cm.doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget)),aboveVisible&&addToScrollPos(cm,0,widget.height)}return!0}),widget}function updateLine(line,text,markedSpans,estimateHeight){line.text=text,line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null),null!=line.order&&(line.order=null),detachMarkedSpans(line),attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;estHeight!=line.height&&updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null,detachMarkedSpans(line)}function runMode(cm,text,mode,state,f,forceToEnd){var flattenSpans=mode.flattenSpans;null==flattenSpans&&(flattenSpans=cm.options.flattenSpans);var curStart=0,curStyle=null,stream=new StringStream(text,cm.options.tabSize),style;for(""==text&&mode.blankLine&&mode.blankLine(state);!stream.eol();)stream.pos>cm.options.maxHighlightLength?(flattenSpans=!1,forceToEnd&&processLine(cm,text,state,stream.pos),stream.pos=text.length,style=null):style=mode.token(stream,state),flattenSpans&&curStyle==style||(curStart<stream.start&&f(stream.start,curStyle),curStart=stream.start,curStyle=style),stream.start=stream.pos;for(;curStart<stream.pos;){var pos=_Mathmin(stream.pos,curStart+5e4);f(pos,curStyle),curStart=pos}}function highlightLine(cm,line,state,forceToEnd){var st=[cm.state.modeGen];runMode(cm,line.text,cm.doc.mode,state,function(end,style){st.push(end,style)},forceToEnd);for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1,at=0;runMode(cm,line.text,overlay.mode,!0,function(end,style){for(var start=i,i_end;at<end;)i_end=st[i],i_end>end&&st.splice(i,1,end,st[i+1],i_end),i+=2,at=_Mathmin(end,i_end);if(style)if(overlay.opaque)st.splice(start,i-start,end,style),i=start+2;else for(;start<i;start+=2){var cur=st[start+1];st[start+1]=cur?cur+" "+style:style}})}return st}function getLineStyles(cm,line){return line.styles&&line.styles[0]==cm.state.modeGen||(line.styles=highlightLine(cm,line,line.stateAfter=getStateBefore(cm,lineNo(line)))),line.styles}function processLine(cm,text,state,startAt){var mode=cm.doc.mode,stream=new StringStream(text,cm.options.tabSize);for(stream.start=stream.pos=startAt||0,""==text&&mode.blankLine&&mode.blankLine(state);!stream.eol()&&stream.pos<=cm.options.maxHighlightLength;)mode.token(stream,state),stream.start=stream.pos}function interpretTokenStyle(style,builder){if(!style)return null;for(;;){var lineClass=style.match(/(?:^|\s)line-(background-)?(\S+)/);if(!lineClass)break;style=style.slice(0,lineClass.index)+style.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";null==builder[prop]?builder[prop]=lineClass[2]:!new RegExp("(?:^|s)"+lineClass[2]+"(?:$|s)").test(builder[prop])&&(builder[prop]+=" "+lineClass[2])}return styleToClassCache[style]||(styleToClassCache[style]="cm-"+style.replace(/ +/g," cm-"))}function buildLineContent(cm,realLine,measure,copyWidgets){for(var line=realLine,empty=!0,merged;merged=collapsedSpanAtStart(line);)line=getLine(cm.doc,merged.find().from.line);var builder={pre:elt("pre"),col:0,pos:0,measure:null,measuredSomething:!1,cm:cm,copyWidgets:copyWidgets};do{line.text&&(empty=!1),builder.measure=line==realLine&&measure,builder.pos=0,builder.addToken=builder.measure?buildTokenMeasure:buildToken,(ie||webkit)&&cm.getOption("lineWrapping")&&(builder.addToken=buildTokenSplitSpaces(builder.addToken));var next=insertLineContent(line,builder,getLineStyles(cm,line));measure&&line==realLine&&!builder.measuredSomething&&(measure[0]=builder.pre.appendChild(zeroWidthElement(cm.display.measure)),builder.measuredSomething=!0),next&&(line=getLine(cm.doc,next.to.line))}while(next);!measure||builder.measuredSomething||measure[0]||(measure[0]=builder.pre.appendChild(empty?elt("span","\xA0"):zeroWidthElement(cm.display.measure))),builder.pre.firstChild||lineIsHidden(cm.doc,realLine)||builder.pre.appendChild(document.createTextNode("\xA0"));var order;if(measure&&(ie||ie_gt10)&&(order=getOrder(line))){var l=order.length-1;order[l].from==order[l].to&&--l;var last=order[l],prev=order[l-1];if(last.from+1==last.to&&prev&&last.level<prev.level){var span=measure[builder.pos-1];span&&span.parentNode.insertBefore(span.measureRight=zeroWidthElement(cm.display.measure),span.nextSibling)}}var textClass=builder.textClass?builder.textClass+" "+(realLine.textClass||""):realLine.textClass;return textClass&&(builder.pre.className=textClass),signal(cm,"renderLine",cm,realLine,builder.pre),builder}function buildToken(builder,text,style,startStyle,endStyle,title){if(text){var special=builder.cm.options.specialChars;if(!special.test(text)){builder.col+=text.length;var content=document.createTextNode(text)}else for(var content=document.createDocumentFragment(),pos=0;;){special.lastIndex=pos;var m=special.exec(text),skipped=m?m.index-pos:text.length-pos;if(skipped&&(content.appendChild(document.createTextNode(text.slice(pos,pos+skipped))),builder.col+=skipped),!m)break;if(pos+=skipped+1,"\t"==m[0]){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab")),builder.col+=tabWidth}else{var token=builder.cm.options.specialCharPlaceholder(m[0]);content.appendChild(token),builder.col+=1}}if(style||startStyle||endStyle||builder.measure){var fullStyle=style||"";startStyle&&(fullStyle+=startStyle),endStyle&&(fullStyle+=endStyle);var token=elt("span",[content],fullStyle);return title&&(token.title=title),builder.pre.appendChild(token)}builder.pre.appendChild(content)}}function buildTokenMeasure(builder,text,style,startStyle,endStyle){for(var wrapping=builder.cm.options.lineWrapping,i=0;i<text.length;++i){var ch=text.charAt(i),start=0==i;"\uD800"<=ch&&"\uDBFF">ch&&i<text.length-1?(ch=text.slice(i,i+2),++i):i&&wrapping&&spanAffectsWrapping(text,i)&&builder.pre.appendChild(elt("wbr"));var old=builder.measure[builder.pos],span=builder.measure[builder.pos]=buildToken(builder,ch,style,start&&startStyle,i==text.length-1&&endStyle);old&&(span.leftSide=old.leftSide||old),ie&&wrapping&&" "==ch&&i&&!/\s/.test(text.charAt(i-1))&&i<text.length-1&&!/\s/.test(text.charAt(i+1))&&(span.style.whiteSpace="normal"),builder.pos+=ch.length}text.length&&(builder.measuredSomething=!0)}function buildTokenSplitSpaces(inner){function split(old){for(var out=" ",i=0;i<old.length-2;++i)out+=i%2?" ":"\xA0";return out+=" ",out}return function(builder,text,style,startStyle,endStyle,title){return inner(builder,text.replace(/ {3,}/g,split),style,startStyle,endStyle,title)}}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.replacedWith;if(widget&&(builder.copyWidgets&&(widget=widget.cloneNode(!0)),builder.pre.appendChild(widget),builder.measure)){if(size)builder.measure[builder.pos]=widget;else{var elt=zeroWidthElement(builder.cm.display.measure);if("bookmark"==marker.type&&!marker.insertLeft)builder.measure[builder.pos]=builder.pre.appendChild(elt);else{if(builder.measure[builder.pos])return;builder.measure[builder.pos]=builder.pre.insertBefore(elt,widget)}}builder.measuredSomething=!0}builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(!spans){for(var i=1;i<styles.length;i+=2)builder.addToken(builder,allText.slice(at,at=styles[i]),interpretTokenStyle(styles[i+1],builder));return}for(var len=allText.length,pos=0,i=1,text="",nextChange=0,style,spanStyle,spanEndStyle,spanStartStyle,title,collapsed;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=title="",collapsed=null,nextChange=Infinity;for(var foundBookmarks=[],j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;sp.from<=pos&&(null==sp.to||sp.to>pos)?(null!=sp.to&&nextChange>sp.to&&(nextChange=sp.to,spanEndStyle=""),m.className&&(spanStyle+=" "+m.className),m.startStyle&&sp.from==pos&&(spanStartStyle+=" "+m.startStyle),m.endStyle&&sp.to==nextChange&&(spanEndStyle+=" "+m.endStyle),m.title&&!title&&(title=m.title),m.collapsed&&(!collapsed||collapsed.marker.size<m.size)&&(collapsed=sp)):sp.from>pos&&nextChange>sp.from&&(nextChange=sp.from),"bookmark"==m.type&&sp.from==pos&&m.replacedWith&&foundBookmarks.push(m)}if(collapsed&&(collapsed.from||0)==pos&&(buildCollapsedSpan(builder,(null==collapsed.to?len:collapsed.to)-pos,collapsed.marker,null==collapsed.from),null==collapsed.to))return collapsed.marker.find();if(!collapsed&&foundBookmarks.length)for(var j=0;j<foundBookmarks.length;++j)buildCollapsedSpan(builder,0,foundBookmarks[j])}if(pos>=len)break;for(var upto=_Mathmin(len,nextChange);;){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",title)}if(end>=upto){text=text.slice(upto-pos),pos=upto;break}pos=end,spanStartStyle=""}text=allText.slice(at,at=styles[i++]),style=interpretTokenStyle(styles[i++],builder)}}}function updateDoc(doc,change,markedSpans,selAfter,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight),signalLater(line,"change",line,change)}var from=change.from,to=change.to,text=change.text,firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line),lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(0==from.ch&&0==to.ch&&""==lastText&&(!doc.cm||doc.cm.options.wholeLineUpdateBefore)){for(var i=0,e=text.length-1,added=[];i<e;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));update(lastLine,lastLine.text,lastSpans),nlines&&doc.remove(from.line,nlines),added.length&&doc.insert(from.line,added)}else if(firstLine==lastLine){if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans);else{for(var added=[],i=1,e=text.length-1;i<e;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));added.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight)),update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),doc.insert(from.line+1,added)}}else if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0)),doc.remove(from.line+1,nlines);else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);for(var i=1,e=text.length-1,added=[];i<e;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));1<nlines&&doc.remove(from.line+1,nlines-1),doc.insert(from.line+1,added)}signalLater(doc,"change",doc,change),setSelection(doc,selAfter.anchor,selAfter.head,null,!0)}function LeafChunk(lines){this.lines=lines,this.parent=null;for(var i=0,e=lines.length,height=0;i<e;++i)lines[i].parent=this,height+=lines[i].height;this.height=height}function BranchChunk(children){this.children=children;for(var size=0,height=0,i=0,e=children.length,ch;i<e;++i)ch=children[i],size+=ch.chunkSize(),height+=ch.height,ch.parent=this;this.size=size,this.height=height,this.parent=null}function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0,rel;i<doc.linked.length;++i)if(rel=doc.linked[i],rel.doc!=skip){var shared=sharedHist&&rel.sharedHist;sharedHistOnly&&!shared||(f(rel.doc,shared),propagate(rel.doc,doc,shared))}}propagate(doc,null,!0)}function attachDoc(cm,doc){if(doc.cm)throw new Error("This document is already in use.");cm.doc=doc,doc.cm=cm,estimateLineHeights(cm),loadMode(cm),cm.options.lineWrapping||computeMaxLength(cm),cm.options.mode=doc.modeOption,regChange(cm)}function getLine(chunk,n){for(n-=chunk.first;!chunk.lines;)for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break}n-=sz}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;return doc.iter(start.line,end.line+1,function(line){var text=line.text;n==end.line&&(text=text.slice(0,end.ch)),n==start.line&&(text=text.slice(start.ch)),out.push(text),++n}),out}function getLines(doc,from,to){var out=[];return doc.iter(from,to,function(line){out.push(line.text)}),out}function updateLineHeight(line,height){for(var diff=height-line.height,n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(null==line.parent)return null;for(var cur=line.parent,no=indexOf(cur.lines,line),chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent)for(var i=0;;++i){if(chunk.children[i]==cur)break;no+=chunk.children[i].chunkSize()}return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0,e=chunk.children.length;i<e;++i){var child=chunk.children[i],ch=child.height;if(h<ch){chunk=child;continue outer}h-=ch,n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0,e=chunk.lines.length;i<e;++i){var line=chunk.lines[i],lh=line.height;if(h<lh)break;h-=lh}return n+i}function heightAtLine(cm,lineObj){lineObj=visualLine(cm.doc,lineObj);for(var h=0,chunk=lineObj.parent,i=0,line;i<chunk.lines.length&&(line=chunk.lines[i],line!=lineObj);++i)h+=line.height;for(var p=chunk.parent;p;chunk=p,p=chunk.parent)for(var i=0,cur;i<p.children.length&&(cur=p.children[i],cur!=chunk);++i)h+=cur.height;return h}function getOrder(line){var order=line.order;return null==order&&(order=line.order=bidiOrdering(line.text)),order}function makeHistory(startGen){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,generation:startGen||1,maxGeneration:startGen||1}}function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(_Mathmax(doc.first,from),_Mathmin(doc.first+doc.size,to),function(line){line.markedSpans&&((existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans),++n})}function historyChangeFromChange(doc,change){var from={line:change.from.line,ch:change.from.ch},histChange={from:from,to:changeEnd(change),text:getBetween(doc,change.from,change.to)};return attachLocalSpans(doc,histChange,change.from.line,change.to.line+1),linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},!0),histChange}function addToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date,cur=lst(hist.done);if(cur&&(hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&("+"==change.origin.charAt(0)&&doc.cm&&hist.lastTime>time-doc.cm.options.historyEventDelay||"*"==change.origin.charAt(0)))){var last=lst(cur.changes);posEq(change.from,change.to)&&posEq(change.from,last.to)?last.to=changeEnd(change):cur.changes.push(historyChangeFromChange(doc,change)),cur.anchorAfter=selAfter.anchor,cur.headAfter=selAfter.head}else for(cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation,anchorBefore:doc.sel.anchor,headBefore:doc.sel.head,anchorAfter:selAfter.anchor,headAfter:selAfter.head},hist.done.push(cur),hist.generation=++hist.maxGeneration;hist.done.length>hist.undoDepth;)hist.done.shift();hist.lastTime=time,hist.lastOp=opId,hist.lastOrigin=change.origin}function removeClearedSpans(spans){if(!spans)return null;for(var i=0,out;i<spans.length;++i)spans[i].marker.explicitlyCleared?out||(out=spans.slice(0,i)):out&&out.push(spans[i]);return out?out.length?out:null:spans}function getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup){for(var i=0,copy=[];i<events.length;++i){var event=events[i],changes=event.changes,newChanges=[];copy.push({changes:newChanges,anchorBefore:event.anchorBefore,headBefore:event.headBefore,anchorAfter:event.anchorAfter,headAfter:event.headAfter});for(var j=0;j<changes.length;++j){var change=changes[j],m;if(newChanges.push({from:change.from,to:change.to,text:change.text}),newGroup)for(var prop in change)(m=prop.match(/^spans_(\d+)$/))&&-1<indexOf(newGroup,+m[1])&&(lst(newChanges)[prop]=change[prop],delete change[prop])}}return copy}function rebaseHistSel(pos,from,to,diff){to<pos.line?pos.line+=diff:from<pos.line&&(pos.line=from,pos.ch=0)}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){for(var sub=array[i],ok=!0,j=0,cur;j<sub.changes.length;++j)if(cur=sub.changes[j],sub.copied||(cur.from=copyPos(cur.from),cur.to=copyPos(cur.to)),to<cur.from.line)cur.from.line+=diff,cur.to.line+=diff;else if(from<=cur.to.line){ok=!1;break}sub.copied||(sub.anchorBefore=copyPos(sub.anchorBefore),sub.headBefore=copyPos(sub.headBefore),sub.anchorAfter=copyPos(sub.anchorAfter),sub.readAfter=copyPos(sub.headAfter),sub.copied=!0),ok?(rebaseHistSel(sub.anchorBefore),rebaseHistSel(sub.headBefore),rebaseHistSel(sub.anchorAfter),rebaseHistSel(sub.headAfter)):(array.splice(0,i+1),i=0)}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff),rebaseHistArray(hist.undone,from,to,diff)}function stopMethod(){e_stop(this)}function addStop(event){return event.stop||(event.stop=stopMethod),event}function e_preventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function e_stopPropagation(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function e_defaultPrevented(e){return null==e.defaultPrevented?!1==e.returnValue:e.defaultPrevented}function e_stop(e){e_preventDefault(e),e_stopPropagation(e)}function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;return null==b&&(1&e.button?b=1:2&e.button?b=3:4&e.button&&(b=2)),mac&&e.ctrlKey&&1==b&&(b=3),b}function on(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,!1);else if(emitter.attachEvent)emitter.attachEvent("on"+type,f);else{var map=emitter._handlers||(emitter._handlers={}),arr=map[type]||(map[type]=[]);arr.push(f)}}function off(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,!1);else if(emitter.detachEvent)emitter.detachEvent("on"+type,f);else{var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;for(var i=0;i<arr.length;++i)if(arr[i]==f){arr.splice(i,1);break}}}function signal(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(arr)for(var args=Array.prototype.slice.call(arguments,2),i=0;i<arr.length;++i)arr[i].apply(null,args)}function signalLater(emitter,type){function bnd(f){return function(){f.apply(null,args)}}var arr=emitter._handlers&&emitter._handlers[type];if(arr){var args=Array.prototype.slice.call(arguments,2);delayedCallbacks||(++delayedCallbackDepth,delayedCallbacks=[],setTimeout(fireDelayed,0));for(var i=0;i<arr.length;++i)delayedCallbacks.push(bnd(arr[i]))}}function signalDOMEvent(cm,e,override){return signal(cm,override||e.type,cm,e),e_defaultPrevented(e)||e.codemirrorIgnore}function fireDelayed(){--delayedCallbackDepth;var delayed=delayedCallbacks;delayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function hasHandler(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];return arr&&0<arr.length}function eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f)},ctor.prototype.off=function(type,f){off(this,type,f)}}function Delayed(){this.id=null}function countColumn(string,end,tabSize,startIndex,startValue){null==end&&(end=string.search(/[^\s\u00a0]/),-1==end&&(end=string.length));for(var i=startIndex||0,n=startValue||0;i<end;++i)"\t"==string.charAt(i)?n+=tabSize-n%tabSize:++n;return n}function spaceStr(n){for(;spaceStrs.length<=n;)spaceStrs.push(lst(spaceStrs)+" ");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function selectInput(node){if(ios)node.selectionStart=0,node.selectionEnd=node.value.length;else try{node.select()}catch(_e){}}function indexOf(collection,elt){if(collection.indexOf)return collection.indexOf(elt);for(var i=0,e=collection.length;i<e;++i)if(collection[i]==elt)return i;return-1}function createObj(base,props){function Obj(){}Obj.prototype=base;var inst=new Obj;return props&&copyObj(props,inst),inst}function copyObj(obj,target){for(var prop in target||(target={}),obj)obj.hasOwnProperty(prop)&&(target[prop]=obj[prop]);return target}function emptyArray(size){for(var a=[],i=0;i<size;++i)a.push(void 0);return a}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}function isWordChar(ch){return /\w/.test(ch)||"\x80"<ch&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return!1;return!0}function elt(tag,content,className,style){var e=document.createElement(tag);if(className&&(e.className=className),style&&(e.style.cssText=style),"string"==typeof content)setTextContent(e,content);else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function removeChildren(e){for(var count=e.childNodes.length;0<count;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function setTextContent(e,str){ie_lt9?(e.innerHTML="",e.appendChild(document.createTextNode(str))):e.textContent=str}function getRect(node){return node.getBoundingClientRect()}function spanAffectsWrapping(){return!1}function scrollbarWidth(measure){if(null!=knownScrollbarWidth)return knownScrollbarWidth;var test=elt("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return removeChildrenAndAdd(measure,test),test.offsetWidth&&(knownScrollbarWidth=test.offsetHeight-test.clientHeight),knownScrollbarWidth||0}function zeroWidthElement(measure){if(null==zwspSupported){var test=elt("span","\u200B");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")])),0!=measure.firstChild.offsetHeight&&(zwspSupported=1>=test.offsetWidth&&2<test.offsetHeight&&!ie_lt8)}return zwspSupported?elt("span","\u200B"):elt("span","\xA0",null,"display: inline-block; width: 1px; margin-right: -1px")}function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,"ltr");for(var found=!1,i=0,part;i<order.length;++i)part=order[i],(part.from<to&&part.to>from||from==to&&part.to==from)&&(f(_Mathmax(part.from,from),_Mathmin(part.to,to),1==part.level?"rtl":"ltr"),found=!0);found||f(from,to,"ltr")}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);return order?bidiRight(lst(order)):line.text.length}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN),visual=visualLine(cm.doc,line);visual!=line&&(lineN=lineNo(visual));var order=getOrder(visual),ch=order?order[0].level%2?lineRight(visual):lineLeft(visual):0;return Pos(lineN,ch)}function lineEnd(cm,lineN){for(var merged,line;merged=collapsedSpanAtEnd(line=getLine(cm.doc,lineN));)lineN=merged.find().to.line;var order=getOrder(line),ch=order?order[0].level%2?lineLeft(line):lineRight(line):line.text.length;return Pos(lineN,ch)}function compareBidiLevel(order,a,b){var linedir=order[0].level;return a==linedir||b!=linedir&&a<b}function getBidiPartAt(order,pos){for(var i=0,found,cur;i<order.length;++i){if(cur=order[i],cur.from<pos&&cur.to>pos)return bidiOther=null,i;if(cur.from==pos||cur.to==pos)if(null==found)found=i;else return compareBidiLevel(order,cur.level,order[found].level)?(bidiOther=found,i):(bidiOther=i,found)}return bidiOther=null,found}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do pos+=dir;while(0<pos&&isExtendingChar.test(line.text.charAt(pos)));return pos}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);for(var pos=getBidiPartAt(bidi,start),part=bidi[pos],target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to)return getBidiPartAt(bidi,target)==pos?target:(part=bidi[pos+=dir],0<dir==part.level%2?part.to:part.from);if(part=bidi[pos+=dir],!part)return null;target=0<dir==part.level%2?moveInLine(line,part.to,-1,byUnit):moveInLine(line,part.from,1,byUnit)}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)for(;0<target&&isExtendingChar.test(line.text.charAt(target));)target+=dir;return 0>target||target>line.text.length?null:target}var gecko=/gecko\/\d/i.test(navigator.userAgent),ie=/MSIE \d/.test(navigator.userAgent),ie_lt8=ie&&(null==document.documentMode||8>document.documentMode),ie_lt9=ie&&(null==document.documentMode||9>document.documentMode),ie_gt10=/Trident\/([7-9]|\d{2,})\./.test(navigator.userAgent),webkit=/WebKit\//.test(navigator.userAgent),qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(navigator.userAgent),chrome=/Chrome\//.test(navigator.userAgent),opera=/Opera\//.test(navigator.userAgent),safari=/Apple Computer/.test(navigator.vendor),khtml=/KHTML\//.test(navigator.userAgent),mac_geLion=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),phantom=/PhantomJS/.test(navigator.userAgent),ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),mac=ios||/Mac/.test(navigator.platform),windows=/win/i.test(navigator.platform),opera_version=opera&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);opera_version&&(opera_version=+opera_version[1]),opera_version&&15<=opera_version&&(opera=!1,webkit=!0);var flipCtrlCmd=mac&&(qtwebkit||opera&&(null==opera_version||12.11>opera_version)),captureMiddleClick=gecko||ie&&!ie_lt9,sawReadOnlySpans=!1,sawCollapsedSpans=!1,nextOpId=0,lastDrop=0,wheelSamples=0,wheelPixelsPerUnit=null,measureText,lastClick,lastDoubleClick;ie?wheelPixelsPerUnit=-.53:gecko?wheelPixelsPerUnit=15:chrome?wheelPixelsPerUnit=-.7:safari&&(wheelPixelsPerUnit=-1/3);var lastStoppedKey=null,changeEnd=CodeMirror.changeEnd=function(change){return change.text?Pos(change.from.line+change.text.length-1,lst(change.text).length+(1==change.text.length?change.from.ch:0)):change.to},maybeTransition,detectingSelectAll;CodeMirror.Pos=Pos,CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus(),focusInput(this),fastPoll(this)},setOption:function(option,value){var options=this.options,old=options[option];options[option]==value&&"mode"!=option||(options[option]=value,optionHandlers.hasOwnProperty(option)&&operation(this,optionHandlers[option])(this,value,old))},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](map)},removeKeyMap:function(map){for(var maps=this.state.keyMaps,i=0;i<maps.length;++i)if(maps[i]==map||"string"!=typeof maps[i]&&maps[i].name==map)return maps.splice(i,1),!0},addOverlay:operation(null,function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque}),this.state.modeGen++,regChange(this)}),removeOverlay:operation(null,function(spec){for(var overlays=this.state.overlays,i=0,cur;i<overlays.length;++i)if(cur=overlays[i].modeSpec,cur==spec||"string"==typeof spec&&cur.name==spec)return overlays.splice(i,1),this.state.modeGen++,void regChange(this)}),indentLine:operation(null,function(n,dir,aggressive){"string"!=typeof dir&&"number"!=typeof dir&&(null==dir?dir=this.options.smartIndent?"smart":"prev":dir=dir?"add":"subtract"),isLine(this.doc,n)&&indentLine(this,n,dir,aggressive)}),indentSelection:operation(null,function(how){var sel=this.doc.sel;if(posEq(sel.from,sel.to))return indentLine(this,sel.from.line,how);for(var e=sel.to.line-(sel.to.ch?0:1),i=sel.from.line;i<=e;++i)indentLine(this,i,how)}),getTokenAt:function(pos,precise){var doc=this.doc;pos=clipPos(doc,pos);for(var state=getStateBefore(this,pos.line,precise),mode=this.doc.mode,line=getLine(doc,pos.line),stream=new StringStream(line.text,this.options.tabSize);stream.pos<pos.ch&&!stream.eol();){stream.start=stream.pos;var style=mode.token(stream,state)}return{start:stream.start,end:stream.pos,string:stream.current(),className:style||null,type:style||null,state:state}},getTokenTypeAt:function(pos){pos=clipPos(this.doc,pos);var styles=getLineStyles(this,getLine(this.doc,pos.line)),before=0,after=(styles.length-1)/2,ch=pos.ch;if(0==ch)return styles[2];for(;;){var mid=before+after>>1;if((mid?styles[2*mid-1]:0)>=ch)after=mid;else if(styles[2*mid+1]<ch)before=mid+1;else return styles[2*mid+2]}},getModeAt:function(pos){var mode=this.doc.mode;return mode.innerMode?CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode:mode},getHelper:function(pos,type){if(helpers.hasOwnProperty(type)){var help=helpers[type],mode=this.getModeAt(pos);return mode[type]&&help[mode[type]]||mode.helperType&&help[mode.helperType]||help[mode.name]}},getStateAfter:function(line,precise){var doc=this.doc;return line=clipLine(doc,null==line?doc.first+doc.size-1:line),getStateBefore(this,line+1,precise)},cursorCoords:function(start,mode){var sel=this.doc.sel,pos;return pos=null==start?sel.head:"object"==typeof start?clipPos(this.doc,start):start?sel.from:sel.to,cursorCoords(this,pos,mode||"page")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page")},coordsChar:function(coords,mode){return coords=fromCoordSystem(this,coords,mode||"page"),coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){return height=fromCoordSystem(this,{top:height,left:0},mode||"page").top,lineAtHeight(this.doc,height+this.display.viewOffset)},heightAtLine:function(line,mode){var end=!1,last=this.doc.first+this.doc.size-1;line<this.doc.first?line=this.doc.first:line>last&&(line=last,end=!0);var lineObj=getLine(this.doc,line);return intoCoordSystem(this,getLine(this.doc,line),{top:0,left:0},mode||"page").top+(end?lineObj.height:0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:operation(null,function(line,gutterID,value){return changeLine(this,line,function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});return markers[gutterID]=value,!value&&isEmpty(markers)&&(line.gutterMarkers=null),!0})}),clearGutter:operation(null,function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){line.gutterMarkers&&line.gutterMarkers[gutterID]&&(line.gutterMarkers[gutterID]=null,regChange(cm,i,i+1),isEmpty(line.gutterMarkers)&&(line.gutterMarkers=null)),++i})}),addLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"wrapClass";if(!line[prop])line[prop]=cls;else{if(new RegExp("(?:^|\\s)"+cls+"(?:$|\\s)").test(line[prop]))return!1;line[prop]+=" "+cls}return!0})}),removeLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"wrapClass",cur=line[prop];if(!cur)return!1;if(null==cls)line[prop]=null;else{var found=cur.match(new RegExp("(?:^|\\s+)"+cls+"(?:$|\\s+)"));if(!found)return!1;var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(found.index&&end!=cur.length?" ":"")+cur.slice(end)||null}return!0})}),addLineWidget:operation(null,function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},lineInfo:function(line){if("number"==typeof line){if(!isLine(this.doc,line))return null;var n=line;if(line=getLine(this.doc,line),!line)return null}else{var n=lineNo(line);if(null==n)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;if(node.style.position="absolute",display.sizer.appendChild(node),"over"==vert)top=pos.top;else if("above"==vert||"near"==vert){var vspace=_Mathmax(display.wrapper.clientHeight,this.doc.height),hspace=_Mathmax(display.sizer.clientWidth,display.lineSpace.clientWidth);("above"==vert||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight?top=pos.top-node.offsetHeight:pos.bottom+node.offsetHeight<=vspace&&(top=pos.bottom),left+node.offsetWidth>hspace&&(left=hspace-node.offsetWidth)}node.style.top=top+"px",node.style.left=node.style.right="","right"==horiz?(left=display.sizer.clientWidth-node.offsetWidth,node.style.right="0px"):("left"==horiz?left=0:"middle"==horiz&&(left=(display.sizer.clientWidth-node.offsetWidth)/2),node.style.left=left+"px"),scroll&&scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:operation(null,onKeyDown),execCommand:function(cmd){return commands[cmd](this)},findPosH:function(from,amount,unit,visually){var dir=1;0>amount&&(dir=-1,amount=-amount);for(var i=0,cur=clipPos(this.doc,from);i<amount&&(cur=findPosH(this.doc,cur,dir,unit,visually),!cur.hitSide);++i);return cur},moveH:operation(null,function(dir,unit){var sel=this.doc.sel,pos;pos=sel.shift||sel.extend||posEq(sel.from,sel.to)?findPosH(this.doc,sel.head,dir,unit,this.options.rtlMoveVisually):0>dir?sel.from:sel.to,extendSelection(this.doc,pos,pos,dir)}),deleteH:operation(null,function(dir,unit){var sel=this.doc.sel;posEq(sel.from,sel.to)?replaceRange(this.doc,"",sel.from,findPosH(this.doc,sel.head,dir,unit,!1),"+delete"):replaceRange(this.doc,"",sel.from,sel.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;0>amount&&(dir=-1,amount=-amount);for(var i=0,cur=clipPos(this.doc,from),coords;i<amount&&(coords=cursorCoords(this,cur,"div"),null==x?x=coords.left:coords.left=x,cur=findPosV(this,coords,dir,unit),!cur.hitSide);++i);return cur},moveV:operation(null,function(dir,unit){var sel=this.doc.sel,pos=cursorCoords(this,sel.head,"div");null!=sel.goalColumn&&(pos.left=sel.goalColumn);var target=findPosV(this,pos,dir,unit);"page"==unit&&addToScrollPos(this,0,charCoords(this,target,"div").top-pos.top),extendSelection(this.doc,target,target,dir),sel.goalColumn=pos.left}),toggleOverwrite:function(value){null!=value&&value==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite",""))},hasFocus:function(){return this.state.focused},scrollTo:operation(null,function(x,y){updateScrollPos(this,x,y)}),getScrollInfo:function(){var scroller=this.display.scroller,co=scrollerCutOff;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-co,width:scroller.scrollWidth-co,clientHeight:scroller.clientHeight-co,clientWidth:scroller.clientWidth-co}},scrollIntoView:operation(null,function(range,margin){null==range?range={from:this.doc.sel.head,to:null}:"number"==typeof range?range={from:Pos(range,0),to:null}:null==range.from&&(range={from:range,to:null}),range.to||(range.to=range.from),margin||(margin=0);var coords=range;null!=range.from.line&&(this.curOp.scrollToPos={from:range.from,to:range.to,margin:margin},coords={from:cursorCoords(this,range.from),to:cursorCoords(this,range.to)});var sPos=calculateScrollPos(this,_Mathmin(coords.from.left,coords.to.left),_Mathmin(coords.from.top,coords.to.top)-margin,_Mathmax(coords.from.right,coords.to.right),_Mathmax(coords.from.bottom,coords.to.bottom)+margin);updateScrollPos(this,sPos.scrollLeft,sPos.scrollTop)}),setSize:operation(null,function(width,height){function interpret(val){return"number"==typeof val||/^\d+$/.test(val+"")?val+"px":val}null!=width&&(this.display.wrapper.style.width=interpret(width)),null!=height&&(this.display.wrapper.style.height=interpret(height)),this.options.lineWrapping&&(this.display.measureLineCache.length=this.display.measureLineCachePos=0),this.curOp.forceUpdate=!0}),operation:function(f){return runInOp(this,f)},refresh:operation(null,function(){var badHeight=null==this.display.cachedTextHeight;clearCaches(this),updateScrollPos(this,this.doc.scrollLeft,this.doc.scrollTop),regChange(this),badHeight&&estimateLineHeights(this)}),swapDoc:operation(null,function(doc){var old=this.doc;return old.cm=null,attachDoc(this,doc),clearCaches(this),resetInput(this,!0),updateScrollPos(this,doc.scrollLeft,doc.scrollTop),signalLater(this,"swapDoc",this,old),old}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},eventMixin(CodeMirror);var optionHandlers=CodeMirror.optionHandlers={},defaults=CodeMirror.defaults={},Init=CodeMirror.Init={toString:function(){return"CodeMirror.Init"}};option("value","",function(cm,val){cm.setValue(val)},!0),option("mode",null,function(cm,val){cm.doc.modeOption=val,loadMode(cm)},!0),option("indentUnit",2,loadMode,!0),option("indentWithTabs",!1),option("smartIndent",!0),option("tabSize",4,function(cm){loadMode(cm),clearCaches(cm),regChange(cm)},!0),option("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(cm,val){cm.options.specialChars=new RegExp(val.source+(val.test("\t")?"":"|\t"),"g"),cm.refresh()},!0),option("specialCharPlaceholder",function(ch){var token=elt("span","\u2022","cm-invalidchar");return token.title="\\u"+ch.charCodeAt(0).toString(16),token},function(cm){cm.refresh()},!0),option("electricChars",!0),option("rtlMoveVisually",!windows),option("wholeLineUpdateBefore",!0),option("theme","default",function(cm){themeChanged(cm),guttersChanged(cm)},!0),option("keyMap","default",keyMapChanged),option("extraKeys",null),option("onKeyEvent",null),option("onDragEvent",null),option("lineWrapping",!1,function(cm){cm.options.lineWrapping?(cm.display.wrapper.className+=" CodeMirror-wrap",cm.display.sizer.style.minWidth=""):(cm.display.wrapper.className=cm.display.wrapper.className.replace(" CodeMirror-wrap",""),computeMaxLength(cm)),estimateLineHeights(cm),regChange(cm),clearCaches(cm),setTimeout(function(){updateScrollbars(cm)},100)},!0),option("gutters",[],function(cm){setGuttersForLineNumbers(cm.options),guttersChanged(cm)},!0),option("fixedGutter",!0,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0",cm.refresh()},!0),option("coverGutterNextToScrollbar",!1,updateScrollbars,!0),option("lineNumbers",!1,function(cm){setGuttersForLineNumbers(cm.options),guttersChanged(cm)},!0),option("firstLineNumber",1,guttersChanged,!0),option("lineNumberFormatter",function(integer){return integer},guttersChanged,!0),option("showCursorWhenSelecting",!1,updateSelection,!0),option("resetSelectionOnContextMenu",!0),option("readOnly",!1,function(cm,val){"nocursor"==val?(onBlur(cm),cm.display.input.blur(),cm.display.disabled=!0):(cm.display.disabled=!1,!val&&resetInput(cm,!0))}),option("dragDrop",!0),option("cursorBlinkRate",530),option("cursorScrollMargin",0),option("cursorHeight",1),option("workTime",100),option("workDelay",100),option("flattenSpans",!0),option("pollInterval",100),option("undoDepth",40,function(cm,val){cm.doc.history.undoDepth=val}),option("historyEventDelay",500),option("viewportMargin",10,function(cm){cm.refresh()},!0),option("maxHighlightLength",1e4,function(cm){loadMode(cm),cm.refresh()},!0),option("crudeMeasuringFrom",1e4),option("moveInputWithCursor",!0,function(cm,val){val||(cm.display.inputDiv.style.top=cm.display.inputDiv.style.left=0)}),option("tabindex",null,function(cm,val){cm.display.input.tabIndex=val||""}),option("autofocus",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(CodeMirror.defaults.mode||"null"==name||(CodeMirror.defaults.mode=name),2<arguments.length){mode.dependencies=[];for(var i=2;i<arguments.length;++i)mode.dependencies.push(arguments[i])}modes[name]=mode},CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec},CodeMirror.resolveMode=function(spec){if("string"==typeof spec&&mimeModes.hasOwnProperty(spec))spec=mimeModes[spec];else if(spec&&"string"==typeof spec.name&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];spec=createObj(found,spec),spec.name=found.name}else if("string"==typeof spec&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec))return CodeMirror.resolveMode("application/xml");return"string"==typeof spec?{name:spec}:spec||{name:"null"}},CodeMirror.getMode=function(options,spec){var spec=CodeMirror.resolveMode(spec),mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts)exts.hasOwnProperty(prop)&&(modeObj.hasOwnProperty(prop)&&(modeObj["_"+prop]=modeObj[prop]),modeObj[prop]=exts[prop])}return modeObj.name=spec.name,modeObj},CodeMirror.defineMode("null",function(){return{token:function(stream){stream.skipToEnd()}}}),CodeMirror.defineMIME("text/plain","null");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)},CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func},CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func},CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};var helpers=CodeMirror.helpers={};CodeMirror.registerHelper=function(type,name,value){helpers.hasOwnProperty(type)||(helpers[type]=CodeMirror[type]={}),helpers[type][name]=value},CodeMirror.isWordChar=isWordChar,CodeMirror.copyState=copyState,CodeMirror.startState=startState,CodeMirror.innerMode=function(mode,state){for(;mode.innerMode;){var info=mode.innerMode(state);if(!info||info.mode==mode)break;state=info.state,mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()))},killLine:function(cm){var from=cm.getCursor(!0),to=cm.getCursor(!1),sel=!posEq(from,to);sel||cm.getLine(from.line).length!=from.ch?cm.replaceRange("",from,sel?to:Pos(from.line),"+delete"):cm.replaceRange("",from,Pos(from.line+1,0),"+delete")},deleteLine:function(cm){var l=cm.getCursor().line;cm.replaceRange("",Pos(l,0),Pos(l),"+delete")},delLineLeft:function(cm){var cur=cm.getCursor();cm.replaceRange("",Pos(cur.line,0),cur,"+delete")},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelection(lineStart(cm,cm.getCursor().line))},goLineStartSmart:function(cm){var cur=cm.getCursor(),start=lineStart(cm,cur.line),line=cm.getLineHandle(start.line),order=getOrder(line);if(!order||0==order[0].level){var firstNonWS=_Mathmax(0,line.text.search(/\S/)),inWS=cur.line==start.line&&cur.ch<=firstNonWS&&cur.ch;cm.extendSelection(Pos(start.line,inWS?0:firstNonWS))}else cm.extendSelection(start)},goLineEnd:function(cm){cm.extendSelection(lineEnd(cm,cm.getCursor().line))},goLineRight:function(cm){var top=cm.charCoords(cm.getCursor(),"div").top+5;cm.extendSelection(cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div"))},goLineLeft:function(cm){var top=cm.charCoords(cm.getCursor(),"div").top+5;cm.extendSelection(cm.coordsChar({left:0,top:top},"div"))},goLineUp:function(cm){cm.moveV(-1,"line")},goLineDown:function(cm){cm.moveV(1,"line")},goPageUp:function(cm){cm.moveV(-1,"page")},goPageDown:function(cm){cm.moveV(1,"page")},goCharLeft:function(cm){cm.moveH(-1,"char")},goCharRight:function(cm){cm.moveH(1,"char")},goColumnLeft:function(cm){cm.moveH(-1,"column")},goColumnRight:function(cm){cm.moveH(1,"column")},goWordLeft:function(cm){cm.moveH(-1,"word")},goGroupRight:function(cm){cm.moveH(1,"group")},goGroupLeft:function(cm){cm.moveH(-1,"group")},goWordRight:function(cm){cm.moveH(1,"word")},delCharBefore:function(cm){cm.deleteH(-1,"char")},delCharAfter:function(cm){cm.deleteH(1,"char")},delWordBefore:function(cm){cm.deleteH(-1,"word")},delWordAfter:function(cm){cm.deleteH(1,"word")},delGroupBefore:function(cm){cm.deleteH(-1,"group")},delGroupAfter:function(cm){cm.deleteH(1,"group")},indentAuto:function(cm){cm.indentSelection("smart")},indentMore:function(cm){cm.indentSelection("add")},indentLess:function(cm){cm.indentSelection("subtract")},insertTab:function(cm){cm.replaceSelection("\t","end","+input")},defaultTab:function(cm){cm.somethingSelected()?cm.indentSelection("add"):cm.replaceSelection("\t","end","+input")},transposeChars:function(cm){var cur=cm.getCursor(),line=cm.getLine(cur.line);0<cur.ch&&cur.ch<line.length-1&&cm.replaceRange(line.charAt(cur.ch)+line.charAt(cur.ch-1),Pos(cur.line,cur.ch-1),Pos(cur.line,cur.ch+1))},newlineAndIndent:function(cm){operation(cm,function(){cm.replaceSelection("\n","end","+input"),cm.indentLine(cm.getCursor().line,null,!0)})()},toggleOverwrite:function(cm){cm.toggleOverwrite()}},keyMap=CodeMirror.keyMap={};keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]},keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault,keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},CodeMirror.lookupKey=lookupKey,CodeMirror.isModifierKey=isModifierKey,CodeMirror.keyName=keyName,CodeMirror.fromTextArea=function(textarea,options){function save(){textarea.value=cm.getValue()}if(options||(options={}),options.value=textarea.value,!options.tabindex&&textarea.tabindex&&(options.tabindex=textarea.tabindex),!options.placeholder&&textarea.placeholder&&(options.placeholder=textarea.placeholder),null==options.autofocus){var hasFocus=document.body;try{hasFocus=document.activeElement}catch(e){}options.autofocus=hasFocus==textarea||null!=textarea.getAttribute("autofocus")&&hasFocus==document.body}if(textarea.form&&(on(textarea.form,"submit",save),!options.leaveSubmitMethodAlone)){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save(),form.submit=realSubmit,form.submit(),form.submit=wrappedSubmit}}catch(e){}}textarea.style.display="none";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);return cm.save=save,cm.getTextArea=function(){return textarea},cm.toTextArea=function(){save(),textarea.parentNode.removeChild(cm.getWrapperElement()),textarea.style.display="",textarea.form&&(off(textarea.form,"submit",save),"function"==typeof textarea.form.submit&&(textarea.form.submit=realSubmit))},cm},StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(match){var ch=this.string.charAt(this.pos);if("string"==typeof match)var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));return ok?(++this.pos,ch):void 0},eatWhile:function(match){for(var start=this.pos;this.eat(match););return this.pos>start},eatSpace:function(){for(var start=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);if(-1<found)return this.pos=found,!0},backUp:function(n){this.pos-=n},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue},indentation:function(){return countColumn(this.string,null,this.tabSize)},match:function(pattern,consume,caseInsensitive){if("string"==typeof pattern){var cased=function(str){return caseInsensitive?str.toLowerCase():str},substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern))return!1!==consume&&(this.pos+=pattern.length),!0}else{var match=this.string.slice(this.pos).match(pattern);return match&&0<match.index?null:(match&&!1!==consume&&(this.pos+=match[0].length),match)}},current:function(){return this.string.slice(this.start,this.pos)}},CodeMirror.StringStream=StringStream,CodeMirror.TextMarker=TextMarker,eventMixin(TextMarker),TextMarker.prototype.clear=function(){if(!this.explicitlyCleared){var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp&&startOperation(cm),hasHandler(this,"clear")){var found=this.find();found&&signalLater(this,"clear",found.from,found.to)}for(var min=null,max=null,i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);null!=span.to&&(max=lineNo(line)),line.markedSpans=removeMarkedSpan(line.markedSpans,span),null==span.from?this.collapsed&&!lineIsHidden(this.doc,line)&&cm&&updateLineHeight(line,textHeight(cm.display)):min=lineNo(line)}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(cm.doc,this.lines[i]),len=lineLength(cm.doc,visual);len>cm.display.maxLineLength&&(cm.display.maxLine=visual,cm.display.maxLineLength=len,cm.display.maxLineChanged=!0)}null!=min&&cm&&regChange(cm,min,max+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,cm&&reCheckSelection(cm)),withOp&&endOperation(cm)}},TextMarker.prototype.find=function(){for(var i=0,from,to;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);if(null!=span.from||null!=span.to){var found=lineNo(line);null!=span.from&&(from=Pos(found,span.from)),null!=span.to&&(to=Pos(found,span.to))}}return"bookmark"==this.type?from:from&&{from:from,to:to}},TextMarker.prototype.changed=function(){var pos=this.find(),cm=this.doc.cm;if(pos&&cm){"bookmark"!=this.type&&(pos=pos.from);var line=getLine(this.doc,pos.line);if(clearCachedMeasurement(cm,line),pos.line>=cm.display.showingFrom&&pos.line<cm.display.showingTo){for(var node=cm.display.lineDiv.firstChild;node;node=node.nextSibling)if(node.lineObj==line){node.offsetHeight!=line.height&&updateLineHeight(line,node.offsetHeight);break}runInOp(cm,function(){cm.curOp.selectionChanged=cm.curOp.forceUpdate=cm.curOp.updateMaxLine=!0})}}},TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;op.maybeHiddenMarkers&&-1!=indexOf(op.maybeHiddenMarkers,this)||(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)},TextMarker.prototype.detachLine=function(line){if(this.lines.splice(indexOf(this.lines,line),1),!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}},CodeMirror.SharedTextMarker=SharedTextMarker,eventMixin(SharedTextMarker),SharedTextMarker.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,"clear")}},SharedTextMarker.prototype.find=function(){return this.primary.find()};var LineWidget=CodeMirror.LineWidget=function(cm,node,options){if(options)for(var opt in options)options.hasOwnProperty(opt)&&(this[opt]=options[opt]);this.cm=cm,this.node=node};eventMixin(LineWidget),LineWidget.prototype.clear=widgetOperation(function(){var ws=this.line.widgets,no=lineNo(this.line);if(null!=no&&ws){for(var i=0;i<ws.length;++i)ws[i]==this&&ws.splice(i--,1);ws.length||(this.line.widgets=null);var aboveVisible=heightAtLine(this.cm,this.line)<this.cm.doc.scrollTop;updateLineHeight(this.line,_Mathmax(0,this.line.height-widgetHeight(this))),aboveVisible&&addToScrollPos(this.cm,0,-this.height),regChange(this.cm,no,no+1)}}),LineWidget.prototype.changed=widgetOperation(function(){var oldH=this.height;this.height=null;var diff=widgetHeight(this)-oldH;if(diff){updateLineHeight(this.line,this.line.height+diff);var no=lineNo(this.line);regChange(this.cm,no,no+1)}});var Line=CodeMirror.Line=function(text,markedSpans,estimateHeight){this.text=text,attachMarkedSpans(this,markedSpans),this.height=estimateHeight?estimateHeight(this):1};eventMixin(Line),Line.prototype.lineNo=function(){return lineNo(this)};var styleToClassCache={};LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,line;i<at+n;++i)line=this.lines[i],this.height-=line.height,cleanUpLine(line),signalLater(line,"delete");this.lines.splice(at,n)},collapse:function(lines){lines.splice.apply(lines,[lines.length,0].concat(this.lines))},insertInner:function(at,lines,height){this.height+=height,this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0,e=lines.length;i<e;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;at<e;++at)if(op(this.lines[at]))return!0}},BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=_Mathmin(n,sz-at),oldHeight=child.height;if(child.removeInner(at,rm),this.height-=oldHeight-child.height,sz==rm&&(this.children.splice(i--,1),child.parent=null),0==(n-=rm))break;at=0}else at-=sz}if(25>this.size-n){var lines=[];this.collapse(lines),this.children=[new LeafChunk(lines)],this.children[0].parent=this}},collapse:function(lines){for(var i=0,e=this.children.length;i<e;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length,this.height+=height;for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){if(child.insertInner(at,lines,height),child.lines&&50<child.lines.length){for(;50<child.lines.length;){var spilled=child.lines.splice(child.lines.length-25,25),newleaf=new LeafChunk(spilled);child.height-=newleaf.height,this.children.splice(i+1,0,newleaf),newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(!(10>=this.children.length)){var me=this;do{var spilled=me.children.splice(me.children.length-5,5),sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me,me.children=[copy,sibling],me=copy}else{me.size-=sibling.size,me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}sibling.parent=me.parent}while(10<me.children.length);me.parent.maybeSpill()}},iterN:function(at,n,op){for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=_Mathmin(n,sz-at);if(child.iterN(at,used,op))return!0;if(0==(n-=used))break;at=0}else at-=sz}}};var nextDocId=0,Doc=CodeMirror.Doc=function(text,mode,firstLine){if(!(this instanceof Doc))return new Doc(text,mode,firstLine);null==firstLine&&(firstLine=0),BranchChunk.call(this,[new LeafChunk([new Line("",null)])]),this.first=firstLine,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=makeHistory(),this.cleanGeneration=1,this.frontier=firstLine;var start=Pos(firstLine,0);this.sel={from:start,to:start,head:start,anchor:start,shift:!1,extend:!1,goalColumn:null},this.id=++nextDocId,this.modeOption=mode,"string"==typeof text&&(text=splitLines(text)),updateDoc(this,{from:start,to:start,text:text},null,{head:start,anchor:start})};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){op?this.iterN(from-this.first,to-from,op):this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){for(var height=0,i=0,e=lines.length;i<e;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);return!1===lineSep?lines:lines.join(lineSep||"\n")},setValue:function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:splitLines(code),origin:"setValue"},{head:top,anchor:top},!0)},replaceRange:function(code,from,to,origin){from=clipPos(this,from),to=to?clipPos(this,to):from,replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));return!1===lineSep?lines:lines.join(lineSep||"\n")},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},setLine:function(line,text){isLine(this,line)&&replaceRange(this,text,Pos(line,0),clipPos(this,Pos(line)))},removeLine:function(line){line?replaceRange(this,"",clipPos(this,Pos(line-1)),clipPos(this,Pos(line))):replaceRange(this,"",Pos(0,0),clipPos(this,Pos(1,0)))},getLineHandle:function(line){if(isLine(this,line))return getLine(this,line)},getLineNumber:function(line){return lineNo(line)},getLineHandleVisualStart:function(line){return"number"==typeof line&&(line=getLine(this,line)),visualLine(this,line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var sel=this.sel,pos;return pos=null==start||"head"==start?sel.head:"anchor"==start?sel.anchor:"end"==start||!1===start?sel.to:sel.from,copyPos(pos)},somethingSelected:function(){return!posEq(this.sel.head,this.sel.anchor)},setCursor:docOperation(function(line,ch,extend){var pos=clipPos(this,"number"==typeof line?Pos(line,ch||0):line);extend?extendSelection(this,pos):setSelection(this,pos,pos)}),setSelection:docOperation(function(anchor,head,bias){setSelection(this,clipPos(this,anchor),clipPos(this,head||anchor),bias)}),extendSelection:docOperation(function(from,to,bias){extendSelection(this,clipPos(this,from),to&&clipPos(this,to),bias)}),getSelection:function(lineSep){return this.getRange(this.sel.from,this.sel.to,lineSep)},replaceSelection:function(code,collapse,origin){makeChange(this,{from:this.sel.from,to:this.sel.to,text:splitLines(code),origin:origin},collapse||"around")},undo:docOperation(function(){makeChangeFromHistory(this,"undo")}),redo:docOperation(function(){makeChangeFromHistory(this,"redo")}),setExtending:function(val){this.sel.extend=val},historySize:function(){var hist=this.history;return{undo:hist.done.length,redo:hist.undone.length}},clearHistory:function(){this.history=makeHistory(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration()},changeGeneration:function(){return this.history.lastOp=this.history.lastOrigin=null,this.history.generation},isClean:function(gen){return this.history.generation==(gen||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=makeHistory(this.history.maxGeneration);hist.done=histData.done.slice(0),hist.undone=histData.undone.slice(0)},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,"range")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(null==options.nodeType?options.widget:options),insertLeft:options&&options.insertLeft};return pos=clipPos(this,pos),markText(this,pos,pos,realOpts,"bookmark")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0,span;i<spans.length;++i)span=spans[i],(null==span.from||span.from<=pos.ch)&&(null==span.to||span.to>=pos.ch)&&markers.push(span.marker.parent||span.marker);return markers},getAllMarks:function(){var markers=[];return this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)null!=sps[i].from&&markers.push(sps[i].marker)}),markers},posFromIndex:function(off){var lineNo=this.first,ch;return this.iter(function(line){var sz=line.text.length+1;return sz>off?(ch=off,!0):void(off-=sz,++lineNo)}),clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;return coords.line<this.first||0>coords.ch?0:(this.iter(this.first,coords.line,function(line){index+=line.text.length+1}),index)},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first);return doc.scrollTop=this.scrollTop,doc.scrollLeft=this.scrollLeft,doc.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},copyHistory&&(doc.history.undoDepth=this.history.undoDepth,doc.setHistory(this.getHistory())),doc},linkedDoc:function(options){options||(options={});var from=this.first,to=this.first+this.size;null!=options.from&&options.from>from&&(from=options.from),null!=options.to&&options.to<to&&(to=options.to);var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from);return options.sharedHist&&(copy.history=this.history),(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist}),copy.linked=[{doc:this,isParent:!0,sharedHist:options.sharedHist}],copy},unlinkDoc:function(other){if(other instanceof CodeMirror&&(other=other.doc),this.linked)for(var i=0,link;i<this.linked.length;++i)if(link=this.linked[i],link.doc==other){this.linked.splice(i,1),other.unlinkDoc(this);break}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},!0),other.history=makeHistory(),other.history.done=copyHistoryArray(this.history.done,splitIds),other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate=["iter","insert","remove","copy","getEditor"];for(var prop in Doc.prototype)Doc.prototype.hasOwnProperty(prop)&&0>indexOf(dontDelegate,prop)&&(CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]));eventMixin(Doc),CodeMirror.e_stop=e_stop,CodeMirror.e_preventDefault=e_preventDefault,CodeMirror.e_stopPropagation=e_stopPropagation;var delayedCallbackDepth=0,delayedCallbacks;CodeMirror.on=on,CodeMirror.off=off,CodeMirror.signal=signal;var scrollerCutOff=30,Pass=CodeMirror.Pass={toString:function(){return"CodeMirror.Pass"}};Delayed.prototype={set:function(ms,f){clearTimeout(this.id),this.id=setTimeout(f,ms)}},CodeMirror.countColumn=countColumn;var spaceStrs=[""],nonASCIISingleCaseWordChar=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,isExtendingChar=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\u1DC0–\u1DFF\u20D0–\u20FF\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff\uFE20–\uFE2F]/;CodeMirror.replaceGetRect=function(f){getRect=f};var dragAndDrop=function(){if(ie_lt9)return!1;var div=elt("div");return"draggable"in div||"dragDrop"in div}();gecko?spanAffectsWrapping=function(str,i){return 36==str.charCodeAt(i-1)&&39==str.charCodeAt(i)}:safari&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?spanAffectsWrapping=function(str,i){return /\-[^ \-?]|\?[^ !\'\"\),.\-\/:;\?\]\}]/.test(str.slice(i-1,i+1))}:webkit&&/Chrome\/(?:29|[3-9]\d|\d\d\d)\./.test(navigator.userAgent)?spanAffectsWrapping=function(str,i){var code=str.charCodeAt(i-1);return 8208<=code&&8212>=code}:webkit&&(spanAffectsWrapping=function(str,i){if(1<i&&45==str.charCodeAt(i-1)){if(/\w/.test(str.charAt(i-2))&&/[^\-?\.]/.test(str.charAt(i)))return!0;if(2<i&&/[\d\.,]/.test(str.charAt(i-2))&&/[\d\.,]/.test(str.charAt(i)))return!1}return /[~!#%&*)=+}\]\\|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|…[\w~`@#$%\^&*(_=+{[><]/.test(str.slice(i-1,i+1))});var splitLines=3=="\n\nb".split(/\n/).length?function(string){return string.split(/\r\n?|\n/)}:function(string){for(var pos=0,result=[],l=string.length,nl;pos<=l;){nl=string.indexOf("\n",pos),-1==nl&&(nl=string.length);var line=string.slice(pos,"\r"==string.charAt(nl-1)?nl-1:nl),rt=line.indexOf("\r");-1==rt?(result.push(line),pos=nl+1):(result.push(line.slice(0,rt)),pos+=rt+1)}return result},knownScrollbarWidth,zwspSupported;CodeMirror.splitLines=splitLines;var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return!1}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}return!!(range&&range.parentElement()==te)&&0!=range.compareEndPoints("StartToEnd",range)},hasCopyEvent=function(){var e=elt("div");return!!("oncopy"in e)||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};CodeMirror.keyNames=keyNames,function(){for(var i=0;10>i;i++)keyNames[i+48]=i+"";for(var i=65;90>=i;i++)keyNames[i]=_StringfromCharCode(i);for(var i=1;12>=i;i++)keyNames[i+111]=keyNames[i+63235]="F"+i}();var bidiOrdering=function(){function charType(code){return 255>=code?lowTypes.charAt(code):1424<=code&&1524>=code?"R":1536<=code&&1791>=code?arabicTypes.charAt(code-1536):1792<=code&&2220>=code?"r":"L"}var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",arabicTypes="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/,outerType="L";return function(str){if(!bidiRE.test(str))return!1;for(var len=str.length,types=[],i=0,type;i<len;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType,type;i<len;++i)type=types[i],"m"==type?types[i]=prev:prev=type;for(var i=0,cur=outerType,type;i<len;++i)type=types[i],"1"==type&&"r"==cur?types[i]="n":isStrong.test(type)&&(cur=type,"r"==type&&(types[i]="R"));for(var i=1,prev=types[0],type;i<len-1;++i)type=types[i],"+"==type&&"1"==prev&&"1"==types[i+1]?types[i]="1":","==type&&prev==types[i+1]&&("1"==prev||"n"==prev)&&(types[i]=prev),prev=type;for(var i=0,type;i<len;++i)if(type=types[i],","==type)types[i]="N";else if("%"==type){for(var end=i+1;end<len&&"%"==types[end];++end);for(var replace=i&&"!"==types[i-1]||end<len-1&&"1"==types[end]?"1":"N",j=i;j<end;++j)types[j]=replace;i=end-1}for(var i=0,cur=outerType,type;i<len;++i)type=types[i],"L"==cur&&"1"==type?types[i]="L":isStrong.test(type)&&(cur=type);for(var i=0;i<len;++i)if(isNeutral.test(types[i])){for(var end=i+1;end<len&&isNeutral.test(types[end]);++end);for(var before="L"==(i?types[i-1]:outerType),after="L"==(end<len-1?types[end]:outerType),replace=before||after?"L":"R",j=i;j<end;++j)types[j]=replace;i=end-1}for(var order=[],i=0,m;i<len;)if(countsAsLeft.test(types[i])){var start=i;for(++i;i<len&&countsAsLeft.test(types[i]);++i);order.push({from:start,to:i,level:0})}else{var pos=i,at=order.length;for(++i;i<len&&"L"!=types[i];++i);for(var j=pos;j<i;)if(countsAsNum.test(types[j])){pos<j&&order.splice(at,0,{from:pos,to:j,level:1});var nstart=j;for(++j;j<i&&countsAsNum.test(types[j]);++j);order.splice(at,0,{from:nstart,to:j,level:2}),pos=j}else++j;pos<i&&order.splice(at,0,{from:pos,to:i,level:1})}return 1==order[0].level&&(m=str.match(/^\s+/))&&(order[0].from=m[0].length,order.unshift({from:0,to:m[0].length,level:0})),1==lst(order).level&&(m=str.match(/\s+$/))&&(lst(order).to-=m[0].length,order.push({from:len-m[0].length,to:len,level:0})),order[0].level!=lst(order).level&&order.push({from:len,to:len,level:order[0].level}),order}}(),bidiOther;return CodeMirror.version="3.20.0",CodeMirror}()}(this),_retrieveGlobal()}),$__System.registerDynamic("83",["80"],!1,function($__require,$__exports,$__module){var _retrieveGlobal=$__System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function(){(function(){function jsNonBreakableBlocks(text){for(var nonBreakableRegexes=[/for\s*?\((.*?)\)/,/\"(.*?)(\"|$)/,/\'(.*?)(\'|$)/,/\/\*(.*?)(\*\/|$)/,/\/\/.*/],nonBreakableBlocks=[],i=0,curPos;i<nonBreakableRegexes.length;i++)for(curPos=0;curPos<text.length;){var m=text.substr(curPos).match(nonBreakableRegexes[i]);if(null!=m)nonBreakableBlocks.push({start:curPos+m.index,end:curPos+m.index+m[0].length}),curPos+=m.index+_Mathmax(1,m[0].length);else break}return nonBreakableBlocks.sort(function(a,b){return a.start-b.start}),nonBreakableBlocks}function localModeAt(cm,pos){return CodeMirror.innerMode(cm.getMode(),cm.getTokenAt(pos).state).mode}function enumerateModesBetween(cm,line,start,end){var outer=cm.getMode(),text=cm.getLine(line);if(null==end&&(end=text.length),!outer.innerMode)return[{from:start,to:end,mode:outer}];var state=cm.getTokenAt({line:line,ch:start}).state,mode=CodeMirror.innerMode(outer,state).mode,found=[],stream=new CodeMirror.StringStream(text);for(stream.pos=stream.start=start;;){outer.token(stream,state);var curMode=CodeMirror.innerMode(outer,state).mode;if(curMode!=mode){var cut=stream.start;"xml"==mode.name&&">"==text.charAt(stream.pos-1)&&(cut=stream.pos),found.push({from:start,to:cut,mode:mode}),start=cut,mode=curMode}if(stream.pos>=end)break;stream.start=stream.pos}return start<end&&found.push({from:start,to:end,mode:mode}),found}CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(text){return text.replace(/(;|\{|\})([^\r\n])/g,"$1\n$2")}}),CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(text){var curPos=0,split=this.jsonMode?function(str){return str.replace(/([,{])/g,"$1\n").replace(/}/g,"\n}")}:function(str){return str.replace(/(;|\{|\})([^\r\n;])/g,"$1\n$2")},nonBreakableBlocks=jsNonBreakableBlocks(text),res="";if(null!=nonBreakableBlocks){for(var i=0;i<nonBreakableBlocks.length;i++)nonBreakableBlocks[i].start>curPos&&(res+=split(text.substring(curPos,nonBreakableBlocks[i].start)),curPos=nonBreakableBlocks[i].start),nonBreakableBlocks[i].start<=curPos&&nonBreakableBlocks[i].end>=curPos&&(res+=text.substring(curPos,nonBreakableBlocks[i].end),curPos=nonBreakableBlocks[i].end);curPos<text.length&&(res+=split(text.substr(curPos)))}else res=split(text);return res.replace(/^\n*|\n*$/,"")}}),CodeMirror.extendMode("xml",{commentStart:"<!--",commentEnd:"-->",wordWrapChars:[">"],autoFormatLineBreaks:function(text){for(var lines=text.split("\n"),reProcessedPortion=/(^\s*?<|^[^<]*?)(.+)(>\s*?$|[^>]*?$)/,reOpenBrackets=/</g,reCloseBrackets=/(>)([^\r\n])/g,i=0,mToProcess;i<lines.length;i++)if(mToProcess=lines[i].match(reProcessedPortion),null!=mToProcess&&3<mToProcess.length){lines[i]=mToProcess[1]+mToProcess[2].replace(reOpenBrackets,"\n$&").replace(reCloseBrackets,"$1\n$2")+mToProcess[3];continue}return lines.join("\n")}}),CodeMirror.defineExtension("commentRange",function(isComment,from,to){var curMode=localModeAt(this,from),cm=this;this.operation(function(){if(isComment)cm.replaceRange(curMode.commentEnd,to),cm.replaceRange(curMode.commentStart,from),from.line==to.line&&from.ch==to.ch&&cm.setCursor(from.line,from.ch+curMode.commentStart.length);else{var selText=cm.getRange(from,to),startIndex=selText.indexOf(curMode.commentStart),endIndex=selText.lastIndexOf(curMode.commentEnd);-1<startIndex&&-1<endIndex&&endIndex>startIndex&&(selText=selText.substr(0,startIndex)+selText.substring(startIndex+curMode.commentStart.length,endIndex)+selText.substr(endIndex+curMode.commentEnd.length)),cm.replaceRange(selText,from,to)}})}),CodeMirror.defineExtension("autoIndentRange",function(from,to){var cmInstance=this;this.operation(function(){for(var i=from.line;i<=to.line;i++)cmInstance.indentLine(i,"smart")})}),CodeMirror.defineExtension("autoFormatRange",function(from,to){var cm=this;cm.operation(function(){for(var cur=from.line,end=to.line;cur<=end;++cur){for(var f={line:cur,ch:cur==from.line?from.ch:0},t={line:cur,ch:cur==end?to.ch:null},modes=enumerateModesBetween(cm,cur,f.ch,t.ch),mangled="",text=cm.getRange(f,t),i=0,part;i<modes.length;++i)part=1<modes.length?text.slice(modes[i].from,modes[i].to):text,mangled&&(mangled+="\n"),mangled+=modes[i].mode.autoFormatLineBreaks?modes[i].mode.autoFormatLineBreaks(part):text;if(mangled!=text){for(var count=0,pos=mangled.indexOf("\n");-1!=pos;pos=mangled.indexOf("\n",pos+1),++count);cm.replaceRange(mangled,f,t),cur+=count,end+=count}}for(var cur=from.line+1;cur<=end;++cur)cm.indentLine(cur,"smart");cm.setSelection(from,cm.getCursor(!1))})})})()}(this),_retrieveGlobal()}),$__System.registerDynamic("84",["28"],!0,function($__require,exports,module){var global=this||self;(function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory($__require("28")):factory(global.jQuery)})(this,function($$1){"use strict";function uniqueId(prefix){var id=++idCounter+"";return prefix?prefix+id:id}function head(array){return array[0]}function last(array){return array[array.length-1]}function tail(array){return array.slice(1)}function indexOf(array,item){return $$1.inArray(item,array)}function contains(array,item){return-1!==indexOf(array,item)}function isFontInstalled(fontName){var testFontName="Comic Sans MS"===fontName?"Courier New":"Comic Sans MS",$tester=$$1("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),originalWidth=$tester.css("fontFamily",testFontName).width(),width=$tester.css("fontFamily",fontName+","+testFontName).width();return $tester.remove(),originalWidth!==width}function isEditable(node){return node&&$$1(node).hasClass("note-editable")}function isControlSizing(node){return node&&$$1(node).hasClass("note-control-sizing")}function makePredByNodeName(nodeName){return nodeName=nodeName.toUpperCase(),function(node){return node&&node.nodeName.toUpperCase()===nodeName}}function isText(node){return node&&3===node.nodeType}function isVoid(node){return node&&/^BR|^IMG|^HR|^IFRAME|^BUTTON|^INPUT/.test(node.nodeName.toUpperCase())}function isPara(node){return!isEditable(node)&&node&&/^DIV|^P|^LI|^H[1-7]/.test(node.nodeName.toUpperCase())}function isInline(node){return!isBodyContainer(node)&&!isList(node)&&!isHr(node)&&!isPara(node)&&!isTable(node)&&!isBlockquote(node)&&!isData(node)}function isList(node){return node&&/^UL|^OL/.test(node.nodeName.toUpperCase())}function isCell(node){return node&&/^TD|^TH/.test(node.nodeName.toUpperCase())}function isBodyContainer(node){return isCell(node)||isBlockquote(node)||isEditable(node)}function nodeLength(node){return isText(node)?node.nodeValue.length:node?node.childNodes.length:0}function isEmpty(node){var len=nodeLength(node);if(0===len)return!0;return!(isText(node)||1!==len||node.innerHTML!==blankHTML)||!!(lists.all(node.childNodes,isText)&&""===node.innerHTML)}function paddingBlankHTML(node){isVoid(node)||nodeLength(node)||(node.innerHTML=blankHTML)}function ancestor(node,pred){for(;node;){if(pred(node))return node;if(isEditable(node))break;node=node.parentNode}return null}function listAncestor(node,pred){pred=pred||func.fail;var ancestors=[];return ancestor(node,function(el){return isEditable(el)||ancestors.push(el),pred(el)}),ancestors}function commonAncestor(nodeA,nodeB){for(var ancestors=listAncestor(nodeA),n=nodeB;n;n=n.parentNode)if(-1<$$1.inArray(n,ancestors))return n;return null}function listNext(node,pred){pred=pred||func.fail;for(var nodes=[];node&&!pred(node);)nodes.push(node),node=node.nextSibling;return nodes}function wrap(node,wrapperName){var parent=node.parentNode,wrapper=$$1("<"+wrapperName+">")[0];return parent.insertBefore(wrapper,node),wrapper.appendChild(node),wrapper}function insertAfter(node,preceding){var next=preceding.nextSibling,parent=preceding.parentNode;return next?parent.insertBefore(node,next):parent.appendChild(node),node}function appendChildNodes(node,aChild){return $$1.each(aChild,function(idx,child){node.appendChild(child)}),node}function isLeftEdgePoint(point){return 0===point.offset}function isRightEdgePoint(point){return point.offset===nodeLength(point.node)}function isEdgePoint(point){return isLeftEdgePoint(point)||isRightEdgePoint(point)}function isLeftEdgeOf(node,ancestor){for(;node&&node!==ancestor;){if(0!==position(node))return!1;node=node.parentNode}return!0}function isRightEdgeOf(node,ancestor){if(!ancestor)return!1;for(;node&&node!==ancestor;){if(position(node)!==nodeLength(node.parentNode)-1)return!1;node=node.parentNode}return!0}function position(node){for(var offset=0;node=node.previousSibling;)offset+=1;return offset}function hasChildren(node){return!!(node&&node.childNodes&&node.childNodes.length)}function prevPoint(point,isSkipInnerOffset){var node,offset;if(0===point.offset){if(isEditable(point.node))return null;node=point.node.parentNode,offset=position(point.node)}else hasChildren(point.node)?(node=point.node.childNodes[point.offset-1],offset=nodeLength(node)):(node=point.node,offset=isSkipInnerOffset?0:point.offset-1);return{node:node,offset:offset}}function nextPoint(point,isSkipInnerOffset){var node,offset;if(nodeLength(point.node)===point.offset){if(isEditable(point.node))return null;node=point.node.parentNode,offset=position(point.node)+1}else hasChildren(point.node)?(node=point.node.childNodes[point.offset],offset=0):(node=point.node,offset=isSkipInnerOffset?nodeLength(point.node):point.offset+1);return{node:node,offset:offset}}function isSamePoint(pointA,pointB){return pointA.node===pointB.node&&pointA.offset===pointB.offset}function splitNode(point,options){var isSkipPaddingBlankHTML=options&&options.isSkipPaddingBlankHTML,isNotSplitEdgePoint=options&&options.isNotSplitEdgePoint;if(isEdgePoint(point)&&(isText(point.node)||isNotSplitEdgePoint)){if(isLeftEdgePoint(point))return point.node;if(isRightEdgePoint(point))return point.node.nextSibling}if(isText(point.node))return point.node.splitText(point.offset);var childNode=point.node.childNodes[point.offset],clone=insertAfter(point.node.cloneNode(!1),point.node);return appendChildNodes(clone,listNext(childNode)),isSkipPaddingBlankHTML||(paddingBlankHTML(point.node),paddingBlankHTML(clone)),clone}function splitTree(root,point,options){var ancestors=listAncestor(point.node,func.eq(root));if(!ancestors.length)return null;return 1===ancestors.length?splitNode(point,options):ancestors.reduce(function(node,parent){return node===point.node&&(node=splitNode(point,options)),splitNode({node:parent,offset:node?position(node):nodeLength(parent)},options)})}function create(nodeName){return document.createElement(nodeName)}function remove(node,isRemoveChild){if(node&&node.parentNode){if(node.removeNode)return node.removeNode(isRemoveChild);var parent=node.parentNode;if(!isRemoveChild){for(var nodes=[],i=0,len=node.childNodes.length;i<len;i++)nodes.push(node.childNodes[i]);for(var i=0,len=nodes.length;i<len;i++)parent.insertBefore(nodes[i],node)}parent.removeChild(node)}}function value($node,stripLinebreaks){var val=isTextarea($node[0])?$node.val():$node.html();return stripLinebreaks?val.replace(/[\n\r]/g,""):val}function html($node,isNewlineOnBlock){var markup=value($node);if(isNewlineOnBlock){var regexTag=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;markup=markup.replace(regexTag,function(match,endSlash,name){name=name.toUpperCase();var isEndOfInlineContainer=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(name)&&!!endSlash,isBlockNode=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(name);return match+(isEndOfInlineContainer||isBlockNode?"\n":"")}),markup=$$1.trim(markup)}return markup}function posFromPlaceholder(placeholder){var $placeholder=$$1(placeholder),pos=$placeholder.offset(),height=$placeholder.outerHeight(!0);return{left:pos.left,top:pos.top+height}}function textRangeToPoint(textRange,isStart){var container=textRange.parentElement(),tester=document.body.createTextRange(),childNodes=lists.from(container.childNodes),offset,prevContainer;for(offset=0;offset<childNodes.length;offset++)if(!dom.isText(childNodes[offset])){if(tester.moveToElementText(childNodes[offset]),0<=tester.compareEndPoints("StartToStart",textRange))break;prevContainer=childNodes[offset]}if(0!==offset&&dom.isText(childNodes[offset-1])){var textRangeStart=document.body.createTextRange(),curTextNode=null;textRangeStart.moveToElementText(prevContainer||container),textRangeStart.collapse(!prevContainer),curTextNode=prevContainer?prevContainer.nextSibling:container.firstChild;var pointTester=textRange.duplicate();pointTester.setEndPoint("StartToStart",textRangeStart);for(var textCount=pointTester.text.replace(/[\r\n]/g,"").length;textCount>curTextNode.nodeValue.length&&curTextNode.nextSibling;)textCount-=curTextNode.nodeValue.length,curTextNode=curTextNode.nextSibling;curTextNode.nodeValue;isStart&&curTextNode.nextSibling&&dom.isText(curTextNode.nextSibling)&&textCount===curTextNode.nodeValue.length&&(textCount-=curTextNode.nodeValue.length,curTextNode=curTextNode.nextSibling),container=curTextNode,offset=textCount}return{cont:container,offset:offset}}function pointToTextRange(point){var textRangeInfo=function(container,offset){var node,isCollapseToStart;if(dom.isText(container)){var prevTextNodes=dom.listPrev(container,func.not(dom.isText)),prevContainer=lists.last(prevTextNodes).previousSibling;node=prevContainer||container.parentNode,offset+=lists.sum(lists.tail(prevTextNodes),dom.nodeLength),isCollapseToStart=!prevContainer}else{if(node=container.childNodes[offset]||container,dom.isText(node))return textRangeInfo(node,0);offset=0,isCollapseToStart=!1}return{node:node,collapseToStart:isCollapseToStart,offset:offset}},textRange=document.body.createTextRange(),info=textRangeInfo(point.node,point.offset);return textRange.moveToElementText(info.node),textRange.collapse(info.collapseToStart),textRange.moveStart("character",info.offset),textRange}function readFileAsDataURL(file){return $$1.Deferred(function(deferred){$$1.extend(new FileReader,{onload:function(e){var dataURL=e.target.result;deferred.resolve(dataURL)},onerror:function(err){deferred.reject(err)}}).readAsDataURL(file)}).promise()}function createImage(url){return $$1.Deferred(function(deferred){var $img=$$1("<img>");$img.one("load",function(){$img.off("error abort"),deferred.resolve($img)}).one("error abort",function(){$img.off("load").detach(),deferred.reject($img)}).css({display:"none"}).appendTo(document.body).attr("src",url)}).promise()}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1;var Renderer=function(){function Renderer(markup,children,options,callback){this.markup=markup,this.children=children,this.options=options,this.callback=callback}return Renderer.prototype.render=function($parent){var $node=$$1(this.markup);if(this.options&&this.options.contents&&$node.html(this.options.contents),this.options&&this.options.className&&$node.addClass(this.options.className),this.options&&this.options.data&&$$1.each(this.options.data,function(k,v){$node.attr("data-"+k,v)}),this.options&&this.options.click&&$node.on("click",this.options.click),this.children){var $container_1=$node.find(".note-children-container");this.children.forEach(function(child){child.render($container_1.length?$container_1:$node)})}return this.callback&&this.callback($node,this.options),this.options&&this.options.callback&&this.options.callback($node),$parent&&$parent.append($node),$node},Renderer}(),renderer={create:function(markup,callback){return function(){var options="object"==typeof arguments[1]?arguments[1]:arguments[0],children=$$1.isArray(arguments[0])?arguments[0]:[];return options&&options.children&&(children=options.children),new Renderer(markup,children,options,callback)}}},editor=renderer.create("<div class=\"note-editor note-frame panel\"/>"),toolbar=renderer.create("<div class=\"note-toolbar-wrapper panel-default\"><div class=\"note-toolbar panel-heading\" role=\"toolbar\"></div></div>"),editingArea=renderer.create("<div class=\"note-editing-area\"/>"),codable=renderer.create("<textarea class=\"note-codable\" role=\"textbox\" aria-multiline=\"true\"/>"),editable=renderer.create("<div class=\"note-editable\" contentEditable=\"true\" role=\"textbox\" aria-multiline=\"true\"/>"),statusbar=renderer.create("<output class=\"note-status-output\" aria-live=\"polite\"/><div class=\"note-statusbar\" role=\"status\">  <div class=\"note-resizebar\" role=\"seperator\" aria-orientation=\"horizontal\" aria-label=\"Resize\">    <div class=\"note-icon-bar\"/>    <div class=\"note-icon-bar\"/>    <div class=\"note-icon-bar\"/>  </div></div>"),airEditor=renderer.create("<div class=\"note-editor\"/>"),airEditable=renderer.create("  <output class=\"note-status-output\" aria-live=\"polite\"/><div class=\"note-editable\" contentEditable=\"true\" role=\"textbox\" aria-multiline=\"true\"/>"),buttonGroup=renderer.create("<div class=\"note-btn-group btn-group\">"),dropdown=renderer.create("<ul class=\"dropdown-menu\" role=\"list\">",function($node,options){var markup=$$1.isArray(options.items)?options.items.map(function(item){var value="string"==typeof item?item:item.value||"",content=options.template?options.template(item):item,option="object"==typeof item?item.option:void 0,dataOption=option===void 0?"":" data-option=\""+option+"\"";return"<li role=\"listitem\" aria-label=\""+item+"\"><a href=\"#\" "+("data-value=\""+value+"\""+dataOption)+">"+content+"</a></li>"}).join(""):options.items;$node.html(markup).attr({"aria-label":options.title})}),dropdownCheck=renderer.create("<ul class=\"dropdown-menu note-check\" role=\"list\">",function($node,options){var markup=$$1.isArray(options.items)?options.items.map(function(item){var value="string"==typeof item?item:item.value||"",content=options.template?options.template(item):item;return"<li role=\"listitem\" aria-label=\""+item+"\"><a href=\"#\" data-value=\""+value+"\">"+icon(options.checkClassName)+" "+content+"</a></li>"}).join(""):options.items;$node.html(markup).attr({"aria-label":options.title})}),palette=renderer.create("<div class=\"note-color-palette\"/>",function($node,options){for(var contents=[],row=0,rowSize=options.colors.length;row<rowSize;row++){for(var eventName=options.eventName,colors=options.colors[row],colorsName=options.colorsName[row],buttons=[],col=0,colSize=colors.length;col<colSize;col++){var color=colors[col],colorName=colorsName[col];buttons.push(["<button type=\"button\" class=\"note-color-btn\"","style=\"background-color:",color,"\" ","data-event=\"",eventName,"\" ","data-value=\"",color,"\" ","title=\"",colorName,"\" ","aria-label=\"",colorName,"\" ","data-toggle=\"button\" tabindex=\"-1\"></button>"].join(""))}contents.push("<div class=\"note-color-row\">"+buttons.join("")+"</div>")}$node.html(contents.join("")),options.tooltip&&$node.find(".note-color-btn").tooltip({container:options.container,trigger:"hover",placement:"bottom"})}),dialog=renderer.create("<div class=\"modal\" aria-hidden=\"false\" tabindex=\"-1\" role=\"dialog\"/>",function($node,options){options.fade&&$node.addClass("fade"),$node.attr({"aria-label":options.title}),$node.html(["<div class=\"modal-dialog\">","  <div class=\"modal-content\">",options.title?"    <div class=\"modal-header\">      <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" aria-hidden=\"true\">&times;</button>      <h4 class=\"modal-title\">"+options.title+"</h4>    </div>":"","    <div class=\"modal-body\">"+options.body+"</div>",options.footer?"    <div class=\"modal-footer\">"+options.footer+"</div>":"","  </div>","</div>"].join(""))}),popover=renderer.create("<div class=\"note-popover popover in\">  <div class=\"arrow\"/>  <div class=\"popover-content note-children-container\"/></div>",function($node,options){var direction="undefined"==typeof options.direction?"bottom":options.direction;$node.addClass(direction),options.hideArrow&&$node.find(".arrow").hide()}),checkbox=renderer.create("<div class=\"checkbox\"></div>",function($node,options){$node.html([" <label"+(options.id?" for=\""+options.id+"\"":"")+">"," <input role=\"checkbox\" type=\"checkbox\""+(options.id?" id=\""+options.id+"\"":""),options.checked?" checked":""," aria-checked=\""+(options.checked?"true":"false")+"\"/>",options.text?options.text:"","</label>"].join(""))}),icon=function(iconClassName,tagName){return tagName=tagName||"i","<"+tagName+" class=\""+iconClassName+"\"/>"},ui={editor:editor,toolbar:toolbar,editingArea:editingArea,codable:codable,editable:editable,statusbar:statusbar,airEditor:airEditor,airEditable:airEditable,buttonGroup:buttonGroup,dropdown:dropdown,dropdownButtonContents:function(contents,options){return contents+" "+icon(options.icons.caret,"span")},dropdownCheck:dropdownCheck,palette:palette,dialog:dialog,popover:popover,checkbox:checkbox,icon:icon,options:{},button:function($node,options){return renderer.create("<button type=\"button\" class=\"note-btn btn btn-default btn-sm\" role=\"button\" tabindex=\"-1\">",function($node,options){options&&options.tooltip&&$node.attr({title:options.tooltip,"aria-label":options.tooltip}).tooltip({container:options.container,trigger:"hover",placement:"bottom"})})($node,options)},toggleBtn:function($btn,isEnable){$btn.toggleClass("disabled",!isEnable),$btn.attr("disabled",!isEnable)},toggleBtnActive:function($btn,isActive){$btn.toggleClass("active",isActive)},onDialogShown:function($dialog,handler){$dialog.one("shown.bs.modal",handler)},onDialogHidden:function($dialog,handler){$dialog.one("hidden.bs.modal",handler)},showDialog:function($dialog){$dialog.modal("show")},hideDialog:function($dialog){$dialog.modal("hide")},createLayout:function($note,options){var $editor=(options.airMode?ui.airEditor([ui.editingArea([ui.airEditable()])]):ui.editor([ui.toolbar(),ui.editingArea([ui.codable(),ui.editable()]),ui.statusbar()])).render();return $editor.insertAfter($note),{note:$note,editor:$editor,toolbar:$editor.find(".note-toolbar"),editingArea:$editor.find(".note-editing-area"),editable:$editor.find(".note-editable"),codable:$editor.find(".note-codable"),statusbar:$editor.find(".note-statusbar")}},removeLayout:function($note,layoutInfo){$note.html(layoutInfo.editable.html()),layoutInfo.editor.remove(),$note.show()}},idCounter=0,func={eq:function(itemA){return function(itemB){return itemA===itemB}},eq2:function(itemA,itemB){return itemA===itemB},peq2:function(propName){return function(itemA,itemB){return itemA[propName]===itemB[propName]}},ok:function(){return!0},fail:function(){return!1},self:function(a){return a},not:function(f){return function(){return!f.apply(f,arguments)}},and:function(fA,fB){return function(item){return fA(item)&&fB(item)}},invoke:function(obj,method){return function(){return obj[method].apply(obj,arguments)}},uniqueId:uniqueId,rect2bnd:function(rect){var $document=$(document);return{top:rect.top+$document.scrollTop(),left:rect.left+$document.scrollLeft(),width:rect.right-rect.left,height:rect.bottom-rect.top}},invertObject:function(obj){var inverted={};for(var key in obj)obj.hasOwnProperty(key)&&(inverted[obj[key]]=key);return inverted},namespaceToCamel:function(namespace,prefix){return prefix=prefix||"",prefix+namespace.split(".").map(function(name){return name.substring(0,1).toUpperCase()+name.substring(1)}).join("")},debounce:function(func,wait,immediate){var _this=this,timeout;return function(){var context=_this,args=arguments,callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(function(){timeout=null,immediate||func.apply(context,args)},wait),callNow&&func.apply(context,args)}}},lists={head:head,last:last,initial:function(array){return array.slice(0,array.length-1)},tail:tail,prev:function(array,item){var idx=indexOf(array,item);return-1===idx?null:array[idx-1]},next:function(array,item){var idx=indexOf(array,item);return-1===idx?null:array[idx+1]},find:function(array,pred){for(var idx=0,len=array.length,item;idx<len;idx++)if(item=array[idx],pred(item))return item},contains:contains,all:function(array,pred){for(var idx=0,len=array.length;idx<len;idx++)if(!pred(array[idx]))return!1;return!0},sum:function(array,fn){return fn=fn||func.self,array.reduce(function(memo,v){return memo+fn(v)},0)},from:function(collection){for(var result=[],length=collection.length,idx=-1;++idx<length;)result[idx]=collection[idx];return result},isEmpty:function(array){return!array||!array.length},clusterBy:function(array,fn){if(!array.length)return[];var aTail=tail(array);return aTail.reduce(function(memo,v){var aLast=last(memo);return fn(last(aLast),v)?aLast[aLast.length]=v:memo[memo.length]=[v],memo},[[head(array)]])},compact:function(array){for(var aResult=[],idx=0,len=array.length;idx<len;idx++)array[idx]&&aResult.push(array[idx]);return aResult},unique:function(array){for(var results=[],idx=0,len=array.length;idx<len;idx++)contains(results,array[idx])||results.push(array[idx]);return results}},userAgent=navigator.userAgent,isMSIE=/MSIE|Trident/i.test(userAgent),browserVersion;if(isMSIE){var matches=/MSIE (\d+[.]\d+)/.exec(userAgent);matches&&(browserVersion=parseFloat(matches[1])),matches=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/.exec(userAgent),matches&&(browserVersion=parseFloat(matches[1]))}var isEdge=/Edge\/\d+/.test(userAgent),hasCodeMirror=!!window.CodeMirror;var isSupportTouch="ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints,inputEventName=isMSIE||isEdge?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input",env={isMac:-1<navigator.appVersion.indexOf("Mac"),isMSIE:isMSIE,isEdge:isEdge,isFF:!isEdge&&/firefox/i.test(userAgent),isPhantom:/PhantomJS/i.test(userAgent),isWebkit:!isEdge&&/webkit/i.test(userAgent),isChrome:!isEdge&&/chrome/i.test(userAgent),isSafari:!isEdge&&/safari/i.test(userAgent),browserVersion:browserVersion,jqueryVersion:parseFloat($$1.fn.jquery),isSupportAmd:"function"==typeof void 0,isSupportTouch:isSupportTouch,hasCodeMirror:hasCodeMirror,isFontInstalled:isFontInstalled,isW3CRangeSupport:!!document.createRange,inputEventName:inputEventName},NBSP_CHAR="\xA0",isPre=makePredByNodeName("PRE"),isLi=makePredByNodeName("LI"),isTable=makePredByNodeName("TABLE"),isData=makePredByNodeName("DATA"),isHr=makePredByNodeName("HR"),isBlockquote=makePredByNodeName("BLOCKQUOTE"),isAnchor=makePredByNodeName("A"),isBody=makePredByNodeName("BODY"),blankHTML=env.isMSIE&&11>env.browserVersion?"&nbsp;":"<br>",isTextarea=makePredByNodeName("TEXTAREA"),dom={NBSP_CHAR:NBSP_CHAR,ZERO_WIDTH_NBSP_CHAR:"\uFEFF",blank:blankHTML,emptyPara:"<p>"+blankHTML+"</p>",makePredByNodeName:makePredByNodeName,isEditable:isEditable,isControlSizing:isControlSizing,isText:isText,isElement:function(node){return node&&1===node.nodeType},isVoid:isVoid,isPara:isPara,isPurePara:function(node){return isPara(node)&&!isLi(node)},isHeading:function(node){return node&&/^H[1-7]/.test(node.nodeName.toUpperCase())},isInline:isInline,isBlock:func.not(isInline),isBodyInline:function(node){return isInline(node)&&!ancestor(node,isPara)},isBody:isBody,isParaInline:function(node){return isInline(node)&&!!ancestor(node,isPara)},isPre:isPre,isList:isList,isTable:isTable,isData:isData,isCell:isCell,isBlockquote:isBlockquote,isBodyContainer:isBodyContainer,isAnchor:isAnchor,isDiv:makePredByNodeName("DIV"),isLi:isLi,isBR:makePredByNodeName("BR"),isSpan:makePredByNodeName("SPAN"),isB:makePredByNodeName("B"),isU:makePredByNodeName("U"),isS:makePredByNodeName("S"),isI:makePredByNodeName("I"),isImg:makePredByNodeName("IMG"),isTextarea:isTextarea,isEmpty:isEmpty,isEmptyAnchor:func.and(isAnchor,isEmpty),isClosestSibling:function(nodeA,nodeB){return nodeA.nextSibling===nodeB||nodeA.previousSibling===nodeB},withClosestSiblings:function(node,pred){pred=pred||func.ok;var siblings=[];return node.previousSibling&&pred(node.previousSibling)&&siblings.push(node.previousSibling),siblings.push(node),node.nextSibling&&pred(node.nextSibling)&&siblings.push(node.nextSibling),siblings},nodeLength:nodeLength,isLeftEdgePoint:isLeftEdgePoint,isRightEdgePoint:isRightEdgePoint,isEdgePoint:isEdgePoint,isLeftEdgeOf:isLeftEdgeOf,isRightEdgeOf:isRightEdgeOf,isLeftEdgePointOf:function(point,ancestor){return isLeftEdgePoint(point)&&isLeftEdgeOf(point.node,ancestor)},isRightEdgePointOf:function(point,ancestor){return isRightEdgePoint(point)&&isRightEdgeOf(point.node,ancestor)},prevPoint:prevPoint,nextPoint:nextPoint,isSamePoint:isSamePoint,isVisiblePoint:function(point){if(isText(point.node)||!hasChildren(point.node)||isEmpty(point.node))return!0;var leftNode=point.node.childNodes[point.offset-1],rightNode=point.node.childNodes[point.offset];return!(leftNode&&!isVoid(leftNode)||rightNode&&!isVoid(rightNode))},prevPointUntil:function(point,pred){for(;point;){if(pred(point))return point;point=prevPoint(point)}return null},nextPointUntil:function(point,pred){for(;point;){if(pred(point))return point;point=nextPoint(point)}return null},isCharPoint:function(point){if(!isText(point.node))return!1;var ch=point.node.nodeValue.charAt(point.offset-1);return ch&&" "!==ch&&ch!==NBSP_CHAR},walkPoint:function(startPoint,endPoint,handler,isSkipInnerOffset){for(var point=startPoint,isSkipOffset;point&&(handler(point),!isSamePoint(point,endPoint));)isSkipOffset=isSkipInnerOffset&&startPoint.node!==point.node&&endPoint.node!==point.node,point=nextPoint(point,isSkipOffset)},ancestor:ancestor,singleChildAncestor:function(node,pred){for(node=node.parentNode;node&&!(1!==nodeLength(node));){if(pred(node))return node;if(isEditable(node))break;node=node.parentNode}return null},listAncestor:listAncestor,lastAncestor:function(node,pred){var ancestors=listAncestor(node);return lists.last(ancestors.filter(pred))},listNext:listNext,listPrev:function(node,pred){pred=pred||func.fail;for(var nodes=[];node&&!pred(node);)nodes.push(node),node=node.previousSibling;return nodes},listDescendant:function(node,pred){var descendants=[];return pred=pred||func.ok,function fnWalk(current){node!==current&&pred(current)&&descendants.push(current);for(var idx=0,len=current.childNodes.length;idx<len;idx++)fnWalk(current.childNodes[idx])}(node),descendants},commonAncestor:commonAncestor,wrap:wrap,insertAfter:insertAfter,appendChildNodes:appendChildNodes,position:position,hasChildren:hasChildren,makeOffsetPath:function(ancestor,node){var ancestors=listAncestor(node,func.eq(ancestor));return ancestors.map(position).reverse()},fromOffsetPath:function(ancestor,offsets){for(var current=ancestor,i=0,len=offsets.length;i<len;i++)current=current.childNodes.length<=offsets[i]?current.childNodes[current.childNodes.length-1]:current.childNodes[offsets[i]];return current},splitTree:splitTree,splitPoint:function(point,isInline){var pred=isInline?isPara:isBodyContainer,ancestors=listAncestor(point.node,pred),topAncestor=lists.last(ancestors)||point.node,splitRoot,container;pred(topAncestor)?(splitRoot=ancestors[ancestors.length-2],container=topAncestor):(splitRoot=topAncestor,container=splitRoot.parentNode);var pivot=splitRoot&&splitTree(splitRoot,point,{isSkipPaddingBlankHTML:isInline,isNotSplitEdgePoint:isInline});return pivot||container!==point.node||(pivot=point.node.childNodes[point.offset]),{rightNode:pivot,container:container}},create:create,createText:function(text){return document.createTextNode(text)},remove:remove,removeWhile:function(node,pred){for(;node&&!(isEditable(node)||!pred(node));){var parent=node.parentNode;remove(node),node=parent}},replace:function(node,nodeName){if(node.nodeName.toUpperCase()===nodeName.toUpperCase())return node;var newNode=create(nodeName);return node.style.cssText&&(newNode.style.cssText=node.style.cssText),appendChildNodes(newNode,lists.from(node.childNodes)),insertAfter(newNode,node),remove(node),newNode},html:html,value:value,posFromPlaceholder:posFromPlaceholder,attachEvents:function($node,events){Object.keys(events).forEach(function(key){$node.on(key,events[key])})},detachEvents:function($node,events){Object.keys(events).forEach(function(key){$node.off(key,events[key])})},isCustomStyleTag:function(node){return node&&!isText(node)&&lists.contains(node.classList,"note-styletag")}};$$1.summernote=$$1.summernote||{lang:{}},$$1.extend($$1.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image",original:"Original"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table",addRowAbove:"Add row above",addRowBelow:"Add row below",addColLeft:"Add column left",addColRight:"Add column right",delRow:"Delete row",delCol:"Delete column",delTable:"Delete table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",p:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{insertParagraph:"Insert Paragraph",undo:"Undoes the last command",redo:"Redoes the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"}}});var KEY_MAP={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,DELETE:46,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221},key={isEdit:function(keyCode){return lists.contains([KEY_MAP.BACKSPACE,KEY_MAP.TAB,KEY_MAP.ENTER,KEY_MAP.SPACE,KEY_MAP.DELETE],keyCode)},isMove:function(keyCode){return lists.contains([KEY_MAP.LEFT,KEY_MAP.UP,KEY_MAP.RIGHT,KEY_MAP.DOWN],keyCode)},nameFromCode:func.invertObject(KEY_MAP),code:KEY_MAP},WrappedRange=function(){function WrappedRange(sc,so,ec,eo){this.sc=sc,this.so=so,this.ec=ec,this.eo=eo,this.isOnEditable=this.makeIsOn(dom.isEditable),this.isOnList=this.makeIsOn(dom.isList),this.isOnAnchor=this.makeIsOn(dom.isAnchor),this.isOnCell=this.makeIsOn(dom.isCell),this.isOnData=this.makeIsOn(dom.isData)}return WrappedRange.prototype.nativeRange=function(){if(env.isW3CRangeSupport){var w3cRange=document.createRange();return w3cRange.setStart(this.sc,this.so),w3cRange.setEnd(this.ec,this.eo),w3cRange}var textRange=pointToTextRange({node:this.sc,offset:this.so});return textRange.setEndPoint("EndToEnd",pointToTextRange({node:this.ec,offset:this.eo})),textRange},WrappedRange.prototype.getPoints=function(){return{sc:this.sc,so:this.so,ec:this.ec,eo:this.eo}},WrappedRange.prototype.getStartPoint=function(){return{node:this.sc,offset:this.so}},WrappedRange.prototype.getEndPoint=function(){return{node:this.ec,offset:this.eo}},WrappedRange.prototype.select=function(){var nativeRng=this.nativeRange();if(env.isW3CRangeSupport){var selection=document.getSelection();0<selection.rangeCount&&selection.removeAllRanges(),selection.addRange(nativeRng)}else nativeRng.select();return this},WrappedRange.prototype.scrollIntoView=function(container){var height=$$1(container).height();return container.scrollTop+height<this.sc.offsetTop&&(container.scrollTop+=_Mathabs(container.scrollTop+height-this.sc.offsetTop)),this},WrappedRange.prototype.normalize=function(){var getVisiblePoint=function(point,isLeftToRight){if(dom.isVisiblePoint(point)&&!dom.isEdgePoint(point)||dom.isVisiblePoint(point)&&dom.isRightEdgePoint(point)&&!isLeftToRight||dom.isVisiblePoint(point)&&dom.isLeftEdgePoint(point)&&isLeftToRight||dom.isVisiblePoint(point)&&dom.isBlock(point.node)&&dom.isEmpty(point.node))return point;var block=dom.ancestor(point.node,dom.isBlock);if((dom.isLeftEdgePointOf(point,block)||dom.isVoid(dom.prevPoint(point).node))&&!isLeftToRight||(dom.isRightEdgePointOf(point,block)||dom.isVoid(dom.nextPoint(point).node))&&isLeftToRight){if(dom.isVisiblePoint(point))return point;isLeftToRight=!isLeftToRight}var nextPoint=isLeftToRight?dom.nextPointUntil(dom.nextPoint(point),dom.isVisiblePoint):dom.prevPointUntil(dom.prevPoint(point),dom.isVisiblePoint);return nextPoint||point},endPoint=getVisiblePoint(this.getEndPoint(),!1),startPoint=this.isCollapsed()?endPoint:getVisiblePoint(this.getStartPoint(),!0);return new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset)},WrappedRange.prototype.nodes=function(pred,options){pred=pred||func.ok;var includeAncestor=options&&options.includeAncestor,fullyContains=options&&options.fullyContains,startPoint=this.getStartPoint(),endPoint=this.getEndPoint(),nodes=[],leftEdgeNodes=[];return dom.walkPoint(startPoint,endPoint,function(point){if(!dom.isEditable(point.node)){var node;fullyContains?(dom.isLeftEdgePoint(point)&&leftEdgeNodes.push(point.node),dom.isRightEdgePoint(point)&&lists.contains(leftEdgeNodes,point.node)&&(node=point.node)):includeAncestor?node=dom.ancestor(point.node,pred):node=point.node,node&&pred(node)&&nodes.push(node)}},!0),lists.unique(nodes)},WrappedRange.prototype.commonAncestor=function(){return dom.commonAncestor(this.sc,this.ec)},WrappedRange.prototype.expand=function(pred){var startAncestor=dom.ancestor(this.sc,pred),endAncestor=dom.ancestor(this.ec,pred);if(!startAncestor&&!endAncestor)return new WrappedRange(this.sc,this.so,this.ec,this.eo);var boundaryPoints=this.getPoints();return startAncestor&&(boundaryPoints.sc=startAncestor,boundaryPoints.so=0),endAncestor&&(boundaryPoints.ec=endAncestor,boundaryPoints.eo=dom.nodeLength(endAncestor)),new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo)},WrappedRange.prototype.collapse=function(isCollapseToStart){return isCollapseToStart?new WrappedRange(this.sc,this.so,this.sc,this.so):new WrappedRange(this.ec,this.eo,this.ec,this.eo)},WrappedRange.prototype.splitText=function(){var isSameContainer=this.sc===this.ec,boundaryPoints=this.getPoints();return dom.isText(this.ec)&&!dom.isEdgePoint(this.getEndPoint())&&this.ec.splitText(this.eo),dom.isText(this.sc)&&!dom.isEdgePoint(this.getStartPoint())&&(boundaryPoints.sc=this.sc.splitText(this.so),boundaryPoints.so=0,isSameContainer&&(boundaryPoints.ec=boundaryPoints.sc,boundaryPoints.eo=this.eo-this.so)),new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo)},WrappedRange.prototype.deleteContents=function(){if(this.isCollapsed())return this;var rng=this.splitText(),nodes=rng.nodes(null,{fullyContains:!0}),point=dom.prevPointUntil(rng.getStartPoint(),function(point){return!lists.contains(nodes,point.node)}),emptyParents=[];return $$1.each(nodes,function(idx,node){var parent=node.parentNode;point.node!==parent&&1===dom.nodeLength(parent)&&emptyParents.push(parent),dom.remove(node,!1)}),$$1.each(emptyParents,function(idx,node){dom.remove(node,!1)}),new WrappedRange(point.node,point.offset,point.node,point.offset).normalize()},WrappedRange.prototype.makeIsOn=function(pred){return function(){var ancestor=dom.ancestor(this.sc,pred);return!!ancestor&&ancestor===dom.ancestor(this.ec,pred)}},WrappedRange.prototype.isLeftEdgeOf=function(pred){if(!dom.isLeftEdgePoint(this.getStartPoint()))return!1;var node=dom.ancestor(this.sc,pred);return node&&dom.isLeftEdgeOf(this.sc,node)},WrappedRange.prototype.isCollapsed=function(){return this.sc===this.ec&&this.so===this.eo},WrappedRange.prototype.wrapBodyInlineWithPara=function(){if(dom.isBodyContainer(this.sc)&&dom.isEmpty(this.sc))return this.sc.innerHTML=dom.emptyPara,new WrappedRange(this.sc.firstChild,0,this.sc.firstChild,0);var rng=this.normalize();if(dom.isParaInline(this.sc)||dom.isPara(this.sc))return rng;var topAncestor;if(dom.isInline(rng.sc)){var ancestors=dom.listAncestor(rng.sc,func.not(dom.isInline));topAncestor=lists.last(ancestors),dom.isInline(topAncestor)||(topAncestor=ancestors[ancestors.length-2]||rng.sc.childNodes[rng.so])}else topAncestor=rng.sc.childNodes[0<rng.so?rng.so-1:0];var inlineSiblings=dom.listPrev(topAncestor,dom.isParaInline).reverse();if(inlineSiblings=inlineSiblings.concat(dom.listNext(topAncestor.nextSibling,dom.isParaInline)),inlineSiblings.length){var para=dom.wrap(lists.head(inlineSiblings),"p");dom.appendChildNodes(para,lists.tail(inlineSiblings))}return this.normalize()},WrappedRange.prototype.insertNode=function(node){var rng=this.wrapBodyInlineWithPara().deleteContents(),info=dom.splitPoint(rng.getStartPoint(),dom.isInline(node));return info.rightNode?info.rightNode.parentNode.insertBefore(node,info.rightNode):info.container.appendChild(node),node},WrappedRange.prototype.pasteHTML=function(markup){var contentsContainer=$$1("<div></div>").html(markup)[0],childNodes=lists.from(contentsContainer.childNodes),rng=this.wrapBodyInlineWithPara().deleteContents();return childNodes.reverse().map(function(childNode){return rng.insertNode(childNode)}).reverse()},WrappedRange.prototype.toString=function(){var nativeRng=this.nativeRange();return env.isW3CRangeSupport?nativeRng.toString():nativeRng.text},WrappedRange.prototype.getWordRange=function(findAfter){var endPoint=this.getEndPoint();if(!dom.isCharPoint(endPoint))return this;var startPoint=dom.prevPointUntil(endPoint,function(point){return!dom.isCharPoint(point)});return findAfter&&(endPoint=dom.nextPointUntil(endPoint,function(point){return!dom.isCharPoint(point)})),new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset)},WrappedRange.prototype.bookmark=function(editable){return{s:{path:dom.makeOffsetPath(editable,this.sc),offset:this.so},e:{path:dom.makeOffsetPath(editable,this.ec),offset:this.eo}}},WrappedRange.prototype.paraBookmark=function(paras){return{s:{path:lists.tail(dom.makeOffsetPath(lists.head(paras),this.sc)),offset:this.so},e:{path:lists.tail(dom.makeOffsetPath(lists.last(paras),this.ec)),offset:this.eo}}},WrappedRange.prototype.getClientRects=function(){var nativeRng=this.nativeRange();return nativeRng.getClientRects()},WrappedRange}(),range={create:function(sc,so,ec,eo){if(4===arguments.length)return new WrappedRange(sc,so,ec,eo);if(2===arguments.length)return ec=sc,eo=so,new WrappedRange(sc,so,ec,eo);var wrappedRange=this.createFromSelection();return wrappedRange||1!==arguments.length?wrappedRange:(wrappedRange=this.createFromNode(arguments[0]),wrappedRange.collapse(dom.emptyPara===arguments[0].innerHTML))},createFromSelection:function(){var sc,so,ec,eo;if(env.isW3CRangeSupport){var selection=document.getSelection();if(!selection||0===selection.rangeCount)return null;if(dom.isBody(selection.anchorNode))return null;var nativeRng=selection.getRangeAt(0);sc=nativeRng.startContainer,so=nativeRng.startOffset,ec=nativeRng.endContainer,eo=nativeRng.endOffset}else{var textRange=document.selection.createRange(),textRangeEnd=textRange.duplicate();textRangeEnd.collapse(!1);var textRangeStart=textRange;textRangeStart.collapse(!0);var startPoint=textRangeToPoint(textRangeStart,!0),endPoint=textRangeToPoint(textRangeEnd,!1);dom.isText(startPoint.node)&&dom.isLeftEdgePoint(startPoint)&&dom.isTextNode(endPoint.node)&&dom.isRightEdgePoint(endPoint)&&endPoint.node.nextSibling===startPoint.node&&(startPoint=endPoint),sc=startPoint.cont,so=startPoint.offset,ec=endPoint.cont,eo=endPoint.offset}return new WrappedRange(sc,so,ec,eo)},createFromNode:function(node){var sc=node,so=0,ec=node,eo=dom.nodeLength(ec);return dom.isVoid(sc)&&(so=dom.listPrev(sc).length-1,sc=sc.parentNode),dom.isBR(ec)?(eo=dom.listPrev(ec).length-1,ec=ec.parentNode):dom.isVoid(ec)&&(eo=dom.listPrev(ec).length,ec=ec.parentNode),this.create(sc,so,ec,eo)},createFromNodeBefore:function(node){return this.createFromNode(node).collapse(!0)},createFromNodeAfter:function(node){return this.createFromNode(node).collapse()},createFromBookmark:function(editable,bookmark){var sc=dom.fromOffsetPath(editable,bookmark.s.path),so=bookmark.s.offset,ec=dom.fromOffsetPath(editable,bookmark.e.path),eo=bookmark.e.offset;return new WrappedRange(sc,so,ec,eo)},createFromParaBookmark:function(bookmark,paras){var so=bookmark.s.offset,eo=bookmark.e.offset,sc=dom.fromOffsetPath(lists.head(paras),bookmark.s.path),ec=dom.fromOffsetPath(lists.last(paras),bookmark.e.path);return new WrappedRange(sc,so,ec,eo)}},History=function(){function History($editable){this.stack=[],this.stackOffset=-1,this.$editable=$editable,this.editable=$editable[0]}return History.prototype.makeSnapshot=function(){var rng=range.create(this.editable);return{contents:this.$editable.html(),bookmark:rng?rng.bookmark(this.editable):{s:{path:[],offset:0},e:{path:[],offset:0}}}},History.prototype.applySnapshot=function(snapshot){null!==snapshot.contents&&this.$editable.html(snapshot.contents),null!==snapshot.bookmark&&range.createFromBookmark(this.editable,snapshot.bookmark).select()},History.prototype.rewind=function(){this.$editable.html()!==this.stack[this.stackOffset].contents&&this.recordUndo(),this.stackOffset=0,this.applySnapshot(this.stack[this.stackOffset])},History.prototype.reset=function(){this.stack=[],this.stackOffset=-1,this.$editable.html(""),this.recordUndo()},History.prototype.undo=function(){this.$editable.html()!==this.stack[this.stackOffset].contents&&this.recordUndo(),0<this.stackOffset&&(this.stackOffset--,this.applySnapshot(this.stack[this.stackOffset]))},History.prototype.redo=function(){this.stack.length-1>this.stackOffset&&(this.stackOffset++,this.applySnapshot(this.stack[this.stackOffset]))},History.prototype.recordUndo=function(){this.stackOffset++,this.stack.length>this.stackOffset&&(this.stack=this.stack.slice(0,this.stackOffset)),this.stack.push(this.makeSnapshot())},History}(),Style=function(){function Style(){}return Style.prototype.jQueryCSS=function($obj,propertyNames){if(1.9>env.jqueryVersion){var result_1={};return $$1.each(propertyNames,function(idx,propertyName){result_1[propertyName]=$obj.css(propertyName)}),result_1}return $obj.css(propertyNames)},Style.prototype.fromNode=function($node){var styleInfo=this.jQueryCSS($node,["font-family","font-size","text-align","list-style-type","line-height"])||{};return styleInfo["font-size"]=parseInt(styleInfo["font-size"],10),styleInfo},Style.prototype.stylePara=function(rng,styleInfo){$$1.each(rng.nodes(dom.isPara,{includeAncestor:!0}),function(idx,para){$$1(para).css(styleInfo)})},Style.prototype.styleNodes=function(rng,options){rng=rng.splitText();var nodeName=options&&options.nodeName||"SPAN",expandClosestSibling=!!(options&&options.expandClosestSibling),onlyPartialContains=!!(options&&options.onlyPartialContains);if(rng.isCollapsed())return[rng.insertNode(dom.create(nodeName))];var pred=dom.makePredByNodeName(nodeName),nodes=rng.nodes(dom.isText,{fullyContains:!0}).map(function(text){return dom.singleChildAncestor(text,pred)||dom.wrap(text,nodeName)});if(expandClosestSibling){if(onlyPartialContains){var nodesInRange_1=rng.nodes();pred=func.and(pred,function(node){return lists.contains(nodesInRange_1,node)})}return nodes.map(function(node){var siblings=dom.withClosestSiblings(node,pred),head=lists.head(siblings),tails=lists.tail(siblings);return $$1.each(tails,function(idx,elem){dom.appendChildNodes(head,elem.childNodes),dom.remove(elem)}),lists.head(siblings)})}return nodes},Style.prototype.current=function(rng){var $cont=$$1(dom.isElement(rng.sc)?rng.sc:rng.sc.parentNode),styleInfo=this.fromNode($cont);try{styleInfo=$$1.extend(styleInfo,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal","font-family":document.queryCommandValue("fontname")||styleInfo["font-family"]})}catch(e){}if(!rng.isOnList())styleInfo["list-style"]="none";else{var isUnordered=-1<$$1.inArray(styleInfo["list-style-type"],["circle","disc","disc-leading-zero","square"]);styleInfo["list-style"]=isUnordered?"unordered":"ordered"}var para=dom.ancestor(rng.sc,dom.isPara);if(para&&para.style["line-height"])styleInfo["line-height"]=para.style.lineHeight;else{var lineHeight=parseInt(styleInfo["line-height"],10)/parseInt(styleInfo["font-size"],10);styleInfo["line-height"]=lineHeight.toFixed(1)}return styleInfo.anchor=rng.isOnAnchor()&&dom.ancestor(rng.sc,dom.isAnchor),styleInfo.ancestors=dom.listAncestor(rng.sc,dom.isEditable),styleInfo.range=rng,styleInfo},Style}(),Bullet=function(){function Bullet(){}return Bullet.prototype.insertOrderedList=function(editable){this.toggleList("OL",editable)},Bullet.prototype.insertUnorderedList=function(editable){this.toggleList("UL",editable)},Bullet.prototype.indent=function(editable){var _this=this,rng=range.create(editable).wrapBodyInlineWithPara(),paras=rng.nodes(dom.isPara,{includeAncestor:!0}),clustereds=lists.clusterBy(paras,func.peq2("parentNode"));$$1.each(clustereds,function(idx,paras){var head=lists.head(paras);dom.isLi(head)?_this.wrapList(paras,head.parentNode.nodeName):$$1.each(paras,function(idx,para){$$1(para).css("marginLeft",function(idx,val){return(parseInt(val,10)||0)+25})})}),rng.select()},Bullet.prototype.outdent=function(editable){var _this=this,rng=range.create(editable).wrapBodyInlineWithPara(),paras=rng.nodes(dom.isPara,{includeAncestor:!0}),clustereds=lists.clusterBy(paras,func.peq2("parentNode"));$$1.each(clustereds,function(idx,paras){var head=lists.head(paras);dom.isLi(head)?_this.releaseList([paras]):$$1.each(paras,function(idx,para){$$1(para).css("marginLeft",function(idx,val){return val=parseInt(val,10)||0,25<val?val-25:""})})}),rng.select()},Bullet.prototype.toggleList=function(listName,editable){var _this=this,rng=range.create(editable).wrapBodyInlineWithPara(),paras=rng.nodes(dom.isPara,{includeAncestor:!0}),bookmark=rng.paraBookmark(paras),clustereds=lists.clusterBy(paras,func.peq2("parentNode"));if(lists.find(paras,dom.isPurePara)){var wrappedParas_1=[];$$1.each(clustereds,function(idx,paras){wrappedParas_1=wrappedParas_1.concat(_this.wrapList(paras,listName))}),paras=wrappedParas_1}else{var diffLists=rng.nodes(dom.isList,{includeAncestor:!0}).filter(function(listNode){return!$$1.nodeName(listNode,listName)});diffLists.length?$$1.each(diffLists,function(idx,listNode){dom.replace(listNode,listName)}):paras=this.releaseList(clustereds,!0)}range.createFromParaBookmark(bookmark,paras).select()},Bullet.prototype.wrapList=function(paras,listName){var head=lists.head(paras),last=lists.last(paras),prevList=dom.isList(head.previousSibling)&&head.previousSibling,nextList=dom.isList(last.nextSibling)&&last.nextSibling,listNode=prevList||dom.insertAfter(dom.create(listName||"UL"),last);return paras=paras.map(function(para){return dom.isPurePara(para)?dom.replace(para,"LI"):para}),dom.appendChildNodes(listNode,paras),nextList&&(dom.appendChildNodes(listNode,lists.from(nextList.childNodes)),dom.remove(nextList)),paras},Bullet.prototype.releaseList=function(clustereds,isEscapseToBody){var releasedParas=[];return $$1.each(clustereds,function(idx,paras){var head=lists.head(paras),last=lists.last(paras),headList=isEscapseToBody?dom.lastAncestor(head,dom.isList):head.parentNode,lastList=1<headList.childNodes.length?dom.splitTree(headList,{node:last.parentNode,offset:dom.position(last)+1},{isSkipPaddingBlankHTML:!0}):null,middleList=dom.splitTree(headList,{node:head.parentNode,offset:dom.position(head)},{isSkipPaddingBlankHTML:!0});paras=isEscapseToBody?dom.listDescendant(middleList,dom.isLi):lists.from(middleList.childNodes).filter(dom.isLi),(isEscapseToBody||!dom.isList(headList.parentNode))&&(paras=paras.map(function(para){return dom.replace(para,"P")})),$$1.each(lists.from(paras).reverse(),function(idx,para){dom.insertAfter(para,headList)});var rootLists=lists.compact([headList,middleList,lastList]);$$1.each(rootLists,function(idx,rootList){var listNodes=[rootList].concat(dom.listDescendant(rootList,dom.isList));$$1.each(listNodes.reverse(),function(idx,listNode){dom.nodeLength(listNode)||dom.remove(listNode,!0)})}),releasedParas=releasedParas.concat(paras)}),releasedParas},Bullet}(),Typing=function(){function Typing(){this.bullet=new Bullet}return Typing.prototype.insertTab=function(rng,tabsize){var tab=dom.createText(Array(tabsize+1).join(dom.NBSP_CHAR));rng=rng.deleteContents(),rng.insertNode(tab,!0),rng=range.create(tab,tabsize),rng.select()},Typing.prototype.insertParagraph=function(editable){var rng=range.create(editable);rng=rng.deleteContents(),rng=rng.wrapBodyInlineWithPara();var splitRoot=dom.ancestor(rng.sc,dom.isPara),nextPara;if(splitRoot){if(dom.isEmpty(splitRoot)&&dom.isLi(splitRoot))return void this.bullet.toggleList(splitRoot.parentNode.nodeName);if(dom.isEmpty(splitRoot)&&dom.isPara(splitRoot)&&dom.isBlockquote(splitRoot.parentNode))dom.insertAfter(splitRoot,splitRoot.parentNode),nextPara=splitRoot;else{nextPara=dom.splitTree(splitRoot,rng.getStartPoint());var emptyAnchors=dom.listDescendant(splitRoot,dom.isEmptyAnchor);emptyAnchors=emptyAnchors.concat(dom.listDescendant(nextPara,dom.isEmptyAnchor)),$$1.each(emptyAnchors,function(idx,anchor){dom.remove(anchor)}),(dom.isHeading(nextPara)||dom.isPre(nextPara)||dom.isCustomStyleTag(nextPara))&&dom.isEmpty(nextPara)&&(nextPara=dom.replace(nextPara,"p"))}}else{var next=rng.sc.childNodes[rng.so];nextPara=$$1(dom.emptyPara)[0],next?rng.sc.insertBefore(nextPara,next):rng.sc.appendChild(nextPara)}range.create(nextPara,0).normalize().select().scrollIntoView(editable)},Typing}(),TableResultAction=function(startPoint,where,action,domTable){function setStartPoint(){return startPoint&&startPoint.tagName&&("td"===startPoint.tagName.toLowerCase()||"th"===startPoint.tagName.toLowerCase())?(_startPoint.colPos=startPoint.cellIndex,startPoint.parentElement&&startPoint.parentElement.tagName&&"tr"===startPoint.parentElement.tagName.toLowerCase()?void(_startPoint.rowPos=startPoint.parentElement.rowIndex):void console.error("Impossible to identify start Row point.",startPoint)):void console.error("Impossible to identify start Cell point.",startPoint)}function setVirtualTablePosition(rowIndex,cellIndex,baseRow,baseCell,isRowSpan,isColSpan,isVirtualCell){_virtualTable[rowIndex]||(_virtualTable[rowIndex]=[]),_virtualTable[rowIndex][cellIndex]={baseRow:baseRow,baseCell:baseCell,isRowSpan:isRowSpan,isColSpan:isColSpan,isVirtual:isVirtualCell}}function getActionCell(virtualTableCellObj,resultAction,virtualRowPosition,virtualColPosition){return{baseCell:virtualTableCellObj.baseCell,action:resultAction,virtualTable:{rowIndex:virtualRowPosition,cellIndex:virtualColPosition}}}function recoverCellIndex(rowIndex,cellIndex){if(!_virtualTable[rowIndex])return cellIndex;if(!_virtualTable[rowIndex][cellIndex])return cellIndex;for(var newCellIndex=cellIndex;_virtualTable[rowIndex][newCellIndex];)if(newCellIndex++,!_virtualTable[rowIndex][newCellIndex])return newCellIndex}function addCellInfoToVirtual(row,cell){var cellIndex=recoverCellIndex(row.rowIndex,cell.cellIndex),cellHasColspan=1<cell.colSpan,cellHasRowspan=1<cell.rowSpan,isThisSelectedCell=row.rowIndex===_startPoint.rowPos&&cell.cellIndex===_startPoint.colPos;setVirtualTablePosition(row.rowIndex,cellIndex,row,cell,cellHasRowspan,cellHasColspan,!1);var rowspanNumber=cell.attributes.rowSpan?parseInt(cell.attributes.rowSpan.value,10):0;if(1<rowspanNumber)for(var rp=1,rowspanIndex;rp<rowspanNumber;rp++)rowspanIndex=row.rowIndex+rp,adjustStartPoint(rowspanIndex,cellIndex,cell,isThisSelectedCell),setVirtualTablePosition(rowspanIndex,cellIndex,row,cell,!0,cellHasColspan,!0);var colspanNumber=cell.attributes.colSpan?parseInt(cell.attributes.colSpan.value,10):0;if(1<colspanNumber)for(var cp=1,cellspanIndex;cp<colspanNumber;cp++)cellspanIndex=recoverCellIndex(row.rowIndex,cellIndex+cp),adjustStartPoint(row.rowIndex,cellspanIndex,cell,isThisSelectedCell),setVirtualTablePosition(row.rowIndex,cellspanIndex,row,cell,cellHasRowspan,!0,!0)}function adjustStartPoint(rowIndex,cellIndex,cell,isSelectedCell){rowIndex===_startPoint.rowPos&&_startPoint.colPos>=cell.cellIndex&&cell.cellIndex<=cellIndex&&!isSelectedCell&&_startPoint.colPos++}function createVirtualTable(){for(var rows=domTable.rows,rowIndex=0,cells;rowIndex<rows.length;rowIndex++){cells=rows[rowIndex].cells;for(var cellIndex=0;cellIndex<cells.length;cellIndex++)addCellInfoToVirtual(rows[rowIndex],cells[cellIndex])}}function getDeleteResultActionToCell(cell){switch(where){case TableResultAction.where.Column:if(cell.isColSpan)return TableResultAction.resultAction.SubtractSpanCount;break;case TableResultAction.where.Row:if(!cell.isVirtual&&cell.isRowSpan)return TableResultAction.resultAction.AddCell;if(cell.isRowSpan)return TableResultAction.resultAction.SubtractSpanCount;}return TableResultAction.resultAction.RemoveCell}function getAddResultActionToCell(cell){switch(where){case TableResultAction.where.Column:if(cell.isColSpan)return TableResultAction.resultAction.SumSpanCount;if(cell.isRowSpan&&cell.isVirtual)return TableResultAction.resultAction.Ignore;break;case TableResultAction.where.Row:if(cell.isRowSpan)return TableResultAction.resultAction.SumSpanCount;if(cell.isColSpan&&cell.isVirtual)return TableResultAction.resultAction.Ignore;}return TableResultAction.resultAction.AddCell}var _startPoint={colPos:0,rowPos:0},_virtualTable=[],_actionCellList=[];this.getActionList=function(){for(var fixedRow=where===TableResultAction.where.Row?_startPoint.rowPos:-1,fixedCol=where===TableResultAction.where.Column?_startPoint.colPos:-1,actualPosition=0,canContinue=!0;canContinue;){var rowPosition=0<=fixedRow?fixedRow:actualPosition,colPosition=0<=fixedCol?fixedCol:actualPosition,row=_virtualTable[rowPosition];if(!row)return canContinue=!1,_actionCellList;var cell=row[colPosition];if(!cell)return canContinue=!1,_actionCellList;var resultAction=TableResultAction.resultAction.Ignore;action===TableResultAction.requestAction.Add?resultAction=getAddResultActionToCell(cell):action===TableResultAction.requestAction.Delete?resultAction=getDeleteResultActionToCell(cell):void 0;_actionCellList.push(getActionCell(cell,resultAction,rowPosition,colPosition)),actualPosition++}return _actionCellList},function(){setStartPoint(),createVirtualTable()}()};TableResultAction.where={Row:0,Column:1},TableResultAction.requestAction={Add:0,Delete:1},TableResultAction.resultAction={Ignore:0,SubtractSpanCount:1,RemoveCell:2,AddCell:3,SumSpanCount:4};var Table=function(){function Table(){}return Table.prototype.tab=function(rng,isShift){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),table=dom.ancestor(cell,dom.isTable),cells=dom.listDescendant(table,dom.isCell),nextCell=lists[isShift?"prev":"next"](cells,cell);nextCell&&range.create(nextCell,0).select()},Table.prototype.addRow=function(rng,position){for(var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),currentTr=$$1(cell).closest("tr"),trAttributes=this.recoverAttributes(currentTr),html=$$1("<tr"+trAttributes+"></tr>"),vTable=new TableResultAction(cell,TableResultAction.where.Row,TableResultAction.requestAction.Add,$$1(currentTr).closest("table")[0]),actions=vTable.getActionList(),idCell=0;idCell<actions.length;idCell++){var currentCell=actions[idCell],tdAttributes=this.recoverAttributes(currentCell.baseCell);switch(currentCell.action){case TableResultAction.resultAction.AddCell:html.append("<td"+tdAttributes+">"+dom.blank+"</td>");break;case TableResultAction.resultAction.SumSpanCount:if("top"===position){var baseCellTr=currentCell.baseCell.parent,isTopFromRowSpan=(baseCellTr?currentCell.baseCell.closest("tr").rowIndex:0)<=currentTr[0].rowIndex;if(isTopFromRowSpan){var newTd=$$1("<div></div>").append($$1("<td"+tdAttributes+">"+dom.blank+"</td>").removeAttr("rowspan")).html();html.append(newTd);break}}var rowspanNumber=parseInt(currentCell.baseCell.rowSpan,10);rowspanNumber++,currentCell.baseCell.setAttribute("rowSpan",rowspanNumber);}}if("top"===position)currentTr.before(html);else{var cellHasRowspan=1<cell.rowSpan;if(cellHasRowspan){var lastTrIndex=currentTr[0].rowIndex+(cell.rowSpan-2);return void $$1($$1(currentTr).parent().find("tr")[lastTrIndex]).after($$1(html))}currentTr.after(html)}},Table.prototype.addCol=function(rng,position){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),row=$$1(cell).closest("tr"),rowsGroup=$$1(row).siblings();rowsGroup.push(row);for(var vTable=new TableResultAction(cell,TableResultAction.where.Column,TableResultAction.requestAction.Add,$$1(row).closest("table")[0]),actions=vTable.getActionList(),actionIndex=0;actionIndex<actions.length;actionIndex++){var currentCell=actions[actionIndex],tdAttributes=this.recoverAttributes(currentCell.baseCell);switch(currentCell.action){case TableResultAction.resultAction.AddCell:"right"===position?$$1(currentCell.baseCell).after("<td"+tdAttributes+">"+dom.blank+"</td>"):$$1(currentCell.baseCell).before("<td"+tdAttributes+">"+dom.blank+"</td>");break;case TableResultAction.resultAction.SumSpanCount:if("right"===position){var colspanNumber=parseInt(currentCell.baseCell.colSpan,10);colspanNumber++,currentCell.baseCell.setAttribute("colSpan",colspanNumber)}else $$1(currentCell.baseCell).before("<td"+tdAttributes+">"+dom.blank+"</td>");}}},Table.prototype.recoverAttributes=function(el){var resultStr="";if(!el)return resultStr;for(var attrList=el.attributes||[],i=0;i<attrList.length;i++)"id"!==attrList[i].name.toLowerCase()&&attrList[i].specified&&(resultStr+=" "+attrList[i].name+"='"+attrList[i].value+"'");return resultStr},Table.prototype.deleteRow=function(rng){for(var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),row=$$1(cell).closest("tr"),cellPos=row.children("td, th").index($$1(cell)),rowPos=row[0].rowIndex,vTable=new TableResultAction(cell,TableResultAction.where.Row,TableResultAction.requestAction.Delete,$$1(row).closest("table")[0]),actions=vTable.getActionList(),actionIndex=0;actionIndex<actions.length;actionIndex++)if(actions[actionIndex]){var baseCell=actions[actionIndex].baseCell,virtualPosition=actions[actionIndex].virtualTable,hasRowspan=baseCell.rowSpan&&1<baseCell.rowSpan,rowspanNumber=hasRowspan?parseInt(baseCell.rowSpan,10):0;switch(actions[actionIndex].action){case TableResultAction.resultAction.Ignore:continue;case TableResultAction.resultAction.AddCell:var nextRow=row.next("tr")[0];if(!nextRow)continue;var cloneRow=row[0].cells[cellPos];hasRowspan&&(2<rowspanNumber?(rowspanNumber--,nextRow.insertBefore(cloneRow,nextRow.cells[cellPos]),nextRow.cells[cellPos].setAttribute("rowSpan",rowspanNumber),nextRow.cells[cellPos].innerHTML=""):2==rowspanNumber&&(nextRow.insertBefore(cloneRow,nextRow.cells[cellPos]),nextRow.cells[cellPos].removeAttribute("rowSpan"),nextRow.cells[cellPos].innerHTML=""));continue;case TableResultAction.resultAction.SubtractSpanCount:hasRowspan&&(2<rowspanNumber?(rowspanNumber--,baseCell.setAttribute("rowSpan",rowspanNumber),virtualPosition.rowIndex!==rowPos&&baseCell.cellIndex===cellPos&&(baseCell.innerHTML="")):2==rowspanNumber&&(baseCell.removeAttribute("rowSpan"),virtualPosition.rowIndex!==rowPos&&baseCell.cellIndex===cellPos&&(baseCell.innerHTML="")));continue;case TableResultAction.resultAction.RemoveCell:continue;}}row.remove()},Table.prototype.deleteCol=function(rng){for(var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),row=$$1(cell).closest("tr"),cellPos=row.children("td, th").index($$1(cell)),vTable=new TableResultAction(cell,TableResultAction.where.Column,TableResultAction.requestAction.Delete,$$1(row).closest("table")[0]),actions=vTable.getActionList(),actionIndex=0;actionIndex<actions.length;actionIndex++)if(actions[actionIndex])switch(actions[actionIndex].action){case TableResultAction.resultAction.Ignore:continue;case TableResultAction.resultAction.SubtractSpanCount:var baseCell=actions[actionIndex].baseCell,hasColspan=baseCell.colSpan&&1<baseCell.colSpan;if(hasColspan){var colspanNumber=baseCell.colSpan?parseInt(baseCell.colSpan,10):0;2<colspanNumber?(colspanNumber--,baseCell.setAttribute("colSpan",colspanNumber),baseCell.cellIndex===cellPos&&(baseCell.innerHTML="")):2==colspanNumber&&(baseCell.removeAttribute("colSpan"),baseCell.cellIndex===cellPos&&(baseCell.innerHTML=""))}continue;case TableResultAction.resultAction.RemoveCell:dom.remove(actions[actionIndex].baseCell,!0);continue;}},Table.prototype.createTable=function(colCount,rowCount,options){for(var tds=[],idxCol=0,tdHTML;idxCol<colCount;idxCol++)tds.push("<td>"+dom.blank+"</td>");tdHTML=tds.join("");for(var trs=[],idxRow=0,trHTML;idxRow<rowCount;idxRow++)trs.push("<tr>"+tdHTML+"</tr>");trHTML=trs.join("");var $table=$$1("<table>"+trHTML+"</table>");return options&&options.tableClassName&&$table.addClass(options.tableClassName),$table[0]},Table.prototype.deleteTable=function(rng){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell);$$1(cell).closest("table").remove()},Table}(),Editor=function(){function Editor(context){var _this=this;this.context=context,this.$note=context.layoutInfo.note,this.$editor=context.layoutInfo.editor,this.$editable=context.layoutInfo.editable,this.options=context.options,this.lang=this.options.langInfo,this.editable=this.$editable[0],this.lastRange=null,this.style=new Style,this.table=new Table,this.typing=new Typing,this.bullet=new Bullet,this.history=new History(this.$editable),this.context.memo("help.undo",this.lang.help.undo),this.context.memo("help.redo",this.lang.help.redo),this.context.memo("help.tab",this.lang.help.tab),this.context.memo("help.untab",this.lang.help.untab),this.context.memo("help.insertParagraph",this.lang.help.insertParagraph),this.context.memo("help.insertOrderedList",this.lang.help.insertOrderedList),this.context.memo("help.insertUnorderedList",this.lang.help.insertUnorderedList),this.context.memo("help.indent",this.lang.help.indent),this.context.memo("help.outdent",this.lang.help.outdent),this.context.memo("help.formatPara",this.lang.help.formatPara),this.context.memo("help.insertHorizontalRule",this.lang.help.insertHorizontalRule),this.context.memo("help.fontName",this.lang.help.fontName);for(var commands=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor"],idx=0,len=commands.length;idx<len;idx++)this[commands[idx]]=function(sCmd){return function(value){_this.beforeCommand(),document.execCommand(sCmd,!1,value),_this.afterCommand(!0)}}(commands[idx]),this.context.memo("help."+commands[idx],this.lang.help[commands[idx]]);this.fontName=this.wrapCommand(function(value){return _this.fontStyling("font-family","'"+value+"'")}),this.fontSize=this.wrapCommand(function(value){return _this.fontStyling("font-size",value+"px")});for(var idx=1;6>=idx;idx++)this["formatH"+idx]=function(idx){return function(){_this.formatBlock("H"+idx)}}(idx),this.context.memo("help.formatH"+idx,this.lang.help["formatH"+idx]);this.insertParagraph=this.wrapCommand(function(){_this.typing.insertParagraph(_this.editable)}),this.insertOrderedList=this.wrapCommand(function(){_this.bullet.insertOrderedList(_this.editable)}),this.insertUnorderedList=this.wrapCommand(function(){_this.bullet.insertUnorderedList(_this.editable)}),this.indent=this.wrapCommand(function(){_this.bullet.indent(_this.editable)}),this.outdent=this.wrapCommand(function(){_this.bullet.outdent(_this.editable)}),this.insertNode=this.wrapCommand(function(node){if(!_this.isLimited($$1(node).text().length)){var rng=_this.createRange();rng.insertNode(node),range.createFromNodeAfter(node).select()}}),this.insertText=this.wrapCommand(function(text){if(!_this.isLimited(text.length)){var rng=_this.createRange(),textNode=rng.insertNode(dom.createText(text));range.create(textNode,dom.nodeLength(textNode)).select()}}),this.pasteHTML=this.wrapCommand(function(markup){if(!_this.isLimited(markup.length)){var contents=_this.createRange().pasteHTML(markup);range.createFromNodeAfter(lists.last(contents)).select()}}),this.formatBlock=this.wrapCommand(function(tagName,$target){var onApplyCustomStyle=_this.options.callbacks.onApplyCustomStyle;onApplyCustomStyle?onApplyCustomStyle.call(_this,$target,_this.context,_this.onFormatBlock):_this.onFormatBlock(tagName,$target)}),this.insertHorizontalRule=this.wrapCommand(function(){var hrNode=_this.createRange().insertNode(dom.create("HR"));hrNode.nextSibling&&range.create(hrNode.nextSibling,0).normalize().select()}),this.lineHeight=this.wrapCommand(function(value){_this.style.stylePara(_this.createRange(),{lineHeight:value})}),this.createLink=this.wrapCommand(function(linkInfo){var linkUrl=linkInfo.url,linkText=linkInfo.text,isNewWindow=linkInfo.isNewWindow,rng=linkInfo.range||_this.createRange(),isTextChanged=rng.toString()!==linkText;"string"==typeof linkUrl&&(linkUrl=linkUrl.trim()),linkUrl=_this.options.onCreateLink?_this.options.onCreateLink(linkUrl):/^[A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?/.test(linkUrl)?linkUrl:"http://"+linkUrl;var anchors=[];if(isTextChanged){rng=rng.deleteContents();var anchor=rng.insertNode($$1("<A>"+linkText+"</A>")[0]);anchors.push(anchor)}else anchors=_this.style.styleNodes(rng,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});$$1.each(anchors,function(idx,anchor){$$1(anchor).attr("href",linkUrl),isNewWindow?$$1(anchor).attr("target","_blank"):$$1(anchor).removeAttr("target")});var startRange=range.createFromNodeBefore(lists.head(anchors)),startPoint=startRange.getStartPoint(),endRange=range.createFromNodeAfter(lists.last(anchors)),endPoint=endRange.getEndPoint();range.create(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset).select()}),this.color=this.wrapCommand(function(colorInfo){var foreColor=colorInfo.foreColor,backColor=colorInfo.backColor;foreColor&&document.execCommand("foreColor",!1,foreColor),backColor&&document.execCommand("backColor",!1,backColor)}),this.foreColor=this.wrapCommand(function(colorInfo){document.execCommand("styleWithCSS",!1,!0),document.execCommand("foreColor",!1,colorInfo)}),this.insertTable=this.wrapCommand(function(dim){var dimension=dim.split("x"),rng=_this.createRange().deleteContents();rng.insertNode(_this.table.createTable(dimension[0],dimension[1],_this.options))}),this.removeMedia=this.wrapCommand(function(){var $target=$$1(_this.restoreTarget()).parent();$target.parent("figure").length?$target.parent("figure").remove():$target=$$1(_this.restoreTarget()).detach(),_this.context.triggerEvent("media.delete",$target,_this.$editable)}),this.floatMe=this.wrapCommand(function(value){var $target=$$1(_this.restoreTarget());$target.toggleClass("note-float-left","left"===value),$target.toggleClass("note-float-right","right"===value),$target.css("float",value)}),this.resize=this.wrapCommand(function(value){var $target=$$1(_this.restoreTarget());$target.css({width:100*value+"%",height:""})})}return Editor.prototype.initialize=function(){var _this=this;this.$editable.on("keydown",function(event){if(event.keyCode===key.code.ENTER&&_this.context.triggerEvent("enter",event),_this.context.triggerEvent("keydown",event),event.isDefaultPrevented()||(_this.options.shortcuts?_this.handleKeyMap(event):_this.preventDefaultEditableShortCuts(event)),_this.isLimited(1,event))return!1}).on("keyup",function(event){_this.context.triggerEvent("keyup",event)}).on("focus",function(event){_this.context.triggerEvent("focus",event)}).on("blur",function(event){_this.context.triggerEvent("blur",event)}).on("mousedown",function(event){_this.context.triggerEvent("mousedown",event)}).on("mouseup",function(event){_this.context.triggerEvent("mouseup",event)}).on("scroll",function(event){_this.context.triggerEvent("scroll",event)}).on("paste",function(event){_this.context.triggerEvent("paste",event)}),this.$editable.html(dom.html(this.$note)||dom.emptyPara),this.$editable.on(env.inputEventName,func.debounce(function(){_this.context.triggerEvent("change",_this.$editable.html())},100)),this.$editor.on("focusin",function(event){_this.context.triggerEvent("focusin",event)}).on("focusout",function(event){_this.context.triggerEvent("focusout",event)}),this.options.airMode||(this.options.width&&this.$editor.outerWidth(this.options.width),this.options.height&&this.$editable.outerHeight(this.options.height),this.options.maxHeight&&this.$editable.css("max-height",this.options.maxHeight),this.options.minHeight&&this.$editable.css("min-height",this.options.minHeight)),this.history.recordUndo()},Editor.prototype.destroy=function(){this.$editable.off()},Editor.prototype.handleKeyMap=function(event){var keyMap=this.options.keyMap[env.isMac?"mac":"pc"],keys=[];event.metaKey&&keys.push("CMD"),event.ctrlKey&&!event.altKey&&keys.push("CTRL"),event.shiftKey&&keys.push("SHIFT");var keyName=key.nameFromCode[event.keyCode];keyName&&keys.push(keyName);var eventName=keyMap[keys.join("+")];eventName?!1!==this.context.invoke(eventName)&&event.preventDefault():key.isEdit(event.keyCode)&&this.afterCommand()},Editor.prototype.preventDefaultEditableShortCuts=function(event){(event.ctrlKey||event.metaKey)&&lists.contains([66,73,85],event.keyCode)&&event.preventDefault()},Editor.prototype.isLimited=function(pad,event){return pad=pad||0,!("undefined"!=typeof event&&(key.isMove(event.keyCode)||event.ctrlKey||event.metaKey||lists.contains([key.code.BACKSPACE,key.code.DELETE],event.keyCode)))&&!!(0<this.options.maxTextLength&&this.$editable.text().length+pad>=this.options.maxTextLength)},Editor.prototype.createRange=function(){return this.focus(),range.create(this.editable)},Editor.prototype.saveRange=function(thenCollapse){this.lastRange=this.createRange(),thenCollapse&&this.lastRange.collapse().select()},Editor.prototype.restoreRange=function(){this.lastRange&&(this.lastRange.select(),this.focus())},Editor.prototype.saveTarget=function(node){this.$editable.data("target",node)},Editor.prototype.clearTarget=function(){this.$editable.removeData("target")},Editor.prototype.restoreTarget=function(){return this.$editable.data("target")},Editor.prototype.currentStyle=function(){var rng=range.create();return rng&&(rng=rng.normalize()),rng?this.style.current(rng):this.style.fromNode(this.$editable)},Editor.prototype.styleFromNode=function($node){return this.style.fromNode($node)},Editor.prototype.undo=function(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.undo(),this.context.triggerEvent("change",this.$editable.html())},Editor.prototype.redo=function(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.redo(),this.context.triggerEvent("change",this.$editable.html())},Editor.prototype.beforeCommand=function(){this.context.triggerEvent("before.command",this.$editable.html()),this.focus()},Editor.prototype.afterCommand=function(isPreventTrigger){this.normalizeContent(),this.history.recordUndo(),isPreventTrigger||this.context.triggerEvent("change",this.$editable.html())},Editor.prototype.tab=function(){var rng=this.createRange();if(rng.isCollapsed()&&rng.isOnCell())this.table.tab(rng);else{if(0===this.options.tabSize)return!1;this.isLimited(this.options.tabSize)||(this.beforeCommand(),this.typing.insertTab(rng,this.options.tabSize),this.afterCommand())}},Editor.prototype.untab=function(){var rng=this.createRange();if(rng.isCollapsed()&&rng.isOnCell())this.table.tab(rng,!0);else if(0===this.options.tabSize)return!1},Editor.prototype.wrapCommand=function(fn){var _this=this;return function(){_this.beforeCommand(),fn.apply(_this,arguments),_this.afterCommand()}},Editor.prototype.insertImage=function(src,param){var _this=this;return createImage(src,param).then(function($image){_this.beforeCommand(),"function"==typeof param?param($image):("string"==typeof param&&$image.attr("data-filename",param),$image.css("width",_Mathmin(_this.$editable.width(),$image.width()))),$image.show(),range.create(_this.editable).insertNode($image[0]),range.createFromNodeAfter($image[0]).select(),_this.afterCommand()}).fail(function(e){_this.context.triggerEvent("image.upload.error",e)})},Editor.prototype.insertImages=function(files){var _this=this;$$1.each(files,function(idx,file){var filename=file.name;_this.options.maximumImageFileSize&&_this.options.maximumImageFileSize<file.size?_this.context.triggerEvent("image.upload.error",_this.lang.image.maximumFileSizeError):readFileAsDataURL(file).then(function(dataURL){return _this.insertImage(dataURL,filename)}).fail(function(){_this.context.triggerEvent("image.upload.error")})})},Editor.prototype.insertImagesOrCallback=function(files){var callbacks=this.options.callbacks;callbacks.onImageUpload?this.context.triggerEvent("image.upload",files):this.insertImages(files)},Editor.prototype.getSelectedText=function(){var rng=this.createRange();return rng.isOnAnchor()&&(rng=range.createFromNode(dom.ancestor(rng.sc,dom.isAnchor))),rng.toString()},Editor.prototype.onFormatBlock=function(tagName,$target){if(tagName=env.isMSIE?"<"+tagName+">":tagName,document.execCommand("FormatBlock",!1,tagName),$target&&$target.length){var className=$target[0].className||"";if(className){var currentRange=this.createRange(),$parent=$$1([currentRange.sc,currentRange.ec]).closest(tagName);$parent.addClass(className)}}},Editor.prototype.formatPara=function(){this.formatBlock("P")},Editor.prototype.fontStyling=function(target,value){var rng=this.createRange();if(rng){var spans=this.style.styleNodes(rng);if($$1(spans).css(target,value),rng.isCollapsed()){var firstSpan=lists.head(spans);firstSpan&&!dom.nodeLength(firstSpan)&&(firstSpan.innerHTML=dom.ZERO_WIDTH_NBSP_CHAR,range.createFromNodeAfter(firstSpan.firstChild).select(),this.$editable.data("bogus",firstSpan))}}},Editor.prototype.unlink=function(){var rng=this.createRange();if(rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor);rng=range.createFromNode(anchor),rng.select(),this.beforeCommand(),document.execCommand("unlink"),this.afterCommand()}},Editor.prototype.getLinkInfo=function(){var rng=this.createRange().expand(dom.isAnchor),$anchor=$$1(lists.head(rng.nodes(dom.isAnchor))),linkInfo={range:rng,text:rng.toString(),url:$anchor.length?$anchor.attr("href"):""};return $anchor.length&&(linkInfo.isNewWindow="_blank"===$anchor.attr("target")),linkInfo},Editor.prototype.addRow=function(position){var rng=this.createRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.addRow(rng,position),this.afterCommand())},Editor.prototype.addCol=function(position){var rng=this.createRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.addCol(rng,position),this.afterCommand())},Editor.prototype.deleteRow=function(){var rng=this.createRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.deleteRow(rng),this.afterCommand())},Editor.prototype.deleteCol=function(){var rng=this.createRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.deleteCol(rng),this.afterCommand())},Editor.prototype.deleteTable=function(){var rng=this.createRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.deleteTable(rng),this.afterCommand())},Editor.prototype.resizeTo=function(pos,$target,bKeepRatio){var imageSize;if(bKeepRatio){var newRatio=pos.y/pos.x,ratio=$target.data("ratio");imageSize={width:ratio>newRatio?pos.x:pos.y/ratio,height:ratio>newRatio?pos.x*ratio:pos.y}}else imageSize={width:pos.x,height:pos.y};$target.css(imageSize)},Editor.prototype.hasFocus=function(){return this.$editable.is(":focus")},Editor.prototype.focus=function(){this.hasFocus()||this.$editable.focus()},Editor.prototype.isEmpty=function(){return dom.isEmpty(this.$editable[0])||dom.emptyPara===this.$editable.html()},Editor.prototype.empty=function(){this.context.invoke("code",dom.emptyPara)},Editor.prototype.normalizeContent=function(){this.$editable[0].normalize()},Editor}(),Clipboard=function(){function Clipboard(context){this.context=context,this.$editable=context.layoutInfo.editable}return Clipboard.prototype.initialize=function(){this.$editable.on("paste",this.pasteByEvent.bind(this))},Clipboard.prototype.pasteByEvent=function(event){var clipboardData=event.originalEvent.clipboardData;if(clipboardData&&clipboardData.items&&clipboardData.items.length){var item=lists.head(clipboardData.items);"file"===item.kind&&-1!==item.type.indexOf("image/")&&this.context.invoke("editor.insertImagesOrCallback",[item.getAsFile()]),this.context.invoke("editor.afterCommand")}},Clipboard}(),Dropzone=function(){function Dropzone(context){this.context=context,this.$eventListener=$$1(document),this.$editor=context.layoutInfo.editor,this.$editable=context.layoutInfo.editable,this.options=context.options,this.lang=this.options.langInfo,this.documentEventHandlers={},this.$dropzone=$$1("<div class=\"note-dropzone\">  <div class=\"note-dropzone-message\"/></div>").prependTo(this.$editor)}return Dropzone.prototype.initialize=function(){this.options.disableDragAndDrop?(this.documentEventHandlers.onDrop=function(e){e.preventDefault()},this.$eventListener=this.$dropzone,this.$eventListener.on("drop",this.documentEventHandlers.onDrop)):this.attachDragAndDropEvent()},Dropzone.prototype.attachDragAndDropEvent=function(){var _this=this,collection=$$1(),$dropzoneMessage=this.$dropzone.find(".note-dropzone-message");this.documentEventHandlers.onDragenter=function(e){var isCodeview=_this.context.invoke("codeview.isActivated"),hasEditorSize=0<_this.$editor.width()&&0<_this.$editor.height();isCodeview||collection.length||!hasEditorSize||(_this.$editor.addClass("dragover"),_this.$dropzone.width(_this.$editor.width()),_this.$dropzone.height(_this.$editor.height()),$dropzoneMessage.text(_this.lang.image.dragImageHere)),collection=collection.add(e.target)},this.documentEventHandlers.onDragleave=function(e){collection=collection.not(e.target),collection.length||_this.$editor.removeClass("dragover")},this.documentEventHandlers.onDrop=function(){collection=$$1(),_this.$editor.removeClass("dragover")},this.$eventListener.on("dragenter",this.documentEventHandlers.onDragenter).on("dragleave",this.documentEventHandlers.onDragleave).on("drop",this.documentEventHandlers.onDrop),this.$dropzone.on("dragenter",function(){_this.$dropzone.addClass("hover"),$dropzoneMessage.text(_this.lang.image.dropImage)}).on("dragleave",function(){_this.$dropzone.removeClass("hover"),$dropzoneMessage.text(_this.lang.image.dragImageHere)}),this.$dropzone.on("drop",function(event){var dataTransfer=event.originalEvent.dataTransfer;event.preventDefault(),dataTransfer&&dataTransfer.files&&dataTransfer.files.length?(_this.$editable.focus(),_this.context.invoke("editor.insertImagesOrCallback",dataTransfer.files)):$$1.each(dataTransfer.types,function(idx,type){var content=dataTransfer.getData(type);-1<type.toLowerCase().indexOf("text")?_this.context.invoke("editor.pasteHTML",content):$$1(content).each(function(idx,item){_this.context.invoke("editor.insertNode",item)})})}).on("dragover",!1)},Dropzone.prototype.destroy=function(){var _this=this;Object.keys(this.documentEventHandlers).forEach(function(key){_this.$eventListener.off(key.substr(2).toLowerCase(),_this.documentEventHandlers[key])}),this.documentEventHandlers={}},Dropzone}(),CodeMirror;env.hasCodeMirror&&(env.isSupportAmd?$__require(["codemirror"],function(cm){CodeMirror=cm}):CodeMirror=window.CodeMirror);var CodeView=function(){function CodeView(context){this.context=context,this.$editor=context.layoutInfo.editor,this.$editable=context.layoutInfo.editable,this.$codable=context.layoutInfo.codable,this.options=context.options}return CodeView.prototype.sync=function(){var isCodeview=this.isActivated();isCodeview&&env.hasCodeMirror&&this.$codable.data("cmEditor").save()},CodeView.prototype.isActivated=function(){return this.$editor.hasClass("codeview")},CodeView.prototype.toggle=function(){this.isActivated()?this.deactivate():this.activate(),this.context.triggerEvent("codeview.toggled")},CodeView.prototype.activate=function(){var _this=this;if(this.$codable.val(dom.html(this.$editable,this.options.prettifyHtml)),this.$codable.height(this.$editable.height()),this.context.invoke("toolbar.updateCodeview",!0),this.$editor.addClass("codeview"),this.$codable.focus(),env.hasCodeMirror){var cmEditor_1=CodeMirror.fromTextArea(this.$codable[0],this.options.codemirror);if(this.options.codemirror.tern){var server_1=new CodeMirror.TernServer(this.options.codemirror.tern);cmEditor_1.ternServer=server_1,cmEditor_1.on("cursorActivity",function(cm){server_1.updateArgHints(cm)})}cmEditor_1.on("blur",function(event){_this.context.triggerEvent("blur.codeview",cmEditor_1.getValue(),event)}),cmEditor_1.setSize(null,this.$editable.outerHeight()),this.$codable.data("cmEditor",cmEditor_1)}else this.$codable.on("blur",function(event){_this.context.triggerEvent("blur.codeview",_this.$codable.val(),event)})},CodeView.prototype.deactivate=function(){if(env.hasCodeMirror){var cmEditor=this.$codable.data("cmEditor");this.$codable.val(cmEditor.getValue()),cmEditor.toTextArea()}var value=dom.value(this.$codable,this.options.prettifyHtml)||dom.emptyPara,isChange=this.$editable.html()!==value;this.$editable.html(value),this.$editable.height(this.options.height?this.$codable.height():"auto"),this.$editor.removeClass("codeview"),isChange&&this.context.triggerEvent("change",this.$editable.html(),this.$editable),this.$editable.focus(),this.context.invoke("toolbar.updateCodeview",!1)},CodeView.prototype.destroy=function(){this.isActivated()&&this.deactivate()},CodeView}(),Statusbar=function(){function Statusbar(context){this.$document=$$1(document),this.$statusbar=context.layoutInfo.statusbar,this.$editable=context.layoutInfo.editable,this.options=context.options}return Statusbar.prototype.initialize=function(){var _this=this;return this.options.airMode||this.options.disableResizeEditor?void this.destroy():void this.$statusbar.on("mousedown",function(event){event.preventDefault(),event.stopPropagation();var editableTop=_this.$editable.offset().top-_this.$document.scrollTop(),onMouseMove=function(event){var height=event.clientY-(editableTop+24);height=0<_this.options.minheight?_Mathmax(height,_this.options.minheight):height,height=0<_this.options.maxHeight?_Mathmin(height,_this.options.maxHeight):height,_this.$editable.height(height)};_this.$document.on("mousemove",onMouseMove).one("mouseup",function(){_this.$document.off("mousemove",onMouseMove)})})},Statusbar.prototype.destroy=function(){this.$statusbar.off(),this.$statusbar.addClass("locked")},Statusbar}(),Fullscreen=function(){function Fullscreen(context){var _this=this;this.context=context,this.$editor=context.layoutInfo.editor,this.$toolbar=context.layoutInfo.toolbar,this.$editable=context.layoutInfo.editable,this.$codable=context.layoutInfo.codable,this.$window=$$1(window),this.$scrollbar=$$1("html, body"),this.onResize=function(){_this.resizeTo({h:_this.$window.height()-_this.$toolbar.outerHeight()})}}return Fullscreen.prototype.resizeTo=function(size){this.$editable.css("height",size.h),this.$codable.css("height",size.h),this.$codable.data("cmeditor")&&this.$codable.data("cmeditor").setsize(null,size.h)},Fullscreen.prototype.toggle=function(){this.$editor.toggleClass("fullscreen"),this.isFullscreen()?(this.$editable.data("orgHeight",this.$editable.css("height")),this.$window.on("resize",this.onResize).trigger("resize"),this.$scrollbar.css("overflow","hidden")):(this.$window.off("resize",this.onResize),this.resizeTo({h:this.$editable.data("orgHeight")}),this.$scrollbar.css("overflow","visible")),this.context.invoke("toolbar.updateFullscreen",this.isFullscreen())},Fullscreen.prototype.isFullscreen=function(){return this.$editor.hasClass("fullscreen")},Fullscreen}(),Handle=function(){function Handle(context){var _this=this;this.context=context,this.$document=$$1(document),this.$editingArea=context.layoutInfo.editingArea,this.options=context.options,this.lang=this.options.langInfo,this.events={"summernote.mousedown":function(we,e){_this.update(e.target)&&e.preventDefault()},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":function(){_this.update()},"summernote.disable":function(){_this.hide()},"summernote.codeview.toggled":function(){_this.update()}}}return Handle.prototype.initialize=function(){var _this=this;this.$handle=$$1(["<div class=\"note-handle\">","<div class=\"note-control-selection\">","<div class=\"note-control-selection-bg\"></div>","<div class=\"note-control-holder note-control-nw\"></div>","<div class=\"note-control-holder note-control-ne\"></div>","<div class=\"note-control-holder note-control-sw\"></div>","<div class=\"",this.options.disableResizeImage?"note-control-holder":"note-control-sizing"," note-control-se\"></div>",this.options.disableResizeImage?"":"<div class=\"note-control-selection-info\"></div>","</div>","</div>"].join("")).prependTo(this.$editingArea),this.$handle.on("mousedown",function(event){if(dom.isControlSizing(event.target)){event.preventDefault(),event.stopPropagation();var $target_1=_this.$handle.find(".note-control-selection").data("target"),posStart_1=$target_1.offset(),scrollTop_1=_this.$document.scrollTop(),onMouseMove_1=function(event){_this.context.invoke("editor.resizeTo",{x:event.clientX-posStart_1.left,y:event.clientY-(posStart_1.top-scrollTop_1)},$target_1,!event.shiftKey),_this.update($target_1[0])};_this.$document.on("mousemove",onMouseMove_1).one("mouseup",function(e){e.preventDefault(),_this.$document.off("mousemove",onMouseMove_1),_this.context.invoke("editor.afterCommand")}),$target_1.data("ratio")||$target_1.data("ratio",$target_1.height()/$target_1.width())}}),this.$handle.on("wheel",function(e){e.preventDefault(),_this.update()})},Handle.prototype.destroy=function(){this.$handle.remove()},Handle.prototype.update=function(target){if(this.context.isDisabled())return!1;var isImage=dom.isImg(target),$selection=this.$handle.find(".note-control-selection");if(this.context.invoke("imagePopover.update",target),isImage){var $image=$$1(target),position=$image.position(),pos={left:position.left+parseInt($image.css("marginLeft"),10),top:position.top+parseInt($image.css("marginTop"),10)},imageSize={w:$image.outerWidth(!1),h:$image.outerHeight(!1)};$selection.css({display:"block",left:pos.left,top:pos.top,width:imageSize.w,height:imageSize.h}).data("target",$image);var origImageObj=new Image;origImageObj.src=$image.attr("src");var sizingText=imageSize.w+"x"+imageSize.h+" ("+this.lang.image.original+": "+origImageObj.width+"x"+origImageObj.height+")";$selection.find(".note-control-selection-info").text(sizingText),this.context.invoke("editor.saveTarget",target)}else this.hide();return isImage},Handle.prototype.hide=function(){this.context.invoke("editor.clearTarget"),this.$handle.children().hide()},Handle}(),linkPattern=/^([A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?|mailto:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i,AutoLink=function(){function AutoLink(context){var _this=this;this.context=context,this.events={"summernote.keyup":function(we,e){e.isDefaultPrevented()||_this.handleKeyup(e)},"summernote.keydown":function(we,e){_this.handleKeydown(e)}}}return AutoLink.prototype.initialize=function(){this.lastWordRange=null},AutoLink.prototype.destroy=function(){this.lastWordRange=null},AutoLink.prototype.replace=function(){if(this.lastWordRange){var keyword=this.lastWordRange.toString(),match=keyword.match(linkPattern);if(match&&(match[1]||match[2])){var link=match[1]?keyword:"http://"+keyword,node=$$1("<a />").html(keyword).attr("href",link)[0];this.lastWordRange.insertNode(node),this.lastWordRange=null,this.context.invoke("editor.focus")}}},AutoLink.prototype.handleKeydown=function(e){if(lists.contains([key.code.ENTER,key.code.SPACE],e.keyCode)){var wordRange=this.context.invoke("editor.createRange").getWordRange();this.lastWordRange=wordRange}},AutoLink.prototype.handleKeyup=function(e){lists.contains([key.code.ENTER,key.code.SPACE],e.keyCode)&&this.replace()},AutoLink}(),AutoSync=function(){function AutoSync(context){var _this=this;this.$note=context.layoutInfo.note,this.events={"summernote.change":function(){_this.$note.val(context.invoke("code"))}}}return AutoSync.prototype.shouldInitialize=function(){return dom.isTextarea(this.$note[0])},AutoSync}(),Placeholder=function(){function Placeholder(context){var _this=this;this.context=context,this.$editingArea=context.layoutInfo.editingArea,this.options=context.options,this.events={"summernote.init summernote.change":function(){_this.update()},"summernote.codeview.toggled":function(){_this.update()}}}return Placeholder.prototype.shouldInitialize=function(){return!!this.options.placeholder},Placeholder.prototype.initialize=function(){var _this=this;this.$placeholder=$$1("<div class=\"note-placeholder\">"),this.$placeholder.on("click",function(){_this.context.invoke("focus")}).text(this.options.placeholder).prependTo(this.$editingArea),this.update()},Placeholder.prototype.destroy=function(){this.$placeholder.remove()},Placeholder.prototype.update=function(){var isShow=!this.context.invoke("codeview.isActivated")&&this.context.invoke("editor.isEmpty");this.$placeholder.toggle(isShow)},Placeholder}(),Buttons=function(){function Buttons(context){this.ui=$$1.summernote.ui,this.context=context,this.$toolbar=context.layoutInfo.toolbar,this.options=context.options,this.lang=this.options.langInfo,this.invertedKeyMap=func.invertObject(this.options.keyMap[env.isMac?"mac":"pc"])}return Buttons.prototype.representShortcut=function(editorMethod){var shortcut=this.invertedKeyMap[editorMethod];return this.options.shortcuts&&shortcut?(env.isMac&&(shortcut=shortcut.replace("CMD","\u2318").replace("SHIFT","\u21E7")),shortcut=shortcut.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")," ("+shortcut+")"):""},Buttons.prototype.button=function(o){return!this.options.tooltip&&o.tooltip&&delete o.tooltip,o.container=this.options.container,this.ui.button(o)},Buttons.prototype.initialize=function(){this.addToolbarButtons(),this.addImagePopoverButtons(),this.addLinkPopoverButtons(),this.addTablePopoverButtons(),this.fontInstalledMap={}},Buttons.prototype.destroy=function(){delete this.fontInstalledMap},Buttons.prototype.isFontInstalled=function(name){return this.fontInstalledMap.hasOwnProperty(name)||(this.fontInstalledMap[name]=env.isFontInstalled(name)||lists.contains(this.options.fontNamesIgnoreCheck,name)),this.fontInstalledMap[name]},Buttons.prototype.isFontDeservedToAdd=function(name){return name=name.toLowerCase(),""!==name&&this.isFontInstalled(name)&&-1===$$1.inArray(name,["sans-serif","serif","monospace","cursive","fantasy"])},Buttons.prototype.addToolbarButtons=function(){var _this=this;this.context.memo("button.style",function(){return _this.ui.buttonGroup([_this.button({className:"dropdown-toggle",contents:_this.ui.dropdownButtonContents(_this.ui.icon(_this.options.icons.magic),_this.options),tooltip:_this.lang.style.style,data:{toggle:"dropdown"}}),_this.ui.dropdown({className:"dropdown-style",items:_this.options.styleTags,title:_this.lang.style.style,template:function(item){"string"==typeof item&&(item={tag:item,title:_this.lang.style.hasOwnProperty(item)?_this.lang.style[item]:item});var tag=item.tag,title=item.title,style=item.style?" style=\""+item.style+"\" ":"",className=item.className?" class=\""+item.className+"\"":"";return"<"+tag+style+className+">"+title+"</"+tag+">"},click:_this.context.createInvokeHandler("editor.formatBlock")})]).render()});for(var _loop_1=function(styleIdx){var item=this_1.options.styleTags[styleIdx];this_1.context.memo("button.style."+item,function(){return _this.button({className:"note-btn-style-"+item,contents:"<div data-value=\""+item+"\">"+item.toUpperCase()+"</div>",tooltip:_this.lang.style[item],click:_this.context.createInvokeHandler("editor.formatBlock")}).render()})},this_1=this,styleIdx=0,styleLen=this.options.styleTags.length;styleIdx<styleLen;styleIdx++)_loop_1(styleIdx,styleLen);this.context.memo("button.bold",function(){return _this.button({className:"note-btn-bold",contents:_this.ui.icon(_this.options.icons.bold),tooltip:_this.lang.font.bold+_this.representShortcut("bold"),click:_this.context.createInvokeHandlerAndUpdateState("editor.bold")}).render()}),this.context.memo("button.italic",function(){return _this.button({className:"note-btn-italic",contents:_this.ui.icon(_this.options.icons.italic),tooltip:_this.lang.font.italic+_this.representShortcut("italic"),click:_this.context.createInvokeHandlerAndUpdateState("editor.italic")}).render()}),this.context.memo("button.underline",function(){return _this.button({className:"note-btn-underline",contents:_this.ui.icon(_this.options.icons.underline),tooltip:_this.lang.font.underline+_this.representShortcut("underline"),click:_this.context.createInvokeHandlerAndUpdateState("editor.underline")}).render()}),this.context.memo("button.clear",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.eraser),tooltip:_this.lang.font.clear+_this.representShortcut("removeFormat"),click:_this.context.createInvokeHandler("editor.removeFormat")}).render()}),this.context.memo("button.strikethrough",function(){return _this.button({className:"note-btn-strikethrough",contents:_this.ui.icon(_this.options.icons.strikethrough),tooltip:_this.lang.font.strikethrough+_this.representShortcut("strikethrough"),click:_this.context.createInvokeHandlerAndUpdateState("editor.strikethrough")}).render()}),this.context.memo("button.superscript",function(){return _this.button({className:"note-btn-superscript",contents:_this.ui.icon(_this.options.icons.superscript),tooltip:_this.lang.font.superscript,click:_this.context.createInvokeHandlerAndUpdateState("editor.superscript")}).render()}),this.context.memo("button.subscript",function(){return _this.button({className:"note-btn-subscript",contents:_this.ui.icon(_this.options.icons.subscript),tooltip:_this.lang.font.subscript,click:_this.context.createInvokeHandlerAndUpdateState("editor.subscript")}).render()}),this.context.memo("button.fontname",function(){var styleInfo=_this.context.invoke("editor.currentStyle");return $$1.each(styleInfo["font-family"].split(","),function(idx,fontname){fontname=fontname.trim().replace(/['"]+/g,""),_this.isFontDeservedToAdd(fontname)&&-1===$$1.inArray(fontname,_this.options.fontNames)&&_this.options.fontNames.push(fontname)}),_this.ui.buttonGroup([_this.button({className:"dropdown-toggle",contents:_this.ui.dropdownButtonContents("<span class=\"note-current-fontname\"/>",_this.options),tooltip:_this.lang.font.name,data:{toggle:"dropdown"}}),_this.ui.dropdownCheck({className:"dropdown-fontname",checkClassName:_this.options.icons.menuCheck,items:_this.options.fontNames.filter(_this.isFontInstalled.bind(_this)),title:_this.lang.font.name,template:function(item){return"<span style=\"font-family: '"+item+"'\">"+item+"</span>"},click:_this.context.createInvokeHandlerAndUpdateState("editor.fontName")})]).render()}),this.context.memo("button.fontsize",function(){return _this.ui.buttonGroup([_this.button({className:"dropdown-toggle",contents:_this.ui.dropdownButtonContents("<span class=\"note-current-fontsize\"/>",_this.options),tooltip:_this.lang.font.size,data:{toggle:"dropdown"}}),_this.ui.dropdownCheck({className:"dropdown-fontsize",checkClassName:_this.options.icons.menuCheck,items:_this.options.fontSizes,title:_this.lang.font.size,click:_this.context.createInvokeHandlerAndUpdateState("editor.fontSize")})]).render()}),this.context.memo("button.color",function(){return _this.ui.buttonGroup({className:"note-color",children:[_this.button({className:"note-current-color-button",contents:_this.ui.icon(_this.options.icons.font+" note-recent-color"),tooltip:_this.lang.color.recent,click:function(e){var $button=$$1(e.currentTarget);_this.context.invoke("editor.color",{backColor:$button.attr("data-backColor"),foreColor:$button.attr("data-foreColor")})},callback:function($button){var $recentColor=$button.find(".note-recent-color");$recentColor.css("background-color","#FFFF00"),$button.attr("data-backColor","#FFFF00")}}),_this.button({className:"dropdown-toggle",contents:_this.ui.dropdownButtonContents("",_this.options),tooltip:_this.lang.color.more,data:{toggle:"dropdown"}}),_this.ui.dropdown({items:["<div class=\"note-palette\">","  <div class=\"note-palette-title\">"+_this.lang.color.background+"</div>","  <div>","    <button type=\"button\" class=\"note-color-reset btn btn-light\" data-event=\"backColor\" data-value=\"inherit\">",_this.lang.color.transparent,"    </button>","  </div>","  <div class=\"note-holder\" data-event=\"backColor\"/>","</div>","<div class=\"note-palette\">","  <div class=\"note-palette-title\">"+_this.lang.color.foreground+"</div>","  <div>","    <button type=\"button\" class=\"note-color-reset btn btn-light\" data-event=\"removeFormat\" data-value=\"foreColor\">",_this.lang.color.resetToDefault,"    </button>","  </div>","  <div class=\"note-holder\" data-event=\"foreColor\"/>","</div>"].join(""),callback:function($dropdown){$dropdown.find(".note-holder").each(function(idx,item){var $holder=$$1(item);$holder.append(_this.ui.palette({colors:_this.options.colors,colorsName:_this.options.colorsName,eventName:$holder.data("event"),container:_this.options.container,tooltip:_this.options.tooltip}).render())})},click:function(event){var $button=$$1(event.target),eventName=$button.data("event"),value=$button.data("value");if(eventName&&value){var key="backColor"===eventName?"background-color":"color",$color=$button.closest(".note-color").find(".note-recent-color"),$currentButton=$button.closest(".note-color").find(".note-current-color-button");$color.css(key,value),$currentButton.attr("data-"+eventName,value),_this.context.invoke("editor."+eventName,value)}}})]}).render()}),this.context.memo("button.ul",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.unorderedlist),tooltip:_this.lang.lists.unordered+_this.representShortcut("insertUnorderedList"),click:_this.context.createInvokeHandler("editor.insertUnorderedList")}).render()}),this.context.memo("button.ol",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.orderedlist),tooltip:_this.lang.lists.ordered+_this.representShortcut("insertOrderedList"),click:_this.context.createInvokeHandler("editor.insertOrderedList")}).render()});var justifyLeft=this.button({contents:this.ui.icon(this.options.icons.alignLeft),tooltip:this.lang.paragraph.left+this.representShortcut("justifyLeft"),click:this.context.createInvokeHandler("editor.justifyLeft")}),justifyCenter=this.button({contents:this.ui.icon(this.options.icons.alignCenter),tooltip:this.lang.paragraph.center+this.representShortcut("justifyCenter"),click:this.context.createInvokeHandler("editor.justifyCenter")}),justifyRight=this.button({contents:this.ui.icon(this.options.icons.alignRight),tooltip:this.lang.paragraph.right+this.representShortcut("justifyRight"),click:this.context.createInvokeHandler("editor.justifyRight")}),justifyFull=this.button({contents:this.ui.icon(this.options.icons.alignJustify),tooltip:this.lang.paragraph.justify+this.representShortcut("justifyFull"),click:this.context.createInvokeHandler("editor.justifyFull")}),outdent=this.button({contents:this.ui.icon(this.options.icons.outdent),tooltip:this.lang.paragraph.outdent+this.representShortcut("outdent"),click:this.context.createInvokeHandler("editor.outdent")}),indent=this.button({contents:this.ui.icon(this.options.icons.indent),tooltip:this.lang.paragraph.indent+this.representShortcut("indent"),click:this.context.createInvokeHandler("editor.indent")});this.context.memo("button.justifyLeft",func.invoke(justifyLeft,"render")),this.context.memo("button.justifyCenter",func.invoke(justifyCenter,"render")),this.context.memo("button.justifyRight",func.invoke(justifyRight,"render")),this.context.memo("button.justifyFull",func.invoke(justifyFull,"render")),this.context.memo("button.outdent",func.invoke(outdent,"render")),this.context.memo("button.indent",func.invoke(indent,"render")),this.context.memo("button.paragraph",function(){return _this.ui.buttonGroup([_this.button({className:"dropdown-toggle",contents:_this.ui.dropdownButtonContents(_this.ui.icon(_this.options.icons.alignLeft),_this.options),tooltip:_this.lang.paragraph.paragraph,data:{toggle:"dropdown"}}),_this.ui.dropdown([_this.ui.buttonGroup({className:"note-align",children:[justifyLeft,justifyCenter,justifyRight,justifyFull]}),_this.ui.buttonGroup({className:"note-list",children:[outdent,indent]})])]).render()}),this.context.memo("button.height",function(){return _this.ui.buttonGroup([_this.button({className:"dropdown-toggle",contents:_this.ui.dropdownButtonContents(_this.ui.icon(_this.options.icons.textHeight),_this.options),tooltip:_this.lang.font.height,data:{toggle:"dropdown"}}),_this.ui.dropdownCheck({items:_this.options.lineHeights,checkClassName:_this.options.icons.menuCheck,className:"dropdown-line-height",title:_this.lang.font.height,click:_this.context.createInvokeHandler("editor.lineHeight")})]).render()}),this.context.memo("button.table",function(){return _this.ui.buttonGroup([_this.button({className:"dropdown-toggle",contents:_this.ui.dropdownButtonContents(_this.ui.icon(_this.options.icons.table),_this.options),tooltip:_this.lang.table.table,data:{toggle:"dropdown"}}),_this.ui.dropdown({title:_this.lang.table.table,className:"note-table",items:"<div class=\"note-dimension-picker\">  <div class=\"note-dimension-picker-mousecatcher\" data-event=\"insertTable\" data-value=\"1x1\"/>  <div class=\"note-dimension-picker-highlighted\"/>  <div class=\"note-dimension-picker-unhighlighted\"/></div><div class=\"note-dimension-display\">1 x 1</div>"})],{callback:function($node){var $catcher=$node.find(".note-dimension-picker-mousecatcher");$catcher.css({width:_this.options.insertTableMaxSize.col+"em",height:_this.options.insertTableMaxSize.row+"em"}).mousedown(_this.context.createInvokeHandler("editor.insertTable")).on("mousemove",_this.tableMoveHandler.bind(_this))}}).render()}),this.context.memo("button.link",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.link),tooltip:_this.lang.link.link+_this.representShortcut("linkDialog.show"),click:_this.context.createInvokeHandler("linkDialog.show")}).render()}),this.context.memo("button.picture",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.picture),tooltip:_this.lang.image.image,click:_this.context.createInvokeHandler("imageDialog.show")}).render()}),this.context.memo("button.video",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.video),tooltip:_this.lang.video.video,click:_this.context.createInvokeHandler("videoDialog.show")}).render()}),this.context.memo("button.hr",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.minus),tooltip:_this.lang.hr.insert+_this.representShortcut("insertHorizontalRule"),click:_this.context.createInvokeHandler("editor.insertHorizontalRule")}).render()}),this.context.memo("button.fullscreen",function(){return _this.button({className:"btn-fullscreen",contents:_this.ui.icon(_this.options.icons.arrowsAlt),tooltip:_this.lang.options.fullscreen,click:_this.context.createInvokeHandler("fullscreen.toggle")}).render()}),this.context.memo("button.codeview",function(){return _this.button({className:"btn-codeview",contents:_this.ui.icon(_this.options.icons.code),tooltip:_this.lang.options.codeview,click:_this.context.createInvokeHandler("codeview.toggle")}).render()}),this.context.memo("button.redo",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.redo),tooltip:_this.lang.history.redo+_this.representShortcut("redo"),click:_this.context.createInvokeHandler("editor.redo")}).render()}),this.context.memo("button.undo",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.undo),tooltip:_this.lang.history.undo+_this.representShortcut("undo"),click:_this.context.createInvokeHandler("editor.undo")}).render()}),this.context.memo("button.help",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.question),tooltip:_this.lang.options.help,click:_this.context.createInvokeHandler("helpDialog.show")}).render()})},Buttons.prototype.addImagePopoverButtons=function(){var _this=this;this.context.memo("button.imageSize100",function(){return _this.button({contents:"<span class=\"note-fontsize-10\">100%</span>",tooltip:_this.lang.image.resizeFull,click:_this.context.createInvokeHandler("editor.resize","1")}).render()}),this.context.memo("button.imageSize50",function(){return _this.button({contents:"<span class=\"note-fontsize-10\">50%</span>",tooltip:_this.lang.image.resizeHalf,click:_this.context.createInvokeHandler("editor.resize","0.5")}).render()}),this.context.memo("button.imageSize25",function(){return _this.button({contents:"<span class=\"note-fontsize-10\">25%</span>",tooltip:_this.lang.image.resizeQuarter,click:_this.context.createInvokeHandler("editor.resize","0.25")}).render()}),this.context.memo("button.floatLeft",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.alignLeft),tooltip:_this.lang.image.floatLeft,click:_this.context.createInvokeHandler("editor.floatMe","left")}).render()}),this.context.memo("button.floatRight",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.alignRight),tooltip:_this.lang.image.floatRight,click:_this.context.createInvokeHandler("editor.floatMe","right")}).render()}),this.context.memo("button.floatNone",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.alignJustify),tooltip:_this.lang.image.floatNone,click:_this.context.createInvokeHandler("editor.floatMe","none")}).render()}),this.context.memo("button.removeMedia",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.trash),tooltip:_this.lang.image.remove,click:_this.context.createInvokeHandler("editor.removeMedia")}).render()})},Buttons.prototype.addLinkPopoverButtons=function(){var _this=this;this.context.memo("button.linkDialogShow",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.link),tooltip:_this.lang.link.edit,click:_this.context.createInvokeHandler("linkDialog.show")}).render()}),this.context.memo("button.unlink",function(){return _this.button({contents:_this.ui.icon(_this.options.icons.unlink),tooltip:_this.lang.link.unlink,click:_this.context.createInvokeHandler("editor.unlink")}).render()})},Buttons.prototype.addTablePopoverButtons=function(){var _this=this;this.context.memo("button.addRowUp",function(){return _this.button({className:"btn-md",contents:_this.ui.icon(_this.options.icons.rowAbove),tooltip:_this.lang.table.addRowAbove,click:_this.context.createInvokeHandler("editor.addRow","top")}).render()}),this.context.memo("button.addRowDown",function(){return _this.button({className:"btn-md",contents:_this.ui.icon(_this.options.icons.rowBelow),tooltip:_this.lang.table.addRowBelow,click:_this.context.createInvokeHandler("editor.addRow","bottom")}).render()}),this.context.memo("button.addColLeft",function(){return _this.button({className:"btn-md",contents:_this.ui.icon(_this.options.icons.colBefore),tooltip:_this.lang.table.addColLeft,click:_this.context.createInvokeHandler("editor.addCol","left")}).render()}),this.context.memo("button.addColRight",function(){return _this.button({className:"btn-md",contents:_this.ui.icon(_this.options.icons.colAfter),tooltip:_this.lang.table.addColRight,click:_this.context.createInvokeHandler("editor.addCol","right")}).render()}),this.context.memo("button.deleteRow",function(){return _this.button({className:"btn-md",contents:_this.ui.icon(_this.options.icons.rowRemove),tooltip:_this.lang.table.delRow,click:_this.context.createInvokeHandler("editor.deleteRow")}).render()}),this.context.memo("button.deleteCol",function(){return _this.button({className:"btn-md",contents:_this.ui.icon(_this.options.icons.colRemove),tooltip:_this.lang.table.delCol,click:_this.context.createInvokeHandler("editor.deleteCol")}).render()}),this.context.memo("button.deleteTable",function(){return _this.button({className:"btn-md",contents:_this.ui.icon(_this.options.icons.trash),tooltip:_this.lang.table.delTable,click:_this.context.createInvokeHandler("editor.deleteTable")}).render()})},Buttons.prototype.build=function($container,groups){for(var groupIdx=0,groupLen=groups.length;groupIdx<groupLen;groupIdx++){for(var group=groups[groupIdx],groupName=$$1.isArray(group)?group[0]:group,buttons=$$1.isArray(group)?1===group.length?[group[0]]:group[1]:[group],$group=this.ui.buttonGroup({className:"note-"+groupName}).render(),idx=0,len=buttons.length,btn;idx<len;idx++)btn=this.context.memo("button."+buttons[idx]),btn&&$group.append("function"==typeof btn?btn(this.context):btn);$group.appendTo($container)}},Buttons.prototype.updateCurrentStyle=function($container){var _this=this,$cont=$container||this.$toolbar,styleInfo=this.context.invoke("editor.currentStyle");if(this.updateBtnStates($cont,{".note-btn-bold":function(){return"bold"===styleInfo["font-bold"]},".note-btn-italic":function(){return"italic"===styleInfo["font-italic"]},".note-btn-underline":function(){return"underline"===styleInfo["font-underline"]},".note-btn-subscript":function(){return"subscript"===styleInfo["font-subscript"]},".note-btn-superscript":function(){return"superscript"===styleInfo["font-superscript"]},".note-btn-strikethrough":function(){return"strikethrough"===styleInfo["font-strikethrough"]}}),styleInfo["font-family"]){var fontNames=styleInfo["font-family"].split(",").map(function(name){return name.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")}),fontName_1=lists.find(fontNames,this.isFontInstalled.bind(this));$cont.find(".dropdown-fontname a").each(function(idx,item){var $item=$$1(item),isChecked=$item.data("value")+""==fontName_1+"";$item.toggleClass("checked",isChecked)}),$cont.find(".note-current-fontname").text(fontName_1).css("font-family",fontName_1)}if(styleInfo["font-size"]){var fontSize_1=styleInfo["font-size"];$cont.find(".dropdown-fontsize a").each(function(idx,item){var $item=$$1(item),isChecked=$item.data("value")+""==fontSize_1+"";$item.toggleClass("checked",isChecked)}),$cont.find(".note-current-fontsize").text(fontSize_1)}if(styleInfo["line-height"]){var lineHeight_1=styleInfo["line-height"];$cont.find(".dropdown-line-height li a").each(function(idx,item){var isChecked=$$1(item).data("value")+""==lineHeight_1+"";_this.className=isChecked?"checked":""})}},Buttons.prototype.updateBtnStates=function($container,infos){var _this=this;$$1.each(infos,function(selector,pred){_this.ui.toggleBtnActive($container.find(selector),pred())})},Buttons.prototype.tableMoveHandler=function(event){var PX_PER_EM=18,$picker=$$1(event.target.parentNode),$dimensionDisplay=$picker.next(),$catcher=$picker.find(".note-dimension-picker-mousecatcher"),$highlighted=$picker.find(".note-dimension-picker-highlighted"),$unhighlighted=$picker.find(".note-dimension-picker-unhighlighted"),posOffset;if(void 0===event.offsetX){var posCatcher=$$1(event.target).offset();posOffset={x:event.pageX-posCatcher.left,y:event.pageY-posCatcher.top}}else posOffset={x:event.offsetX,y:event.offsetY};var dim={c:_Mathceil(posOffset.x/PX_PER_EM)||1,r:_Mathceil(posOffset.y/PX_PER_EM)||1};$highlighted.css({width:dim.c+"em",height:dim.r+"em"}),$catcher.data("value",dim.c+"x"+dim.r),3<dim.c&&dim.c<this.options.insertTableMaxSize.col&&$unhighlighted.css({width:dim.c+1+"em"}),3<dim.r&&dim.r<this.options.insertTableMaxSize.row&&$unhighlighted.css({height:dim.r+1+"em"}),$dimensionDisplay.html(dim.c+" x "+dim.r)},Buttons}(),Toolbar=function(){function Toolbar(context){this.context=context,this.$window=$$1(window),this.$document=$$1(document),this.ui=$$1.summernote.ui,this.$note=context.layoutInfo.note,this.$editor=context.layoutInfo.editor,this.$toolbar=context.layoutInfo.toolbar,this.options=context.options,this.followScroll=this.followScroll.bind(this)}return Toolbar.prototype.shouldInitialize=function(){return!this.options.airMode},Toolbar.prototype.initialize=function(){var _this=this;this.options.toolbar=this.options.toolbar||[],this.options.toolbar.length?this.context.invoke("buttons.build",this.$toolbar,this.options.toolbar):this.$toolbar.hide(),this.options.toolbarContainer&&this.$toolbar.appendTo(this.options.toolbarContainer),this.changeContainer(!1),this.$note.on("summernote.keyup summernote.mouseup summernote.change",function(){_this.context.invoke("buttons.updateCurrentStyle")}),this.context.invoke("buttons.updateCurrentStyle"),this.options.followingToolbar&&this.$window.on("scroll resize",this.followScroll)},Toolbar.prototype.destroy=function(){this.$toolbar.children().remove(),this.options.followingToolbar&&this.$window.off("scroll resize",this.followScroll)},Toolbar.prototype.followScroll=function(){if(this.$editor.hasClass("fullscreen"))return!1;var $toolbarWrapper=this.$toolbar.parent(".note-toolbar-wrapper"),editorHeight=this.$editor.outerHeight(),editorWidth=this.$editor.width(),toolbarHeight=this.$toolbar.height();$toolbarWrapper.css({height:toolbarHeight});var otherBarHeight=0;this.options.otherStaticBar&&(otherBarHeight=$$1(this.options.otherStaticBar).outerHeight());var currentOffset=this.$document.scrollTop(),editorOffsetTop=this.$editor.offset().top,activateOffset=editorOffsetTop-otherBarHeight,deactivateOffsetBottom=editorOffsetTop+editorHeight-otherBarHeight-toolbarHeight;currentOffset>activateOffset&&currentOffset<deactivateOffsetBottom?this.$toolbar.css({position:"fixed",top:otherBarHeight,width:editorWidth}):this.$toolbar.css({position:"relative",top:0,width:"100%"})},Toolbar.prototype.changeContainer=function(isFullscreen){isFullscreen?this.$toolbar.prependTo(this.$editor):this.options.toolbarContainer&&this.$toolbar.appendTo(this.options.toolbarContainer)},Toolbar.prototype.updateFullscreen=function(isFullscreen){this.ui.toggleBtnActive(this.$toolbar.find(".btn-fullscreen"),isFullscreen),this.changeContainer(isFullscreen)},Toolbar.prototype.updateCodeview=function(isCodeview){this.ui.toggleBtnActive(this.$toolbar.find(".btn-codeview"),isCodeview),isCodeview?this.deactivate():this.activate()},Toolbar.prototype.activate=function(isIncludeCodeview){var $btn=this.$toolbar.find("button");isIncludeCodeview||($btn=$btn.not(".btn-codeview")),this.ui.toggleBtn($btn,!0)},Toolbar.prototype.deactivate=function(isIncludeCodeview){var $btn=this.$toolbar.find("button");isIncludeCodeview||($btn=$btn.not(".btn-codeview")),this.ui.toggleBtn($btn,!1)},Toolbar}(),LinkDialog=function(){function LinkDialog(context){this.context=context,this.ui=$$1.summernote.ui,this.$body=$$1(document.body),this.$editor=context.layoutInfo.editor,this.options=context.options,this.lang=this.options.langInfo,context.memo("help.linkDialog.show",this.options.langInfo.help["linkDialog.show"])}return LinkDialog.prototype.initialize=function(){var $container=this.options.dialogsInBody?this.$body:this.$editor,body=["<div class=\"form-group note-form-group\">","<label class=\"note-form-label\">"+this.lang.link.textToDisplay+"</label>","<input class=\"note-link-text form-control note-form-control  note-input\" type=\"text\" />","</div>","<div class=\"form-group note-form-group\">","<label class=\"note-form-label\">"+this.lang.link.url+"</label>","<input class=\"note-link-url form-control note-form-control note-input\" type=\"text\" value=\"http://\" />","</div>",this.options.disableLinkTarget?"":$$1("<div/>").append(this.ui.checkbox({id:"sn-checkbox-open-in-new-window",text:this.lang.link.openInNewWindow,checked:!0}).render()).html()].join(""),footer="<button type=\"submit\" href=\"#\" class=\""+"btn btn-primary note-btn note-btn-primary note-link-btn"+"\" disabled>"+this.lang.link.insert+"</button>";this.$dialog=this.ui.dialog({className:"link-dialog",title:this.lang.link.insert,fade:this.options.dialogsFade,body:body,footer:footer}).render().appendTo($container)},LinkDialog.prototype.destroy=function(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()},LinkDialog.prototype.bindEnterKey=function($input,$btn){$input.on("keypress",function(event){event.keyCode===key.code.ENTER&&(event.preventDefault(),$btn.trigger("click"))})},LinkDialog.prototype.toggleLinkBtn=function($linkBtn,$linkText,$linkUrl){this.ui.toggleBtn($linkBtn,$linkText.val()&&$linkUrl.val())},LinkDialog.prototype.showLinkDialog=function(linkInfo){var _this=this;return $$1.Deferred(function(deferred){var $linkText=_this.$dialog.find(".note-link-text"),$linkUrl=_this.$dialog.find(".note-link-url"),$linkBtn=_this.$dialog.find(".note-link-btn"),$openInNewWindow=_this.$dialog.find("input[type=checkbox]");_this.ui.onDialogShown(_this.$dialog,function(){_this.context.triggerEvent("dialog.shown"),linkInfo.url||(linkInfo.url=linkInfo.text),$linkText.val(linkInfo.text);var handleLinkTextUpdate=function(){_this.toggleLinkBtn($linkBtn,$linkText,$linkUrl),linkInfo.text=$linkText.val()};$linkText.on("input",handleLinkTextUpdate).on("paste",function(){setTimeout(handleLinkTextUpdate,0)});var handleLinkUrlUpdate=function(){_this.toggleLinkBtn($linkBtn,$linkText,$linkUrl),linkInfo.text||$linkText.val($linkUrl.val())};$linkUrl.on("input",handleLinkUrlUpdate).on("paste",function(){setTimeout(handleLinkUrlUpdate,0)}).val(linkInfo.url),env.isSupportTouch||$linkUrl.trigger("focus"),_this.toggleLinkBtn($linkBtn,$linkText,$linkUrl),_this.bindEnterKey($linkUrl,$linkBtn),_this.bindEnterKey($linkText,$linkBtn);var isChecked=void 0===linkInfo.isNewWindow?_this.context.options.linkTargetBlank:linkInfo.isNewWindow;$openInNewWindow.prop("checked",isChecked),$linkBtn.one("click",function(event){event.preventDefault(),deferred.resolve({range:linkInfo.range,url:$linkUrl.val(),text:$linkText.val(),isNewWindow:$openInNewWindow.is(":checked")}),_this.ui.hideDialog(_this.$dialog)})}),_this.ui.onDialogHidden(_this.$dialog,function(){$linkText.off("input paste keypress"),$linkUrl.off("input paste keypress"),$linkBtn.off("click"),"pending"===deferred.state()&&deferred.reject()}),_this.ui.showDialog(_this.$dialog)}).promise()},LinkDialog.prototype.show=function(){var _this=this,linkInfo=this.context.invoke("editor.getLinkInfo");this.context.invoke("editor.saveRange"),this.showLinkDialog(linkInfo).then(function(linkInfo){_this.context.invoke("editor.restoreRange"),_this.context.invoke("editor.createLink",linkInfo)}).fail(function(){_this.context.invoke("editor.restoreRange")})},LinkDialog}(),LinkPopover=function(){function LinkPopover(context){var _this=this;this.context=context,this.ui=$$1.summernote.ui,this.options=context.options,this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){_this.update()},"summernote.disable summernote.dialog.shown":function(){_this.hide()}}}return LinkPopover.prototype.shouldInitialize=function(){return!lists.isEmpty(this.options.popover.link)},LinkPopover.prototype.initialize=function(){this.$popover=this.ui.popover({className:"note-link-popover",callback:function($node){var $content=$node.find(".popover-content,.note-popover-content");$content.prepend("<span><a target=\"_blank\"></a>&nbsp;</span>")}}).render().appendTo(this.options.container);var $content=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",$content,this.options.popover.link)},LinkPopover.prototype.destroy=function(){this.$popover.remove()},LinkPopover.prototype.update=function(){if(!this.context.invoke("editor.hasFocus"))return void this.hide();var rng=this.context.invoke("editor.createRange");if(rng.isCollapsed()&&rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor),href=$$1(anchor).attr("href");this.$popover.find("a").attr("href",href).html(href);var pos=dom.posFromPlaceholder(anchor);this.$popover.css({display:"block",left:pos.left,top:pos.top})}else this.hide()},LinkPopover.prototype.hide=function(){this.$popover.hide()},LinkPopover}(),ImageDialog=function(){function ImageDialog(context){this.context=context,this.ui=$$1.summernote.ui,this.$body=$$1(document.body),this.$editor=context.layoutInfo.editor,this.options=context.options,this.lang=this.options.langInfo}return ImageDialog.prototype.initialize=function(){var $container=this.options.dialogsInBody?this.$body:this.$editor,imageLimitation="";if(this.options.maximumImageFileSize){var unit=_Mathfloor(_Mathlog(this.options.maximumImageFileSize)/6.931471805599453),readableSize=1*(this.options.maximumImageFileSize/_Mathpow(1024,unit)).toFixed(2)+" "+" KMGTP"[unit]+"B";imageLimitation="<small>"+(this.lang.image.maximumFileSize+" : "+readableSize)+"</small>"}var body=["<div class=\"form-group note-form-group note-group-select-from-files\">","<label class=\"note-form-label\">"+this.lang.image.selectFromFiles+"</label>","<input class=\"note-image-input note-form-control note-input\" "," type=\"file\" name=\"files\" accept=\"image/*\" multiple=\"multiple\" />",imageLimitation,"</div>","<div class=\"form-group note-group-image-url\" style=\"overflow:auto;\">","<label class=\"note-form-label\">"+this.lang.image.url+"</label>","<input class=\"note-image-url form-control note-form-control note-input "," col-md-12\" type=\"text\" />","</div>"].join(""),footer="<button type=\"submit\" href=\"#\" class=\""+"btn btn-primary note-btn note-btn-primary note-image-btn"+"\" disabled>"+this.lang.image.insert+"</button>";this.$dialog=this.ui.dialog({title:this.lang.image.insert,fade:this.options.dialogsFade,body:body,footer:footer}).render().appendTo($container)},ImageDialog.prototype.destroy=function(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()},ImageDialog.prototype.bindEnterKey=function($input,$btn){$input.on("keypress",function(event){event.keyCode===key.code.ENTER&&(event.preventDefault(),$btn.trigger("click"))})},ImageDialog.prototype.show=function(){var _this=this;this.context.invoke("editor.saveRange"),this.showImageDialog().then(function(data){_this.ui.hideDialog(_this.$dialog),_this.context.invoke("editor.restoreRange"),"string"==typeof data?_this.context.invoke("editor.insertImage",data):_this.context.invoke("editor.insertImagesOrCallback",data)}).fail(function(){_this.context.invoke("editor.restoreRange")})},ImageDialog.prototype.showImageDialog=function(){var _this=this;return $$1.Deferred(function(deferred){var $imageInput=_this.$dialog.find(".note-image-input"),$imageUrl=_this.$dialog.find(".note-image-url"),$imageBtn=_this.$dialog.find(".note-image-btn");_this.ui.onDialogShown(_this.$dialog,function(){_this.context.triggerEvent("dialog.shown"),$imageInput.replaceWith($imageInput.clone().on("change",function(event){deferred.resolve(event.target.files||event.target.value)}).val("")),$imageBtn.click(function(event){event.preventDefault(),deferred.resolve($imageUrl.val())}),$imageUrl.on("keyup paste",function(){var url=$imageUrl.val();_this.ui.toggleBtn($imageBtn,url)}).val(""),env.isSupportTouch||$imageUrl.trigger("focus"),_this.bindEnterKey($imageUrl,$imageBtn)}),_this.ui.onDialogHidden(_this.$dialog,function(){$imageInput.off("change"),$imageUrl.off("keyup paste keypress"),$imageBtn.off("click"),"pending"===deferred.state()&&deferred.reject()}),_this.ui.showDialog(_this.$dialog)})},ImageDialog}(),ImagePopover=function(){function ImagePopover(context){var _this=this;this.context=context,this.ui=$$1.summernote.ui,this.editable=context.layoutInfo.editable[0],this.options=context.options,this.events={"summernote.disable":function(){_this.hide()}}}return ImagePopover.prototype.shouldInitialize=function(){return!lists.isEmpty(this.options.popover.image)},ImagePopover.prototype.initialize=function(){this.$popover=this.ui.popover({className:"note-image-popover"}).render().appendTo(this.options.container);var $content=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",$content,this.options.popover.image)},ImagePopover.prototype.destroy=function(){this.$popover.remove()},ImagePopover.prototype.update=function(target){if(dom.isImg(target)){var pos=dom.posFromPlaceholder(target),posEditor=dom.posFromPlaceholder(this.editable);this.$popover.css({display:"block",left:this.options.popatmouse?event.pageX-20:pos.left,top:this.options.popatmouse?event.pageY:_Mathmin(pos.top,posEditor.top)})}else this.hide()},ImagePopover.prototype.hide=function(){this.$popover.hide()},ImagePopover}(),TablePopover=function(){function TablePopover(context){var _this=this;this.context=context,this.ui=$$1.summernote.ui,this.options=context.options,this.events={"summernote.mousedown":function(we,e){_this.update(e.target)},"summernote.keyup summernote.scroll summernote.change":function(){_this.update()},"summernote.disable":function(){_this.hide()}}}return TablePopover.prototype.shouldInitialize=function(){return!lists.isEmpty(this.options.popover.table)},TablePopover.prototype.initialize=function(){this.$popover=this.ui.popover({className:"note-table-popover"}).render().appendTo(this.options.container);var $content=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",$content,this.options.popover.table),env.isFF&&document.execCommand("enableInlineTableEditing",!1,!1)},TablePopover.prototype.destroy=function(){this.$popover.remove()},TablePopover.prototype.update=function(target){if(this.context.isDisabled())return!1;var isCell=dom.isCell(target);if(isCell){var pos=dom.posFromPlaceholder(target);this.$popover.css({display:"block",left:pos.left,top:pos.top})}else this.hide();return isCell},TablePopover.prototype.hide=function(){this.$popover.hide()},TablePopover}(),VideoDialog=function(){function VideoDialog(context){this.context=context,this.ui=$$1.summernote.ui,this.$body=$$1(document.body),this.$editor=context.layoutInfo.editor,this.options=context.options,this.lang=this.options.langInfo}return VideoDialog.prototype.initialize=function(){var $container=this.options.dialogsInBody?this.$body:this.$editor,body=["<div class=\"form-group note-form-group row-fluid\">","<label class=\"note-form-label\">"+this.lang.video.url+" <small class=\"text-muted\">"+this.lang.video.providers+"</small></label>","<input class=\"note-video-url form-control note-form-control note-input\" type=\"text\" />","</div>"].join(""),footer="<button type=\"submit\" href=\"#\" class=\""+"btn btn-primary note-btn note-btn-primary note-video-btn"+"\" disabled>"+this.lang.video.insert+"</button>";this.$dialog=this.ui.dialog({title:this.lang.video.insert,fade:this.options.dialogsFade,body:body,footer:footer}).render().appendTo($container)},VideoDialog.prototype.destroy=function(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()},VideoDialog.prototype.bindEnterKey=function($input,$btn){$input.on("keypress",function(event){event.keyCode===key.code.ENTER&&(event.preventDefault(),$btn.trigger("click"))})},VideoDialog.prototype.createVideoNode=function(url){var ytRegExp=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,ytMatch=url.match(ytRegExp),igRegExp=/(?:www\.|\/\/)instagram\.com\/p\/(.[a-zA-Z0-9_-]*)/,igMatch=url.match(igRegExp),vRegExp=/\/\/vine\.co\/v\/([a-zA-Z0-9]+)/,vMatch=url.match(vRegExp),vimRegExp=/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*(\d+)[?]?.*/,vimMatch=url.match(vimRegExp),dmRegExp=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,dmMatch=url.match(dmRegExp),youkuRegExp=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/,youkuMatch=url.match(youkuRegExp),qqRegExp=/\/\/v\.qq\.com.*?vid=(.+)/,qqMatch=url.match(qqRegExp),qqRegExp2=/\/\/v\.qq\.com\/x?\/?(page|cover).*?\/([^\/]+)\.html\??.*/,qqMatch2=url.match(qqRegExp2),mp4RegExp=/^.+.(mp4|m4v)$/,mp4Match=url.match(mp4RegExp),oggRegExp=/^.+.(ogg|ogv)$/,oggMatch=url.match(oggRegExp),webmRegExp=/^.+.(webm)$/,webmMatch=url.match(webmRegExp),$video;if(ytMatch&&11===ytMatch[1].length){var youtubeId=ytMatch[1];$video=$$1("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+youtubeId).attr("width","640").attr("height","360")}else if(igMatch&&igMatch[0].length)$video=$$1("<iframe>").attr("frameborder",0).attr("src","https://instagram.com/p/"+igMatch[1]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(vMatch&&vMatch[0].length)$video=$$1("<iframe>").attr("frameborder",0).attr("src",vMatch[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(vimMatch&&vimMatch[3].length)$video=$$1("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+vimMatch[3]).attr("width","640").attr("height","360");else if(dmMatch&&dmMatch[2].length)$video=$$1("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+dmMatch[2]).attr("width","640").attr("height","360");else if(youkuMatch&&youkuMatch[1].length)$video=$$1("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+youkuMatch[1]);else if(qqMatch&&qqMatch[1].length||qqMatch2&&qqMatch2[2].length){var vid=qqMatch&&qqMatch[1].length?qqMatch[1]:qqMatch2[2];$video=$$1("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","310").attr("width","500").attr("src","http://v.qq.com/iframe/player.html?vid="+vid+"&amp;auto=0")}else if(mp4Match||oggMatch||webmMatch)$video=$$1("<video controls>").attr("src",url).attr("width","640").attr("height","360");else return!1;return $video.addClass("note-video-clip"),$video[0]},VideoDialog.prototype.show=function(){var _this=this,text=this.context.invoke("editor.getSelectedText");this.context.invoke("editor.saveRange"),this.showVideoDialog(text).then(function(url){_this.ui.hideDialog(_this.$dialog),_this.context.invoke("editor.restoreRange");var $node=_this.createVideoNode(url);$node&&_this.context.invoke("editor.insertNode",$node)}).fail(function(){_this.context.invoke("editor.restoreRange")})},VideoDialog.prototype.showVideoDialog=function(text){var _this=this;return $$1.Deferred(function(deferred){var $videoUrl=_this.$dialog.find(".note-video-url"),$videoBtn=_this.$dialog.find(".note-video-btn");_this.ui.onDialogShown(_this.$dialog,function(){_this.context.triggerEvent("dialog.shown"),$videoUrl.val(text).on("input",function(){_this.ui.toggleBtn($videoBtn,$videoUrl.val())}),env.isSupportTouch||$videoUrl.trigger("focus"),$videoBtn.click(function(event){event.preventDefault(),deferred.resolve($videoUrl.val())}),_this.bindEnterKey($videoUrl,$videoBtn)}),_this.ui.onDialogHidden(_this.$dialog,function(){$videoUrl.off("input"),$videoBtn.off("click"),"pending"===deferred.state()&&deferred.reject()}),_this.ui.showDialog(_this.$dialog)})},VideoDialog}(),HelpDialog=function(){function HelpDialog(context){this.context=context,this.ui=$$1.summernote.ui,this.$body=$$1(document.body),this.$editor=context.layoutInfo.editor,this.options=context.options,this.lang=this.options.langInfo}return HelpDialog.prototype.initialize=function(){var $container=this.options.dialogsInBody?this.$body:this.$editor;this.$dialog=this.ui.dialog({title:this.lang.options.help,fade:this.options.dialogsFade,body:this.createShortcutList(),footer:"<p class=\"text-center\"><a href=\"http://summernote.org/\" target=\"_blank\">Summernote 0.8.10</a> \xB7 <a href=\"https://github.com/summernote/summernote\" target=\"_blank\">Project</a> \xB7 <a href=\"https://github.com/summernote/summernote/issues\" target=\"_blank\">Issues</a></p>",callback:function($node){$node.find(".modal-body,.note-modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo($container)},HelpDialog.prototype.destroy=function(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()},HelpDialog.prototype.createShortcutList=function(){var _this=this,keyMap=this.options.keyMap[env.isMac?"mac":"pc"];return Object.keys(keyMap).map(function(key){var command=keyMap[key],$row=$$1("<div><div class=\"help-list-item\"/></div>");return $row.append($$1("<label><kbd>"+key+"</kdb></label>").css({width:180,"margin-right":10})).append($$1("<span/>").html(_this.context.memo("help."+command)||command)),$row.html()}).join("")},HelpDialog.prototype.showHelpDialog=function(){var _this=this;return $$1.Deferred(function(deferred){_this.ui.onDialogShown(_this.$dialog,function(){_this.context.triggerEvent("dialog.shown"),deferred.resolve()}),_this.ui.showDialog(_this.$dialog)}).promise()},HelpDialog.prototype.show=function(){var _this=this;this.context.invoke("editor.saveRange"),this.showHelpDialog().then(function(){_this.context.invoke("editor.restoreRange")})},HelpDialog}(),AirPopover=function(){function AirPopover(context){var _this=this;this.context=context,this.ui=$$1.summernote.ui,this.options=context.options,this.events={"summernote.keyup summernote.mouseup summernote.scroll":function(){_this.update()},"summernote.disable summernote.change summernote.dialog.shown":function(){_this.hide()},"summernote.focusout":function(we,e){!env.isFF&&(e.relatedTarget&&dom.ancestor(e.relatedTarget,func.eq(_this.$popover[0]))||_this.hide())}}}return AirPopover.prototype.shouldInitialize=function(){return this.options.airMode&&!lists.isEmpty(this.options.popover.air)},AirPopover.prototype.initialize=function(){this.$popover=this.ui.popover({className:"note-air-popover"}).render().appendTo(this.options.container);var $content=this.$popover.find(".popover-content");this.context.invoke("buttons.build",$content,this.options.popover.air)},AirPopover.prototype.destroy=function(){this.$popover.remove()},AirPopover.prototype.update=function(){var styleInfo=this.context.invoke("editor.currentStyle");if(styleInfo.range&&!styleInfo.range.isCollapsed()){var rect=lists.last(styleInfo.range.getClientRects());if(rect){var bnd=func.rect2bnd(rect);this.$popover.css({display:"block",left:_Mathmax(bnd.left+bnd.width/2,0)-20,top:bnd.top+bnd.height}),this.context.invoke("buttons.updateCurrentStyle",this.$popover)}}else this.hide()},AirPopover.prototype.hide=function(){this.$popover.hide()},AirPopover}(),POPOVER_DIST=5,HintPopover=function(){function HintPopover(context){var _this=this;this.context=context,this.ui=$$1.summernote.ui,this.$editable=context.layoutInfo.editable,this.options=context.options,this.hint=this.options.hint||[],this.direction=this.options.hintDirection||"bottom",this.hints=$$1.isArray(this.hint)?this.hint:[this.hint],this.events={"summernote.keyup":function(we,e){e.isDefaultPrevented()||_this.handleKeyup(e)},"summernote.keydown":function(we,e){_this.handleKeydown(e)},"summernote.disable summernote.dialog.shown":function(){_this.hide()}}}return HintPopover.prototype.shouldInitialize=function(){return 0<this.hints.length},HintPopover.prototype.initialize=function(){var _this=this;this.lastWordRange=null,this.$popover=this.ui.popover({className:"note-hint-popover",hideArrow:!0,direction:""}).render().appendTo(this.options.container),this.$popover.hide(),this.$content=this.$popover.find(".popover-content,.note-popover-content"),this.$content.on("click",".note-hint-item",function(){_this.$content.find(".active").removeClass("active"),$$1(_this).addClass("active"),_this.replace()})},HintPopover.prototype.destroy=function(){this.$popover.remove()},HintPopover.prototype.selectItem=function($item){this.$content.find(".active").removeClass("active"),$item.addClass("active"),this.$content[0].scrollTop=$item[0].offsetTop-this.$content.innerHeight()/2},HintPopover.prototype.moveDown=function(){var $current=this.$content.find(".note-hint-item.active"),$next=$current.next();if($next.length)this.selectItem($next);else{var $nextGroup=$current.parent().next();$nextGroup.length||($nextGroup=this.$content.find(".note-hint-group").first()),this.selectItem($nextGroup.find(".note-hint-item").first())}},HintPopover.prototype.moveUp=function(){var $current=this.$content.find(".note-hint-item.active"),$prev=$current.prev();if($prev.length)this.selectItem($prev);else{var $prevGroup=$current.parent().prev();$prevGroup.length||($prevGroup=this.$content.find(".note-hint-group").last()),this.selectItem($prevGroup.find(".note-hint-item").last())}},HintPopover.prototype.replace=function(){var $item=this.$content.find(".note-hint-item.active");if($item.length){var node=this.nodeFromItem($item);this.lastWordRange.insertNode(node),range.createFromNode(node).collapse().select(),this.lastWordRange=null,this.hide(),this.context.triggerEvent("change",this.$editable.html(),this.$editable[0]),this.context.invoke("editor.focus")}},HintPopover.prototype.nodeFromItem=function($item){var hint=this.hints[$item.data("index")],item=$item.data("item"),node=hint.content?hint.content(item):item;return"string"==typeof node&&(node=dom.createText(node)),node},HintPopover.prototype.createItemTemplates=function(hintIdx,items){var hint=this.hints[hintIdx];return items.map(function(item){var $item=$$1("<div class=\"note-hint-item\"/>");return $item.append(hint.template?hint.template(item):item+""),$item.data({index:hintIdx,item:item}),$item})},HintPopover.prototype.handleKeydown=function(e){this.$popover.is(":visible")&&(e.keyCode===key.code.ENTER?(e.preventDefault(),this.replace()):e.keyCode===key.code.UP?(e.preventDefault(),this.moveUp()):e.keyCode===key.code.DOWN&&(e.preventDefault(),this.moveDown()))},HintPopover.prototype.searchKeyword=function(index,keyword,callback){var hint=this.hints[index];if(hint&&hint.match.test(keyword)&&hint.search){var matches=hint.match.exec(keyword);hint.search(matches[1],callback)}else callback()},HintPopover.prototype.createGroup=function(idx,keyword){var _this=this,$group=$$1("<div class=\"note-hint-group note-hint-group-"+idx+"\"/>");return this.searchKeyword(idx,keyword,function(items){items=items||[],items.length&&($group.html(_this.createItemTemplates(idx,items)),_this.show())}),$group},HintPopover.prototype.handleKeyup=function(e){var _this=this;if(!lists.contains([key.code.ENTER,key.code.UP,key.code.DOWN],e.keyCode)){var wordRange=this.context.invoke("editor.createRange").getWordRange(),keyword_1=wordRange.toString();if(this.hints.length&&keyword_1){this.$content.empty();var bnd=func.rect2bnd(lists.last(wordRange.getClientRects()));bnd&&(this.$popover.hide(),this.lastWordRange=wordRange,this.hints.forEach(function(hint,idx){hint.match.test(keyword_1)&&_this.createGroup(idx,keyword_1).appendTo(_this.$content)}),this.$content.find(".note-hint-item:first").addClass("active"),"top"===this.direction?this.$popover.css({left:bnd.left,top:bnd.top-this.$popover.outerHeight()-POPOVER_DIST}):this.$popover.css({left:bnd.left,top:bnd.top+bnd.height+POPOVER_DIST}))}else this.hide()}},HintPopover.prototype.show=function(){this.$popover.show()},HintPopover.prototype.hide=function(){this.$popover.hide()},HintPopover}(),Context=function(){function Context($note,options){this.ui=$$1.summernote.ui,this.$note=$note,this.memos={},this.modules={},this.layoutInfo={},this.options=options,this.initialize()}return Context.prototype.initialize=function(){return this.layoutInfo=this.ui.createLayout(this.$note,this.options),this._initialize(),this.$note.hide(),this},Context.prototype.destroy=function(){this._destroy(),this.$note.removeData("summernote"),this.ui.removeLayout(this.$note,this.layoutInfo)},Context.prototype.reset=function(){var disabled=this.isDisabled();this.code(dom.emptyPara),this._destroy(),this._initialize(),disabled&&this.disable()},Context.prototype._initialize=function(){var _this=this,buttons=$$1.extend({},this.options.buttons);Object.keys(buttons).forEach(function(key){_this.memo("button."+key,buttons[key])});var modules=$$1.extend({},this.options.modules,$$1.summernote.plugins||{});Object.keys(modules).forEach(function(key){_this.module(key,modules[key],!0)}),Object.keys(this.modules).forEach(function(key){_this.initializeModule(key)})},Context.prototype._destroy=function(){var _this=this;Object.keys(this.modules).reverse().forEach(function(key){_this.removeModule(key)}),Object.keys(this.memos).forEach(function(key){_this.removeMemo(key)}),this.triggerEvent("destroy",this)},Context.prototype.code=function(html){var isActivated=this.invoke("codeview.isActivated");return void 0===html?(this.invoke("codeview.sync"),isActivated?this.layoutInfo.codable.val():this.layoutInfo.editable.html()):void(isActivated?this.layoutInfo.codable.val(html):this.layoutInfo.editable.html(html),this.$note.val(html),this.triggerEvent("change",html))},Context.prototype.isDisabled=function(){return"false"===this.layoutInfo.editable.attr("contenteditable")},Context.prototype.enable=function(){this.layoutInfo.editable.attr("contenteditable",!0),this.invoke("toolbar.activate",!0),this.triggerEvent("disable",!1)},Context.prototype.disable=function(){this.invoke("codeview.isActivated")&&this.invoke("codeview.deactivate"),this.layoutInfo.editable.attr("contenteditable",!1),this.invoke("toolbar.deactivate",!0),this.triggerEvent("disable",!0)},Context.prototype.triggerEvent=function(){var namespace=lists.head(arguments),args=lists.tail(lists.from(arguments)),callback=this.options.callbacks[func.namespaceToCamel(namespace,"on")];callback&&callback.apply(this.$note[0],args),this.$note.trigger("summernote."+namespace,args)},Context.prototype.initializeModule=function(key){var module=this.modules[key];module.shouldInitialize=module.shouldInitialize||func.ok,module.shouldInitialize()&&(module.initialize&&module.initialize(),module.events&&dom.attachEvents(this.$note,module.events))},Context.prototype.module=function(key,ModuleClass,withoutIntialize){return 1===arguments.length?this.modules[key]:void(this.modules[key]=new ModuleClass(this),!withoutIntialize&&this.initializeModule(key))},Context.prototype.removeModule=function(key){var module=this.modules[key];module.shouldInitialize()&&(module.events&&dom.detachEvents(this.$note,module.events),module.destroy&&module.destroy()),delete this.modules[key]},Context.prototype.memo=function(key,obj){return 1===arguments.length?this.memos[key]:void(this.memos[key]=obj)},Context.prototype.removeMemo=function(key){this.memos[key]&&this.memos[key].destroy&&this.memos[key].destroy(),delete this.memos[key]},Context.prototype.createInvokeHandlerAndUpdateState=function(namespace,value){var _this=this;return function(event){_this.createInvokeHandler(namespace,value)(event),_this.invoke("buttons.updateCurrentStyle")}},Context.prototype.createInvokeHandler=function(namespace,value){var _this=this;return function(event){event.preventDefault();var $target=$$1(event.target);_this.invoke(namespace,value||$target.closest("[data-value]").data("value"),$target)}},Context.prototype.invoke=function(){var namespace=lists.head(arguments),args=lists.tail(lists.from(arguments)),splits=namespace.split("."),hasSeparator=1<splits.length,moduleName=hasSeparator&&lists.head(splits),methodName=hasSeparator?lists.last(splits):lists.head(splits),module=this.modules[moduleName||"editor"];return!moduleName&&this[methodName]?this[methodName].apply(this,args):module&&module[methodName]&&module.shouldInitialize()?module[methodName].apply(module,args):void 0},Context}();$$1.fn.extend({summernote:function(){var type=$$1.type(lists.head(arguments)),options=$$1.extend({},$$1.summernote.options,"object"===type?lists.head(arguments):{});options.langInfo=$$1.extend(!0,{},$$1.summernote.lang["en-US"],$$1.summernote.lang[options.lang]),options.icons=$$1.extend(!0,{},$$1.summernote.options.icons,options.icons),options.tooltip="auto"===options.tooltip?!env.isSupportTouch:options.tooltip,this.each(function(idx,note){var $note=$$1(note);if(!$note.data("summernote")){var context=new Context($note,options);$note.data("summernote",context),$note.data("summernote").triggerEvent("init",context.layoutInfo)}});var $note=this.first();if($note.length){var context=$note.data("summernote");if("string"===type)return context.invoke.apply(context,lists.from(arguments));options.focus&&context.invoke("editor.focus")}return this}}),$$1.summernote=$$1.extend($$1.summernote,{version:"0.8.10",ui:ui,dom:dom,plugins:{},options:{modules:{editor:Editor,clipboard:Clipboard,dropzone:Dropzone,codeview:CodeView,statusbar:Statusbar,fullscreen:Fullscreen,handle:Handle,hintPopover:HintPopover,autoLink:AutoLink,autoSync:AutoSync,placeholder:Placeholder,buttons:Buttons,toolbar:Toolbar,linkDialog:LinkDialog,linkPopover:LinkPopover,imageDialog:ImageDialog,imagePopover:ImagePopover,tablePopover:TablePopover,videoDialog:VideoDialog,helpDialog:HelpDialog,airPopover:AirPopover},buttons:{},lang:"en-US",followingToolbar:!0,otherStaticBar:"",toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popatmouse:!0,popover:{image:[["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],table:[["add",["addRowDown","addRowUp","addColLeft","addColRight"]],["delete",["deleteRow","deleteCol","deleteTable"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]]},airMode:!1,width:null,height:null,linkTargetBlank:!0,focus:!1,tabSize:4,styleWithSpan:!0,shortcuts:!0,textareaAutoSync:!0,hintDirection:"bottom",tooltip:"auto",container:"body",maxTextLength:0,styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontSizes:["8","9","10","11","12","14","18","24","36"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],colorsName:[["Black","Tundora","Dove Gray","Star Dust","Pale Slate","Gallery","Alabaster","White"],["Red","Orange Peel","Yellow","Green","Cyan","Blue","Electric Violet","Magenta"],["Azalea","Karry","Egg White","Zanah","Botticelli","Tropical Blue","Mischka","Twilight"],["Tonys Pink","Peach Orange","Cream Brulee","Sprout","Casper","Perano","Cold Purple","Careys Pink"],["Mandy","Rajah","Dandelion","Olivine","Gulf Stream","Viking","Blue Marguerite","Puce"],["Guardsman Red","Fire Bush","Golden Dream","Chelsea Cucumber","Smalt Blue","Boston Blue","Butterfly Bush","Cadillac"],["Sangria","Mai Tai","Buddha Gold","Forest Green","Eden","Venice Blue","Meteorite","Claret"],["Rosewood","Cinnamon","Olive","Parsley","Tiber","Midnight Blue","Valentino","Loulou"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:!1,dialogsFade:!1,maximumImageFileSize:null,callbacks:{onInit:null,onFocus:null,onBlur:null,onBlurCodeview:null,onEnter:null,onKeyup:null,onKeydown:null,onImageUpload:null,onImageUploadError:null},codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"note-icon-align",alignCenter:"note-icon-align-center",alignJustify:"note-icon-align-justify",alignLeft:"note-icon-align-left",alignRight:"note-icon-align-right",rowBelow:"note-icon-row-below",colBefore:"note-icon-col-before",colAfter:"note-icon-col-after",rowAbove:"note-icon-row-above",rowRemove:"note-icon-row-remove",colRemove:"note-icon-col-remove",indent:"note-icon-align-indent",outdent:"note-icon-align-outdent",arrowsAlt:"note-icon-arrows-alt",bold:"note-icon-bold",caret:"note-icon-caret",circle:"note-icon-circle",close:"note-icon-close",code:"note-icon-code",eraser:"note-icon-eraser",font:"note-icon-font",frame:"note-icon-frame",italic:"note-icon-italic",link:"note-icon-link",unlink:"note-icon-chain-broken",magic:"note-icon-magic",menuCheck:"note-icon-menu-check",minus:"note-icon-minus",orderedlist:"note-icon-orderedlist",pencil:"note-icon-pencil",picture:"note-icon-picture",question:"note-icon-question",redo:"note-icon-redo",square:"note-icon-square",strikethrough:"note-icon-strikethrough",subscript:"note-icon-subscript",superscript:"note-icon-superscript",table:"note-icon-table",textHeight:"note-icon-text-height",trash:"note-icon-trash",underline:"note-icon-underline",undo:"note-icon-undo",unorderedlist:"note-icon-unorderedlist",video:"note-icon-video"}}})})}),function(){var define=$__System.amdDefine;define("85",["84"],function(main){return main})}(),function(){var define=$__System.amdDefine;(function(global,factory){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)})("undefined"==typeof window?this:window,function(window,noGlobal){"use strict";function DOMEval(code,doc,node){doc=doc||document;var script=doc.createElement("script"),i;if(script.text=code,node)for(i in preservedScriptAttributes)node[i]&&(script[i]=node[i]);doc.head.appendChild(script).parentNode.removeChild(script)}function toType(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj}function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=toType(obj);return!(isFunction(obj)||isWindow(obj))&&("array"===type||0===length||"number"==typeof length&&0<length&&length-1 in obj)}function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()}function winnow(elements,qualifier,not){return isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not}):"string"==typeof qualifier?jQuery.filter(qualifier,elements,not):jQuery.grep(elements,function(elem){return-1<indexOf.call(qualifier,elem)!==not})}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0}),object}function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject,noValue){var method;try{value&&isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&isFunction(method=value.then)?method.call(value,resolve,reject):resolve.apply(void 0,[value].slice(noValue))}catch(value){reject.apply(void 0,[value])}}function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}function fcamelCase(all,letter){return letter.toUpperCase()}function camelCase(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)}function Data(){this.expando=jQuery.expando+Data.uid++}function getData(data){return"true"===data||"false"!==data&&("null"===data?null:data===+data+""?+data:rbrace.test(data)?JSON.parse(data):data)}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),data=elem.getAttribute(name),"string"==typeof data){try{data=getData(data)}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}function adjustCSS(elem,prop,valueParts,tween){var maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop)),adjusted,scale;if(initialInUnit&&initialInUnit[3]!==unit){for(initial/=2,unit=unit||initialInUnit[3],initialInUnit=+initial||1;maxIterations--;)jQuery.style(elem,prop,initialInUnit+unit),0>=(1-scale)*(1-(scale=currentValue()/initial||.5))&&(maxIterations=0),initialInUnit/=scale;initialInUnit*=2,jQuery.style(elem,prop,initialInUnit+unit),valueParts=valueParts||[]}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}function getDefaultDisplay(elem){var doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName],temp;return display?display:(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,"display"),temp.parentNode.removeChild(temp),"none"===display&&(display="block"),defaultDisplayMap[nodeName]=display,display)}function showHide(elements,show){for(var values=[],index=0,length=elements.length,display,elem;index<length;index++)(elem=elements[index],!!elem.style)&&(display=elem.style.display,show?("none"===display&&(values[index]=dataPriv.get(elem,"display")||null,!values[index]&&(elem.style.display="")),""===elem.style.display&&isHiddenWithinTree(elem)&&(values[index]=getDefaultDisplay(elem))):"none"!==display&&(values[index]="none",dataPriv.set(elem,"display",display)));for(index=0;index<length;index++)null!=values[index]&&(elements[index].style.display=values[index]);return elements}function getAll(context,tag){var ret;return ret="undefined"==typeof context.getElementsByTagName?"undefined"==typeof context.querySelectorAll?[]:context.querySelectorAll(tag||"*"):context.getElementsByTagName(tag||"*"),void 0===tag||tag&&nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;i<l;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}function buildFragment(elems,context,scripts,selection,ignored){for(var fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length,elem,tmp,tag,wrap,contains,j;i<l;i++)if(elem=elems[i],elem||0===elem)if("object"===toType(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(!rhtml.test(elem))nodes.push(context.createTextNode(elem));else{for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}for(fragment.textContent="",i=0;elem=nodes[i++];){if(selection&&-1<jQuery.inArray(elem,selection)){ignored&&ignored.push(elem);continue}if(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem)}return fragment}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){for(type in"string"!=typeof selector&&(data=data||selector,selector=void 0),types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),!1===fn)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function manipulationTarget(elem,content){return nodeName(elem,"table")&&nodeName(11===content.nodeType?content.firstChild:content,"tr")?jQuery(elem).children("tbody")[0]||elem:elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){return"true/"===(elem.type||"").slice(0,5)?elem.type=elem.type.slice(5):elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(pdataOld=dataPriv.access(src),pdataCur=dataPriv.set(dest,pdataOld),events=pdataOld.events,events))for(type in delete pdataCur.handle,pdataCur.events={},events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i]);dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var i=0,l=collection.length,value=args[0],valueIsFunction=isFunction(value),fragment,first,scripts,hasScripts,node,doc;if(valueIsFunction||1<l&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);valueIsFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;i<l;i++)node=fragment,i!=l-1&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src&&"module"!==(node.type||"").toLowerCase()?jQuery._evalUrl&&jQuery._evalUrl(node.src):DOMEval(node.textContent.replace(rcleanScript,""),doc,node))}return collection}function remove(elem,selector,keepData){for(var nodes=selector?jQuery.filter(selector,elem):elem,i=0,node;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}function curCSS(elem,name,computed){var style=elem.style,width,minWidth,maxWidth,ret;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name],""===ret&&!jQuery.contains(elem.ownerDocument,elem)&&(ret=jQuery.style(elem,name)),!support.pixelBoxStyles()&&rnumnonpx.test(ret)&&rboxStyle.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0===ret?ret:ret+""}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(name){if(name in emptyStyle)return name;for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in emptyStyle)return name}function finalPropName(name){var ret=jQuery.cssProps[name];return ret||(ret=jQuery.cssProps[name]=vendorPropName(name)||name),ret}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?_Mathmax(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function boxModelAdjustment(elem,dimension,box,isBorderBox,styles,computedVal){var i="width"===dimension?1:0,extra=0,delta=0;if(box===(isBorderBox?"border":"content"))return 0;for(;4>i;i+=2)"margin"===box&&(delta+=jQuery.css(elem,box+cssExpand[i],!0,styles)),isBorderBox?("content"===box&&(delta-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==box&&(delta-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(delta+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"===box?extra+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles):delta+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles));return!isBorderBox&&0<=computedVal&&(delta+=_Mathmax(0,_Mathceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-computedVal-delta-extra-.5))),delta}function getWidthOrHeight(elem,dimension,extra){var styles=getStyles(elem),val=curCSS(elem,dimension,styles),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles),valueIsBorderBox=isBorderBox;if(rnumnonpx.test(val)){if(!extra)return val;val="auto"}return valueIsBorderBox=valueIsBorderBox&&(support.boxSizingReliable()||val===elem.style[dimension]),"auto"!==val&&(parseFloat(val)||"inline"!==jQuery.css(elem,"display",!1,styles))||(val=elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)],valueIsBorderBox=!0),val=parseFloat(val)||0,val+boxModelAdjustment(elem,dimension,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles,val)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function schedule(){inProgress&&(!1===document.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(schedule):window.setTimeout(schedule,jQuery.fx.interval),jQuery.fx.tick())}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=Date.now()}function genFx(type,includeWidth){var i=0,attrs={height:type},which;for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length,tween;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow"),prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display;for(prop in opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show"))if("show"===value&&dataShow&&void 0!==dataShow[prop])hidden=!0;else continue;orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if(propTween=!jQuery.isEmptyObject(props),propTween||!jQuery.isEmptyObject(orig))for(prop in isBox&&1===elem.nodeType&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],restoreDisplay=dataShow&&dataShow.display,null==restoreDisplay&&(restoreDisplay=dataPriv.get(elem,"display")),display=jQuery.css(elem,"display"),"none"===display&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,"display"),showHide([elem]))),("inline"===display||"inline-block"===display&&null!=restoreDisplay)&&"none"===jQuery.css(elem,"float")&&(!propTween&&(anim.done(function(){style.display=restoreDisplay}),null==restoreDisplay&&(display=style.display,restoreDisplay="none"===display?"":display)),style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]})),propTween=!1,orig)propTween||(dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){for(prop in hidden||showHide([elem]),dataPriv.remove(elem,"fxshow"),orig)jQuery.style(elem,prop,orig[prop])})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0))}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=camelCase(index),easing=specialEasing[name],value=props[index],Array.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!=name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks)for(index in value=hooks.expand(value),delete props[name],value)index in props||(props[index]=value[index],specialEasing[index]=easing);else specialEasing[name]=easing}function Animation(elem,properties,options){var index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=_Mathmax(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return(deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length)?remaining:(length||deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props,result,stopped;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts),result)return isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=result.stop.bind(result)),result;return jQuery.map(props,createTween,animation),isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation}function stripAndCollapse(value){var tokens=value.match(rnothtmlwhite)||[];return tokens.join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function classesToArray(value){return Array.isArray(value)?value:"string"==typeof value?value.match(rnothtmlwhite)||[]:[]}function buildParams(prefix,obj,traditional,add){if(Array.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(!traditional&&"object"===toType(obj))for(var name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add);else add(prefix,obj)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[],dataType;if(isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var flatOptions=jQuery.ajaxSettings.flatOptions||{},key,deep;for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var contents=s.contents,dataTypes=s.dataTypes,ct,type,finalDataType,firstDataType;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var converters={},dataTypes=s.dataTypes.slice(),conv2,current,conv,tmp,prev;if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift(),current)if("*"===current)current=prev;else if("*"!==prev&&prev!=current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]],conv)){!0===conv?conv=converters[conv2]:!0!==converters[conv2]&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(!0!==conv)if(conv&&s.throws)response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}var arr=[],document=window.document,getProto=Object.getPrototypeOf,slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),support={},isFunction=function(obj){return"function"==typeof obj&&"number"!=typeof obj.nodeType},isWindow=function(obj){return null!=obj&&obj===obj.window},preservedScriptAttributes={type:!0,src:!0,noModule:!0},version="3.3.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){return null==num?slice.call(this):0>num?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(0<=j&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var target=arguments[0]||{},i=1,length=arguments.length,deep=!1,options,name,src,copy,copyIsArray,clone;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)(src=target[name],copy=options[name],target!==copy)&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&Array.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isPlainObject:function(obj){var proto,Ctor;return!!(obj&&"[object Object]"===toString.call(obj))&&((proto=getProto(obj),!!!proto)||(Ctor=hasOwn.call(proto,"constructor")&&proto.constructor,"function"==typeof Ctor&&fnToString.call(Ctor)===ObjectFunctionString))},isEmptyObject:function(obj){for(var name in obj)return!1;return!0},globalEval:function(code){DOMEval(code)},each:function(obj,callback){var i=0,length;if(isArrayLike(obj))for(length=obj.length;i<length&&!1!==callback.call(obj[i],i,obj[i]);i++);else for(i in obj)if(!1===callback.call(obj[i],i,obj[i]))break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var matches=[],i=0,length=elems.length,callbackInverse;i<length;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==!invert&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var i=0,ret=[],length,value;if(isArrayLike(elems))for(length=elems.length;i<length;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each(["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error","Symbol"],function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9,m,i,elem,nid,match,groups,newSelector;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(!(m=match[1])){if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}else if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results;if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(1!==nodeType)newContext=context,newSelector=selector;else if("object"!==context.nodeName.toLowerCase()){for((nid=context.getAttribute("id"))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute("id",nid=expando),groups=tokenize(selector),i=groups.length;i--;)groups[i]="#"+nid+" "+toSelector(groups[i]);newSelector=groups.join(","),newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return!1}finally{el.parentNode&&el.parentNode.removeChild(el),el=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createDisabledPseudo(disabled){return function(elem){return"form"in elem?elem.parentNode&&!1===elem.disabled?"label"in elem?"label"in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&disabledAncestor(elem)===disabled:elem.disabled===disabled:!!("label"in elem)&&elem.disabled===disabled}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var matchIndexes=fn([],seed.length,argument),i=matchIndexes.length,j;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&"parentNode"===key,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml);return!1}:function(elem,context,xml){var newCache=[dirruns,doneName],oldCache,uniqueCache,outerCache;if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0;}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else{if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(uniqueCache[key]=newCache,newCache[2]=matcher(elem,context,xml))return!0}return!1}}function elementMatcher(matchers){return 1<matchers.length?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var newUnmatched=[],i=0,len=unmatched.length,elem;i<len;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),null!=map&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn,temp,i,elem;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(!seed)matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut);else if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&-1<(temp=postFinder?indexOf(seed,elem):preMap[i])&&(seed[temp]=!(results[temp]=elem))}})}function matcherFromTokens(tokens){for(var len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return-1<indexOf(checkContext,elem)},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}],checkContext,matcher,j;i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(1<i&&elementMatcher(matchers),1<i&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=0<setMatchers.length,byElement=0<elementMatchers.length,superMatcher=function(seed,context,xml,results,outermost){var matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length,elem,j,matcher;for(outermost&&(outermostContext=context===document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument===document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(0<matchedCount)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&0<setMatched.length&&1<matchedCount+setMatchers.length&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",rwhitespace=/[\x20\t\r\n\f]+/g,rtrim=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,rcomma=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,rcombinators=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,rattributeQuotes=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,rpseudo=/:((?:\\.|[\w-]|[^\0-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\0-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\0-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,ridentifier=/^(?:\\.|[\w-]|[^\0-\xa0])+$/,matchExpr={ID:/^#((?:\\.|[\w-]|[^\0-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\0-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\0-\xa0])+|[*])/,ATTR:/^\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\0-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\0-\xa0])+))|)[\x20\t\r\n\f]*\]/,PSEUDO:/^:((?:\\.|[\w-]|[^\0-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\0-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\0-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!=high||escapedWhitespace?escaped:0>high?_StringfromCharCode(high+65536):_StringfromCharCode(55296|high>>10,56320|1023&high)},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\0"===ch?"\uFFFD":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch},unloadHandler=function(){setDocument()},disabledAncestor=addCombinator(function(elem){return!0===elem.disabled&&("form"in elem||"label"in elem)},{dir:"parentNode",next:"legend"}),i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains;try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}for(i in support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc,hasCompare,subWindow;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=document.documentElement,documentIsHTML=!isXML(document),preferredDoc!==document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener("unload",unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent("onunload",unloadHandler)),support.attributes=assert(function(el){return el.className="i",!el.getAttribute("className")}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment("")),!el.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}},Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var elem=context.getElementById(id),node,i,elems;if(elem){if(node=elem.getAttributeNode("id"),node&&node.value===id)return[elem];for(elems=context.getElementsByName(id),i=0;elem=elems[i++];)if(node=elem.getAttributeNode("id"),node&&node.value===id)return[elem]}return[]}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"==typeof context.getElementsByTagName?support.qsa?context.querySelectorAll(tag):void 0:context.getElementsByTagName(tag)}:function(tag,context){var tmp=[],i=0,results=context.getElementsByTagName(tag),elem;if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if("undefined"!=typeof context.getElementsByClassName&&documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),el.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),el.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),el.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),el.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden"),el.appendChild(input).setAttribute("name","D"),el.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),2!==el.querySelectorAll(":enabled").length&&rbuggyQSA.push(":enabled",":disabled"),docElem.appendChild(el).disabled=!0,2!==el.querySelectorAll(":disabled").length&&rbuggyQSA.push(":enabled",":disabled"),el.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,"*"),matches.call(el,"[s!='']:x"),rbuggyMatches.push("!=",":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+("\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]")+")*)|.*)\\)|)")}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&1===bup.nodeType&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b],cur;if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return 0<Sizzle(expr,document,null,[elem]).length},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0===val?support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null:val},Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var duplicates=[],j=0,i=0,elem;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var ret="",i=0,nodeType=elem.nodeType,node;if(!nodeType)for(;node=elem[i++];)ret+=getText(node);else if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue;return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(!match[3]&&Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var unquoted=!match[6]&&match[2],excess;return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&-1<result.indexOf(check):"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?-1<(" "+result.replace(rwhitespace," ")+" ").indexOf(check):"|="==operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var dir=simple==forward?"previousSibling":"nextSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1,cache,uniqueCache,outerCache,node,nodeIndex,start;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(node=parent,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(node=elem,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex),!1===diff)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&!((ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)&&++diff&&(useCache&&(outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),uniqueCache[type]=[dirruns,diff]),node===elem)););return diff-=last,diff===first||0==diff%first&&0<=diff/first}}},PSEUDO:function(pseudo,argument){var fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo),args;return fn[expando]?fn(argument):1<fn.length?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var matched=fn(seed,argument),i=matched.length,idx;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var unmatched=matcher(seed,null,xml,[]),i=seed.length,elem;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return 0<Sizzle(selector,elem).length}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return-1<(elem.textContent||elem.innerText||getText(elem)).indexOf(text)}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(6>elem.nodeType)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;0<=--i;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var cached=tokenCache[selector+" "],matched,match,tokens,type,soFar,groups,preFilters;if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){for(type in(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length)),Expr.filter)(match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))&&(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "],i;if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector),i,tokens,token,type,find;if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),2<tokens.length&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(el){return 1&el.compareDocumentPosition(document.createElement("fieldset"))}),assert(function(el){return el.innerHTML="<a href='#'></a>","#"===el.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(el){return el.innerHTML="<input/>",el.firstChild.setAttribute("value",""),""===el.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(el){return null==el.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return!0===elem[name]?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){for(var matched=[];(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(void 0!==until&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var len=this.length,self=this,i,ret;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=this.pushStack([]),i=0;i<len;i++)jQuery.find(selector,self[i],ret);return 1<len?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"==typeof selector){if(match="<"===selector[0]&&">"===selector[selector.length-1]&&3<=selector.length?[null,selector,null]:rquickExpr.exec(selector),match&&(match[1]||!context)){if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&(this[0]=elem,this.length=1),this}return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector)}return selector.nodeType?(this[0]=selector,this.length=1,this):isFunction(selector)?void 0===root.ready?selector(jQuery):root.ready(selector):jQuery.makeArray(selector,this)},rootjQuery;init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;i<l;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){var i=0,l=this.length,matched=[],targets="string"!=typeof selectors&&jQuery(selectors),cur;if(!rneedsContext.test(selectors))for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(11>cur.nodeType&&(targets?-1<targets.index(cur):1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(1<matched.length?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return nodeName(elem,"iframe")?elem.contentDocument:(nodeName(elem,"template")&&(elem=elem.content||elem),jQuery.merge([],elem.childNodes))}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),1<this.length&&(!guaranteedUnique[name]&&jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;jQuery.Callbacks=function(options){options="string"==typeof options?createOptions(options):jQuery.extend({},options);var list=[],queue=[],firingIndex=-1,fire=function(){for(locked=locked||options.once,fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)!1===list[firingIndex].apply(memory[0],memory[1])&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,locked&&(memory?list=[]:list="")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){isFunction(arg)?(!options.unique||!self.has(arg))&&list.push(arg):arg&&arg.length&&"string"!==toType(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;-1<(index=jQuery.inArray(arg,list,index));)list.splice(index,1),index<=firingIndex&&firingIndex--}),this},has:function(fn){return fn?-1<jQuery.inArray(fn,list):0<list.length},empty:function(){return list&&(list=[]),this},disable:function(){return locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return locked=queue=[],memory||firing||(list=memory=""),this},locked:function(){return!!locked},fireWith:function(context,args){return locked||(args=args||[],args=[context,args.slice?args.slice():args],queue.push(args),!firing&&fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}},firing,memory,fired,locked;return self},jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},catch:function(fn){return promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this,fn?[returned]:arguments)})}),fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(!(depth<maxDepth)){if(returned=handler.apply(that,args),returned===deferred.promise())throw new TypeError("Thenable self-resolution");then=returned&&("object"==typeof returned||"function"==typeof returned)&&returned.then,isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=void 0,args=[returned]),(special||deferred.resolveWith)(that,args))}},process=special?mightThrow:function(){try{mightThrow()}catch(e){jQuery.Deferred.exceptionHook&&jQuery.Deferred.exceptionHook(e,process.stackTrace),depth+1>=maxDepth&&(handler!==Thrower&&(that=void 0,args=[e]),deferred.rejectWith(that,args))}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process))}}var maxDepth=0;return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return null==obj?promise:jQuery.extend(obj,promise)}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[3-i][2].disable,tuples[3-i][3].disable,tuples[0][2].lock,tuples[0][3].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?void 0:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this,resolveValues[i]=1<arguments.length?slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues)}};if(1>=remaining&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining),"pending"===master.state()||isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();for(;i--;)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)},jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){return readyList.then(fn).catch(function(error){jQuery.readyException(error)}),this},jQuery.extend({isReady:!1,readyWait:1,ready:function(wait){(!0===wait?! --jQuery.readyWait:!jQuery.isReady)&&(jQuery.isReady=!0,!0!==wait&&0<--jQuery.readyWait||readyList.resolveWith(document,[jQuery]))}}),jQuery.ready.then=readyList.then,"complete"!==document.readyState&&("loading"===document.readyState||document.documentElement.doScroll)?(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed)):window.setTimeout(jQuery.ready);var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===toType(key))for(i in chainable=!0,key)access(elems,fn,i,key[i],!0,emptyGet,raw);else if(void 0!==value&&(chainable=!0,isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g,acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};Data.uid=1,Data.prototype={cache:function(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var cache=this.cache(owner),prop;if("string"==typeof data)cache[camelCase(data)]=value;else for(prop in data)cache[camelCase(prop)]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][camelCase(key)]},access:function(owner,key,value){return void 0===key||key&&"string"==typeof key&&void 0===value?this.get(owner,key):(this.set(owner,key,value),void 0===value?key:value)},remove:function(owner,key){var cache=owner[this.expando],i;if(void 0!==cache){if(void 0!==key)for(Array.isArray(key)?key=key.map(camelCase):(key=camelCase(key),key=(key in cache)?[key]:key.match(rnothtmlwhite)||[]),i=key.length;i--;)delete cache[key[i]];(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var elem=this[0],attrs=elem&&elem.attributes,i,name,data;if(void 0===key){if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=camelCase(name.slice(5)),dataAttr(elem,name,data[name])));dataPriv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data;return elem&&void 0===value?(data=dataUser.get(elem,key),void 0!==data)?data:(data=dataAttr(elem,key),void 0===data?void 0:data):void this.each(function(){dataUser.set(this,key,value)})},null,value,1<arguments.length,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||Array.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])},tmp;for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=dataPriv.get(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],isHiddenWithinTree=function(elem,el){return elem=el||elem,"none"===elem.style.display||""===elem.style.display&&jQuery.contains(elem.ownerDocument,elem)&&"none"===jQuery.css(elem,"display")},swap=function(elem,options,callback,args){var old={},ret,name;for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];for(name in ret=callback.apply(elem,args||[]),options)elem.style[name]=old[name];return ret},defaultDisplayMap={};jQuery.fn.extend({show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide()})}});var rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,rscriptType=/^$|^module$|\/(?:java|ecma)script/i,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue})();var documentElement=document.documentElement,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var elemData=dataPriv.get(elem),handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType;if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return"undefined"!=typeof jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),!!type)&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,(!special.setup||!1===special.setup.call(elem,data,namespaces,eventHandle))&&elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),!handleObj.handler.guid&&(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var elemData=dataPriv.hasData(elem)&&dataPriv.get(elem),j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType;if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;){if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),!type){for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);continue}for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],(mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||"**"===selector&&handleObj.selector)&&(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&((!special.teardown||!1===special.teardown.call(elem,namespaces,elemData.handle))&&jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var event=jQuery.event.fix(nativeEvent),args=Array(arguments.length),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{},i,j,ret,matched,handleObj,handlerQueue;for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,!(special.preDispatch&&!1===special.preDispatch.call(this,event))){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.rnamespace||event.rnamespace.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&!1===(event.result=ret)&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target,i,handleObj,sel,matchedHandlers,matchedSelectors;if(delegateCount&&cur.nodeType&&!("click"===event.type&&1<=event.button))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&("click"!==event.type||!0!==cur.disabled)){for(matchedHandlers=[],matchedSelectors={},i=0;i<delegateCount;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matchedSelectors[sel]&&(matchedSelectors[sel]=handleObj.needsContext?-1<jQuery(sel,this).index(cur):jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers})}return cur=this,delegateCount<handlers.length&&handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)}),handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:isFunction(hook)?function(){if(this.originalEvent)return hook(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[name]},set:function(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&nodeName(this,"input"))return this.click(),!1},_default:function(event){return nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){return this instanceof jQuery.Event?void(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&!1===src.returnValue?returnTrue:returnFalse,this.target=src.target&&3===src.target.nodeType?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||Date.now(),this[jQuery.expando]=!0):new jQuery.Event(src,props)},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(event){var button=event.button;return null==event.which&&rkeyEvent.test(event.type)?null==event.charCode?event.keyCode:event.charCode:!event.which&&void 0!==button&&rmouseEvent.test(event.type)?1&button?1:2&button?3:4&button?2:0:event.which}},jQuery.event.addProp),jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var target=this,related=event.relatedTarget,handleObj=event.handleObj,ret;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(!1===selector||"function"==typeof selector)&&(fn=selector,selector=void 0),!1===fn&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem),i,l,srcElements,destElements;if(!support.noCloneChecked&&(1===elem.nodeType||11===elem.nodeType)&&!jQuery.isXMLDoc(elem))for(destElements=getAll(clone),srcElements=getAll(elem),(i=0,l=srcElements.length);i<l;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),(i=0,l=srcElements.length);i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),0<destElements.length&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var special=jQuery.event.special,i=0,data,elem,type;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var i=0,elem;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;0>jQuery.inArray(this,ignored)&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var ret=[],insert=jQuery(selector),last=insert.length-1,i=0,elems;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)},rboxStyle=new RegExp(cssExpand.join("|"),"i");(function(){function computeStyleTests(){if(div){container.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",div.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",documentElement.appendChild(container).appendChild(div);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal=12===roundPixelMeasures(divStyle.marginLeft),div.style.right="60%",pixelBoxStylesVal=36===roundPixelMeasures(divStyle.right),boxSizingReliableVal=36===roundPixelMeasures(divStyle.width),div.style.position="absolute",scrollboxSizeVal=36===div.offsetWidth||"absolute",documentElement.removeChild(container),div=null}}function roundPixelMeasures(measure){return _Mathround(parseFloat(measure))}var container=document.createElement("div"),div=document.createElement("div"),pixelPositionVal,boxSizingReliableVal,scrollboxSizeVal,pixelBoxStylesVal,reliableMarginLeftVal;div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,jQuery.extend(support,{boxSizingReliable:function(){return computeStyleTests(),boxSizingReliableVal},pixelBoxStyles:function(){return computeStyleTests(),pixelBoxStylesVal},pixelPosition:function(){return computeStyleTests(),pixelPositionVal},reliableMarginLeft:function(){return computeStyleTests(),reliableMarginLeftVal},scrollboxSize:function(){return computeStyleTests(),scrollboxSizeVal}}))})();var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style;jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var origName=camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style,ret,type,hooks;if(isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0!==value){if(type=typeof value,"string"===type&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),null==value||value!==value)return;"number"===type&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(isCustomProp?style.setProperty(name,value):style[name]=value)}else return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name]}},css:function(elem,name,extra,styles){var origName=camelCase(name),isCustomProp=rcustomProp.test(name),val,num,hooks;return isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),!0===extra||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,dimension){jQuery.cssHooks[dimension]={get:function(elem,computed,extra){if(computed)return!rdisplayswap.test(jQuery.css(elem,"display"))||elem.getClientRects().length&&elem.getBoundingClientRect().width?getWidthOrHeight(elem,dimension,extra):swap(elem,cssShow,function(){return getWidthOrHeight(elem,dimension,extra)})},set:function(elem,value,extra){var styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles),subtract=extra&&boxModelAdjustment(elem,dimension,extra,isBorderBox,styles),matches;return isBorderBox&&support.scrollboxSize()===styles.position&&(subtract-=_Mathceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-parseFloat(styles[dimension])-boxModelAdjustment(elem,dimension,"border",!1,styles)-.5)),subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[dimension]=value,value=jQuery.css(elem,dimension)),setPositiveNumber(elem,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed)return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},"margin"!==prefix&&(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var map={},i=0,styles,len;if(Array.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0===value?jQuery.css(elem,name):jQuery.style(elem,name,value)},name,value,1<arguments.length)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var hooks=Tween.propHooks[this.prop],eased;return this.pos=this.options.duration?eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0)},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1===tween.elem.nodeType&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return .5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/,fxNow,inProgress;jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){isFunction(props)?(callback=props,props=["*"]):props=props.match(rnothtmlwhite);for(var index=0,length=props.length,prop;index<length;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!isFunction(easing)&&easing};return jQuery.fx.off?opt.duration=0:"number"!=typeof opt.duration&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),(null==opt.queue||!0===opt.queue)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||!1===optall.queue?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&!1!==type&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem===this&&(null==type||timers[index].queue===type)&&(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return!1!==type&&(type=type||"fx"),this.each(function(){var data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0,index;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var i=0,timers=jQuery.timers,timer;for(fxNow=Date.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){inProgress||(inProgress=!0,schedule())},jQuery.fx.stop=function(){inProgress=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var attrHandle=jQuery.expr.attrHandle,boolHook;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,1<arguments.length)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var nType=elem.nodeType,ret,hooks;if(3!==nType&&8!==nType&&2!==nType)return"undefined"==typeof elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value)?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var i=0,attrNames=value&&value.match(rnothtmlwhite),name;if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return!1===value?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var lowercaseName=name.toLowerCase(),ret,handle;return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=null==getter(elem,name,isXML)?null:lowercaseName,attrHandle[lowercaseName]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,1<arguments.length)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var nType=elem.nodeType,ret,hooks;if(3!==nType&&8!==nType&&2!==nType)return 1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]:hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.fn.extend({addClass:function(value){var i=0,classes,elem,cur,curValue,clazz,j,finalValue;if(isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if(classes=classesToArray(value),classes.length)for(;elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" ",cur){for(j=0;clazz=classes[j++];)0>cur.indexOf(" "+clazz+" ")&&(cur+=clazz+" ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var i=0,classes,elem,cur,curValue,clazz,j,finalValue;if(isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if(classes=classesToArray(value),classes.length)for(;elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" ",cur){for(j=0;clazz=classes[j++];)for(;-1<cur.indexOf(" "+clazz+" ");)cur=cur.replace(" "+clazz+" "," ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value,isValidValue="string"==type||Array.isArray(value);return"boolean"==typeof stateVal&&isValidValue?stateVal?this.addClass(value):this.removeClass(value):isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if(isValidValue)for(i=0,self=jQuery(this),classNames=classesToArray(value);className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(void 0===value||"boolean"==type)&&(className=getClass(this),className&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",className||!1===value?"":dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){var i=0,className,elem;for(className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&-1<(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className))return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var elem=this[0],hooks,ret,valueIsFunction;return arguments.length?(valueIsFunction=isFunction(value),this.each(function(i){var val;1!==this.nodeType||(val=valueIsFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":Array.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],(!hooks||!("set"in hooks)||void 0===hooks.set(this,val,"value"))&&(this.value=val))})):elem?(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value")))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret):void 0}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null==val?stripAndCollapse(jQuery.text(elem)):val}},select:{get:function(elem){var options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type,values=one?null:[],max=one?index+1:options.length,value,option,i;for(i=0>index?max:one?index:0;i<max;i++)if(option=options[i],(option.selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var options=elem.options,values=jQuery.makeArray(value),i=options.length,optionSet,option;i--;)option=options[i],(option.selected=-1<jQuery.inArray(jQuery.valHooks.option.get(option),values))&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value))return elem.checked=-1<jQuery.inArray(jQuery(elem).val(),value)}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),support.focusin="onfocusin"in window;var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,stopPropagationCallback=function(e){e.stopPropagation()};jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[],i,cur,tmp,bubbleType,ontype,handle,special,lastElement;if((cur=lastElement=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType)&&!rfocusMorph.test(type+jQuery.event.triggered)&&(-1<type.indexOf(".")&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=0>type.indexOf(":")&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||!1!==special.trigger.apply(elem,data))){if(!onlyHandlers&&!special.noBubble&&!isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)lastElement=cur,event.type=1<i?bubbleType:special.bindType||type,handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),!1===event.result&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&!1!==special._default.apply(eventPath.pop(),data)||!acceptData(elem)||!ontype||!isFunction(elem[type])||isWindow(elem)||(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,event.isPropagationStopped()&&lastElement.addEventListener(type,stopPropagationCallback),elem[type](),event.isPropagationStopped()&&lastElement.removeEventListener(type,stopPropagationCallback),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}}),support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce=Date.now(),rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=new window.DOMParser().parseFromString(data,"text/xml")}catch(e){xml=void 0}return(!xml||xml.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+data),xml};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var s=[],add=function(key,valueOrFunction){var value=isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(null==value?"":value)},prefix;if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:Array.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var statusText=nativeStatusText,isSuccess,success,error,response,modified;completed||(completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=0<status?4:0,isSuccess=200<=status&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),! --jQuery.active&&jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){return null==completed&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return null==completed&&(s.mimeType=type),this},statusCode:function(map){if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(var code in map)statusCode[code]=[statusCode[code],map[code]];return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}},transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached;if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;for(i in fireGlobals=jQuery.event&&s.global,fireGlobals&&0==jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(rhash,""),s.hasContent?s.data&&s.processData&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&(s.data=s.data.replace(r20,"+")):(uncached=s.url.slice(cacheURL.length),s.data&&(s.processData||"string"==typeof s.data)&&(cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),!1===s.cache&&(cacheURL=cacheURL.replace(rantiCache,"$1"),uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce++ +uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&!1!==s.contentType||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"===s.dataTypes[0]?"":", "+allTypes+"; q=0.01"):s.accepts["*"]),s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(!1===s.beforeSend.call(callbackContext,jqXHR,s)||completed))return jqXHR.abort();if(strAbort="abort",completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR),!transport)done(-1,"No Transport");else{if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),completed)return jqXHR;s.async&&0<s.timeout&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{completed=!1,transport.send(requestHeaders,done)}catch(e){if(completed)throw e;done(-1,e)}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return this[0]&&(isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this},wrapInner:function(html){return isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var htmlIsFunction=isFunction(html);return this.each(function(i){jQuery(this).wrapAll(htmlIsFunction?html.call(this,i):html)})},unwrap:function(selector){return this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)}),this}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var xhr=options.xhr(),i;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];for(i in options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest"),headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.ontimeout=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"==typeof xhr.status?complete(xhr.status,xhr.statusText):complete(0,"error"):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=callback(),errorCallback=xhr.onerror=xhr.ontimeout=callback("error"),void 0===xhr.onabort?xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})}:xhr.onabort=errorCallback,callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var jsonProp=!1!==s.jsonp&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data"),callbackName,overwritten,responseContainer;if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):!1!==s.jsonp&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),support.createHTMLDocument=function(){var body=document.implementation.createHTMLDocument("").body;return body.innerHTML="<form></form><form></form>",2===body.childNodes.length}(),jQuery.parseHTML=function(data,context,keepScripts){if("string"!=typeof data)return[];"boolean"==typeof context&&(keepScripts=context,context=!1);var base,parsed,scripts;return(context||(support.createHTMLDocument?(context=document.implementation.createHTMLDocument(""),base=context.createElement("base"),base.href=document.location.href,context.head.appendChild(base)):context=document),parsed=rsingleTag.exec(data),scripts=!keepScripts&&[],parsed)?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},jQuery.fn.load=function(url,params,callback){var self=this,off=url.indexOf(" "),selector,type,response;return-1<off&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),0<self.length&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={},curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition;"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&-1<(curCSSTop+curCSSLeft).indexOf("auto"),calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var elem=this[0],rect,win;if(elem)return elem.getClientRects().length?(rect=elem.getBoundingClientRect(),win=elem.ownerDocument.defaultView,{top:rect.top+win.pageYOffset,left:rect.left+win.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var elem=this[0],parentOffset={top:0,left:0},offsetParent,offset,doc;if("fixed"===jQuery.css(elem,"position"))offset=elem.getBoundingClientRect();else{for(offset=this.offset(),doc=elem.ownerDocument,offsetParent=elem.offsetParent||doc.documentElement;offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.parentNode;offsetParent&&offsetParent!==elem&&1===offsetParent.nodeType&&(parentOffset=jQuery(offsetParent).offset(),parentOffset.top+=jQuery.css(offsetParent,"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent,"borderLeftWidth",!0))}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;return isWindow(elem)?win=elem:9===elem.nodeType&&(win=elem.defaultView),void 0===val?win?win[prop]:elem[method]:void(win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val)},method,val,arguments.length)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(!0===margin||!0===value?"margin":"border");return access(this,function(elem,type,value){var doc;return isWindow(elem)?0===funcName.indexOf("outer")?elem["inner"+name]:elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,_Mathmax(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable)}})}),jQuery.each(["blur","focus","focusin","focusout","resize","scroll","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","change","select","submit","keydown","keypress","keyup","contextmenu"],function(i,name){jQuery.fn[name]=function(data,fn){return 0<arguments.length?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}}),jQuery.proxy=function(fn,context){var tmp,args,proxy;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),!!isFunction(fn))return args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy},jQuery.holdReady=function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},jQuery.isArray=Array.isArray,jQuery.parseJSON=JSON.parse,jQuery.nodeName=nodeName,jQuery.isFunction=isFunction,jQuery.isWindow=isWindow,jQuery.camelCase=camelCase,jQuery.type=toType,jQuery.now=Date.now,jQuery.isNumeric=function(obj){var type=jQuery.type(obj);return("number"===type||"string"===type)&&!isNaN(obj-parseFloat(obj))},"function"==typeof define&&define.amd&&define("86",[],function(){return jQuery})&&define("jquery",["86"],function(m){return m});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},noGlobal||(window.jQuery=window.$=jQuery),jQuery})}(),function(){var define=$__System.amdDefine;define("28",["86"],function(main){return main})}(),function(){var define=$__System.amdDefine;(function(factory){"function"==typeof define&&define.amd?define("87",["28"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("jquery")):factory(window.jQuery)})(function($){$.extend(!0,$.summernote,{plugins:{fileDialog:function(context){var self=this,ui=$.summernote.ui,$editor=context.layoutInfo.editor,options=context.options,lang=options.langInfo,callbacks=options.callbacks;context.memo("button.file",function(){return ui.button({contents:"<i class=\"fa fa-paperclip\" />",tooltip:lang.file.insert,click:context.createInvokeHandler("fileDialog.show")}).render()}),this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor,footer="<button href=\"#\" class=\"btn btn-primary note-file-btn\">"+lang.file.insert+"</button>",body="<div class=\"form-group note-group-select-from-files\"><label>"+lang.file.selectFromFiles+"</label><input class=\"note-file-input form-control\" type=\"file\" name=\"files\" multiple=\"multiple\" /></div><div class=\"form-group\" style=\"overflow:auto;\"><label>"+lang.file.text+"</label><input class=\"note-file-text form-control col-md-12\" type=\"text\" /></div>";this.$dialog=ui.dialog({title:lang.file.insert,fade:options.dialogsFade,body:body,footer:footer}).render().appendTo($container)},this.show=function(){context.invoke("editor.saveRange"),this.showFileDialog().then(function(files,text){ui.hideDialog(self.$dialog),context.invoke("editor.restoreRange"),callbacks.onFileUpload?context.triggerEvent("file.upload",files,text):console.log("onFileUpload not defined")}).fail(function(){context.invoke("editor.restoreRange")})},this.showFileDialog=function(){return $.Deferred(function(deferred){var $fileInput=self.$dialog.find(".note-file-input"),$fileText=self.$dialog.find(".note-file-text"),$fileBtn=self.$dialog.find(".note-file-btn");ui.onDialogShown(self.$dialog,function(){$fileBtn.click(function(event){event.preventDefault(),deferred.resolve($fileInput.prop("files")||$fileInput.prop("value"),$fileText.val())})}),ui.onDialogHidden(self.$dialog,function(){$fileBtn.off("click"),$fileInput.replaceWith($fileInput.clone().val("")),$fileText.replaceWith($fileText.clone().val("")),"pending"===deferred.state()&&deferred.reject()}),ui.showDialog(self.$dialog)})},this.destroy=function(){this.$dialog.remove(),this.$dialog=null}}},lang:{"en-US":{file:{file:"File",text:"Link Text",insert:"Insert File",selectFromFiles:"Select from files"}}},options:{callbacks:{onFileUpload:null}}})})}(),function(){var define=$__System.amdDefine;define("88",["87"],function(main){return main})}(),$__System.register("89",["5","6","7","28","80","81","82","83","85","88","a","7a","7b","7d","7e","7f"],function(_export){var _get,_inherits,_classCallCheck,$,_createClass,MasterEditor,Helper,EditorSummernote;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){$=_4["default"]},function(){},function(){},function(){},function(){},function(){},function(){},function(_a){_createClass=_a["default"]},function(_a2){MasterEditor=_a2.MasterEditor},function(_b){Helper=_b.Helper},function(){},function(){},function(){}],execute:function(){"use strict";EditorSummernote=function(_MasterEditor){function EditorSummernote(){var _this=this,WebTorrent=0>=arguments.length||void 0===arguments[0]?null:arguments[0];_classCallCheck(this,EditorSummernote),_get(Object.getPrototypeOf(EditorSummernote.prototype),"constructor",this).call(this),this.WebTorrent=WebTorrent,this.torrentNodeName="span",this.container=null,this.summernote=$.summernote,this.Helper=new Helper,this.changeEvent=function(){console.warn("No ChangeEvent defined!!!")},this.changeDelay=1e3,this.timeout=!0,this.timeoutCont=null,this.css=this.Helper.addBaseURL(["jspm_packages/"+System.map.bootstrap+"/css/bootstrap.min.css","JavaScript/js/Editor/lib/codemirror/codemirror.css","JavaScript/js/Editor/lib/codemirror/monokai.css","jspm_packages/"+System.map["summernote/summernote"]+"/summernote.css"]),this.css.forEach(function(e){$("<link/>",{rel:"stylesheet",type:"text/css",href:e}).appendTo("head")}),this.addEmojis(),this.opts={toolbar:[["insert",["link","codeview"]],["font",["style","fontsize","fontname"]],["weight",["color","bold","italic","underline","strikethrough","superscript","subscript","clear"]],["para",["height","ul","ol","paragraph","table"]],["view",["undo","redo","fullscreen","help"]]],callbacks:{onImageload:function(files){0<files.length&&_this.loadFileInit(files)},onFileUpload:function(files,text){0<files.length&&_this.loadFileInit(files,text,void 0,!1)},onMediaDelete:function($target){$target.remove();for(var nodeList=document.evaluate("//"+_this.torrentNodeName+"[@data-blobs[contains(., '"+$target[0].src+"')]]",document,null,XPathResult.ANY_TYPE,null),node=nodeList.iterateNext();node&&0!==node.childNodes.length;)node=nodeList.iterateNext();node&&(node.nextSibling&&""===node.nextSibling.innerHTML&&node.nextSibling.remove(),node.remove())}},hint:{match:/:([\-+\w]+)$/,search:function(keyword,callback){callback($.grep(emojis,function(item){return 0===item.indexOf(keyword)}))},template:function(item){var content=emojiUrls[item];return"<img src=\""+content+"\" width=\"20\" /> :"+item+":"},content:function(item){var url=emojiUrls[item];return url?$("<img />").attr("src",url).css("width",20)[0]:""}},codemirror:{mode:"htmlmixed",htmlMode:!0,lineNumbers:!0,theme:"monokai"},height:"40vh",minHeight:null,maxHeight:null,focus:!1}}return _inherits(EditorSummernote,_MasterEditor),_createClass(EditorSummernote,[{key:"add",value:function(){var container=0>=arguments.length||void 0===arguments[0]?this.container:arguments[0];this.container=container,container.summernote(this.opts),this.addFileDialog(container)}},{key:"remove",value:function(){var container=0>=arguments.length||void 0===arguments[0]?this.container:arguments[0];container.summernote("destroy")}},{key:"getData",value:function(){var container=0>=arguments.length||void 0===arguments[0]?this.container:arguments[0];return container.summernote("code")}},{key:"setData",value:function(){var container=0>=arguments.length||void 0===arguments[0]?this.container:arguments[0],data=1>=arguments.length||void 0===arguments[1]?"":arguments[1],type=2>=arguments.length||void 0===arguments[2]?"insertText":arguments[2];return container.summernote(type,data,type)}},{key:"attachChangeEvent",value:function(container,event){var _this2=this;void 0===container&&(container=this.container),this.changeEvent=event,container.on("summernote.change",function(we,contents){contents&&0<contents.length&&(clearTimeout(_this2.timeoutCont),_this2.timeoutCont=setTimeout(function(){_this2.WebTorrent&&0<_this2.WebTorrent.api.removeDeletedNodes().length&&!_this2.WebTorrent.api.areTorrentsLoading()&&$(".btn-codeview").first().removeClass("disabled").removeAttr("disabled",!0)},_this2.changeDelay),_this2.changeEvent(contents,container[0].id))})}},{key:"addFileDialog",value:function(){var container=0>=arguments.length||void 0===arguments[0]?this.container:arguments[0],ui=this.summernote.ui,button=ui.button({contents:"<i class=\"glyphicon glyphicon-open-file\"/>",tooltip:"File",click:function(){container.summernote("fileDialog.show")}});$(".note-btn-group.btn-group.note-insert").prepend(button.render())}},{key:"loadFileInit",value:function(files,text){var container=2>=arguments.length||void 0===arguments[2]?this.container:arguments[2],image=!!(3>=arguments.length||void 0===arguments[3])||arguments[3];if(this.WebTorrent){var torrent;if(!image&&(torrent=this.WebTorrent.api.torrents.get(this.WebTorrent.api.createFilesId(files)))&&torrent.sst_containsVideo&&!confirm("Adding a video more than once is going to reset the videos of Sender and Receiver. Do you want to continue?"))return;this.loadFile(files,text,container)}else _get(Object.getPrototypeOf(EditorSummernote.prototype),"loadFile",this).call(this,files,text,container)}},{key:"loadFile",value:function(files,text){var _this3=this,container=2>=arguments.length||void 0===arguments[2]?this.container:arguments[2],node=document.createElement(this.torrentNodeName);node.id=this.Helper.getRandomString(),$(".btn-codeview").first().addClass("disabled").attr("disabled",!0),this.WebTorrent.api.seed(files,text,node,void 0,void 0,void 0,function(){_this3.changeEvent(_this3.getData(),container[0].id),_this3.WebTorrent.api.areTorrentsLoading()||$(".btn-codeview").first().removeClass("disabled").removeAttr("disabled",!0)}),this.setData(container,document.createElement("span"),"insertNode"),this.setData(container,node,"insertNode")}}]),EditorSummernote}(MasterEditor),_export("EditorSummernote",EditorSummernote)}}}),$__System.registerDynamic("77",["33","35","31"],!0,function($__require,exports,module){var global=this||self,$export=$__require("33"),core=$__require("35"),fails=$__require("31");module.exports=function(KEY,exec){var fn=(core.Object||{})[KEY]||Object[KEY],exp={};exp[KEY]=exec(fn),$export($export.S+$export.F*fails(function(){fn(1)}),"Object",exp)}}),$__System.registerDynamic("8a",["8b","77"],!0,function($__require){var global=this||self,toIObject=$__require("8b");$__require("77")("getOwnPropertyDescriptor",function($getOwnPropertyDescriptor){return function(it,key){return $getOwnPropertyDescriptor(toIObject(it),key)}})}),$__System.registerDynamic("8c",["2e","8a"],!0,function($__require,exports,module){var global=this||self,$=$__require("2e");$__require("8a"),module.exports=function(it,key){return $.getDesc(it,key)}}),$__System.registerDynamic("8d",["8c"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("8c"),__esModule:!0}}),$__System.registerDynamic("5",["8d"],!0,function($__require,exports){"use strict";var global=this||self,_Object$getOwnPropertyDescriptor=$__require("8d")["default"];exports["default"]=function(_x,_x2,_x3){var _again=!0;_function:for(;_again;){var object=_x,property=_x2,receiver=_x3;_again=!1,null===object&&(object=Function.prototype);var desc=_Object$getOwnPropertyDescriptor(object,property);if(desc===void 0){var parent=Object.getPrototypeOf(object);if(null===parent)return;_x=parent,_x2=property,_x3=receiver,_again=!0,desc=parent=void 0;continue _function}else{if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}}},exports.__esModule=!0}),$__System.registerDynamic("8e",["2e"],!0,function($__require,exports,module){var global=this||self,$=$__require("2e");module.exports=function(P,D){return $.create(P,D)}}),$__System.registerDynamic("8f",["8e"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("8e"),__esModule:!0}}),$__System.registerDynamic("4d",["2e","3f","38","41"],!0,function($__require,exports,module){var global=this||self,getDesc=$__require("2e").getDesc,isObject=$__require("3f"),anObject=$__require("38"),check=function(O,proto){if(anObject(O),!isObject(proto)&&null!==proto)throw TypeError(proto+": can't set as prototype!")};module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(test,buggy,set){try{set=$__require("41")(Function.call,getDesc(Object.prototype,"__proto__").set,2),set(test,[]),buggy=!(test instanceof Array)}catch(e){buggy=!0}return function(O,proto){return check(O,proto),buggy?O.__proto__=proto:set(O,proto),O}}({},!1):void 0),check:check}}),$__System.registerDynamic("90",["33","4d"],!0,function($__require){var global=this||self,$export=$__require("33");$export($export.S,"Object",{setPrototypeOf:$__require("4d").set})}),$__System.registerDynamic("91",["90","35"],!0,function($__require,exports,module){var global=this||self;$__require("90"),module.exports=$__require("35").Object.setPrototypeOf}),$__System.registerDynamic("92",["91"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("91"),__esModule:!0}}),$__System.registerDynamic("6",["8f","92"],!0,function($__require,exports){"use strict";var global=this||self,_Object$create=$__require("8f")["default"],_Object$setPrototypeOf=$__require("92")["default"];exports["default"]=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=_Object$create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(_Object$setPrototypeOf?_Object$setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)},exports.__esModule=!0}),$__System.registerDynamic("93",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(){}}),$__System.registerDynamic("69",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(done,value){return{value:value,done:!!done}}}),$__System.registerDynamic("30",["42"],!0,function($__require,exports,module){var global=this||self,cof=$__require("42");module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return"String"==cof(it)?it.split(""):Object(it)}}),$__System.registerDynamic("8b",["30","67"],!0,function($__require,exports,module){var global=this||self,IObject=$__require("30"),defined=$__require("67");module.exports=function(it){return IObject(defined(it))}}),$__System.registerDynamic("94",["93","69","6f","8b","68"],!0,function($__require,exports,module){"use strict";var global=this||self,addToUnscopables=$__require("93"),step=$__require("69"),Iterators=$__require("6f"),toIObject=$__require("8b");module.exports=$__require("68")(Array,"Array",function(iterated,kind){this._t=toIObject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,step(1)):"keys"==kind?step(0,index):"values"==kind?step(0,O[index]):step(0,[index,O[index]])},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries")}),$__System.registerDynamic("56",["94","6f"],!0,function($__require){var global=this||self;$__require("94");var Iterators=$__require("6f");Iterators.NodeList=Iterators.HTMLCollection=Iterators.Array}),$__System.registerDynamic("70",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(it){return isNaN(it=+it)?0:(0<it?_Mathfloor:_Mathceil)(it)}}),$__System.registerDynamic("67",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(it){if(it==void 0)throw TypeError("Can't call method on  "+it);return it}}),$__System.registerDynamic("95",["70","67"],!0,function($__require,exports,module){var global=this||self,toInteger=$__require("70"),defined=$__require("67");module.exports=function(TO_STRING){return function(that,pos){var s=defined(that)+"",i=toInteger(pos),l=s.length,a,b;return 0>i||i>=l?TO_STRING?"":void 0:(a=s.charCodeAt(i),55296>a||56319<a||i+1===l||56320>(b=s.charCodeAt(i+1))||57343<b?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536)}}}),$__System.registerDynamic("49",[],!0,function($__require,exports,module){var global=this||self;module.exports=!0}),$__System.registerDynamic("39",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(it){if("function"!=typeof it)throw TypeError(it+" is not a function!");return it}}),$__System.registerDynamic("41",["39"],!0,function($__require,exports,module){var global=this||self,aFunction=$__require("39");module.exports=function(fn,that,length){return(aFunction(fn),void 0===that)?fn:1===length?function(a){return fn.call(that,a)}:2===length?function(a,b){return fn.call(that,a,b)}:3===length?function(a,b,c){return fn.call(that,a,b,c)}:function(){return fn.apply(that,arguments)}}}),$__System.registerDynamic("33",["3d","35","41"],!0,function($__require,exports,module){var global=this||self,global=$__require("3d"),core=$__require("35"),ctx=$__require("41"),PROTOTYPE="prototype",$export=function(type,name,source){var IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,IS_WRAP=type&$export.W,exports=IS_GLOBAL?core:core[name]||(core[name]={}),target=IS_GLOBAL?global:IS_STATIC?global[name]:(global[name]||{})[PROTOTYPE],key,own,out;for(key in IS_GLOBAL&&(source=name),source)own=!IS_FORCED&&target&&key in target,own&&key in exports||(out=own?target[key]:source[key],exports[key]=IS_GLOBAL&&"function"!=typeof target[key]?source[key]:IS_BIND&&own?ctx(out,global):IS_WRAP&&target[key]==out?function(C){var F=function(param){return this instanceof C?new C(param):C(param)};return F[PROTOTYPE]=C[PROTOTYPE],F}(out):IS_PROTO&&"function"==typeof out?ctx(Function.call,out):out,IS_PROTO&&((exports[PROTOTYPE]||(exports[PROTOTYPE]={}))[key]=out))};$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,module.exports=$export}),$__System.registerDynamic("6c",["66"],!0,function($__require,exports,module){var global=this||self;module.exports=$__require("66")}),$__System.registerDynamic("96",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}}}),$__System.registerDynamic("31",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(exec){try{return!!exec()}catch(e){return!0}}}),$__System.registerDynamic("4e",["31"],!0,function($__require,exports,module){var global=this||self;module.exports=!$__require("31")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})}),$__System.registerDynamic("66",["2e","96","4e"],!0,function($__require,exports,module){var global=this||self,$=$__require("2e"),createDesc=$__require("96");module.exports=$__require("4e")?function(object,key,value){return $.setDesc(object,key,createDesc(1,value))}:function(object,key,value){return object[key]=value,object}}),$__System.registerDynamic("97",["2e","96","50","66","3a"],!0,function($__require,exports,module){"use strict";var global=this||self,$=$__require("2e"),descriptor=$__require("96"),setToStringTag=$__require("50"),IteratorPrototype={};$__require("66")(IteratorPrototype,$__require("3a")("iterator"),function(){return this}),module.exports=function(Constructor,NAME,next){Constructor.prototype=$.create(IteratorPrototype,{next:descriptor(1,next)}),setToStringTag(Constructor,NAME+" Iterator")}}),$__System.registerDynamic("6b",[],!0,function($__require,exports,module){var global=this||self,hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}}),$__System.registerDynamic("50",["2e","6b","3a"],!0,function($__require,exports,module){var global=this||self,def=$__require("2e").setDesc,has=$__require("6b"),TAG=$__require("3a")("toStringTag");module.exports=function(it,tag,stat){it&&!has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})}}),$__System.registerDynamic("68",["49","33","6c","66","6b","6f","97","50","2e","3a"],!0,function($__require,exports,module){"use strict";var global=this||self,LIBRARY=$__require("49"),$export=$__require("33"),redefine=$__require("6c"),hide=$__require("66"),has=$__require("6b"),Iterators=$__require("6f"),$iterCreate=$__require("97"),setToStringTag=$__require("50"),getProto=$__require("2e").getProto,ITERATOR=$__require("3a")("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var getMethod=function(kind){return!BUGGY&&kind in proto?proto[kind]:kind===KEYS?function(){return new Constructor(this,kind)}:kind===VALUES?function(){return new Constructor(this,kind)}:function(){return new Constructor(this,kind)}},TAG=NAME+" Iterator",DEF_VALUES=DEFAULT==VALUES,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto[FF_ITERATOR]||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT),methods,key;if($native){var IteratorPrototype=getProto($default.call(new Base));setToStringTag(IteratorPrototype,TAG,!0),!LIBRARY&&has(proto,FF_ITERATOR)&&hide(IteratorPrototype,ITERATOR,returnThis),DEF_VALUES&&$native.name!==VALUES&&(VALUES_BUG=!0,$default=function(){return $native.call(this)})}if((!LIBRARY||FORCED)&&(BUGGY||VALUES_BUG||!proto[ITERATOR])&&hide(proto,ITERATOR,$default),Iterators[NAME]=$default,Iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:DEF_VALUES?getMethod("entries"):$default},FORCED)for(key in methods)key in proto||redefine(proto,key,methods[key]);else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods}}),$__System.registerDynamic("55",["95","68"],!0,function($__require){"use strict";var global=this||self,$at=$__require("95")(!0);$__require("68")(String,"String",function(iterated){this._t=iterated+"",this._i=0},function(){var O=this._t,index=this._i,point;return index>=O.length?{value:void 0,done:!0}:(point=$at(O,index),this._i+=point.length,{value:point,done:!1})})}),$__System.registerDynamic("3f",[],!0,function($__require,exports,module){var global=this||self;module.exports=function(it){return"object"==typeof it?null!==it:"function"==typeof it}}),$__System.registerDynamic("38",["3f"],!0,function($__require,exports,module){var global=this||self,isObject=$__require("3f");module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}}),$__System.registerDynamic("42",[],!0,function($__require,exports,module){var global=this||self,toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}}),$__System.registerDynamic("4a",["42","3a"],!0,function($__require,exports,module){var global=this||self,cof=$__require("42"),TAG=$__require("3a")("toStringTag"),ARG="Arguments"==cof(function(){return arguments}());module.exports=function(it){var O,T,B;return it===void 0?"Undefined":null===it?"Null":"string"==typeof(T=(O=Object(it))[TAG])?T:ARG?cof(O):"Object"==(B=cof(O))&&"function"==typeof O.callee?"Arguments":B}}),$__System.registerDynamic("98",["3d"],!0,function($__require,exports,module){var global=this||self,global=$__require("3d"),SHARED="__core-js_shared__",store=global[SHARED]||(global[SHARED]={});module.exports=function(key){return store[key]||(store[key]={})}}),$__System.registerDynamic("6a",[],!0,function($__require,exports,module){var global=this||self,id=0,px=Math.random();module.exports=function(key){return"Symbol(".concat(key===void 0?"":key,")_",(++id+px).toString(36))}}),$__System.registerDynamic("3d",[],!0,function($__require,exports,module){var global=this||self,global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global)}),$__System.registerDynamic("3a",["98","6a","3d"],!0,function($__require,exports,module){var global=this||self,store=$__require("98")("wks"),uid=$__require("6a"),Symbol=$__require("3d").Symbol;module.exports=function(name){return store[name]||(store[name]=Symbol&&Symbol[name]||(Symbol||uid)("Symbol."+name))}}),$__System.registerDynamic("6f",[],!0,function($__require,exports,module){var global=this||self;module.exports={}}),$__System.registerDynamic("62",["4a","3a","6f","35"],!0,function($__require,exports,module){var global=this||self,classof=$__require("4a"),ITERATOR=$__require("3a")("iterator"),Iterators=$__require("6f");module.exports=$__require("35").getIteratorMethod=function(it){if(it!=void 0)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}}),$__System.registerDynamic("35",[],!0,function($__require,exports,module){var global=this||self,core=module.exports={version:"1.2.6"};"number"==typeof __e&&(__e=core)}),$__System.registerDynamic("99",["38","62","35"],!0,function($__require,exports,module){var global=this||self,anObject=$__require("38"),get=$__require("62");module.exports=$__require("35").getIterator=function(it){var iterFn=get(it);if("function"!=typeof iterFn)throw TypeError(it+" is not iterable!");return anObject(iterFn.call(it))}}),$__System.registerDynamic("9a",["56","55","99"],!0,function($__require,exports,module){var global=this||self;$__require("56"),$__require("55"),module.exports=$__require("99")}),$__System.registerDynamic("5d",["9a"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("9a"),__esModule:!0}}),$__System.registerDynamic("2e",[],!0,function($__require,exports,module){var global=this||self,$Object=Object;module.exports={create:$Object.create,getProto:$Object.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:$Object.getOwnPropertyDescriptor,setDesc:$Object.defineProperty,setDescs:$Object.defineProperties,getKeys:$Object.keys,getNames:$Object.getOwnPropertyNames,getSymbols:$Object.getOwnPropertySymbols,each:[].forEach}}),$__System.registerDynamic("9b",["2e"],!0,function($__require,exports,module){var global=this||self,$=$__require("2e");module.exports=function(it,key,desc){return $.setDesc(it,key,desc)}}),$__System.registerDynamic("9",["9b"],!0,function($__require,exports,module){var global=this||self;module.exports={default:$__require("9b"),__esModule:!0}}),$__System.registerDynamic("a",["9"],!0,function($__require,exports){"use strict";var global=this||self,_Object$defineProperty=$__require("9")["default"];exports["default"]=function(){function defineProperties(target,props){for(var i=0,descriptor;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),_Object$defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),exports.__esModule=!0}),$__System.registerDynamic("7",[],!0,function($__require,exports){"use strict";var global=this||self;exports["default"]=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},exports.__esModule=!0}),$__System.register("19",["7","a"],function(_export){var _classCallCheck,_createClass,MasterHelper;return{setters:[function(_){_classCallCheck=_["default"]},function(_a){_createClass=_a["default"]}],execute:function(){"use strict";MasterHelper=function(){function MasterHelper(){_classCallCheck(this,MasterHelper),this.baseURL=window.sst&&window.sst.karma?window.sst.karma:location.host.includes("github")?"PeerWebSite/":""}return _createClass(MasterHelper,[{key:"addBaseURL",value:function(){var _this=this,url=0>=arguments.length||void 0===arguments[0]?[]:arguments[0],relative=!!(1>=arguments.length||void 0===arguments[1])||arguments[1],locOrigin=relative?".":location.origin;return url.map(function(e){return!_this.baseURL&&relative&&e.includes("./")?e:locOrigin+"/"+(location.host.includes("github")&&relative?"":_this.baseURL)+e.replace(":","/")})}},{key:"getRandomString",value:function(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var a=window.crypto.getRandomValues(new Uint32Array(3)),token="",i=0,l=a.length;i<l;i++)token+=a[i].toString(36);return token}return(Math.random()*new Date().getTime()).toString(36).replace(/\./g,"")}}]),MasterHelper}(),_export("MasterHelper",MasterHelper)}}}),$__System.register("5c",["5","6","7","19","a","5d"],function(_export){var _get,_inherits,_classCallCheck,MasterHelper,_createClass,_getIterator,Helper;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_4){MasterHelper=_4.MasterHelper},function(_a){_createClass=_a["default"]},function(_d){_getIterator=_d["default"]}],execute:function(){"use strict";Helper=function(_MasterHelper){function Helper(){_classCallCheck(this,Helper),_get(Object.getPrototypeOf(Helper.prototype),"constructor",this).apply(this,arguments)}return _inherits(Helper,_MasterHelper),_createClass(Helper,[{key:"createFilesId",value:function(files){if(!files.length)return this.getHash(""+files.lastModified+files.name+files.size);var str="",_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError;try{for(var _iterator=_getIterator(files),_step,file;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)file=_step.value,str+=""+file.lastModified+file.name+file.size}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator["return"]&&_iterator["return"]()}finally{if(_didIteratorError)throw _iteratorError}}return this.getHash(str)}},{key:"getHash",value:function(str){var hash=0,i,chr;for(i=0;i<str.length;i++)chr=str.charCodeAt(i),hash=(hash<<5)-hash+chr,hash|=0;return _Mathabs(hash)}}]),Helper}(MasterHelper),_export("Helper",Helper)}}}),$__System.register("9c",["7","a","5c"],function(_export){var _classCallCheck,_createClass,Helper,ServiceWorker;return{setters:[function(_){_classCallCheck=_["default"]},function(_a){_createClass=_a["default"]},function(_c){Helper=_c.Helper}],execute:function(){"use strict";ServiceWorker=function(){function ServiceWorker(serviceWorkerPath,serviceWorkerScope,getBlobByFileName){void 0===serviceWorkerPath&&(serviceWorkerPath="MasterServiceWorker.js"),void 0===serviceWorkerScope&&(serviceWorkerScope="./"),_classCallCheck(this,ServiceWorker),this.serviceWorkerPath=serviceWorkerPath,this.serviceWorkerScope=serviceWorkerScope,this.getBlobByFileName=getBlobByFileName,this.name="ServiceWorker",this.Worker=null,this.messageChannel=new MessageChannel,this.Helper=new Helper,this.serviceWorkerPath=this.Helper.addBaseURL([this.serviceWorkerPath])[0],this.serviceWorkerScope=this.Helper.addBaseURL([this.serviceWorkerScope])[0]}return _createClass(ServiceWorker,[{key:"run",value:function(){navigator.serviceWorker?(this.addReadyEventListener(),this.register()):console.warn("SST:Service Worker is not supported in this browser.")}},{key:"addReadyEventListener",value:function(){var _this=this;navigator.serviceWorker.ready.then(function(registration){_this.Worker=registration.active,_this.addMessageChannelEventListener(),_this.Worker.postMessage(location.origin,[_this.messageChannel.port2])})["catch"](function(e){console.error(e)})}},{key:"addMessageChannelEventListener",value:function(){var _this2=this;this.messageChannel.port1.onmessage=function(event){"!!!ready"===event.data||(Array.isArray(event.data)&&event.data[0].includes(".")?function(){var name=event.data[0].split("/").slice(-1)[0];_this2.getBlobByFileName(name).then(function(blob){_this2.Worker.postMessage([event.data,[blob,{status:200,statusText:name}]])},function(){_this2.Worker.postMessage([event.data,!1])})}():_this2.Worker.postMessage([event.data,!1]))}}},{key:"register",value:function(){navigator.serviceWorker.register(this.serviceWorkerPath,{scope:this.serviceWorkerScope}).then(function(registration){registration.update()})["catch"](function(e){console.error(e)})}}]),ServiceWorker}(),_export("ServiceWorker",ServiceWorker)}}}),$__System.register("9d",["7","22","29","75","89","a","2a","9c"],function(_export){var _classCallCheck,WebRTC,HTML,WebTorrentReceiver,EditorSummernote,_createClass,WebTorrentSeeder,ServiceWorker,MasterApp;return{setters:[function(_){_classCallCheck=_["default"]},function(_2){WebRTC=_2.WebRTC},function(_3){HTML=_3.HTML},function(_4){WebTorrentReceiver=_4.WebTorrentReceiver},function(_5){EditorSummernote=_5.EditorSummernote},function(_a){_createClass=_a["default"]},function(_a2){WebTorrentSeeder=_a2.WebTorrentSeeder},function(_c){ServiceWorker=_c.ServiceWorker}],execute:function(){"use strict";MasterApp=function(){function MasterApp(){_classCallCheck(this,MasterApp),this.WebRTC=new WebRTC,this.WebTorrentReceiver=new WebTorrentReceiver,this.HTML=new HTML(this.WebTorrentReceiver),this.WebTorrentSeeder=new WebTorrentSeeder,this.Editor=new EditorSummernote(this.WebTorrentSeeder),this.ServiceWorker=new ServiceWorker(void 0,void 0,this.WebTorrentReceiver.getBlobByFileName.bind(this.WebTorrentReceiver)),this.ServiceWorker.run(),window.sst&&window.sst.isDebug&&(window.App=this)}return _createClass(MasterApp,[{key:"createElements",value:function(name){return this.HTML.createElements(name,void 0,this.WebRTC.connection)}}]),MasterApp}(),_export("MasterApp",MasterApp)}}}),$__System.register("9e",["5","6","7","a","9d"],function(_export){var _get,_inherits,_classCallCheck,_createClass,MasterApp,App;return{setters:[function(_){_get=_["default"]},function(_2){_inherits=_2["default"]},function(_3){_classCallCheck=_3["default"]},function(_a){_createClass=_a["default"]},function(_d){MasterApp=_d.MasterApp}],execute:function(){"use strict";App=function(_MasterApp){function App(){_classCallCheck(this,App),_get(Object.getPrototypeOf(App.prototype),"constructor",this).call(this)}return _inherits(App,_MasterApp),_createClass(App,[{key:"createElements",value:function(){var name=0>=arguments.length||void 0===arguments[0]?"open-or-join-room":arguments[0],htmlElements=_get(Object.getPrototypeOf(App.prototype),"createElements",this).call(this,name),sendCont=htmlElements[0],receiveCont=htmlElements[1];this.WebTorrentReceiver.container=receiveCont[0];var button=htmlElements[2];this.Editor.add(sendCont),this.WebTorrentSeeder.container=sendCont[0].nextSibling.getElementsByClassName("note-editable")[0];var isViewerOnly=this.viewerOnly();this.HTML.attachButtonEvent(button,sendCont,this.Editor.getData,this.WebRTC.api.openOrJoinEvent,!isViewerOnly),isViewerOnly||(this.Editor.attachChangeEvent(sendCont,this.WebRTC.api.sendEvent),this.WebRTC.api.onNewParticipant.add(function(){return[this.Editor.getData(),this.Editor.container[0].id]},this)),this.WebRTC.api.onReceive.add(function(dataPack){this.HTML.setData(receiveCont,dataPack)},this),this.connectHash(),window.addEventListener("hashchange",this.connectHash),$("#txt-roomid").focus()}},{key:"connectHash",value:function(){location.hash&&($("#txt-roomid").val(location.hash.substr(1)),$("#open-or-join-room").click())}},{key:"viewerOnly",value:function(){return!!location.hash&&($("#controls, #sender, .note-editor").hide(),$("body").addClass("viewer"),!0)}}]),App}(MasterApp),_export("App",App)}}}),$__System.register("9f",["9e"],function(){"use strict";var App,App1;return{setters:[function(_e){App=_e.App}],execute:function(){App1=new App,App1.createElements()}}}),$__System.register("2",["9f"],function(){"use strict";return{setters:[function(){}],execute:function(){}}})})(function(factory){factory()});